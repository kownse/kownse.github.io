var window=window||global,a=a||(window.document={}),b=window.Laya=function(window,a){var b={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(a,c){return 1==arguments.length?b.__presubstr.call(this,a):b.__presubstr.call(this,a,c>0?c:this.length+c)},__init:function(a){a.forEach(function(a){a.__init$&&a.__init$()})},__isClass:function(a){return a&&(a.__isclass||a==Object||a==String||a==Array)},__newvec:function(a,b){var c=[];c.length=a;for(var d=0;d<a;d++)c[d]=b;return c},__extend:function(a,c){function d(){b.un(this,"constructor",a)}for(var e in c)if(c.hasOwnProperty(e)){var f=Object.getOwnPropertyDescriptor(c,e),g=f.get,h=f.set;g||h?g&&h?Object.defineProperty(a,e,f):(g&&Object.defineProperty(a,e,g),h&&Object.defineProperty(a,e,h)):a[e]=c[e]}d.prototype=c.prototype,a.prototype=new d,b.un(a.prototype,"__imps",b.__copy({},c.prototype.__imps))},__copy:function(a,b){if(!b)return null;a=a||{};for(var c in b)a[c]=b[c];return a},__package:function(a,c){if(!b.__packages[a]){b.__packages[a]=!0;var d=window,e=a.split(".");if(e.length>1)for(var f=0,g=e.length-1;f<g;f++){var h=d[e[f]];d=h?h:d[e[f]]={}}d[e[e.length-1]]||(d[e[e.length-1]]=c||{})}},__hasOwnProperty:function(a,b){function c(a,b){if(Object.hasOwnProperty.call(b.prototype,a))return!0;var d=b.prototype.__super;return null==d?null:c(a,d)}return b=b||this,Object.hasOwnProperty.call(b,a)||c(a,b.__class)},__typeof:function(a,b){if(!a||!b)return!1;if(b===String)return"string"==typeof a;if(b===Number)return"number"==typeof a;if(b.__interface__)b=b.__interface__;else if("string"!=typeof b)return a instanceof b;return a.__imps&&a.__imps[b]||a.__class==b},__as:function(a,b){return this.__typeof(a,b)?a:null},interface:function(a,c){b.__package(a,{});var d=b.__internals,e=d[a]=d[a]||{self:a};if(c){var f=c.split(",");e.extend=[];for(var g=0;g<f.length;g++){var a=f[g];d[a]=d[a]||{self:a},e.extend.push(d[a])}}for(var h=window,i=a.split("."),g=0;g<i.length-1;g++)h=h[i[g]];h[i[i.length-1]]={__interface__:a}},class:function(a,c,d,e){if(d&&b.__extend(a,d),c)if(b.__package(c,a),b.__classmap[c]=a,c.indexOf(".")>0){if(0==c.indexOf("laya.")){var f=c.split(".");e=e||f[f.length-1],b[e]&&console.log("Warning!,this class["+e+"] already exist:",b[e]),b[e]=a}}else"Main"==c?window.Main=a:(b[c]&&console.log("Error!,this class["+c+"] already exist:",b[c]),b[c]=a);var g=b.un,h=a.prototype;g(h,"hasOwnProperty",b.__hasOwnProperty),g(h,"__class",a),g(h,"__super",d),g(h,"__className",c),g(a,"__super",d),g(a,"__className",c),g(a,"__isclass",!0),g(a,"super",function(a){this.__super.call(a)})},imps:function(a,c){function d(a){var c,f;if((c=b.__internals[a])&&(e[a]=!0,f=c.extend))for(var g=0;g<f.length;g++)d(f[g].self)}if(!c)return null;var e=a.__imps||b.un(a,"__imps",{});for(var f in c)d(f)},getset:function(a,c,d,e,f){a?(e&&(c["_$GET_"+d]=e),f&&(c["_$SET_"+d]=f)):(e&&b.un(c,"_$get_"+d,e),f&&b.un(c,"_$set_"+d,f)),e&&f?Object.defineProperty(c,d,{get:e,set:f,enumerable:!1}):(e&&Object.defineProperty(c,d,{get:e,enumerable:!1}),f&&Object.defineProperty(c,d,{set:f,enumerable:!1}))},static:function(a,b){for(var c=0,d=b.length;c<d;c+=2)"length"==b[c]?a.length=b[c+1].call(a):function(){var d=b[c],e=b[c+1];Object.defineProperty(a,d,{get:function(){return delete this[d],this[d]=e.call(this)},set:function(a){delete this[d],this[d]=a},enumerable:!0,configurable:!0})}()},un:function(a,c,d){return d||(d=a[c]),b.__propun.value=d,Object.defineProperty(a,c,b.__propun),d},uns:function(a,c){c.forEach(function(c){b.un(a,c)})}};return window.console=window.console||{log:function(){}},window.trace=window.console.log,Error.prototype.throwError=function(){throw arguments},String.prototype.substr=b.__substr,Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),b}(window);!function(window,a,b){b.un,b.uns,b.static,b.class,b.getset,b.__newvec}(0,0,b),function(window,a,b){var c=b.un,d=b.uns,e=b.static,f=b.class,g=b.getset,h=b.__newvec;b.interface("laya.runtime.IMarket"),b.interface("laya.filters.IFilter"),b.interface("laya.display.ILayout"),b.interface("laya.resource.IDispose"),b.interface("laya.runtime.IPlatform"),b.interface("laya.resource.IDestroy"),b.interface("laya.runtime.IConchNode"),b.interface("laya.filters.IFilterAction"),b.interface("laya.runtime.ICPlatformClass"),b.interface("laya.resource.ICreateResource"),b.interface("laya.runtime.IConchRenderObject"),b.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var i=function(){function a(){}return f(a,"laya.utils.RunDriver"),a.FILTER_ACTIONS=[],a.pixelRatio=-1,a._charSizeTestDiv=null,a.now=function(){return Date.now()},a.getWindow=function(){return window},a.getPixelRatio=function(){if(a.pixelRatio<0){var b=Q.context,c=b.backingStorePixelRatio||b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1;a.pixelRatio=(Q.window.devicePixelRatio||1)/c,a.pixelRatio<1&&(a.pixelRatio=1)}return a.pixelRatio},a.getIncludeStr=function(a){return null},a.createShaderCondition=function(a){var b="(function() {return "+a+";})";return Q.window.eval(b)},a.fontMap=[],a.measureText=function(b,c){var d=a.hanzi.test(b);if(d&&a.fontMap[c])return a.fontMap[c];var e=Q.context;e.font=c;var f=e.measureText(b);return d&&(a.fontMap[c]=f),f},a.beginFlush=function(){},a.endFinish=function(){},a.addToAtlas=null,a.flashFlushImage=function(a){},a.drawToCanvas=function(a,b,c,d,e,f){var g=Ia.create("2D"),h=new K(c,d,g);return L.renders[b]._fun(a,h,e,f),g},a.createParticleTemplate2D=null,a.createGLTextur=null,a.createWebGLContext2D=null,a.changeWebGLSize=function(a,b){},a.createRenderSprite=function(a,b){return new L(a,b)},a.createFilterAction=function(a){return new y},a.createGraphics=function(){return new r},a.clear=function(a){J._context.ctx.clear()},a.clearAtlas=function(a){},a.addTextureToAtlas=function(a){},a.getTexturePixels=function(a,b,c,d,e){return null},a.skinAniSprite=function(){return null},e(a,["hanzi",function(){return this.hanzi=RegExp("^[一-龥]$")}]),a}(),j=function(){return g(1,b,"alertGlobalError",null,function(a){var b=0;Q.window.onerror=a?function(a,c,d,e,f){b++<5&&f&&alert("出错啦，请把此信息截图给研发商\n"+a+"\n"+f.stack)}:null}),b.init=function(a,c,d){for(var e=[],f=2,g=arguments.length;f<g;f++)e.push(arguments[f]);if(!b._isinit){b._isinit=!0,Q.__init__(),M.__init__(),r.__init__(),b.timer=new ea,b.loader=new ra;for(var f=0,h=e.length;f<h;f++)e[f].enable&&e[f].enable();p.__init__(),o.__init__(),N.__init__(),S.beginCheck(),b.g=b.stage=new Ea,b.stage.conchModel&&b.stage.conchModel.setRootNode();var i=Q.window.location,j=i.pathname;return j=":"==j.charAt(2)?j.substring(1):j,I.rootPath=I.basePath=I.getPath("file:"==i.protocol?j:i.protocol+"//"+i.host+i.pathname),b.render=new J(0,0),b.stage.size(a,c),L.__init__(),u.__init__(),w.instance.__init__(b.stage,J.canvas),Ma.__init__(),G.autoStopMusic=!0,H.__init__(),J.canvas}},b.stage=null,b.timer=null,b.loader=null,b.version="1.7.2beta",b.render=null,b.g=null,b._isinit=!1,e(b,["conchMarket",function(){return this.conchMarket=window.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=window.PlatformClass}]),b}(),k=function(){function a(){}return f(a,"Config"),a.WebGLTextCacheCount=500,a.atlasEnable=!1,a.showCanvasMark=!1,a.animationInterval=50,a.isAntialias=!1,a.isAlpha=!1,a.premultipliedAlpha=!1,a.i=!0,a.j=!1,a}(),l=function(){function a(){this._events=null}var b;f(a,"laya.events.EventDispatcher");var c=a.prototype;return c.hasListener=function(a){return!(!this._events||!this._events[a])},c.event=function(a,b){if(!this._events||!this._events[a])return!1;var c=this._events[a];if(c.run)c.once&&delete this._events[a],null!=b?c.runWith(b):c.run();else{for(var d=0,e=c.length;d<e;d++){var f=c[d];f&&(null!=b?f.runWith(b):f.run()),f&&!f.once||(c.splice(d,1),d--,e--)}0===c.length&&this._events&&delete this._events[a]}return!0},c.on=function(a,b,c,d){return this._createListener(a,b,c,d,!1)},c.once=function(a,b,c,d){return this._createListener(a,b,c,d,!0)},c._createListener=function(a,c,d,e,f,g){void 0===g&&(g=!0),g&&this.off(a,c,d,f);var h=b.create(c||this,d,e,f);this._events||(this._events={});var i=this._events;return i[a]?i[a].run?i[a]=[i[a],h]:i[a].push(h):i[a]=h,this},c.off=function(a,b,c,d){if(void 0===d&&(d=!1),!this._events||!this._events[a])return this;var e=this._events[a];if(null!=c)if(e.run)b&&e.caller!==b||e.method!==c||d&&!e.once||(delete this._events[a],e.recover());else{for(var f=0,g=0,h=e.length;g<h;g++){var i=e[g];!i||b&&i.caller!==b||i.method!==c||d&&!i.once||(f++,e[g]=null,i.recover())}f===h&&delete this._events[a]}return this},c.offAll=function(a){var b=this._events;if(!b)return this;if(a)this._recoverHandlers(b[a]),delete b[a];else{for(var c in b)this._recoverHandlers(b[c]);this._events=null}return this},c._recoverHandlers=function(a){if(a)if(a.run)a.recover();else for(var b=a.length-1;b>-1;b--)a[b]&&(a[b].recover(),a[b]=null)},c.isMouseEvent=function(b){return a.MOUSE_EVENTS[b]},a.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},a.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0}),b=function(a){function b(a,c,d,e){b.__super.call(this,a,c,d,e)}return f(b,"",a),b.prototype.recover=function(){this._id>0&&(this._id=0,b._pool.push(this.clear()))},b.create=function(a,c,d,e){return void 0===e&&(e=!0),b._pool.length?b._pool.pop().setTo(a,c,d,e):new b(a,c,d,e)},b._pool=[],b}(m)},a}(),m=function(){function a(a,b,c,d){this.once=!1,this._id=0,void 0===d&&(d=!1),this.setTo(a,b,c,d)}f(a,"laya.utils.Handler");var b=a.prototype;return b.setTo=function(b,c,d,e){return this._id=a._gid++,this.caller=b,this.method=c,this.args=d,this.once=e,this},b.run=function(){if(null==this.method)return null;var a=this._id,b=this.method.apply(this.caller,this.args);return this._id===a&&this.once&&this.recover(),b},b.runWith=function(a){if(null==this.method)return null;var b=this._id;if(null==a)var c=this.method.apply(this.caller,this.args);else c=this.args||a.unshift?this.args?this.method.apply(this.caller,this.args.concat(a)):this.method.apply(this.caller,a):this.method.call(this.caller,a);return this._id===b&&this.once&&this.recover(),c},b.clear=function(){return this.caller=null,this.method=null,this.args=null,this},b.recover=function(){this._id>0&&(this._id=0,a._pool.push(this.clear()))},a.create=function(b,c,d,e){return void 0===e&&(e=!0),a._pool.length?a._pool.pop().setTo(b,c,d,e):new a(b,c,d,e)},a._pool=[],a._gid=1,a}(),n=function(){function a(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}f(a,"laya.display.BitmapFont");var c=a.prototype;return c.loadFont=function(a,c){this._path=a,this._complete=c,b.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],m.create(this,this.onLoaded))},c.onLoaded=function(){this.parseFont(qa.getRes(this._path),qa.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.run()},c.parseFont=function(a,b){if(null!=a&&null!=b){this._texture=b;var c=a.getElementsByTagName("info");this.fontSize=parseInt(c[0].attributes.size.nodeValue);var d=c[0].attributes.padding.nodeValue,e=d.split(",");this._padding=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2]),parseInt(e[3])];var f=a.getElementsByTagName("char"),g=0;for(g=0;g<f.length;g++){var h=f[g].attributes,i=parseInt(h.id.nodeValue),j=parseInt(h.xoffset.nodeValue)/1,k=parseInt(h.yoffset.nodeValue)/1,l=parseInt(h.xadvance.nodeValue)/1,m=new F;m.x=parseInt(h.x.nodeValue),m.y=parseInt(h.y.nodeValue),m.width=parseInt(h.width.nodeValue),m.height=parseInt(h.height.nodeValue);var n=wa.create(b,m.x,m.y,m.width,m.height,j,k);this._maxWidth=Math.max(this._maxWidth,l+this.letterSpacing),this._fontCharDic[i]=n,this._fontWidthMap[i]=l}}},c.getCharTexture=function(a){return this._fontCharDic[a.charCodeAt(0)]},c.destroy=function(){if(this._texture){for(var a in this._fontCharDic){var b=this._fontCharDic[a];b&&b.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},c.setSpaceWidth=function(a){this._spaceWidth=a},c.getCharWidth=function(a){var b=a.charCodeAt(0);return this._fontWidthMap[b]?this._fontWidthMap[b]+this.letterSpacing:" "==a?this._spaceWidth+this.letterSpacing:0},c.getTextWidth=function(a){for(var b=0,c=0,d=a.length;c<d;c++)b+=this.getCharWidth(a.charAt(c));return b},c.getMaxWidth=function(){return this._maxWidth},c.getMaxHeight=function(){return this.fontSize},c.drawText=function(a,b,c,d,e,f){var g,h=this.getTextWidth(a),i=0;"center"===e&&(i=(f-h)/2),"right"===e&&(i=f-h);for(var j=0,k=0,l=a.length;k<l;k++)(g=this.getCharTexture(a.charAt(k)))&&(b.graphics.drawTexture(g,c+j+i,d),j+=this.getCharWidth(a.charAt(k)))},a}(),o=function(){function a(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=a._TF_EMPTY}f(a,"laya.display.css.Style");var b=a.prototype;return b.getTransform=function(){return this._tf},b.setTransform=function(b){this._tf="none"!==b&&b?b:a._TF_EMPTY},b.setTranslateX=function(b){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.translateX=b},b.setTranslateY=function(b){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.translateY=b},b.setScaleX=function(b){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.scaleX=b},b.setScale=function(b,c){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.scaleX=b,this._tf.scaleY=c},b.setScaleY=function(b){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.scaleY=b},b.setRotate=function(b){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.rotate=b},b.setSkewX=function(b){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.skewX=b},b.setSkewY=function(b){this._tf===a._TF_EMPTY&&(this._tf=new q),this._tf.skewY=b},b.destroy=function(){this.scrollRect=null},b.render=function(a,b,c,d){},b.getCSSStyle=function(){return ka.EMPTY},b._enableLayout=function(){return!1},g(0,b,"scaleX",function(){return this._tf.scaleX},function(a){this.setScaleX(a)}),g(0,b,"transform",function(){return this.getTransform()},function(a){this.setTransform(a)}),g(0,b,"translateX",function(){return this._tf.translateX},function(a){this.setTranslateX(a)}),g(0,b,"translateY",function(){return this._tf.translateY},function(a){this.setTranslateY(a)}),g(0,b,"scaleY",function(){return this._tf.scaleY},function(a){this.setScaleY(a)}),g(0,b,"block",function(){return 0!=(1&this._type)}),g(0,b,"skewY",function(){return this._tf.skewY},function(a){this.setSkewY(a)}),g(0,b,"rotate",function(){return this._tf.rotate},function(a){this.setRotate(a)}),g(0,b,"skewX",function(){return this._tf.skewX},function(a){this.setSkewX(a)}),g(0,b,"paddingLeft",function(){return 0}),g(0,b,"paddingTop",function(){return 0}),g(0,b,"absolute",function(){return!0}),a.__init__=function(){a._TF_EMPTY=new q,a.EMPTY=new a},a.EMPTY=null,a._TF_EMPTY=null,a}(),p=function(){function a(b){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=U.create(a.defaultColor),this.family=a.defaultFamily,this.stroke=a._STROKE,this.size=a.defaultSize,b&&b!==a.EMPTY&&b.copyTo(this)}f(a,"laya.display.css.Font");var b=a.prototype;return b.set=function(a){this._text=null;for(var b=a.split(" "),c=0,d=b.length;c<d;c++){var e=b[c];switch(e){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}e.indexOf("px")>0&&(this.size=parseInt(e),this.family=b[c+1],c++)}},b.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},b.copyTo=function(b){b._type=this._type,b._text=this._text,b._weight=this._weight,b._color=this._color,b.family=this.family,b.stroke=this.stroke!=a._STROKE?this.stroke.slice():a._STROKE,b.indent=this.indent,b.size=this.size},g(0,b,"password",function(){return 0!=(1024&this._type)},function(a){a?this._type|=1024:this._type&=-1025}),g(0,b,"color",function(){return this._color.strColor},function(a){this._color=U.create(a)}),g(0,b,"italic",function(){return 0!=(512&this._type)},function(a){a?this._type|=512:this._type&=-513}),g(0,b,"bold",function(){return 0!=(2048&this._type)},function(a){a?this._type|=2048:this._type&=-2049}),g(0,b,"weight",function(){return""+this._weight},function(a){var b=0;switch(a){case"normal":break;case"bold":this.bold=!0,b=700;break;case"bolder":b=800;break;case"lighter":b=100;break;default:b=parseInt(a)}this._weight=b,this._text=null}),g(0,b,"decoration",function(){return this._decoration?this._decoration.value:"none"},function(a){var b=a.split(" ");switch(this._decoration||(this._decoration={}),b[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=b[0]}b[1]&&(this._decoration.color=U.create(b)),this._decoration.value=a}),a.__init__=function(){a.EMPTY=new a(null)},a.EMPTY=null,a.defaultColor="#000000",a.defaultSize=12,a.defaultFamily="Arial",a.defaultFont="12px Arial",a._STROKE=[0,"#000000"],a._ITALIC=512,a._PASSWORD=1024,a._BOLD=2048,a}(),q=function(){function a(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return f(a,"laya.display.css.TransformInfo"),a}(),r=function(){function a(){this._one=null,this._cmds=null,this._render=this._renderEmpty,J.isConchNode&&(this._nativeObj=new _conchGraphics,this.id=this._nativeObj.conchID)}f(a,"laya.display.Graphics");var c=a.prototype;return c.destroy=function(){this.clear(),this._temp=null,this._bounds=null,this._rstBoundPoints=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},c.clear=function(){if(this._one=null,this._render=this._renderEmpty,this._cmds=null,this._temp&&(this._temp.length=0),this._sp&&(this._sp._renderType&=-2),this._sp&&(this._sp._renderType&=-513),this._repaint(),this._vectorgraphArray){for(var a=0,b=this._vectorgraphArray.length;a<b;a++)ha.getInstance().deleteShape(this._vectorgraphArray[a]);this._vectorgraphArray.length=0}},c._repaint=function(){this._temp&&(this._temp.length=0),this._sp&&this._sp.repaint()},c._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},c.getBounds=function(){return(!this._bounds||!this._temp||this._temp.length<1)&&(this._bounds=F._getWrapRec(this.getBoundPoints(),this._bounds)),this._bounds},c.getBoundPoints=function(){return(!this._temp||this._temp.length<1)&&(this._temp=this._getCmdPoints()),this._rstBoundPoints=ga.copyArray(this._rstBoundPoints,this._temp)},c._addCmd=function(a){this._cmds=this._cmds||[],a.callee=a.shift(),this._cmds.push(a)},c._getCmdPoints=function(){var b,c=J._context,d=this._cmds;if(b=this._temp||(this._temp=[]),b.length=0,d||null==this._one||(a._tempCmds.length=0,a._tempCmds.push(this._one),d=a._tempCmds),!d)return b;var e;e=a._tempMatrixArrays,e.length=0;var f=a._initMatrix;f.identity();for(var g,h,i=a._tempMatrix,j=0,k=d.length;j<k;j++)switch(g=d[j],g.callee){case c._save:case 7:e.push(f),f=f.clone();break;case c._restore:case 8:f=e.pop();break;case c._scale:case 5:i.identity(),i.translate(-g[2],-g[3]),i.scale(g[0],g[1]),i.translate(g[2],g[3]),this._switchMatrix(f,i);break;case c._rotate:case 3:i.identity(),i.translate(-g[1],-g[2]),i.rotate(g[0]),i.translate(g[1],g[2]),this._switchMatrix(f,i);break;case c._translate:case 6:i.identity(),i.translate(g[0],g[1]),this._switchMatrix(f,i);break;case c._transform:case 4:i.identity(),i.translate(-g[1],-g[2]),i.concat(g[0]),i.translate(g[1],g[2]),this._switchMatrix(f,i);break;case 16:case 24:a._addPointArrToRst(b,F._getBoundPointS(g[0],g[1],g[2],g[3]),f);break;case 17:f.copyTo(i),i.concat(g[4]),a._addPointArrToRst(b,F._getBoundPointS(g[0],g[1],g[2],g[3]),i);break;case c._drawTexture:h=g[0];var l=h.offsetX>0?h.offsetX:0,m=h.offsetY>0?h.offsetY:0;g[3]&&g[4]?a._addPointArrToRst(b,F._getBoundPointS(g[1]-l,g[2]-m,g[3]+h.sourceWidth-h.width,g[4]+h.sourceHeight-h.height),f):a._addPointArrToRst(b,F._getBoundPointS(g[1]-l,g[2]-m,h.width+h.sourceWidth-h.width,h.height+h.sourceHeight-h.height),f);break;case c._fillTexture:g[3]&&g[4]?a._addPointArrToRst(b,F._getBoundPointS(g[1],g[2],g[3],g[4]),f):(h=g[0],a._addPointArrToRst(b,F._getBoundPointS(g[1],g[2],h.width,h.height),f));break;case c._drawTextureWithTransform:;g[5]?(f.copyTo(i),i.concat(g[5]),i):f,h=g[0],l=h.offsetX>0?h.offsetX:0,m=h.offsetY>0?h.offsetY:0,g[3]&&g[4]?a._addPointArrToRst(b,F._getBoundPointS(g[1]-l,g[2]-m,g[3]+h.sourceWidth-h.width,g[4]+h.sourceHeight-h.height),f):a._addPointArrToRst(b,F._getBoundPointS(g[1]-l,g[2]-m,h.width+h.sourceWidth-h.width,h.height+h.sourceHeight-h.height),f);break;case c._drawRect:case 13:a._addPointArrToRst(b,F._getBoundPointS(g[0],g[1],g[2],g[3]),f);break;case c._drawCircle:case c._fillCircle:case 14:a._addPointArrToRst(b,F._getBoundPointS(g[0]-g[2],g[1]-g[2],g[2]+g[2],g[2]+g[2]),f);break;case c._drawLine:case 20:a._tempPoints.length=0;var n=NaN;n=.5*g[5],g[0]==g[2]?a._tempPoints.push(g[0]+n,g[1],g[2]+n,g[3],g[0]-n,g[1],g[2]-n,g[3]):g[1]==g[3]?a._tempPoints.push(g[0],g[1]+n,g[2],g[3]+n,g[0],g[1]-n,g[2],g[3]-n):a._tempPoints.push(g[0],g[1],g[2],g[3]),a._addPointArrToRst(b,a._tempPoints,f);break;case c._drawCurves:case 22:a._addPointArrToRst(b,A.I.getBezierPoints(g[2]),f,g[0],g[1]);break;case c._drawPoly:case c._drawLines:case 18:a._addPointArrToRst(b,g[2],f,g[0],g[1]);break;case c._drawPath:case 19:a._addPointArrToRst(b,this._getPathPoints(g[2]),f,g[0],g[1]);break;case c._drawPie:case 15:a._addPointArrToRst(b,this._getPiePoints(g[0],g[1],g[2],g[3],g[4]),f)}return b.length>200?b=ga.copyArray(b,F._getWrapRec(b)._getBoundPoints()):b.length>8&&(b=B.scanPList(b)),b},c._switchMatrix=function(a,b){b.concat(a),b.copyTo(a)},c.drawTexture=function(a,b,c,d,e,f,g){if(void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===g&&(g=1),a&&(d||(d=a.sourceWidth),e||(e=a.sourceHeight),d=d-a.sourceWidth+a.width,e=e-a.sourceHeight+a.height,!a.loaded||!(d<=0||e<=0))){b+=a.offsetX,c+=a.offsetY,this._sp&&(this._sp._renderType|=512);var h=[a,b,c,d,e,f,g];h.callee=f||1!=g?J._context._drawTextureWithTransform:J._context._drawTexture,null!=this._one||f||1!=g?this._saveToCmd(h.callee,h):(this._one=h,this._render=this._renderOneImg),a.loaded||a.once("loaded",this,this._textureLoaded,[a,h]),this._repaint()}},c.cleanByTexture=function(a,b,c,d,e){if(void 0===d&&(d=0),void 0===e&&(e=0),!a)return this.clear();this._one&&this._render===this._renderOneImg?(d||(d=a.sourceWidth),e||(e=a.sourceHeight),d=d-a.sourceWidth+a.width,e=e-a.sourceHeight+a.height,b+=a.offsetX,c+=a.offsetY,this._one[0]=a,this._one[1]=b,this._one[2]=c,this._one[3]=d,this._one[4]=e):(this.clear(),a&&this.drawTexture(a,b,c,d,e))},c.drawTextures=function(a,b){a&&this._saveToCmd(J._context._drawTextures,[a,b])},c.fillTexture=function(a,b,c,d,e,f,g){if(void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f="repeat"),a){var h=[a,b,c,d,e,f,g||E.EMPTY,{}];a.loaded||a.once("loaded",this,this._textureLoaded,[a,h]),this._saveToCmd(J._context._fillTexture,h)}},c._textureLoaded=function(a,b){b[3]=b[3]||a.width,b[4]=b[4]||a.height,this._repaint()},c._saveToCmd=function(a,b){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=b,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(b)),b.callee=a,this._temp&&(this._temp.length=0),this._repaint(),b},c.clipRect=function(a,b,c,d){this._saveToCmd(J._context._clipRect,[a,b,c,d])},c.fillText=function(a,b,c,d,e,f){this._saveToCmd(J._context._fillText,[a,b,c,d||p.defaultFont,e,f])},c.fillBorderText=function(a,b,c,d,e,f,g,h){this._saveToCmd(J._context._fillBorderText,[a,b,c,d||p.defaultFont,e,f,g,h])},c.strokeText=function(a,b,c,d,e,f,g){this._saveToCmd(J._context._strokeText,[a,b,c,d||p.defaultFont,e,f,g])},c.alpha=function(a){this._saveToCmd(J._context._alpha,[a])},c.transform=function(a,b,c){void 0===b&&(b=0),void 0===c&&(c=0),this._saveToCmd(J._context._transform,[a,b,c])},c.rotate=function(a,b,c){void 0===b&&(b=0),void 0===c&&(c=0),this._saveToCmd(J._context._rotate,[a,b,c])},c.scale=function(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=0),this._saveToCmd(J._context._scale,[a,b,c,d])},c.translate=function(a,b){this._saveToCmd(J._context._translate,[a,b])},c.save=function(){this._saveToCmd(J._context._save,[])},c.restore=function(){this._saveToCmd(J._context._restore,[])},c.replaceText=function(a){this._repaint();var b=this._cmds;if(b){for(var c=b.length-1;c>-1;c--)if(this._isTextCmd(b[c].callee))return b[c][0].toUpperCase?b[c][0]=a:b[c][0].setText(a),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=a:this._one[0].setText(a),!0;return!1},c._isTextCmd=function(a){return a===J._context._fillText||a===J._context._fillBorderText||a===J._context._strokeText},c.replaceTextColor=function(a){this._repaint();var b=this._cmds;if(b)for(var c=b.length-1;c>-1;c--)this._isTextCmd(b[c].callee)&&(b[c][4]=a,b[c][0].toUpperCase||(b[c][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=a,this._one[0].toUpperCase||(this._one[0].changed=!0))},c.loadImage=function(a,c,d,e,f,g){function h(a){a&&(i.drawTexture(a,c,d,e,f),null!=g&&g.call(i._sp,a))}var i=this;void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=0);var j=qa.getRes(a);j?h(j):b.loader.load(a,m.create(null,h),null,"image")},c._renderEmpty=function(a,b,c,d){},c._renderAll=function(a,b,c,d){for(var e,f=this._cmds,g=0,h=f.length;g<h;g++)(e=f[g]).callee.call(b,c,d,e)},c._renderOne=function(a,b,c,d){this._one.callee.call(b,c,d,this._one)},c._renderOneImg=function(a,b,c,d){this._one.callee.call(b,c,d,this._one),2305!==a._renderType&&(a._renderType|=1)},c.drawLine=function(a,b,c,d,e,f){void 0===f&&(f=1);var g=0;J.isWebGL&&(g=ha.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(g));var h=f%2==0?0:.5,i=[a+h,b+h,c+h,d+h,e,f,g];this._saveToCmd(J._context._drawLine,i)},c.drawLines=function(a,b,c,d,e){void 0===e&&(e=1);var f=0;J.isWebGL&&(f=ha.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(f));var g=e%2==0?0:.5,h=[a+g,b+g,c,d,e,f];this._saveToCmd(J._context._drawLines,h)},c.drawCurves=function(a,b,c,d,e){void 0===e&&(e=1);var f=[a,b,c,d,e];this._saveToCmd(J._context._drawCurves,f)},c.drawRect=function(a,b,c,d,e,f,g){void 0===g&&(g=1);var h=f?g/2:0,i=f?g:0,j=[a+h,b+h,c-i,d-i,e,f,g];this._saveToCmd(J._context._drawRect,j)},c.drawCircle=function(a,b,c,d,e,f){void 0===f&&(f=1);var g=e?f/2:0,h=0;J.isWebGL&&(h=ha.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(h));var i=[a,b,c-g,d,e,f,h];this._saveToCmd(J._context._drawCircle,i)},c.drawPie=function(a,b,c,d,e,f,g,h){void 0===h&&(h=1);var i=g?h/2:0,j=g?h:0,k=0;J.isWebGL&&(k=ha.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(k));var l=[a+i,b+i,c-j,d,e,f,g,h,k];l[3]=ga.toRadian(d),l[4]=ga.toRadian(e),this._saveToCmd(J._context._drawPie,l)},c._getPiePoints=function(b,c,d,e,f){var g=a._tempPoints;a._tempPoints.length=0,g.push(b,c);var h=Math.PI/10,i=NaN;for(i=e;i<f;i+=h)g.push(b+d*Math.cos(i),c+d*Math.sin(i));return f!=i&&g.push(b+d*Math.cos(f),c+d*Math.sin(f)),g},c.drawPoly=function(a,b,c,d,e,f){void 0===f&&(f=1);var g=0;if(J.isWebGL){g=ha.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(g);var h=!1;h=!(c.length>6)}var i=e?f%2==0?0:.5:0,j=[a+i,b+i,c,d,e,f,g,h];this._saveToCmd(J._context._drawPoly,j)},c._getPathPoints=function(b){var c=0,d=0,e=a._tempPoints;e.length=0,d=b.length;var f;for(c=0;c<d;c++)f=b[c],f.length>1&&(e.push(f[1],f[2]),f.length>3&&e.push(f[3],f[4]));return e},c.drawPath=function(a,b,c,d,e){var f=[a,b,c,d,e];this._saveToCmd(J._context._drawPath,f)},g(0,c,"cmds",function(){return this._cmds},function(a){this._sp&&(this._sp._renderType|=512),this._cmds=a,this._render=this._renderAll,this._repaint()}),a.__init__=function(){if(J.isConchNode){for(var a=laya.display.Graphics.prototype,b=ConchGraphics.prototype,c=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],d=0;d<=31;d++){var e=c[d];a[e]=b[e]}a._saveToCmd=null,b.drawImageS&&(a.drawTextures=function(a,b){if(a&&a.loaded&&a.bitmap&&a.source){var c=a.uv,d=a.bitmap.width,e=a.bitmap.height;this.drawImageS(a.bitmap.source,c[0]*d,c[1]*e,(c[2]-c[0])*d,(c[5]-c[3])*e,a.offsetX,a.offsetY,a.width,a.height,b)}}),a.drawTexture=function(a,b,c,d,e,f,g){if(void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===g&&(g=1),a){if(!a.loaded)return void a.once("loaded",this,function(){this.drawTexture(a,b,c,d,e,f)});if(a.loaded&&a.bitmap&&a.source&&(d||(d=a.sourceWidth),e||(e=a.sourceHeight),d=d-a.sourceWidth+a.width,e=e-a.sourceHeight+a.height,!(d<=0||e<=0))){b+=a.offsetX,c+=a.offsetY;var h=a.uv,i=a.bitmap.width,j=a.bitmap.height;this.drawImageM(a.bitmap.source,h[0]*i,h[1]*j,(h[2]-h[0])*i,(h[5]-h[3])*j,b,c,d,e,f),this._repaint()}}},a.fillTexture=function(a,b,c,d,e,f,g){if(void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f="repeat"),a&&a.loaded){var h,i=J._context.ctx,j=a.bitmap.width,k=a.bitmap.height,l=a.uv;h=a.uv!=wa.DEF_UV?i.createPattern(a.bitmap.source,f,l[0]*j,l[1]*k,(l[2]-l[0])*j,(l[5]-l[3])*k):i.createPattern(a.bitmap.source,f);var m=0,n=0;g&&(b+=g.x%a.width,c+=g.y%a.height,m-=g.x%a.width,n-=g.y%a.height),this._fillImage(h,b,c,m,n,d,e)}}}},a._addPointArrToRst=function(b,c,d,e,f){void 0===e&&(e=0),void 0===f&&(f=0);var g=0,h=0;for(h=c.length,g=0;g<h;g+=2)a._addPointToRst(b,c[g]+e,c[g+1]+f,d)},a._addPointToRst=function(a,b,c,d){var e=E.TEMP;e.setTo(b?b:0,c?c:0),d.transformPoint(e),a.push(e.x,e.y)},a._tempPoints=[],a._tempMatrixArrays=[],a._tempCmds=[],e(a,["_tempMatrix",function(){return this._tempMatrix=new D},"_initMatrix",function(){return this._initMatrix=new D}]),a}(),s=function(){function a(){}f(a,"laya.events.Event");var c=a.prototype;return c.setTo=function(a,b,c){return this.type=a,this.currentTarget=b,this.target=c,this},c.stopPropagation=function(){this._stoped=!0},g(0,c,"stageY",function(){return b.stage.mouseY}),g(0,c,"charCode",function(){return this.nativeEvent.charCode}),g(0,c,"touches",function(){var a=this.nativeEvent.touches;if(a)for(var c=b.stage,d=0,e=a.length;d<e;d++){var f=a[d],g=E.TEMP;g.setTo(f.clientX,f.clientY),c._canvasTransform.invertTransformPoint(g),c.transform.invertTransformPoint(g),f.stageX=g.x,f.stageY=g.y}return a}),g(0,c,"keyLocation",function(){return this.nativeEvent.keyLocation}),g(0,c,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),g(0,c,"altKey",function(){return this.nativeEvent.altKey}),g(0,c,"shiftKey",function(){return this.nativeEvent.shiftKey}),g(0,c,"stageX",function(){return b.stage.mouseX}),a.EMPTY=new a,a.MOUSE_DOWN="mousedown",a.MOUSE_UP="mouseup",a.CLICK="click",a.RIGHT_MOUSE_DOWN="rightmousedown",a.RIGHT_MOUSE_UP="rightmouseup",a.RIGHT_CLICK="rightclick",a.MOUSE_MOVE="mousemove",a.MOUSE_OVER="mouseover",a.MOUSE_OUT="mouseout",a.MOUSE_WHEEL="mousewheel",a.ROLL_OVER="mouseover",a.ROLL_OUT="mouseout",a.DOUBLE_CLICK="doubleclick",a.CHANGE="change",a.CHANGED="changed",a.RESIZE="resize",a.ADDED="added",a.REMOVED="removed",
a.DISPLAY="display",a.UNDISPLAY="undisplay",a.ERROR="error",a.COMPLETE="complete",a.LOADED="loaded",a.PROGRESS="progress",a.INPUT="input",a.RENDER="render",a.OPEN="open",a.MESSAGE="message",a.CLOSE="close",a.KEY_DOWN="keydown",a.KEY_PRESS="keypress",a.KEY_UP="keyup",a.FRAME="enterframe",a.DRAG_START="dragstart",a.DRAG_MOVE="dragmove",a.DRAG_END="dragend",a.ENTER="enter",a.SELECT="select",a.BLUR="blur",a.FOCUS="focus",a.VISIBILITY_CHANGE="visibilitychange",a.FOCUS_CHANGE="focuschange",a.PLAYED="played",a.PAUSED="paused",a.STOPPED="stopped",a.START="start",a.END="end",a.k="enablechanged",a.l="activeinhierarchychanged",a.COMPONENT_ADDED="componentadded",a.COMPONENT_REMOVED="componentremoved",a.LAYER_CHANGED="layerchanged",a.HIERARCHY_LOADED="hierarchyloaded",a.RECOVERING="recovering",a.RECOVERED="recovered",a.RELEASED="released",a.LINK="link",a.LABEL="label",a.FULL_SCREEN_CHANGE="fullscreenchange",a.DEVICE_LOST="devicelost",a.MESH_CHANGED="meshchanged",a.MATERIAL_CHANGED="materialchanged",a.RENDERQUEUE_CHANGED="renderqueuechanged",a.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",a.ANIMATION_CHANGED="animationchanged",a}(),t=function(){function a(){}return f(a,"laya.events.Keyboard"),a.NUMBER_0=48,a.NUMBER_1=49,a.NUMBER_2=50,a.NUMBER_3=51,a.NUMBER_4=52,a.NUMBER_5=53,a.NUMBER_6=54,a.NUMBER_7=55,a.NUMBER_8=56,a.NUMBER_9=57,a.A=65,a.B=66,a.C=67,a.D=68,a.E=69,a.F=70,a.G=71,a.H=72,a.I=73,a.J=74,a.K=75,a.L=76,a.M=77,a.N=78,a.O=79,a.P=80,a.Q=81,a.R=82,a.S=83,a.T=84,a.U=85,a.V=86,a.W=87,a.X=88,a.Y=89,a.Z=90,a.F1=112,a.F2=113,a.F3=114,a.F4=115,a.F5=116,a.F6=117,a.F7=118,a.F8=119,a.F9=120,a.F10=121,a.F11=122,a.F12=123,a.F13=124,a.F14=125,a.F15=126,a.NUMPAD=21,a.NUMPAD_0=96,a.NUMPAD_1=97,a.NUMPAD_2=98,a.NUMPAD_3=99,a.NUMPAD_4=100,a.NUMPAD_5=101,a.NUMPAD_6=102,a.NUMPAD_7=103,a.NUMPAD_8=104,a.NUMPAD_9=105,a.NUMPAD_ADD=107,a.NUMPAD_DECIMAL=110,a.NUMPAD_DIVIDE=111,a.NUMPAD_ENTER=108,a.NUMPAD_MULTIPLY=106,a.NUMPAD_SUBTRACT=109,a.SEMICOLON=186,a.EQUAL=187,a.COMMA=188,a.MINUS=189,a.PERIOD=190,a.SLASH=191,a.BACKQUOTE=192,a.LEFTBRACKET=219,a.BACKSLASH=220,a.RIGHTBRACKET=221,a.QUOTE=222,a.ALTERNATE=18,a.BACKSPACE=8,a.CAPS_LOCK=20,a.COMMAND=15,a.CONTROL=17,a.DELETE=46,a.ENTER=13,a.ESCAPE=27,a.PAGE_UP=33,a.PAGE_DOWN=34,a.END=35,a.HOME=36,a.LEFT=37,a.UP=38,a.RIGHT=39,a.DOWN=40,a.SHIFT=16,a.SPACE=32,a.TAB=9,a.INSERT=45,a}(),u=function(){function a(){}return f(a,"laya.events.KeyBoardManager"),a.__init__=function(){a._addEvent("keydown"),a._addEvent("keypress"),a._addEvent("keyup")},a._addEvent=function(a){Q.document.addEventListener(a,function(b){laya.events.KeyBoardManager._dispatch(b,a)},!0)},a._dispatch=function(c,d){if(a.enabled){a._event._stoped=!1,a._event.nativeEvent=c,a._event.keyCode=c.keyCode||c.which||c.charCode,"keydown"===d?a._pressKeys[a._event.keyCode]=!0:"keyup"===d&&(a._pressKeys[a._event.keyCode]=null);for(var e=b.stage.focus&&null!=b.stage.focus.event&&b.stage.focus.displayedInStage?b.stage.focus:b.stage,f=e;f;)f.event(d,a._event.setTo(d,f,e)),f=f.parent}},a.hasKeyDown=function(b){return a._pressKeys[b]},a._pressKeys={},a.enabled=!0,e(a,["_event",function(){return this._event=new s}]),a}(),v=function(){function a(){}return f(a,"laya.events.KeyLocation"),a.STANDARD=0,a.LEFT=1,a.RIGHT=2,a.NUM_PAD=3,a}(),w=function(){function a(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastOvers=[],this._currOvers=[],this._lastClickTimer=0,this._lastMoveTimer=0,this._isDoubleClick=!1,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._event=new s,this._matrix=new D,this._point=new E,this._rect=new F,this._prePoint=new E}f(a,"laya.events.MouseManager");var c=a.prototype;return c.__init__=function(b,c){var d=this;this._stage=b;var e=this,f=this._eventList;c.oncontextmenu=function(b){if(a.enabled)return!1},c.addEventListener("mousedown",function(b){a.enabled&&(b.preventDefault(),f.push(b),e.mouseDownTime=Q.now())}),c.addEventListener("mouseup",function(b){a.enabled&&(b.preventDefault(),f.push(b),e.mouseDownTime=-Q.now())},!0),c.addEventListener("mousemove",function(b){if(a.enabled){b.preventDefault();var c=Q.now();if(c-e._lastMoveTimer<10)return;e._lastMoveTimer=c,f.push(b)}},!0),c.addEventListener("mouseout",function(b){a.enabled&&f.push(b)}),c.addEventListener("mouseover",function(b){a.enabled&&f.push(b)}),c.addEventListener("touchstart",function(b){a.enabled&&(f.push(b),d.runEvent(),Ma.isInputting||b.preventDefault(),e.mouseDownTime=Q.now())}),c.addEventListener("touchend",function(b){a.enabled&&(Ma.isInputting||b.preventDefault(),f.push(b),e.mouseDownTime=-Q.now())},!0),c.addEventListener("touchmove",function(b){a.enabled&&(b.preventDefault(),f.push(b))},!0),c.addEventListener("mousewheel",function(b){a.enabled&&f.push(b)}),c.addEventListener("DOMMouseScroll",function(b){a.enabled&&f.push(b)})},c.initEvent=function(a,b){var c=this;c._event._stoped=!1,c._event.nativeEvent=b||a,c._target=null,this._point.setTo(a.clientX,a.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),c.mouseX=this._point.x,c.mouseY=this._point.y,c._event.touchId=a.identifier||0},c.checkMouseWheel=function(a){this._event.delta=a.wheelDelta?.025*a.wheelDelta:-a.detail;for(var b=0,c=this._lastOvers.length;b<c;b++){var d=this._lastOvers[b];d.event("mousewheel",this._event.setTo("mousewheel",d,this._target))}this._stage.event("mousewheel",this._event.setTo("mousewheel",this._stage,this._target))},c.checkMouseOut=function(){if(!this.disableMouseEvent){for(var a=0,b=this._lastOvers.length;a<b;a++){var c=this._lastOvers[a];!c.destroyed&&this._currOvers.indexOf(c)<0&&(c._set$P("$_MOUSEOVER",!1),c.event("mouseout",this._event.setTo("mouseout",c,c)))}var d=this._lastOvers;this._lastOvers=this._currOvers,this._currOvers=d,this._currOvers.length=0}},c.onMouseMove=function(a){this.sendMouseMove(a),this._event._stoped=!1,this.sendMouseOver(this._target)},c.sendMouseMove=function(a){a.event("mousemove",this._event.setTo("mousemove",a,this._target)),!this._event._stoped&&a.parent&&this.sendMouseMove(a.parent)},c.sendMouseOver=function(a){(a.parent||a===this._stage)&&(a._get$P("$_MOUSEOVER")||(a._set$P("$_MOUSEOVER",!0),a.event("mouseover",this._event.setTo("mouseover",a,this._target))),this._currOvers.push(a)),!this._event._stoped&&a.parent&&this.sendMouseOver(a.parent)},c.onMouseDown=function(a){Ma.isInputting&&b.stage.focus&&b.stage.focus.focus&&!b.stage.focus.contains(this._target)&&(b.stage.focus.focus=!1),this._onMouseDown(a)},c._onMouseDown=function(a){this._isLeftMouse?(a._set$P("$_MOUSEDOWN",this._touchIDs[this._event.touchId]),a.event("mousedown",this._event.setTo("mousedown",a,this._target))):(a._set$P("$_RIGHTMOUSEDOWN",this._touchIDs[this._event.touchId]),a.event("rightmousedown",this._event.setTo("rightmousedown",a,this._target))),!this._event._stoped&&a.parent&&this.onMouseDown(a.parent)},c.onMouseUp=function(a){var b=this._isLeftMouse?"mouseup":"rightmouseup";this.sendMouseUp(a,b),this._event._stoped=!1,this.sendClick(this._target,b)},c.sendMouseUp=function(a,b){a.event(b,this._event.setTo(b,a,this._target)),!this._event._stoped&&a.parent&&this.sendMouseUp(a.parent,b)},c.sendClick=function(a,b){a.destroyed||("mouseup"===b&&a._get$P("$_MOUSEDOWN")===this._touchIDs[this._event.touchId]?(a._set$P("$_MOUSEDOWN",-1),a.event("click",this._event.setTo("click",a,this._target)),this._isDoubleClick&&a.event("doubleclick",this._event.setTo("doubleclick",a,this._target))):"rightmouseup"===b&&a._get$P("$_RIGHTMOUSEDOWN")===this._touchIDs[this._event.touchId]&&(a._set$P("$_RIGHTMOUSEDOWN",-1),a.event("rightclick",this._event.setTo("rightclick",a,this._target))),!this._event._stoped&&a.parent&&this.sendClick(a.parent,b))},c.check=function(a,b,c,d){this._point.setTo(b,c),a.fromParentPoint(this._point),b=this._point.x,c=this._point.y;var e=a.scrollRect;if(e){this._rect.setTo(e.x,e.y,e.width,e.height);var f=this._rect.contains(b,c);if(!f)return!1}if(!this.disableMouseEvent){if(a.hitTestPrior&&!a.mouseThrough&&!this.hitTest(a,b,c))return!1;for(var g=a._childs.length-1;g>-1;g--){var h=a._childs[g];if(!h.destroyed&&h.mouseEnabled&&h.visible&&this.check(h,b,c,d))return!0}}return f=this.hitTest(a,e?b-e.x:b,e?c-e.y:c),f?(this._target=a,d.call(this,a)):d===this.onMouseUp&&a===this._stage&&(this._target=this._stage,d.call(this,this._target)),f},c.hitTest=function(a,b,c){var d=!1;if(a.hitArea instanceof laya.utils.HitArea)return a.hitArea.isHit(b,c);if(a.width>0&&a.height>0||a.mouseThrough||a.hitArea){var e=this._rect;a.mouseThrough?d=a.getGraphicBounds().contains(b,c):(a.hitArea?e=a.hitArea:e.setTo(0,0,a.width,a.height),d=e.contains(b,c))}return d},c.runEvent=function(){var b=this._eventList.length;if(b){for(var c=this,d=0;d<b;){var e=this._eventList[d];switch("mousemove"!==e.type&&(this._prePoint.x=this._prePoint.y=-1e6),e.type){case"mousedown":this._touchIDs[0]=this._id++,a._isTouchRespond?a._isTouchRespond=!1:(c._isLeftMouse=0===e.button,c.initEvent(e),c.check(c._stage,c.mouseX,c.mouseY,c.onMouseDown));break;case"mouseup":c._isLeftMouse=0===e.button;var f=Q.now();c._isDoubleClick=f-c._lastClickTimer<300,c._lastClickTimer=f,c.initEvent(e),c.check(c._stage,c.mouseX,c.mouseY,c.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-e.clientX)+Math.abs(this._prePoint.y-e.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=e.clientX,this._prePoint.y=e.clientY,c.initEvent(e),c.check(c._stage,c.mouseX,c.mouseY,c.onMouseMove),c.checkMouseOut());break;case"touchstart":a._isTouchRespond=!0,c._isLeftMouse=!0;for(var g=e.changedTouches,h=0,i=g.length;h<i;h++){var j=g[h];this._id%200==0&&(this._touchIDs={}),this._touchIDs[j.identifier]=this._id++,c.initEvent(j,e),c.check(c._stage,c.mouseX,c.mouseY,c.onMouseDown)}break;case"touchend":a._isTouchRespond=!0,c._isLeftMouse=!0,f=Q.now(),c._isDoubleClick=f-c._lastClickTimer<300,c._lastClickTimer=f;var k=e.changedTouches;for(h=0,i=k.length;h<i;h++)c.initEvent(k[h],e),c.check(c._stage,c.mouseX,c.mouseY,c.onMouseUp);break;case"touchmove":var l=e.changedTouches;for(h=0,i=l.length;h<i;h++)c.initEvent(l[h],e),c.check(c._stage,c.mouseX,c.mouseY,c.onMouseMove);c.checkMouseOut();break;case"wheel":case"mousewheel":case"DOMMouseScroll":c.checkMouseWheel(e);break;case"mouseout":c._stage.event("mouseout",c._event.setTo("mouseout",c._stage,c._stage));break;case"mouseover":c._stage.event("mouseover",c._event.setTo("mouseover",c._stage,c._stage))}d++}this._eventList.length=0}},a.enabled=!0,a._isTouchRespond=!1,e(a,["instance",function(){return this.instance=new a}]),a}(),x=function(){function a(){this._action=null}f(a,"laya.filters.Filter");var c=a.prototype;return b.imps(c,{"laya.filters.IFilter":!0}),c.callNative=function(a){},g(0,c,"type",function(){return-1}),g(0,c,"action",function(){return this._action}),a.BLUR=16,a.COLOR=32,a.GLOW=8,a._filterStart=null,a._filterEnd=null,a._EndTarget=null,a._recycleScope=null,a._filter=null,a._useSrc=null,a._endSrc=null,a._useOut=null,a._endOut=null,a}(),y=function(){function a(){this.data=null}f(a,"laya.filters.ColorFilterAction");var c=a.prototype;return b.imps(c,{"laya.filters.IFilterAction":!0}),c.apply=function(a){var b=a.ctx.ctx,c=a.ctx.ctx.canvas;if(0==c.width||0==c.height)return c;for(var d,e=b.getImageData(0,0,c.width,c.height),f=e.data,g=0,h=f.length;g<h;g+=4)d=this.getColor(f[g],f[g+1],f[g+2],f[g+3]),0!=f[g+3]&&(f[g]=d[0],f[g+1]=d[1],f[g+2]=d[2],f[g+3]=d[3]);return b.putImageData(e,0,0),a},c.getColor=function(a,b,c,d){var e=[];if(this.data._mat&&this.data._alpha){var f=this.data._mat,g=this.data._alpha;e[0]=f[0]*a+f[1]*b+f[2]*c+f[3]*d+g[0],e[1]=f[4]*a+f[5]*b+f[6]*c+f[7]*d+g[1],e[2]=f[8]*a+f[9]*b+f[10]*c+f[11]*d+g[2],e[3]=f[12]*a+f[13]*b+f[14]*c+f[15]*d+g[3]}return e},a}(),z=function(){function a(){}return f(a,"laya.maths.Arith"),a.formatR=function(a){return a>Math.PI&&(a-=2*Math.PI),a<-Math.PI&&(a+=2*Math.PI),a},a.isPOT=function(a,b){return a>0&&0==(a&a-1)&&b>0&&0==(b&b-1)},a.setMatToArray=function(a,b){a.a,a.b,a.c,a.d,a.tx,a.ty,b[0]=a.a,b[1]=a.b,b[4]=a.c,b[5]=a.d,b[12]=a.tx,b[13]=a.ty},a}(),A=function(){function a(){this._controlPoints=[new E,new E,new E],this._calFun=this.getPoint2}f(a,"laya.maths.Bezier");var b=a.prototype;return b._switchPoint=function(a,b){var c=this._controlPoints.shift();c.setTo(a,b),this._controlPoints.push(c)},b.getPoint2=function(a,b){var c=this._controlPoints[0],d=this._controlPoints[1],e=this._controlPoints[2],f=Math.pow(1-a,2)*c.x+2*a*(1-a)*d.x+Math.pow(a,2)*e.x,g=Math.pow(1-a,2)*c.y+2*a*(1-a)*d.y+Math.pow(a,2)*e.y;b.push(f,g)},b.getPoint3=function(a,b){var c=this._controlPoints[0],d=this._controlPoints[1],e=this._controlPoints[2],f=this._controlPoints[3],g=Math.pow(1-a,3)*c.x+3*d.x*a*(1-a)*(1-a)+3*e.x*a*a*(1-a)+f.x*Math.pow(a,3),h=Math.pow(1-a,3)*c.y+3*d.y*a*(1-a)*(1-a)+3*e.y*a*a*(1-a)+f.y*Math.pow(a,3);b.push(g,h)},b.insertPoints=function(a,b){var c=NaN;a=a>0?a:5;var d=NaN;for(d=1/a,c=0;c<=1;c+=d)this._calFun(c,b)},b.getBezierPoints=function(a,b,c){void 0===b&&(b=5),void 0===c&&(c=2);var d=0,e=0;if((e=a.length)<2*(c+1))return[];var f;switch(f=[],c){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=c;)this._controlPoints.push(new E);for(d=0;d<2*c;d+=2)this._switchPoint(a[d],a[d+1]);for(d=2*c;d<e;d+=2)this._switchPoint(a[d],a[d+1]),d/2%c==0&&this.insertPoints(b,f);return f},e(a,["I",function(){return this.I=new a}]),a}(),B=function(){function a(){}return f(a,"laya.maths.GrahamScan"),a.multiply=function(a,b,c){return(a.x-c.x)*(b.y-c.y)-(b.x-c.x)*(a.y-c.y)},a.dis=function(a,b){return(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y)},a._getPoints=function(b,c,d){for(void 0===c&&(c=!1),a._mPointList||(a._mPointList=[]);a._mPointList.length<b;)a._mPointList.push(new E);return d||(d=[]),d.length=0,c?a.getFrom(d,a._mPointList,b):a.getFromR(d,a._mPointList,b),d},a.getFrom=function(a,b,c){var d=0;for(d=0;d<c;d++)a.push(b[d]);return a},a.getFromR=function(a,b,c){var d=0;for(d=0;d<c;d++)a.push(b.pop());return a},a.pListToPointList=function(b,c){void 0===c&&(c=!1);var d=0,e=b.length/2,f=a._getPoints(e,c,a._tempPointList);for(d=0;d<e;d++)f[d].setTo(b[d+d],b[d+d+1]);return f},a.pointListToPlist=function(b){var c,d=0,e=b.length,f=a._temPList;for(f.length=0,d=0;d<e;d++)c=b[d],f.push(c.x,c.y);return f},a.scanPList=function(b){return ga.copyArray(b,a.pointListToPlist(a.scan(a.pListToPointList(b,!0))))},a.scan=function(b){var c,d,e,f=0,g=0,h=0,i=b.length,j={};for(d=a._temArr,d.length=0,i=b.length,f=i-1;f>=0;f--)c=b[f],e=c.x+"_"+c.y,j.hasOwnProperty(e)||(j[e]=!0,d.push(c));for(i=d.length,ga.copyArray(b,d),f=1;f<i;f++)(b[f].y<b[h].y||b[f].y==b[h].y&&b[f].x<b[h].x)&&(h=f);for(c=b[0],b[0]=b[h],b[h]=c,f=1;f<i-1;f++){for(h=f,g=f+1;g<i;g++)(a.multiply(b[g],b[h],b[0])>0||0==a.multiply(b[g],b[h],b[0])&&a.dis(b[0],b[g])<a.dis(b[0],b[h]))&&(h=g);c=b[f],b[f]=b[h],b[h]=c}if(d=a._temArr,d.length=0,b.length<3)return ga.copyArray(d,b);for(d.push(b[0],b[1],b[2]),f=3;f<i;f++){for(;d.length>=2&&a.multiply(b[f],d[d.length-1],d[d.length-2])>=0;)d.pop();b[f]&&d.push(b[f])}return d},a._mPointList=null,a._tempPointList=[],a._temPList=[],a._temArr=[],a}(),C=function(){function a(){}return f(a,"laya.maths.MathUtil"),a.subtractVector3=function(a,b,c){c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2]},a.lerp=function(a,b,c){return a*(1-c)+b*c},a.scaleVector3=function(a,b,c){c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b},a.lerpVector3=function(a,b,c,d){var e=a[0],f=a[1],g=a[2];d[0]=e+c*(b[0]-e),d[1]=f+c*(b[1]-f),d[2]=g+c*(b[2]-g)},a.lerpVector4=function(a,b,c,d){var e=a[0],f=a[1],g=a[2],h=a[3];d[0]=e+c*(b[0]-e),d[1]=f+c*(b[1]-f),d[2]=g+c*(b[2]-g),d[3]=h+c*(b[3]-h)},a.slerpQuaternionArray=function(a,b,c,d,e,f,g){var h,i,j,k,l,m=a[b+0],n=a[b+1],o=a[b+2],p=a[b+3],q=c[d+0],r=c[d+1],s=c[d+2],t=c[d+3];return i=m*q+n*r+o*s+p*t,i<0&&(i=-i,q=-q,r=-r,s=-s,t=-t),1-i>1e-6?(h=Math.acos(i),j=Math.sin(h),k=Math.sin((1-e)*h)/j,l=Math.sin(e*h)/j):(k=1-e,l=e),f[g+0]=k*m+l*q,f[g+1]=k*n+l*r,f[g+2]=k*o+l*s,f[g+3]=k*p+l*t,f},a.getRotation=function(a,b,c,d){return Math.atan2(d-b,c-a)/Math.PI*180},a.sortBigFirst=function(a,b){return a==b?0:b>a?1:-1},a.sortSmallFirst=function(a,b){return a==b?0:b>a?-1:1},a.sortNumBigFirst=function(a,b){return parseFloat(b)-parseFloat(a)},a.sortNumSmallFirst=function(a,b){return parseFloat(a)-parseFloat(b)},a.sortByKey=function(b,c,d){void 0===c&&(c=!1),void 0===d&&(d=!0);var e;return e=c?d?a.sortNumBigFirst:a.sortBigFirst:d?a.sortNumSmallFirst:a.sortSmallFirst,function(a,c){return e(a[b],c[b])}},a}(),D=function(){function a(a,b,c,d,e,f){this.cos=1,this.sin=0,this.inPool=!1,this.bTransform=!1,void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),void 0===e&&(e=0),void 0===f&&(f=0),this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f,this._checkTransform()}f(a,"laya.maths.Matrix");var b=a.prototype;return b.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},b._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},b.setTranslate=function(a,b){return this.tx=a,this.ty=b,this},b.translate=function(a,b){return this.tx+=a,this.ty+=b,this},b.scale=function(a,b){this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this.bTransform=!0},b.rotate=function(a){var b=this.cos=Math.cos(a),c=this.sin=Math.sin(a),d=this.a,e=this.c,f=this.tx;this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this.bTransform=!0},b.skew=function(a,b){var c=Math.tan(a),d=Math.tan(b),e=this.a,f=this.b;return this.a+=d*this.c,this.b+=d*this.d,this.c+=c*e,this.d+=c*f,this},b.invertTransformPoint=function(a){var b=this.a,c=this.b,d=this.c,e=this.d,f=this.tx,g=b*e-c*d,h=e/g,i=-c/g,j=-d/g,k=b/g,l=(d*this.ty-e*f)/g,m=-(b*this.ty-c*f)/g;return a.setTo(h*a.x+j*a.y+l,i*a.x+k*a.y+m)},b.transformPoint=function(a){return a.setTo(this.a*a.x+this.c*a.y+this.tx,this.b*a.x+this.d*a.y+this.ty)},b.transformPointN=function(a){return a.setTo(this.a*a.x+this.c*a.y,this.b*a.x+this.d*a.y)},b.transformPointArray=function(a,b){for(var c=a.length,d=0;d<c;d+=2){var e=a[d],f=a[d+1];b[d]=this.a*e+this.c*f+this.tx,b[d+1]=this.b*e+this.d*f+this.ty}return b},b.transformPointArrayScale=function(a,b){for(var c=a.length,d=0;d<c;d+=2){var e=a[d],f=a[d+1];b[d]=this.a*e+this.c*f,b[d+1]=this.b*e+this.d*f}return b},b.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},b.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},b.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},b.setTo=function(a,b,c,d,e,f){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f,this},b.concat=function(a){var b=this.a,c=this.c,d=this.tx;return this.a=b*a.a+this.b*a.c,this.b=b*a.b+this.b*a.d,this.c=c*a.a+this.d*a.c,this.d=c*a.b+this.d*a.d,this.tx=d*a.a+this.ty*a.c+a.tx,this.ty=d*a.b+this.ty*a.d+a.ty,this},b.scaleEx=function(a,b){var c=this.a,d=this.b,e=this.c,f=this.d;0!==d||0!==e?(this.a=a*c,this.b=a*d,this.c=b*e,this.d=b*f):(this.a=a*c,this.b=0*f,this.c=0*c,this.d=b*f),this.bTransform=!0},b.rotateEx=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.b,f=this.c,g=this.d;0!==e||0!==f?(this.a=b*d+c*f,this.b=b*e+c*g,this.c=-c*d+b*f,this.d=-c*e+b*g):(this.a=b*d,this.b=c*g,this.c=-c*d,this.d=b*g),this.bTransform=!0},b.clone=function(){var b=a._cache,c=b._length?b[--b._length]:new a;return c.a=this.a,c.b=this.b,c.c=this.c,c.d=this.d,c.tx=this.tx,c.ty=this.ty,c.bTransform=this.bTransform,c},b.copyTo=function(a){return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a.bTransform=this.bTransform,a},b.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},b.destroy=function(){if(!this.inPool){var b=a._cache;this.inPool=!0,b._length||(b._length=0),b[b._length++]=this,this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},a.mul=function(a,b,c){var d=a.a,e=a.b,f=a.c,g=a.d,h=a.tx,i=a.ty,j=b.a,k=b.b,l=b.c,m=b.d,n=b.tx,o=b.ty;return 0!==k||0!==l?(c.a=d*j+e*l,c.b=d*k+e*m,c.c=f*j+g*l,c.d=f*k+g*m,c.tx=j*h+l*i+n,c.ty=k*h+m*i+o):(c.a=d*j,c.b=e*m,c.c=f*j,c.d=g*m,c.tx=j*h+n,c.ty=m*i+o),c},a.mul16=function(a,b,c){var d=a.a,e=a.b,f=a.c,g=a.d,h=a.tx,i=a.ty,j=b.a,k=b.b,l=b.c,m=b.d,n=b.tx,o=b.ty;return 0!==k||0!==l?(c[0]=d*j+e*l,c[1]=d*k+e*m,c[4]=f*j+g*l,c[5]=f*k+g*m,c[12]=j*h+l*i+n,c[13]=k*h+m*i+o):(c[0]=d*j,c[1]=e*m,c[4]=f*j,c[5]=g*m,c[12]=j*h+n,c[13]=m*i+o),c},a.mulPre=function(a,b,c,d,e,f,g,h){var i=a.a,j=a.b,k=a.c,l=a.d,m=a.tx,n=a.ty;return 0!==c||0!==d?(h.a=i*b+j*d,h.b=i*c+j*e,h.c=k*b+l*d,h.d=k*c+l*e,h.tx=b*m+d*n+f,h.ty=c*m+e*n+g):(h.a=i*b,h.b=j*e,h.c=k*b,h.d=l*e,h.tx=b*m+f,h.ty=e*n+g),h},a.mulPos=function(a,b,c,d,e,f,g,h){var i=a.a,j=a.b,k=a.c,l=a.d,m=a.tx,n=a.ty;return 0!==j||0!==k?(h.a=b*i+c*k,h.b=b*j+c*l,h.c=d*i+e*k,h.d=d*j+e*l,h.tx=i*f+k*g+m,h.ty=j*f+l*g+n):(h.a=b*i,h.b=c*l,h.c=d*i,h.d=e*l,h.tx=i*f+m,h.ty=l*g+n),h},a.preMul=function(a,b,c){var d=a.a,e=a.b,f=a.c,g=a.d,h=b.a,i=b.b,j=b.c,k=b.d,l=b.tx,m=b.ty;return c.a=h*d,c.b=c.c=0,c.d=k*g,c.tx=l*d+a.tx,c.ty=m*g+a.ty,0===i&&0===j&&0===e&&0===f||(c.a+=i*f,c.d+=j*e,c.b+=h*e+i*g,c.c+=j*d+k*f,c.tx+=m*f,c.ty+=l*e),c},a.preMulXY=function(a,b,c,d){var e=a.a,f=a.b,g=a.c,h=a.d;return d.a=e,d.b=f,d.c=g,d.d=h,d.tx=b*e+a.tx+c*g,d.ty=c*h+a.ty+b*f,d},a.create=function(){var b=a._cache,c=b._length?b[--b._length]:new a;return c.inPool=!1,c},a.EMPTY=new a,a.TEMP=new a,a._cache=[],a}(),E=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this.x=a,this.y=b}f(a,"laya.maths.Point");var b=a.prototype;return b.setTo=function(a,b){return this.x=a,this.y=b,this},b.distance=function(a,b){return Math.sqrt((this.x-a)*(this.x-a)+(this.y-b)*(this.y-b))},b.toString=function(){return this.x+","+this.y},b.normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a>0){var b=1/a;this.x*=b,this.y*=b}},a.TEMP=new a,a.EMPTY=new a,a}(),F=function(){function a(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),this.x=a,this.y=b,this.width=c,this.height=d}f(a,"laya.maths.Rectangle");var b=a.prototype;return b.setTo=function(a,b,c,d){return this.x=a,this.y=b,this.width=c,this.height=d,this},b.copyFrom=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},b.contains=function(a,b){return!(this.width<=0||this.height<=0)&&(a>=this.x&&a<this.right&&b>=this.y&&b<this.bottom)},b.intersects=function(a){return!(a.x>this.x+this.width||a.x+a.width<this.x||a.y>this.y+this.height||a.y+a.height<this.y)},b.intersection=function(b,c){return this.intersects(b)?(c||(c=new a),c.x=Math.max(this.x,b.x),c.y=Math.max(this.y,b.y),c.width=Math.min(this.right,b.right)-c.x,c.height=Math.min(this.bottom,b.bottom)-c.y,c):null},b.union=function(b,c){return c||(c=new a),this.clone(c),b.width<=0||b.height<=0?c:(c.addPoint(b.x,b.y),c.addPoint(b.right,b.bottom),this)},b.clone=function(b){return b||(b=new a),b.x=this.x,b.y=this.y,b.width=this.width,b.height=this.height,b},b.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},b.equals=function(a){return!(!a||a.x!==this.x||a.y!==this.y||a.width!==this.width||a.height!==this.height)},b.addPoint=function(a,b){return this.x>a&&(this.width+=this.x-a,this.x=a),this.y>b&&(this.height+=this.y-b,this.y=b),this.width<a-this.x&&(this.width=a-this.x),this.height<b-this.y&&(this.height=b-this.y),this},b._getBoundPoints=function(){var b=a._temB;return b.length=0,0==this.width||0==this.height?b:(b.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),b)},b.isEmpty=function(){return this.width<=0||this.height<=0},g(0,b,"right",function(){return this.x+this.width}),g(0,b,"bottom",function(){return this.y+this.height}),a._getBoundPointS=function(b,c,d,e){var f=a._temA;return f.length=0,0==d||0==e?f:(f.push(b,c,b+d,c,b,c+e,b+d,c+e),f)},a._getWrapRec=function(b,c){if(!b||b.length<1)return c?c.setTo(0,0,0,0):a.TEMP.setTo(0,0,0,0);c=c?c:new a;var d,e,f,g,h,i=b.length,j=E.TEMP;for(e=g=99999,f=h=-e,d=0;d<i;d+=2)j.x=b[d],j.y=b[d+1],e=e<j.x?e:j.x,g=g<j.y?g:j.y,f=f>j.x?f:j.x,h=h>j.y?h:j.y;return c.setTo(e,g,f-e,h-g)},a.EMPTY=new a,a.TEMP=new a,a._temB=[],a._temA=[],a}(),G=function(){function a(){}return f(a,"laya.media.SoundManager"),g(1,a,"autoStopMusic",function(){return a._autoStopMusic},function(c){b.stage.off("blur",null,a._stageOnBlur),b.stage.off("focus",null,a._stageOnFocus),b.stage.off("visibilitychange",null,a._visibilityChange),a._autoStopMusic=c,c&&(b.stage.on("blur",null,a._stageOnBlur),b.stage.on("focus",null,a._stageOnFocus),b.stage.on("visibilitychange",null,a._visibilityChange))}),g(1,a,"muted",function(){return a._muted},function(b){b&&a.stopAllSound(),a.musicMuted=b,a._muted=b}),g(1,a,"musicMuted",function(){return a._musicMuted},function(b){b?(a._tMusic&&a.stopSound(a._tMusic),a._musicMuted=b):(a._musicMuted=b,a._tMusic&&a.playMusic(a._tMusic))}),g(1,a,"soundMuted",function(){return a._soundMuted},function(b){a._soundMuted=b}),a.addChannel=function(b){a._channels.indexOf(b)>=0||a._channels.push(b)},a.removeChannel=function(b){var c=0;for(c=a._channels.length-1;c>=0;c--)a._channels[c]==b&&a._channels.splice(c,1)},a._visibilityChange=function(){b.stage.isVisibility?a._stageOnFocus():a._stageOnBlur()},a._stageOnBlur=function(){a._musicChannel&&(a._musicChannel.isStopped||(a._blurPaused=!0,a._musicLoops=a._musicChannel.loops,a._musicCompleteHandler=a._musicChannel.completeHandler,a._musicPosition=a._musicChannel.position,a._musicChannel.stop(),b.stage.once("mousedown",null,a._stageOnFocus)))},a._stageOnFocus=function(){b.stage.off("mousedown",null,a._stageOnFocus),a._blurPaused&&(a.playMusic(a._tMusic,a._musicLoops,a._musicCompleteHandler,a._musicPosition),a._blurPaused=!1)},a.playSound=function(c,d,e,f,g){if(void 0===d&&(d=1),void 0===g&&(g=0),a._muted)return null;if((c=I.formatURL(c))==a._tMusic){if(a._musicMuted)return null}else if(a._soundMuted)return null;var h=b.loader.getRes(c);f||(f=a._soundClass),h||(h=new f,h.load(c),qa.cacheRes(c,h));var i;return i=h.play(g,d),i.url=c,i.volume=c==a._tMusic?a.musicVolume:a.soundVolume,i.completeHandler=e,i},a.destroySound=function(a){var c=b.loader.getRes(a);c&&(qa.clearRes(a),c.dispose())},a.playMusic=function(b,c,d,e){return void 0===c&&(c=0),void 0===e&&(e=0),b=I.formatURL(b),a._tMusic=b,a._musicChannel&&a._musicChannel.stop(),a._musicChannel=a.playSound(b,c,d,null,e)},a.stopSound=function(b){b=I.formatURL(b);var c,d=0;for(d=a._channels.length-1;d>=0;d--)c=a._channels[d],c.url==b&&c.stop()},a.stopAll=function(){a._tMusic=null;var b,c=0;for(c=a._channels.length-1;c>=0;c--)b=a._channels[c],b.stop()},a.stopAllSound=function(){var b,c=0;for(c=a._channels.length-1;c>=0;c--)b=a._channels[c],b.url!=a._tMusic&&b.stop()},a.stopMusic=function(){a._tMusic=null,a._musicChannel&&a._musicChannel.stop()},a.setSoundVolume=function(b,c){if(c)c=I.formatURL(c),a._setVolume(c,b);else{a.soundVolume=b;var d,e=0;for(e=a._channels.length-1;e>=0;e--)d=a._channels[e],d.url!=a._tMusic&&(d.volume=b)}},a.setMusicVolume=function(b){a.musicVolume=b,a._setVolume(a._tMusic,b)},a._setVolume=function(b,c){var d,e=0;for(e=a._channels.length-1;e>=0;e--)d=a._channels[e],d.url==b&&(d.volume=c)},a.musicVolume=1,a.soundVolume=1,a.playbackRate=1,a._muted=!1,a._soundMuted=!1,a._musicMuted=!1,a._tMusic=null,a._musicChannel=null,a._channels=[],a._autoStopMusic=!1,a._blurPaused=!1,a._musicLoops=0,a._musicPosition=0,a._musicCompleteHandler=null,a._soundClass=null,a}(),H=function(){function a(){}var b;return f(a,"laya.net.LocalStorage"),a.__init__=function(){a._baseClass||(a._baseClass=b,b.init()),a.items=a._baseClass.items,a.support=a._baseClass.support},a.setItem=function(b,c){a._baseClass.setItem(b,c)},a.getItem=function(b){return a._baseClass.getItem(b)},a.setJSON=function(b,c){a._baseClass.setJSON(b,c)},a.getJSON=function(b){return a._baseClass.getJSON(b)},a.removeItem=function(b){a._baseClass.removeItem(b)},a.clear=function(){a._baseClass.clear()},a._baseClass=null,a.items=null,a.support=!1,a.__init$=function(){b=function(){function a(){}return f(a,""),a.init=function(){try{a.items=window.localStorage,a.setItem("laya","1"),a.removeItem("laya"),a.support=!0}catch(a){}a.support||console.log("LocalStorage is not supprot or browser is private mode.")},a.setItem=function(b,c){try{a.support&&a.items.setItem(b,c)}catch(a){console.log("set localStorage failed",a)}},a.getItem=function(b){return a.support?a.items.getItem(b):null},a.setJSON=function(b,c){try{a.support&&a.items.setItem(b,JSON.stringify(c))}catch(a){console.log("set localStorage failed",a)}},a.getJSON=function(b){return JSON.parse(a.support?a.items.getItem(b):null)},a.removeItem=function(b){a.support&&a.items.removeItem(b)},a.clear=function(){a.support&&a.items.clear()},a.items=null,a.support=!0,a}()},a}(),I=function(){function a(b){this._url=null,this._path=null,this._url=a.formatURL(b),this._path=a.getPath(b)}f(a,"laya.net.URL");var b=a.prototype;return g(0,b,"path",function(){return this._path}),g(0,b,"url",function(){return this._url}),a.formatURL=function(b,c){if(null!=a.customFormat&&(b=a.customFormat(b,c)),!b)return"null path";if(0===b.indexOf("data:image"))return b;if(0==J.isConchApp&&a.version[b]&&(b+="?v="+a.version[b]),"~"==b.charAt(0))return a.rootPath+b.substring(1);if(a.isAbsolute(b))return b;var d=(c||a.basePath)+b;return a.formatRelativePath(d)},a.formatRelativePath=function(a){if(a.indexOf("../")>-1){for(var b=a.split("/"),c=0,d=b.length;c<d;c++)".."==b[c]&&(b.splice(c-1,2),c-=2);return b.join("/")}return a},a.isAbsolute=function(a){return a.indexOf(":")>0||"/"==a.charAt(0)},a.getPath=function(a){var b=a.lastIndexOf("/");return b>0?a.substr(0,b+1):""},a.getFileName=function(a){var b=a.lastIndexOf("/");return b>0?a.substr(b+1):a},a.version={},a.basePath="",a.rootPath="",a.customFormat=null,a}(),J=function(){function a(c,d){function e(){b.stage._loop(),Q.window.requestAnimationFrame(e)}this._timeId=0;var f=a._mainCanvas.source.style;f.position="absolute",f.top=f.left="0px",f.background="#000000",a._mainCanvas.source.id=a._mainCanvas.source.id||"layaCanvas";var g=laya.renders.Render.isWebGL;a._mainCanvas.source.width=c,a._mainCanvas.source.height=d,g&&a.WebGL.init(a._mainCanvas,c,d),(a._mainCanvas.source.nodeName||laya.renders.Render.isConchApp)&&Q.container.appendChild(a._mainCanvas.source),a._context=new K(c,d,g?null:a._mainCanvas),a._context.ctx.setIsMainContext(),Q.window.requestAnimationFrame(e),b.stage.on("visibilitychange",this,this.m)}f(a,"laya.renders.Render");var c=a.prototype;return c.m=function(){b.stage.isVisibility?this._timeId=Q.window.setInterval(this._enterFrame,1e3):0!=this._timeId&&Q.window.clearInterval(this._timeId)},c._enterFrame=function(a){b.stage._loop()},g(1,a,"isConchApp",function(){return 4==(4&window.ConchRenderType)}),g(1,a,"context",function(){return a._context}),g(1,a,"isConchNode",function(){return 5==(5&window.ConchRenderType)},function(a){a?window.ConchRenderType|=1:window.ConchRenderType&=-2}),g(1,a,"isConchWebGL",function(){return 6==window.ConchRenderType},function(b){b?(a.isConchNode=!1,window.ConchRenderType|=2):window.ConchRenderType&=-3}),g(1,a,"canvas",function(){return a._mainCanvas.source}),a._context=null,a._mainCanvas=null,a.WebGL=null,a.NODE=1,a.WEBGL=2,a.CONCH=4,a.isWebGL=!1,a.is3DMode=!1,a.optimizeTextureMemory=function(a,b){return!0},a.__init$=function(){window.ConchRenderType=window.ConchRenderType||1,window.ConchRenderType|=window.conch?4:0},a}(),K=function(){function a(b,c,d){this.x=0,this.y=0,this._drawTexture=function(a,b,c){c[0].loaded&&this.ctx.drawTexture(c[0],c[1],c[2],c[3],c[4],a,b)},this._fillTexture=function(a,b,c){c[0].loaded&&this.ctx.fillTexture(c[0],c[1]+a,c[2]+b,c[3],c[4],c[5],c[6],c[7])},this._drawTextureWithTransform=function(a,b,c){c[0].loaded&&this.ctx.drawTextureWithTransform(c[0],c[1],c[2],c[3],c[4],c[5],a,b,c[6])},
this._fillQuadrangle=function(a,b,c){this.ctx.fillQuadrangle(c[0],c[1],c[2],c[3],c[4])},this._drawRect=function(a,b,c){var d=this.ctx;null!=c[4]&&(d.fillStyle=c[4],d.fillRect(a+c[0],b+c[1],c[2],c[3],null)),null!=c[5]&&(d.strokeStyle=c[5],d.lineWidth=c[6],d.strokeRect(a+c[0],b+c[1],c[2],c[3],c[6]))},this._drawPie=function(a,b,c){var d=this.ctx;J.isWebGL&&d.setPathId(c[8]),d.beginPath(),J.isWebGL?(d.movePath(c[0]+a,c[1]+b),d.moveTo(0,0)):d.moveTo(a+c[0],b+c[1]),d.arc(a+c[0],b+c[1],c[2],c[3],c[4]),d.closePath(),this._fillAndStroke(c[5],c[6],c[7],!0)},this._clipRect=function(a,b,c){this.ctx.clipRect(a+c[0],b+c[1],c[2],c[3])},this._fillRect=function(a,b,c){this.ctx.fillRect(a+c[0],b+c[1],c[2],c[3],c[4])},this._drawCircle=function(b,c,d){var e=this.ctx;J.isWebGL&&e.setPathId(d[6]),ca.drawCall++,e.beginPath(),J.isWebGL&&e.movePath(d[0]+b,d[1]+c),e.arc(d[0]+b,d[1]+c,d[2],0,a.PI2),e.closePath(),this._fillAndStroke(d[3],d[4],d[5],!0)},this._fillCircle=function(b,c,d){ca.drawCall++;var e=this.ctx;e.beginPath(),e.fillStyle=d[3],e.arc(d[0]+b,d[1]+c,d[2],0,a.PI2),e.fill()},this._setShader=function(a,b,c){this.ctx.setShader(c[0])},this._drawLine=function(a,b,c){var d=this.ctx;J.isWebGL&&d.setPathId(c[6]),d.beginPath(),d.strokeStyle=c[4],d.lineWidth=c[5],J.isWebGL?(d.movePath(a,b),d.moveTo(c[0],c[1]),d.lineTo(c[2],c[3])):(d.moveTo(a+c[0],b+c[1]),d.lineTo(a+c[2],b+c[3])),d.stroke()},this._drawLines=function(a,b,c){var d=this.ctx;J.isWebGL&&d.setPathId(c[5]),d.beginPath(),a+=c[0],b+=c[1],J.isWebGL&&d.movePath(a,b),d.strokeStyle=c[3],d.lineWidth=c[4];var e=c[2],f=2,g=e.length;if(J.isWebGL)for(d.moveTo(e[0],e[1]);f<g;)d.lineTo(e[f++],e[f++]);else for(d.moveTo(a+e[0],b+e[1]);f<g;)d.lineTo(a+e[f++],b+e[f++]);d.stroke()},this._drawLinesWebGL=function(a,b,c){this.ctx.drawLines(a+this.x+c[0],b+this.y+c[1],c[2],c[3],c[4])},this._drawCurves=function(a,b,c){this.ctx.drawCurves(a,b,c)},this._draw=function(a,b,c){c[0].call(null,this,a,b)},this._transformByMatrix=function(a,b,c){this.ctx.transformByMatrix(c[0])},this._setTransform=function(a,b,c){this.ctx.setTransform(c[0],c[1],c[2],c[3],c[4],c[5])},this._setTransformByMatrix=function(a,b,c){this.ctx.setTransformByMatrix(c[0])},this._save=function(a,b,c){this.ctx.save()},this._restore=function(a,b,c){this.ctx.restore()},this._translate=function(a,b,c){this.ctx.translate(c[0],c[1])},this._transform=function(a,b,c){this.ctx.translate(c[1]+a,c[2]+b);var d=c[0];this.ctx.transform(d.a,d.b,d.c,d.d,d.tx,d.ty),this.ctx.translate(-a-c[1],-b-c[2])},this._rotate=function(a,b,c){this.ctx.translate(c[1]+a,c[2]+b),this.ctx.rotate(c[0]),this.ctx.translate(-a-c[1],-b-c[2])},this._scale=function(a,b,c){this.ctx.translate(c[2]+a,c[3]+b),this.ctx.scale(c[0],c[1]),this.ctx.translate(-a-c[2],-b-c[3])},this._alpha=function(a,b,c){this.ctx.globalAlpha*=c[0]},this._setAlpha=function(a,b,c){this.ctx.globalAlpha=c[0]},this._fillText=function(a,b,c){this.ctx.fillText(c[0],c[1]+a,c[2]+b,c[3],c[4],c[5])},this._strokeText=function(a,b,c){this.ctx.strokeText(c[0],c[1]+a,c[2]+b,c[3],c[4],c[5],c[6])},this._fillBorderText=function(a,b,c){this.ctx.fillBorderText(c[0],c[1]+a,c[2]+b,c[3],c[4],c[5],c[6],c[7])},this._blendMode=function(a,b,c){this.ctx.globalCompositeOperation=c[0]},this._beginClip=function(a,b,c){this.ctx.beginClip&&this.ctx.beginClip(a+c[0],b+c[1],c[2],c[3])},this._setIBVB=function(a,b,c){this.ctx.setIBVB(c[0]+a,c[1]+b,c[2],c[3],c[4],c[5],c[6],c[7])},this._fillTrangles=function(a,b,c){this.ctx.fillTrangles(c[0],c[1]+a,c[2]+b,c[3],c[4])},this._drawPath=function(a,b,c){var d=this.ctx;J.isWebGL&&d.setPathId(-1),d.beginPath(),a+=c[0],b+=c[1];for(var e=c[2],f=0,g=e.length;f<g;f++){var h=e[f];switch(h[0]){case"moveTo":d.moveTo(a+h[1],b+h[2]);break;case"lineTo":d.lineTo(a+h[1],b+h[2]);break;case"arcTo":d.arcTo(a+h[1],b+h[2],a+h[3],b+h[4],h[5]);break;case"closePath":d.closePath()}}var i=c[3];null!=i&&(d.fillStyle=i.fillStyle,d.fill());var j=c[4];null!=j&&(d.strokeStyle=j.strokeStyle,d.lineWidth=j.lineWidth||1,d.lineJoin=j.lineJoin,d.lineCap=j.lineCap,d.miterLimit=j.miterLimit,d.stroke())},this.drawPoly=function(a,b,c){this.ctx.drawPoly(a+this.x+c[0],b+this.y+c[1],c[2],c[3],c[4],c[5],c[6])},this._drawPoly=function(a,b,c){var d=this.ctx,e=c[2],f=2,g=e.length;if(J.isWebGL)for(d.setPathId(c[6]),d.beginPath(),a+=c[0],b+=c[1],d.movePath(a,b),d.moveTo(e[0],e[1]);f<g;)d.lineTo(e[f++],e[f++]);else for(d.beginPath(),a+=c[0],b+=c[1],d.moveTo(a+e[0],b+e[1]);f<g;)d.lineTo(a+e[f++],b+e[f++]);d.closePath(),this._fillAndStroke(c[3],c[4],c[5],c[7])},this._drawSkin=function(a,b,c){var d=c[0];if(d){var e=this.ctx;d.render(e,a,b)}},this._drawParticle=function(a,b,c){this.ctx.drawParticle(a+this.x,b+this.y,c[0])},d?this.ctx=d.getContext("2d"):(d=Ia.create("3D"),this.ctx=i.createWebGLContext2D(d),d._setContext(this.ctx)),d.size(b,c),this.canvas=d}f(a,"laya.renders.RenderContext");var b=a.prototype;return b.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},b.drawTexture=function(a,b,c,d,e){a.loaded&&this.ctx.drawTexture(a,b,c,d,e,this.x,this.y)},b._drawTextures=function(a,b,c){c[0].loaded&&this.ctx.drawTextures(c[0],c[1],a+this.x,b+this.y)},b.drawTextureWithTransform=function(a,b,c,d,e,f,g){a.loaded&&this.ctx.drawTextureWithTransform(a,b,c,d,e,f,this.x,this.y,g)},b.fillQuadrangle=function(a,b,c,d,e){this.ctx.fillQuadrangle(a,b,c,d,e)},b.drawCanvas=function(a,b,c,d,e){this.ctx.drawCanvas(a,b+this.x,c+this.y,d,e)},b.drawRect=function(a,b,c,d,e,f){void 0===f&&(f=1);var g=this.ctx;g.strokeStyle=e,g.lineWidth=f,g.strokeRect(a+this.x,b+this.y,c,d,f)},b._fillAndStroke=function(a,b,c,d){void 0===d&&(d=!1);var e=this.ctx;null!=a&&(e.fillStyle=a,J.isWebGL?e.fill(d):e.fill()),null!=b&&c>0&&(e.strokeStyle=b,e.lineWidth=c,e.stroke())},b.clipRect=function(a,b,c,d){this.ctx.clipRect(a+this.x,b+this.y,c,d)},b.fillRect=function(a,b,c,d,e){this.ctx.fillRect(a+this.x,b+this.y,c,d,e)},b.drawCircle=function(b,c,d,e,f){void 0===f&&(f=1),ca.drawCall++;var g=this.ctx;g.beginPath(),g.strokeStyle=e,g.lineWidth=f,g.arc(b+this.x,c+this.y,d,0,a.PI2),g.stroke()},b.fillCircle=function(b,c,d,e){ca.drawCall++;var f=this.ctx;f.beginPath(),f.fillStyle=e,f.arc(b+this.x,c+this.y,d,0,a.PI2),f.fill()},b.setShader=function(a){this.ctx.setShader(a)},b.drawLine=function(a,b,c,d,e,f){void 0===f&&(f=1);var g=this.ctx;g.beginPath(),g.strokeStyle=e,g.lineWidth=f,g.moveTo(this.x+a,this.y+b),g.lineTo(this.x+c,this.y+d),g.stroke()},b.clear=function(){this.ctx.clear()},b.transformByMatrix=function(a){this.ctx.transformByMatrix(a)},b.setTransform=function(a,b,c,d,e,f){this.ctx.setTransform(a,b,c,d,e,f)},b.setTransformByMatrix=function(a){this.ctx.setTransformByMatrix(a)},b.save=function(){this.ctx.save()},b.restore=function(){this.ctx.restore()},b.translate=function(a,b){this.ctx.translate(a,b)},b.transform=function(a,b,c,d,e,f){this.ctx.transform(a,b,c,d,e,f)},b.rotate=function(a){this.ctx.rotate(a)},b.scale=function(a,b){this.ctx.scale(a,b)},b.alpha=function(a){this.ctx.globalAlpha*=a},b.setAlpha=function(a){this.ctx.globalAlpha=a},b.fillWords=function(a,b,c,d,e){this.ctx.fillWords(a,b,c,d,e)},b.fillBorderWords=function(a,b,c,d,e,f,g){this.ctx.fillBorderWords(a,b,c,d,e,f,g)},b.fillText=function(a,b,c,d,e,f){this.ctx.fillText(a,b+this.x,c+this.y,d,e,f)},b.strokeText=function(a,b,c,d,e,f,g){this.ctx.strokeText(a,b+this.x,c+this.y,d,e,f,g)},b.blendMode=function(a){this.ctx.globalCompositeOperation=a},b.flush=function(){this.ctx.flush&&this.ctx.flush()},b.addRenderObject=function(a){this.ctx.addRenderObject(a)},b.beginClip=function(a,b,c,d){this.ctx.beginClip&&this.ctx.beginClip(a,b,c,d)},b.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},b.fillTrangles=function(a,b,c){this.ctx.fillTrangles(c[0],c[1],c[2],c[3],c.length>4?c[4]:null)},a.PI2=2*Math.PI,a}(),L=function(){function a(b,c){switch(this._next=c||a.NORENDER,b){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:return void(this._fun=this._image2);case 517:return void(this._fun=this._image2);case 32:return void(this._fun=x._filter);case 69905:return void(this._fun=a._initRenderFun)}this.onCreate(b)}f(a,"laya.renders.RenderSprite");var c=a.prototype;return c.onCreate=function(a){},c._style=function(a,b,c,d){a._style.render(a,b,c,d);var e=this._next;e._fun.call(e,a,b,c,d)},c._no=function(a,b,c,d){},c._custom=function(a,b,c,d){a.customRender(b,c,d);var e=a._style._tf;this._next._fun.call(this._next,a,b,c-e.translateX,d-e.translateY)},c._clip=function(b,c,d,e){var f=this._next;if(f!=a.NORENDER){var g=b._style.scrollRect;c.ctx.save(),c.ctx.clipRect(d,e,g.width,g.height),f._fun.call(f,b,c,d-g.x,e-g.y),c.ctx.restore()}},c._blend=function(a,b,c,d){var e=a._style;e.blendMode&&(b.ctx.globalCompositeOperation=e.blendMode);var f=this._next;f._fun.call(f,a,b,c,d),b.ctx.globalCompositeOperation="source-over"},c._mask=function(a,b,c,d){var e=this._next;e._fun.call(e,a,b,c,d);var f=a.mask;f&&(b.ctx.globalCompositeOperation="destination-in",(f.numChildren>0||!f.graphics._isOnlyOne())&&(f.cacheAsBitmap=!0),f.render(b,c,d)),b.ctx.globalCompositeOperation="source-over"},c._graphics=function(a,b,c,d){var e=a._style._tf;a._graphics&&a._graphics._render(a,b,c-e.translateX,d-e.translateY);var f=this._next;f._fun.call(f,a,b,c,d)},c._image=function(a,b,c,d){var e=a._style;b.ctx.drawTexture2(c,d,e._tf.translateX,e._tf.translateY,a.transform,e.alpha,e.blendMode,a._graphics._one)},c._image2=function(a,b,c,d){var e=a._style._tf;b.ctx.drawTexture2(c,d,e.translateX,e.translateY,a.transform,1,null,a._graphics._one)},c._alpha=function(a,b,c,d){var e,f=a._style;if((e=f.alpha)>.01){var g=b.ctx.globalAlpha;b.ctx.globalAlpha*=e;var h=this._next;h._fun.call(h,a,b,c,d),b.ctx.globalAlpha=g}},c._transform=function(b,c,d,e){var f=b.transform,g=this._next;f&&g!=a.NORENDER?(c.save(),c.transform(f.a,f.b,f.c,f.d,f.tx+d,f.ty+e),g._fun.call(g,b,c,0,0),c.restore()):g._fun.call(g,b,c,d,e)},c._childs=function(a,b,c,d){var e=a._style;if(c+=-e._tf.translateX+e.paddingLeft,d+=-e._tf.translateY+e.paddingTop,e._calculation){var f=a._getWords();if(f){var g=e;g&&(g.stroke?b.fillBorderWords(f,c,d,g.font,g.color,g.strokeColor,g.stroke):b.fillWords(f,c,d,g.font,g.color))}}var h,i=a._childs,j=i.length;if(a.viewport||a.optimizeScrollRect&&a._style.scrollRect){var k=a.viewport||a._style.scrollRect,l=k.x,m=k.y,n=k.right,o=k.bottom,p=NaN,q=NaN;for(r=0;r<j;++r)(h=i[r]).visible&&(p=h._x)<n&&p+h.width>l&&(q=h._y)<o&&q+h.height>m&&h.render(b,c,d)}else for(var r=0;r<j;++r)(h=i[r])._style.visible&&h.render(b,c,d)},c._canvas=function(a,c,d,e){var f=a._$P.cacheCanvas,g=this._next;if(!f)return void g._fun.call(g,a,l,d,e);var h,i,j,k,l=f.ctx,m=a._needRepaint()||!l;if("bitmap"===f.type?ca.canvasBitmap++:ca.canvasNormal++,m){f._cacheRec||(f._cacheRec=new F);var n,o;J.isWebGL&&"bitmap"!==f.type?f._cacheRec.setTo(0,0,1,1):(k=a.getSelfBounds(),k.x-=a.pivotX,k.y-=a.pivotY,k.x-=16,k.y-=16,k.width+=32,k.height+=32,k.x=Math.floor(k.x+d)-d,k.y=Math.floor(k.y+e)-e,k.width=Math.floor(k.width),k.height=Math.floor(k.height),f._cacheRec.copyFrom(k)),k=f._cacheRec;var p=J.isWebGL?1:Q.pixelRatio*b.stage.clientScaleX,q=J.isWebGL?1:Q.pixelRatio*b.stage.clientScaleY;if(!J.isWebGL){var r,s=1,t=1;for(r=a;r&&r!=b.stage;)s*=r.scaleX,t*=r.scaleY,r=r.parent;J.isWebGL?(s<1&&(p*=s),t<1&&(q*=t)):(s>1&&(p*=s),t>1&&(q*=t))}if(n=k.width*p,o=k.height*q,i=k.x,j=k.y,J.isWebGL&&"bitmap"===f.type&&(n>2048||o>2048))return console.log("cache bitmap size larger than 2048,cache ignored"),f.ctx&&(aa.recover("RenderContext",f.ctx),f.ctx.canvas.size(0,0),f.ctx=null),void g._fun.call(g,a,c,d,e);l||(l=f.ctx=aa.getItem("RenderContext")||new K(n,o,Ia.create("AUTO"))),l.ctx.sprite=a,h=l.canvas,h.clear(),(h.width!=n||h.height!=o)&&h.size(n,o),"bitmap"===f.type&&(h.context.asBitmap=!0);var u;if(1!=p||1!=q){var v=l.ctx;v.save(),v.scale(p,q),!J.isConchWebGL&&J.isConchApp&&(u=a._$P.cf)&&v.setFilterMatrix&&v.setFilterMatrix(u._mat,u._alpha),g._fun.call(g,a,l,-i,-j),v.restore(),J.isConchApp&&!J.isConchWebGL||a._applyFilters()}else v=l.ctx,!J.isConchWebGL&&J.isConchApp&&(u=a._$P.cf)&&v.setFilterMatrix&&v.setFilterMatrix(u._mat,u._alpha),g._fun.call(g,a,l,-i,-j),J.isConchApp&&!J.isConchWebGL||a._applyFilters();a._$P.staticCache&&(f.reCache=!1),ca.canvasReCache++}else k=f._cacheRec,i=k.x,j=k.y,h=l.canvas;c.drawCanvas(h,d+i,e+j,k.width,k.height)},a.__init__=function(){var b,c=0,d=0;for(b=i.createRenderSprite(69905,null),d=a.renders.length=4096,c=0;c<d;c++)a.renders[c]=b;a.renders[0]=i.createRenderSprite(0,null),function(b,c){for(var d=0,e=0;e<b.length;e++)d|=b[e],a.renders[d]=c}([1,512,4,2],new a(1,null)),a.renders[513]=i.createRenderSprite(513,null),a.renders[517]=new a(517,null)},a._initRenderFun=function(b,c,d,e){var f=b._renderType;(a.renders[f]=a._getTypeRender(f))._fun(b,c,d,e)},a._getTypeRender=function(a){for(var b=null,c=2048;c>1;)c&a&&(b=i.createRenderSprite(c,b)),c>>=1;return b},a.IMAGE=1,a.ALPHA=2,a.TRANSFORM=4,a.BLEND=8,a.CANVAS=16,a.FILTERS=32,a.MASK=64,a.CLIP=128,a.STYLE=256,a.GRAPHICS=512,a.CUSTOM=1024,a.CHILDS=2048,a.INIT=69905,a.renders=[],a.NORENDER=new a(0,null),a}(),M=function(){function a(){this._repaint=!1}f(a,"laya.resource.Context");var b=a.prototype;return b.setIsMainContext=function(){},b.drawTextures=function(a,b,c,d){ca.drawCall+=b.length/2;for(var e=a.bitmap.width,f=a.bitmap.height,g=0,h=b.length;g<h;g+=2)this.drawTexture(a,b[g],b[g+1],e,f,c,d)},b.drawCanvas=function(a,b,c,d,e){ca.drawCall++,this.drawImage(a.source,b,c,d,e)},b.fillRect=function(a,b,c,d,e){ca.drawCall++,e&&(this.fillStyle=e),this.__fillRect(a,b,c,d)},b.fillText=function(a,b,c,d,e,f){ca.drawCall++,arguments.length>3&&null!=d&&(this.font=d,this.fillStyle=e,this.textAlign=f,this.textBaseline="top"),this.__fillText(a,b,c)},b.fillBorderText=function(a,b,c,d,e,f,g,h){ca.drawCall++,this.font=d,this.fillStyle=e,this.textBaseline="top",this.strokeStyle=f,this.lineWidth=g,this.textAlign=h,this.__strokeText(a,b,c),this.__fillText(a,b,c)},b.strokeText=function(a,b,c,d,e,f,g){ca.drawCall++,arguments.length>3&&null!=d&&(this.font=d,this.strokeStyle=e,this.lineWidth=f,this.textAlign=g,this.textBaseline="top"),this.__strokeText(a,b,c)},b.transformByMatrix=function(a){this.transform(a.a,a.b,a.c,a.d,a.tx,a.ty)},b.setTransformByMatrix=function(a){this.setTransform(a.a,a.b,a.c,a.d,a.tx,a.ty)},b.clipRect=function(a,b,c,d){ca.drawCall++,this.beginPath(),this.rect(a,b,c,d),this.clip()},b.drawTexture=function(a,b,c,d,e,f,g){ca.drawCall++;var h=a.uv,i=a.bitmap.width,j=a.bitmap.height;this.drawImage(a.source,h[0]*i,h[1]*j,(h[2]-h[0])*i,(h[5]-h[3])*j,b+f,c+g,d,e)},b.drawTextureWithTransform=function(a,b,c,d,e,f,g,h,i){ca.drawCall++;var j=a.uv,k=a.bitmap.width,l=a.bitmap.height;this.save(),1!=i&&(this.globalAlpha*=i),f?(this.transform(f.a,f.b,f.c,f.d,f.tx+g,f.ty+h),this.drawImage(a.source,j[0]*k,j[1]*l,(j[2]-j[0])*k,(j[5]-j[3])*l,b,c,d,e)):this.drawImage(a.source,j[0]*k,j[1]*l,(j[2]-j[0])*k,(j[5]-j[3])*l,b+g,c+h,d,e),this.restore()},b.drawTexture2=function(a,b,c,d,e,f,g,h){"use strict";var i=h[0];if(i.loaded&&i.bitmap&&i.source){ca.drawCall++;var j=1!==f;if(j){var k=this.globalAlpha;this.globalAlpha*=f}var l=i.uv,m=i.bitmap.width,n=i.bitmap.height;e?(this.save(),this.transform(e.a,e.b,e.c,e.d,e.tx+a,e.ty+b),this.drawImage(i.source,l[0]*m,l[1]*n,(l[2]-l[0])*m,(l[5]-l[3])*n,h[1]-c,h[2]-d,h[3],h[4]),this.restore()):this.drawImage(i.source,l[0]*m,l[1]*n,(l[2]-l[0])*m,(l[5]-l[3])*n,h[1]-c+a,h[2]-d+b,h[3],h[4]),j&&(this.globalAlpha=k)}},b.fillTexture=function(a,b,c,d,e,f,g,h){if(!h.pat){if(a.uv!=wa.DEF_UV){var i=new Ia("2D");i.getContext("2d"),i.size(a.width,a.height),i.context.drawTexture(a,0,0,a.width,a.height,0,0),a=new wa(i)}h.pat=this.createPattern(a.bitmap.source,f)}var j=b,k=c,l=0,m=0;g&&(j+=g.x%a.width,k+=g.y%a.height,l-=g.x%a.width,m-=g.y%a.height),this.translate(j,k),this.fillRect(l,m,d,e,h.pat),this.translate(-j,-k)},b.flush=function(){return 0},b.fillWords=function(a,b,c,d,e){d&&(this.font=d),e&&(this.fillStyle=e);this.textBaseline="top",this.textAlign="left";for(var f=0,g=a.length;f<g;f++){var h=a[f];this.__fillText(h.char,h.x+b,h.y+c)}},b.fillBorderWords=function(a,b,c,d,e,f,g){d&&(this.font=d),e&&(this.fillStyle=e),this.textBaseline="top",this.lineWidth=g,this.textAlign="left",this.strokeStyle=f;for(var h=0,i=a.length;h<i;h++){var j=a[h];this.__strokeText(j.char,j.x+b,j.y+c),this.__fillText(j.char,j.x+b,j.y+c)}},b.destroy=function(){this.canvas.width=this.canvas.height=0},b.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},b.drawCurves=function(a,b,c){this.beginPath(),this.strokeStyle=c[3],this.lineWidth=c[4];var d=c[2];a+=c[0],b+=c[1],this.moveTo(a+d[0],b+d[1]);for(var e=2,f=d.length;e<f;)this.quadraticCurveTo(a+d[e++],b+d[e++],a+d[e++],b+d[e++]);this.stroke()},a.__init__=function(a){var b=laya.resource.Context.prototype;a=a||CanvasRenderingContext2D.prototype,a.__fillText=a.fillText,a.__fillRect=a.fillRect,a.__strokeText=a.strokeText,["drawTextures","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(c){a[c]=b[c]||a[c]})},a._default=new a,a}(),N=function(){function a(){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++a._uniqueIDCounter,this._name="Content Manager",a._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,a._resourceManagers.push(this),this._resources=[]}f(a,"laya.resource.ResourceManager");var c=a.prototype;return b.imps(c,{"laya.resource.IDispose":!0}),c.getResourceByIndex=function(a){return this._resources[a]},c.getResourcesLength=function(){return this._resources.length},c.addResource=function(a){return a.resourceManager&&a.resourceManager.removeResource(a),this._resources.indexOf(a)===-1&&(a._resourceManager=this,this._resources.push(a),this.addSize(a.memorySize),!0)},c.removeResource=function(a){var b=this._resources.indexOf(a);return b!==-1&&(this._resources.splice(b,1),a._resourceManager=null,this._memorySize-=a.memorySize,!0)},c.unload=function(){for(var a=this._resources.slice(0,this._resources.length),b=0;b<a.length;b++){a[b].dispose()}a.length=0},c.setUniqueName=function(b){for(var c=!0,d=0;d<a._resourceManagers.length;d++)if(a._resourceManagers[d]._name===b&&a._resourceManagers[d]!==this)return void(c=!1);c?this.name!=b&&(this.name=b,a._isResourceManagersSorted=!1):this.setUniqueName(b.concat("-copy"))},c.dispose=function(){if(this===a._systemResourceManager)throw Error("systemResourceManager不能被释放！");a._resourceManagers.splice(a._resourceManagers.indexOf(this),1),a._isResourceManagersSorted=!1;for(var b=this._resources.slice(0,this._resources.length),c=0;c<b.length;c++){var d=b[c];d.resourceManager.removeResource(d),d.dispose()}b.length=0},c.addSize=function(a){a&&(this.autoRelease&&a>0&&this._memorySize+a>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=a)},c.garbageCollection=function(a){var b=this._resources;b=b.slice(),b.sort(function(a,b){if(!a||!b)throw Error("a或b不能为空！");return a.released&&b.released?0:a.released?1:b.released?-1:a.lastUseFrameCount-b.lastUseFrameCount});for(var c=ca.loopCount,d=0,e=b.length;d<e;d++){var f=b[d];if(!(c-f.lastUseFrameCount>1))return void(this._memorySize>=a&&(this._isOverflow=!0));if(f.releaseResource(),this._memorySize<a)return void(this._isOverflow=!1)}},g(0,c,"id",function(){return this._id}),g(0,c,"name",function(){return this._name},function(b){!b&&""===b||this._name===b||(this._name=b,a._isResourceManagersSorted=!1)}),g(0,c,"memorySize",function(){return this._memorySize}),g(1,a,"systemResourceManager",function(){return null===a._systemResourceManager&&(a._systemResourceManager=new a,a._systemResourceManager._name="System Resource Manager"),a._systemResourceManager}),g(1,a,"sortedResourceManagersByName",function(){return a._isResourceManagersSorted||(a._isResourceManagersSorted=!0,a._resourceManagers.sort(a.compareResourceManagersByName)),a._resourceManagers}),a.__init__=function(){a.currentResourceManager=a.systemResourceManager},a.getLoadedResourceManagerByIndex=function(b){return a._resourceManagers[b]},a.getLoadedResourceManagersCount=function(){return a._resourceManagers.length},a.recreateContentManagers=function(b){void 0===b&&(b=!1);for(var c=a.currentResourceManager,d=0;d<a._resourceManagers.length;d++){a.currentResourceManager=a._resourceManagers[d];for(var e=0;e<a.currentResourceManager._resources.length;e++)a.currentResourceManager._resources[e].releaseResource(b),a.currentResourceManager._resources[e].activeResource(b)}a.currentResourceManager=c},a.releaseContentManagers=function(b){void 0===b&&(b=!1);for(var c=a.currentResourceManager,d=0;d<a._resourceManagers.length;d++){a.currentResourceManager=a._resourceManagers[d];for(var e=0;e<a.currentResourceManager._resources.length;e++){var f=a.currentResourceManager._resources[e];!f.released&&f.releaseResource(b)}}a.currentResourceManager=c},a.compareResourceManagersByName=function(a,b){if(a==b)return 0;var c=a._name,d=b._name;if(null==c)return null==d?0:-1;if(null==d)return 1;var e=c.localeCompare(d);return 0!=e?e:(b.setUniqueName(d),d=b._name,c.localeCompare(d))},a._uniqueIDCounter=0,a._systemResourceManager=null,a._isResourceManagersSorted=!1,a._resourceManagers=[],a.currentResourceManager=null,a}(),O=function(){function a(a){this._ctx=null,this._id=null,this.style={},this._id=a}f(a,"laya.resource.WXCanvas");var b=a.prototype;return b.getContext=function(){var wx=laya.resource.WXCanvas.wx,a=wx.createContext();return a.id=this._id,a.fillRect=function(a,b,c,d){this.rect(a,b,c,d),this.fill()},a.strokeRect=function(a,b,c,d){this.rect(a,b,c,d),this.stroke()},a.___drawImage=a.drawImage,a.drawImage=function(){var a=arguments[0].tempFilePath;if(null!=a)switch(arguments.length){case 3:return void this.___drawImage(a,arguments[1],arguments[2],arguments[0].width,arguments[0].height);case 5:return void this.___drawImage(a,arguments[1],arguments[2],arguments[3],arguments[4]);case 9:return void this.___drawImage(a,arguments[5],arguments[6],arguments[7],arguments[8])}},Object.defineProperty(a,"strokeStyle",{set:function(a){this.setStrokeStyle(a)},enumerable:!1}),Object.defineProperty(a,"fillStyle",{set:function(a){this.setFillStyle(a)},enumerable:!1}),Object.defineProperty(a,"fontSize",{set:function(a){this.setFontSize(a)},enumerable:!1}),Object.defineProperty(a,"lineWidth",{set:function(a){this.setLineWidth(a)},enumerable:!1}),M.__init__(a),a.flush=function(){wx.drawCanvas({canvasId:this.id,actions:this.getActions()})},a},b.oncontextmenu=function(a){},b.addEventListener=function(){},g(0,b,"id",function(){return this._id},function(a){this._id=a}),a.wx=null,a}(),P=function(){function a(){}return f(a,"laya.system.System"),a.changeDefinition=function(a,c){b[a]=c;var d=a+"=classObj";eval(d)},a.__init__=function(){J.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())},a}(),Q=function(){function c(){}return f(c,"laya.utils.Browser"),g(1,c,"pixelRatio",function(){return c.__init__(),c.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1?2:i.getPixelRatio()}),g(1,c,"height",function(){return c.__init__(),(b.stage&&b.stage.canvasRotation?c.clientWidth:c.clientHeight)*c.pixelRatio}),g(1,c,"clientWidth",function(){return c.__init__(),c.window.innerWidth||c.document.body.clientWidth}),g(1,c,"window",function(){return c.__init__(),c._window}),g(1,c,"clientHeight",function(){return c.__init__(),c.window.innerHeight||c.document.body.clientHeight||c.document.documentElement.clientHeight}),g(1,c,"width",function(){return c.__init__(),(b.stage&&b.stage.canvasRotation?c.clientHeight:c.clientWidth)*c.pixelRatio}),g(1,c,"container",function(){return c.__init__(),c._container||(c._container=c.createElement("div"),c._container.id="layaContainer",c.document.body.appendChild(c._container)),c._container},function(a){c._container=a}),g(1,c,"document",function(){return c.__init__(),c._document}),c.__init__=function(){if(!c._window){c._window=i.getWindow(),c._document=c.window.document,c._window.addEventListener("message",function(a){laya.utils.Browser._onMessage(a)},!1),c.document.__createElement=c.document.createElement,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60)};var b=window.document.body.style;b.margin=0,b.overflow="hidden";for(var d=window.document.getElementsByTagName("meta"),e=0,f=!1,g="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";e<d.length;){var h=d[e];if("viewport"==h.name){h.content=g,f=!0;break}e++}f||(h=a.createElement("meta"),h.name="viewport",h.content=g,a.getElementsByTagName("head")[0].appendChild(h)),c.userAgent=c.window.navigator.userAgent,c.u=c.userAgent,c.onIOS=!!c.u.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),c.onMobile=c.u.indexOf("Mobile")>-1,c.onIPhone=c.u.indexOf("iPhone")>-1,c.onIPad=c.u.indexOf("iPad")>-1,c.onAndriod=c.u.indexOf("Android")>-1||c.u.indexOf("Adr")>-1,c.onWP=c.u.indexOf("Windows Phone")>-1,c.onQQBrowser=c.u.indexOf("QQBrowser")>-1,c.onMQQBrowser=c.u.indexOf("MQQBrowser")>-1,c.onWeiXin=c.u.indexOf("MicroMessenger")>-1,c.onPC=!c.onMobile,c.onSafari=!!c.u.match(/Version\/\d+\.\d\x20Mobile\/\S+\x20Safari/),c.httpProtocol="http:"==c.window.location.protocol,c.webAudioEnabled=!!(c.window.AudioContext||c.window.webkitAudioContext||c.window.mozAudioContext),c.soundType=c.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",na=c.webAudioEnabled?oa:la,c.webAudioEnabled&&oa.initWebAudio(),c.enableTouch="ontouchstart"in window||window.DocumentTouch&&a instanceof DocumentTouch,window.focus(),G._soundClass=na;var j=null;if(c.window.MainCanvasID){var k=wx;if(k&&!k.createContext&&(k=null),null!=(O.wx=k)){j=new O(c.window.MainCanvasID);M.prototype.flush=null,c.window.Image=function(){this.setSrc=function(a){this.__src=a;this.success()},this.success=function(a){this.width=200,this.height=200,this.tempFilePath=a?a.tempFilePath:this.__src,this.onload&&this.onload()},this.getSrc=function(){return this.__src},Object.defineProperty(this,"src",{get:this.getSrc,set:this.setSrc,enumerable:!1})}}else j=c.document.getElementById(c.window.MainCanvasID)}J._mainCanvas=J._mainCanvas||Ia.create("2D",j),c.canvas||(c.canvas=Ia.create("2D"),c.context=c.canvas.getContext("2d"))}},c._onMessage=function(a){if(a.data&&"size"==a.data.name){if(c.window.innerWidth=a.data.width,c.window.innerHeight=a.data.height,c.window.__innerHeight=a.data.clientHeight,!c.document.createEvent)return void console.log("no document.createEvent");var b=c.document.createEvent("HTMLEvents");return b.initEvent("resize",!1,!1),void c.window.dispatchEvent(b)}},c.createElement=function(a){return c.__init__(),c.document.__createElement(a)},c.getElementById=function(a){return c.__init__(),c.document.getElementById(a)},c.removeElement=function(a){a&&a.parentNode&&a.parentNode.removeChild(a)},c.now=function(){return i.now()},c._window=null,c._document=null,c._container=null,c.userAgent=null,c.u=null,c.onIOS=!1,c.onMobile=!1,c.onIPhone=!1,c.onIPad=!1,c.onAndriod=!1,c.onWP=!1,c.onQQBrowser=!1,c.onMQQBrowser=!1,c.onSafari=!1,c.onWeiXin=!1,c.onPC=!1,c.httpProtocol=!1,c.webAudioEnabled=!1,c.soundType=null,c.enableTouch=!1,c.canvas=null,c.context=null,c.__init$=function(){},c}(),R=function(){function a(a){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,a?(this._u8d_=new Uint8Array(a),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}f(a,"laya.utils.Byte");var b=a.prototype;return b.___resizeBuffer=function(a){try{var b=new Uint8Array(a);null!=this._u8d_&&(this._u8d_.length<=a?b.set(this._u8d_):b.set(this._u8d_.subarray(0,a))),this._u8d_=b,this._d_=new DataView(b.buffer)}catch(b){throw"___resizeBuffer err:"+a}},b.getString=function(){return this.rUTF(this.getUint16())},b.getFloat32Array=function(a,b){var c=new Float32Array(this._d_.buffer.slice(a,a+b));return this._pos_+=b,c},b.getUint8Array=function(a,b){var c=new Uint8Array(this._d_.buffer.slice(a,a+b));return this._pos_+=b,c},b.getInt16Array=function(a,b){var c=new Int16Array(this._d_.buffer.slice(a,a+b));return this._pos_+=b,c},b.getFloat32=function(){var a=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,a},b.getFloat64=function(){var a=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,a},b.writeFloat32=function(a){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,a,this._xd_),this._pos_+=4},b.writeFloat64=function(a){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,a,this._xd_),this._pos_+=8},b.getInt32=function(){var a=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,a},b.getUint32=function(){var a=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,a},b.writeInt32=function(a){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,a,this._xd_),this._pos_+=4},b.writeUint32=function(a){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,a,this._xd_),this._pos_+=4},b.getInt16=function(){var a=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,a},b.getUint16=function(){var a=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,a},b.writeUint16=function(a){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,a,this._xd_),this._pos_+=2},b.writeInt16=function(a){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,a,this._xd_),this._pos_+=2},b.getUint8=function(){return this._d_.getUint8(this._pos_++)},b.writeUint8=function(a){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,a),this._pos_++},b._getUInt8=function(a){return this._d_.getUint8(a)},b._getUint16=function(a){return this._d_.getUint16(a,this._xd_)},b._getMatrix=function(){return new D(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},b.rUTF=function(a){for(var b="",c=this._pos_+a,d=0,e=0,f=0,g=String.fromCharCode,h=this._u8d_,i=0;this._pos_<c;)d=h[this._pos_++],d<128?0!=d&&(b+=g(d)):d<224?b+=g((63&d)<<6|127&h[this._pos_++]):d<240?(e=h[this._pos_++],b+=g((31&d)<<12|(127&e)<<6|127&h[this._pos_++])):(e=h[this._pos_++],f=h[this._pos_++],b+=g((15&d)<<18|(127&e)<<12|f<<6&127|127&h[this._pos_++])),i++;return b},b.getCustomString=function(a){for(var b="",c=0,d=0,e=0,f=String.fromCharCode,g=this._u8d_;a>0;)if((d=g[this._pos_])<128)b+=f(d),this._pos_++,a--;else for(c=d-128,this._pos_++,a-=c;c>0;)d=g[this._pos_++],e=g[this._pos_++],b+=f(e<<8|d),c--;return b},b.clear=function(){this._pos_=0,this.length=0},b.__getBuffer=function(){return this._d_.buffer},b.writeUTFBytes=function(a){a+="";for(var b=0,c=a.length;b<c;b++){var d=a.charCodeAt(b);d<=127?this.writeByte(d):d<=2047?(this.writeByte(192|d>>6),this.writeByte(128|63&d)):d<=65535?(this.writeByte(224|d>>12),this.writeByte(128|d>>6&63),this.writeByte(128|63&d)):(this.writeByte(240|d>>18),this.writeByte(128|d>>12&63),this.writeByte(128|d>>6&63),this.writeByte(128|63&d))}},b.writeUTFString=function(a){var b=0;b=this.pos,this.writeUint16(1),this.writeUTFBytes(a);var c=0;c=this.pos-b-2,
this._d_.setUint16(b,c,this._xd_)},b.readUTFString=function(){this.pos;var a=0;return a=this.getUint16(),this.readUTFBytes(a)},b.getUTFString=function(){return this.readUTFString()},b.readUTFBytes=function(a){return void 0===a&&(a=-1),0==a?"":(a=a>0?a:this.bytesAvailable,this.rUTF(a))},b.getUTFBytes=function(a){return void 0===a&&(a=-1),this.readUTFBytes(a)},b.writeByte=function(a){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,a),this._pos_+=1},b.readByte=function(){return this._d_.getInt8(this._pos_++)},b.getByte=function(){return this.readByte()},b.ensureWrite=function(a){this._length<a&&(this._length=a),this._allocated_<a&&(this.length=a)},b.writeArrayBuffer=function(a,b,c){if(void 0===b&&(b=0),void 0===c&&(c=0),b<0||c<0)throw"writeArrayBuffer error - Out of bounds";0==c&&(c=a.byteLength-b),this.ensureWrite(this._pos_+c);var d=new Uint8Array(a);this._u8d_.set(d.subarray(b,b+c),this._pos_),this._pos_+=c},g(0,b,"buffer",function(){var a=this._d_.buffer;return a.byteLength==this.length?a:a.slice(0,this.length)}),g(0,b,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(a){this._xd_="littleEndian"==a}),g(0,b,"length",function(){return this._length},function(a){this._allocated_<a?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(a,2*this._allocated_))):this._allocated_>a&&this.___resizeBuffer(this._allocated_=a),this._length=a}),g(0,b,"pos",function(){return this._pos_},function(a){this._pos_=a,this._d_.byteOffset=a}),g(0,b,"bytesAvailable",function(){return this.length-this._pos_}),a.getSystemEndian=function(){if(!a._sysEndian){var b=new ArrayBuffer(2);new DataView(b).setInt16(0,256,!0),a._sysEndian=256===new Int16Array(b)[0]?"littleEndian":"bigEndian"}return a._sysEndian},a.BIG_ENDIAN="bigEndian",a.LITTLE_ENDIAN="littleEndian",a._sysEndian=null,a}(),S=function(){function a(){}return f(a,"laya.utils.CacheManger"),a.regCacheByFunction=function(b,c){a.unRegCacheByFunction(b,c);var d;d={tryDispose:b,getCacheList:c},a._cacheList.push(d)},a.unRegCacheByFunction=function(b,c){var d=0,e=0;for(e=a._cacheList.length,d=0;d<e;d++)if(a._cacheList[d].tryDispose==b&&a._cacheList[d].getCacheList==c)return void a._cacheList.splice(d,1)},a.forceDispose=function(){var b=0,c=a._cacheList.length;for(b=0;b<c;b++)a._cacheList[b].tryDispose(!0)},a.beginCheck=function(c){void 0===c&&(c=15e3),b.timer.loop(c,null,a._checkLoop)},a.stopCheck=function(){b.timer.clear(null,a._checkLoop)},a._checkLoop=function(){var b=a._cacheList;if(!(b.length<1)){var c=Q.now(),d=0,e=0;for(e=d=b.length;d>0&&(a._index++,a._index=a._index%e,b[a._index].tryDispose(!1),!(Q.now()-c>a.loopTimeLimit));)d--}},a.loopTimeLimit=2,a._cacheList=[],a._index=0,a}(),T=function(){function a(){}return f(a,"laya.utils.ClassUtils"),a.regClass=function(b,c){a._classMap[b]=c},a.getRegClass=function(b){return a._classMap[b]},a.getInstance=function(b){var c=a.getClass(b);return c?new c:(console.log("[error] Undefined class:",b),null)},a.createByJson=function(b,c,d,e,f){"string"==typeof b&&(b=JSON.parse(b));var g=b.props;if(!c&&!(c=f?f.runWith(b):a.getInstance(g.runtime||b.type)))return null;var h=b.child;if(h)for(var i=0,j=h.length;i<j;i++){var k=h[i];if("render"!==k.props.name&&"render"!==k.props.renderType||!c._$set_itemRender)if("Graphic"==k.type)a.addGraphicsToSprite(k,c);else if(a.isDrawType(k.type))a.addGraphicToSprite(k,c,!0);else{var l=a.createByJson(k,null,d,e,f);"Script"==k.type?l.owner=c:"mask"==k.props.renderType?c.mask=l:c.addChild(l)}else c.itemRender=k}if(g)for(var m in g){var n=g[m];"var"===m&&d?d[n]=c:n instanceof Array&&"function"==typeof c[m]?c[m].apply(c,n):c[m]=n}return e&&b.customProps&&e.runWith([c,b]),c.created&&c.created(),c},a.addGraphicsToSprite=function(b,c){var d;if((d=b.child)&&!(d.length<1)){var e;e=a._getGraphicsFromSprite(b,c);var f=0,g=0;b.props&&(f=a._getObjVar(b.props,"x",0),g=a._getObjVar(b.props,"y",0)),0!=f&&0!=g&&e.translate(f,g);var h=0,i=0;for(i=d.length,h=0;h<i;h++)a._addGraphicToGraphics(d[h],e);0!=f&&0!=g&&e.translate(-f,-g)}},a.addGraphicToSprite=function(b,c,d){void 0===d&&(d=!1);var e;e=d?a._getGraphicsFromSprite(b,c):c.graphics,a._addGraphicToGraphics(b,e)},a._getGraphicsFromSprite=function(a,b){var c;if(!a||!a.props)return b.graphics;var d;switch(d=a.props.renderType){case"hit":case"unHit":var e;b.hitArea||(b.hitArea=new Y),e=b.hitArea,e[d]||(e[d]=new r),c=e[d]}return c||(c=b.graphics),c},a._getTransformData=function(b){var c;(b.hasOwnProperty("pivotX")||b.hasOwnProperty("pivotY"))&&(c=c||new D,c.translate(-a._getObjVar(b,"pivotX",0),-a._getObjVar(b,"pivotY",0)));var d=a._getObjVar(b,"scaleX",1),e=a._getObjVar(b,"scaleY",1),f=a._getObjVar(b,"rotation",0);a._getObjVar(b,"skewX",0),a._getObjVar(b,"skewY",0);return 1==d&&1==e&&0==f||(c=c||new D,c.scale(d,e),c.rotate(.0174532922222222*f)),c},a._addGraphicToGraphics=function(b,c){var d;if(d=b.props){var e;if(e=a.DrawTypeDic[b.type]){var f;f=c;var g,h=a._getParams(d,e[1],e[2],e[3]);g=a._tM,(g||1!=a._alpha)&&(f.save(),g&&f.transform(g),1!=a._alpha&&f.alpha(a._alpha)),f[e[0]].apply(f,h),(g||1!=a._alpha)&&f.restore()}}},a._adptLineData=function(a){return a[2]=parseFloat(a[0])+parseFloat(a[2]),a[3]=parseFloat(a[1])+parseFloat(a[3]),a},a._adptTextureData=function(a){return a[0]=qa.getRes(a[0]),a},a._adptLinesData=function(b){return b[2]=a._getPointListByStr(b[2]),b},a.isDrawType=function(b){return"Image"!=b&&a.DrawTypeDic.hasOwnProperty(b)},a._getParams=function(b,c,d,e){void 0===d&&(d=0);var f;f=a._temParam,f.length=c.length;var g=0,h=0;for(h=c.length,g=0;g<h;g++)f[g]=a._getObjVar(b,c[g][0],c[g][1]);a._alpha=a._getObjVar(b,"alpha",1);var i;return i=a._getTransformData(b),i?(d||(d=0),i.translate(f[d],f[d+1]),f[d]=f[d+1]=0,a._tM=i):a._tM=null,e&&a[e]&&(f=a[e](f)),f},a._getPointListByStr=function(a){var b;b=a.split(",");var c=0,d=0;for(d=b.length,c=0;c<d;c++)b[c]=parseFloat(b[c]);return b},a._getObjVar=function(a,b,c){return a.hasOwnProperty(b)?a[b]:c},a._temParam=[],a._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},a.getClass=function(c){var d=a._classMap[c]||c;return"string"==typeof d?b.__classmap[d]:d},a._tM=null,a._alpha=NaN,e(a,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),a}(),U=function(){function a(b){if(this._color=[],"string"==typeof b){this.strColor=b,null===b&&(b="#000000"),"#"==b.charAt(0)&&(b=b.substr(1));var c=b.length;if(3==c||4==c){for(var d="",e=0;e<c;e++)d+=b[e]+b[e];b=d}var f=this.numColor=parseInt(b,16);if(8==b.length)return void(this._color=[parseInt(b.substr(0,2),16)/255,((16711680&f)>>16)/255,((65280&f)>>8)/255,(255&f)/255])}else f=this.numColor=b,this.strColor=ga.toHexColor(f);this._color=[((16711680&f)>>16)/255,((65280&f)>>8)/255,(255&f)/255,1],this._color.__id=++a._COLODID}return f(a,"laya.utils.Color"),a._initDefault=function(){a._DEFAULT={};for(var b in a._COLOR_MAP)a._SAVE[b]=a._DEFAULT[b]=new a(a._COLOR_MAP[b]);return a._DEFAULT},a._initSaveMap=function(){a._SAVE_SIZE=0,a._SAVE={};for(var b in a._DEFAULT)a._SAVE[b]=a._DEFAULT[b]},a.create=function(b){var c=a._SAVE[b+""];return null!=c?c:(a._SAVE_SIZE<1e3||a._initSaveMap(),a._SAVE[b+""]=new a(b))},a._SAVE={},a._SAVE_SIZE=0,a._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},a._DEFAULT=a._initDefault(),a._COLODID=1,a}(),V=function(){function a(){this._values=[],this._keys=[]}f(a,"laya.utils.Dictionary");var b=a.prototype;return b.set=function(a,b){var c=this.indexOf(a);if(c>=0)return void(this._values[c]=b);this._keys.push(a),this._values.push(b)},b.indexOf=function(a){var b=this._keys.indexOf(a);return b>=0?b:(a="string"==typeof a?+a:"number"==typeof a?""+a:a,this._keys.indexOf(a))},b.get=function(a){var b=this.indexOf(a);return b<0?null:this._values[b]},b.remove=function(a){var b=this.indexOf(a);return b>=0&&(this._keys.splice(b,1),this._values.splice(b,1),!0)},b.clear=function(){this._values.length=0,this._keys.length=0},g(0,b,"values",function(){return this._values}),g(0,b,"keys",function(){return this._keys}),a}(),W=function(){function a(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}f(a,"laya.utils.Dragging");var c=a.prototype;return c.start=function(a,c,d,e,f,g,h,i){void 0===i&&(i=.92),this.clearTimer(),this.target=a,this.area=c,this.hasInertia=d,this.elasticDistance=c?e:0,this.elasticBackTime=f,this.data=g,this._disableMouseEvent=h,this.ratio=i,1!=a.globalScaleX||1!=a.globalScaleY?this._parent=a.parent:this._parent=b.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,b.stage.on("mouseup",this,this.onStageMouseUp),b.stage.on("mouseout",this,this.onStageMouseUp),b.timer.frameLoop(1,this,this.loop)},c.clearTimer=function(){b.timer.clear(this,this.loop),b.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},c.stop=function(){this._dragging&&(w.instance.disableMouseEvent=!1,b.stage.off("mouseup",this,this.onStageMouseUp),b.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},c.loop=function(){var a=this._parent.getMousePoint(),c=a.x,d=a.y,e=c-this._lastX,f=d-this._lastY;if(this._clickOnly){if(!(Math.abs(e*b.stage._canvasTransform.getScaleX())>1||Math.abs(f*b.stage._canvasTransform.getScaleY())>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),w.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(e,f);0===e&&0===f||(this._lastX=c,this._lastY=d,this.target.x+=e*this._elasticRateX,this.target.y+=f*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},c.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var a=this.area.x-this.target.x;else a=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-a/this.elasticDistance),this.target.y<this.area.y)var b=this.area.y-this.target.y;else b=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-b/this.elasticDistance)}},c.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},c.onStageMouseUp=function(a){if(w.instance.disableMouseEvent=!1,b.stage.off("mouseup",this,this.onStageMouseUp),b.stage.off("mouseout",this,this.onStageMouseUp),b.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var c=this._offsets.length,d=Math.min(c,6),e=this._offsets.length-d,f=c-1;f>e;f--)this._offsetY+=this._offsets[f--],this._offsetX+=this._offsets[f];this._offsetX=this._offsetX/d*2,this._offsetY=this._offsetY/d*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset),b.timer.frameLoop(1,this,this.tweenMove)}else this.elasticDistance>0?this.checkElastic():this.clear()},c.checkElastic=function(){var a=NaN,b=NaN;if(this.target.x<this.area.x?a=this.area.x:this.target.x>this.area.x+this.area.width&&(a=this.area.x+this.area.width),this.target.y<this.area.y?b=this.area.y:this.target.y>this.area.y+this.area.height&&(b=this.area.y+this.area.height),isNaN(a)&&isNaN(b))this.clear();else{var c={};isNaN(a)||(c.x=a),isNaN(b)||(c.y=b),this._tween=fa.to(this.target,c,this.elasticBackTime,X.sineOut,m.create(this,this.clear),0,!1,!1)}},c.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(b.timer.clear(this,this.tweenMove),this.elasticDistance>0?this.checkElastic():this.clear())},c.clear=function(){if(this.target){this.clearTimer();var a=this.target;this.target=null,this._parent=null,a.event("dragend",this.data)}},a}(),X=function(){function a(){}return f(a,"laya.utils.Ease"),a.linearNone=function(a,b,c,d){return c*a/d+b},a.linearIn=function(a,b,c,d){return c*a/d+b},a.linearInOut=function(a,b,c,d){return c*a/d+b},a.linearOut=function(a,b,c,d){return c*a/d+b},a.bounceIn=function(b,c,d,e){return d-a.bounceOut(e-b,0,d,e)+c},a.bounceInOut=function(b,c,d,e){return b<.5*e?.5*a.bounceIn(2*b,0,d,e)+c:.5*a.bounceOut(2*b-e,0,d,e)+.5*d+c},a.bounceOut=function(a,b,c,d){return(a/=d)<1/2.75?c*(7.5625*a*a)+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},a.backIn=function(a,b,c,d,e){return void 0===e&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b},a.backInOut=function(a,b,c,d,e){return void 0===e&&(e=1.70158),(a/=.5*d)<1?.5*c*(a*a*((1+(e*=1.525))*a-e))+b:c/2*((a-=2)*a*((1+(e*=1.525))*a+e)+2)+b},a.backOut=function(a,b,c,d,e){return void 0===e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},a.elasticIn=function(b,c,d,e,f,g){void 0===f&&(f=0),void 0===g&&(g=0);var h;return 0==b?c:1==(b/=e)?c+d:(g||(g=.3*e),!f||d>0&&f<d||d<0&&f<-d?(f=d,h=g/4):h=g/a.PI2*Math.asin(d/f),-(f*Math.pow(2,10*(b-=1))*Math.sin((b*e-h)*a.PI2/g))+c)},a.elasticInOut=function(b,c,d,e,f,g){void 0===f&&(f=0),void 0===g&&(g=0);var h;return 0==b?c:2==(b/=.5*e)?c+d:(g||(g=e*(.3*1.5)),!f||d>0&&f<d||d<0&&f<-d?(f=d,h=g/4):h=g/a.PI2*Math.asin(d/f),b<1?-.5*(f*Math.pow(2,10*(b-=1))*Math.sin((b*e-h)*a.PI2/g))+c:f*Math.pow(2,-10*(b-=1))*Math.sin((b*e-h)*a.PI2/g)*.5+d+c)},a.elasticOut=function(b,c,d,e,f,g){void 0===f&&(f=0),void 0===g&&(g=0);var h;return 0==b?c:1==(b/=e)?c+d:(g||(g=.3*e),!f||d>0&&f<d||d<0&&f<-d?(f=d,h=g/4):h=g/a.PI2*Math.asin(d/f),f*Math.pow(2,-10*b)*Math.sin((b*e-h)*a.PI2/g)+d+c)},a.strongIn=function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},a.strongInOut=function(a,b,c,d){return(a/=.5*d)<1?.5*c*a*a*a*a*a+b:.5*c*((a-=2)*a*a*a*a+2)+b},a.strongOut=function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},a.sineInOut=function(a,b,c,d){return.5*-c*(Math.cos(Math.PI*a/d)-1)+b},a.sineIn=function(b,c,d,e){return-d*Math.cos(b/e*a.HALF_PI)+d+c},a.sineOut=function(b,c,d,e){return d*Math.sin(b/e*a.HALF_PI)+c},a.quintIn=function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},a.quintInOut=function(a,b,c,d){return(a/=.5*d)<1?.5*c*a*a*a*a*a+b:.5*c*((a-=2)*a*a*a*a+2)+b},a.quintOut=function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},a.quartIn=function(a,b,c,d){return c*(a/=d)*a*a*a+b},a.quartInOut=function(a,b,c,d){return(a/=.5*d)<1?.5*c*a*a*a*a+b:.5*-c*((a-=2)*a*a*a-2)+b},a.quartOut=function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},a.cubicIn=function(a,b,c,d){return c*(a/=d)*a*a+b},a.cubicInOut=function(a,b,c,d){return(a/=.5*d)<1?.5*c*a*a*a+b:.5*c*((a-=2)*a*a+2)+b},a.cubicOut=function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},a.quadIn=function(a,b,c,d){return c*(a/=d)*a+b},a.quadInOut=function(a,b,c,d){return(a/=.5*d)<1?.5*c*a*a+b:.5*-c*(--a*(a-2)-1)+b},a.quadOut=function(a,b,c,d){return-c*(a/=d)*(a-2)+b},a.expoIn=function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b-.001*c},a.expoInOut=function(a,b,c,d){return 0==a?b:a==d?b+c:(a/=.5*d)<1?.5*c*Math.pow(2,10*(a-1))+b:.5*c*(2-Math.pow(2,-10*--a))+b},a.expoOut=function(a,b,c,d){return a==d?b+c:c*(1-Math.pow(2,-10*a/d))+b},a.circIn=function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},a.circInOut=function(a,b,c,d){return(a/=.5*d)<1?.5*-c*(Math.sqrt(1-a*a)-1)+b:.5*c*(Math.sqrt(1-(a-=2)*a)+1)+b},a.circOut=function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},a.HALF_PI=.5*Math.PI,a.PI2=2*Math.PI,a}(),Y=function(){function a(){this._hit=null,this._unHit=null}f(a,"laya.utils.HitArea");var b=a.prototype;return b.isHit=function(b,c){return!!a.isHitGraphic(b,c,this.hit)&&!a.isHitGraphic(b,c,this.unHit)},b.contains=function(a,b){return this.isHit(a,b)},g(0,b,"hit",function(){return this._hit||(this._hit=new r),this._hit},function(a){this._hit=a}),g(0,b,"unHit",function(){return this._unHit||(this._unHit=new r),this._unHit},function(a){this._unHit=a}),a.isHitGraphic=function(b,c,d){if(!d)return!1;var e;if(e=d.cmds,!e&&d._one&&(e=a._cmds,e.length=1,e[0]=d._one),!e)return!1;var f=0,g=0;g=e.length;var h;for(f=0;f<g;f++)if(h=e[f]){var i=J._context;switch(h.callee){case i._translate:case 6:b-=h[0],c-=h[1]}if(a.isHitCmd(b,c,h))return!0}return!1},a.isHitCmd=function(b,c,d){if(!d)return!1;var e=J._context,f=!1;switch(d.callee){case e._drawRect:case 13:a._rec.setTo(d[0],d[1],d[2],d[3]),f=a._rec.contains(b,c);break;case e._drawCircle:case e._fillCircle:case 14:var g=NaN;b-=d[0],c-=d[1],g=b*b+c*c,f=g<d[2]*d[2];break;case e._drawPoly:case 18:b-=d[0],c-=d[1],f=a.ptInPolygon(b,c,d[2])}return f},a.ptInPolygon=function(b,c,d){var e;e=a._ptPoint,e.setTo(b,c);var f=0,g=NaN,h=NaN,i=NaN,j=NaN,k=0;k=d.length;for(var l=0;l<k;l+=2)if(g=d[l],h=d[l+1],i=d[(l+2)%k],j=d[(l+3)%k],h!=j&&!(e.y<Math.min(h,j)||e.y>=Math.max(h,j))){var m=(e.y-h)*(i-g)/(j-h)+g;m>e.x&&f++}return f%2==1},a._cmds=[],e(a,["_rec",function(){return this._rec=new F},"_ptPoint",function(){return this._ptPoint=new E}]),a}(),Z=function(){function a(b,c,d,e){this.char=b,this.charNum=b.charCodeAt(0),this._x=this._y=0,this.width=c,this.height=d,this.style=e,this.isWord=!a._isWordRegExp.test(b)}f(a,"laya.utils.HTMLChar");var c=a.prototype;return b.imps(c,{"laya.display.ILayout":!0}),c.setSprite=function(a){this._sprite=a},c.getSprite=function(){return this._sprite},c._isChar=function(){return!0},c._getCSSStyle=function(){return this.style},g(0,c,"width",function(){return this._w},function(a){this._w=a}),g(0,c,"x",function(){return this._x},function(a){this._sprite&&(this._sprite.x=a),this._x=a}),g(0,c,"y",function(){return this._y},function(a){this._sprite&&(this._sprite.y=a),this._y=a}),g(0,c,"height",function(){return this._h},function(a){this._h=a}),a._isWordRegExp=RegExp("[\\w.]",""),a}(),$=function(){function a(){}return f(a,"laya.utils.Log"),a.enable=function(){a._logdiv||(a._logdiv=Q.window.document.createElement("div"),Q.window.document.body.appendChild(a._logdiv),a._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},a.toggle=function(){var b=a._logdiv.style;"1px"==b.width?b.width=b.height="50%":b.width=b.height="1px"},a.print=function(b){a._logdiv&&(a._count>=a.maxCount&&a.clear(),a._count++,a._logdiv.innerText+=b+"\n",a._logdiv.scrollTop=a._logdiv.scrollHeight)},a.clear=function(){a._logdiv.innerText="",a._count=0},a._logdiv=null,a._count=0,a.maxCount=20,a}(),_=function(){function a(){}return f(a,"laya.utils.Mouse"),g(1,a,"cursor",function(){return a._style.cursor},function(b){a._style.cursor=b}),a.hide=function(){"none"!=a.cursor&&(a._preCursor=a.cursor,a.cursor="none")},a.show=function(){"none"==a.cursor&&(a._preCursor?a.cursor=a._preCursor:a.cursor="auto")},a._preCursor=null,e(a,["_style",function(){return this._style=Q.document.body.style}]),a}(),aa=function(){function a(){}return f(a,"laya.utils.Pool"),a.getPoolBySign=function(b){return a._poolDic[b]||(a._poolDic[b]=[])},a.clearBySign=function(b){a._poolDic[b]&&(a._poolDic[b].length=0)},a.recover=function(b,c){c.__InPool||(c.__InPool=!0,a.getPoolBySign(b).push(c))},a.getItemByClass=function(b,c){var d=a.getPoolBySign(b),e=d.length?d.pop():new c;return e.__InPool=!1,e},a.getItemByCreateFun=function(b,c){var d=a.getPoolBySign(b),e=d.length?d.pop():c();return e.__InPool=!1,e},a.getItem=function(b){var c=a.getPoolBySign(b),d=c.length?c.pop():null;return d&&(d.__InPool=!1),d},a._poolDic={},a.InPoolSign="__InPool",a}(),ba=function(){function a(){this.sign=null,this.maxCount=1e3}f(a,"laya.utils.PoolCache");var b=a.prototype;return b.getCacheList=function(){return aa.getPoolBySign(this.sign)},b.tryDispose=function(a){var b;b=aa.getPoolBySign(this.sign),b.length>this.maxCount&&b.splice(this.maxCount,b.length-this.maxCount)},a.addPoolCacheManager=function(b,c){void 0===c&&(c=100);var d;d=new a,d.sign=b,d.maxCount=c,S.regCacheByFunction(ga.bind(d.tryDispose,d),ga.bind(d.getCacheList,d))},a}(),ca=function(){function a(){}return f(a,"laya.utils.Stat"),g(1,a,"onclick",null,function(b){a._canvas.source.onclick=b,a._canvas.source.style.pointerEvents=""}),a.show=function(b,c){if(void 0===b&&(b=0),void 0===c&&(c=0),J.isConchApp)return void(conch.showFPS&&conch.showFPS(b,c));var d=Q.pixelRatio;a._width=130*d,a._vx=75*d,a._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},a._view[1]={title:"Sprite",value:"spriteCount",color:"white",units:"int"},a._view[2]={title:"DrawCall",value:"drawCall",color:"white",units:"int"},a._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},J.isWebGL?(a._view[4]={title:"Shader",value:"shaderCall",color:"white",units:"int"},J.is3DMode?(a._view[0].title="FPS(3D)",a._view[5]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},a._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},a._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"}):(a._view[0].title="FPS(WebGL)",a._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"})):a._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"},a._fontSize=12*d;for(var e=0;e<a._view.length;e++)a._view[e].x=4,a._view[e].y=e*a._fontSize+2*d;a._height=d*(12*a._view.length+3*d),a._canvas||(a._canvas=new Ia("2D"),a._canvas.size(a._width,a._height),a._ctx=a._canvas.getContext("2d"),a._ctx.textBaseline="top",a._ctx.font=a._fontSize+"px Sans-serif",a._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;left:"+b+"px;top:"+c+"px;width:"+a._width/d+"px;height:"+a._height/d+"px;"),a._first=!0,a.loop(),a._first=!1,Q.container.appendChild(a._canvas.source),a.enable()},a.enable=function(){b.timer.frameLoop(1,a,a.loop)},a.hide=function(){Q.removeElement(a._canvas.source),b.timer.clear(a,a.loop)},a.clear=function(){a.trianglesFaces=a.drawCall=a.shaderCall=a.spriteCount=a.o=a.q=a.canvasNormal=a.canvasBitmap=a.canvasReCache=0},a.loop=function(){a._count++;var b=Q.now();if(!(b-a._timer<1e3)){var c=a._count;if(a.FPS=Math.round(1e3*c/(b-a._timer)),a._canvas){a.trianglesFaces=Math.round(a.trianglesFaces/c),a.drawCall=Math.round(a.drawCall/c)-2,a.shaderCall=Math.round(a.shaderCall/c),a.spriteCount=Math.round(a.spriteCount/c)-1,a.canvasNormal=Math.round(a.canvasNormal/c),a.canvasBitmap=Math.round(a.canvasBitmap/c),a.canvasReCache=Math.ceil(a.canvasReCache/c),a.o=Math.round(a.o/c),a.q=Math.round(a.q/c);var d=a.FPS>0?""+Math.floor(1e3/a.FPS):" ";a._fpsStr=a.FPS+(a.renderSlow?" slow":"")+" "+d,a._canvasStr=a.canvasReCache+"/"+a.canvasNormal+"/"+a.canvasBitmap,a.currentMemorySize=N.systemResourceManager.memorySize;var e=a._ctx;e.clearRect(a._first?0:a._vx,0,a._width,a._height);for(var f=0;f<a._view.length;f++){var g=a._view[f];a._first&&(e.fillStyle="white",e.fillText(g.title,g.x,g.y,null,null,null)),e.fillStyle=g.color;var h=a[g.value];"M"==g.units&&(h=Math.floor(h/1048576*100)/100+" M"),e.fillText(h+"",g.x+a._vx,g.y,null,null,null)}a.clear()}a._count=0,a._timer=b}},a.FPS=0,a.loopCount=0,a.shaderCall=0,a.drawCall=0,a.trianglesFaces=0,a.spriteCount=0,a.o=0,a.q=0,a.canvasNormal=0,a.canvasBitmap=0,a.canvasReCache=0,a.renderSlow=!1,a.currentMemorySize=0,a._fpsStr=null,a._canvasStr=null,a._canvas=null,a._ctx=null,a._timer=0,a._count=0,a._width=0,a._height=100,a._view=[],a._fontSize=12,a._first=!1,a._vx=NaN,a}(),da=function(){function a(){this._strsToID={},this._idToStrs=[],this._length=0}f(a,"laya.utils.StringKey");var b=a.prototype;return b.add=function(a){var b=this._strsToID[a];return null!=b?b:(this._idToStrs[this._length]=a,this._strsToID[a]=this._length++)},b.getID=function(a){var b=this._strsToID[a];return null==b?-1:b},b.getName=function(a){var b=this._idToStrs[a];return null==b?void 0:b},a}(),ea=function(){function a(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map=[],this._laters=[],this._handlers=[],this._temp=[],this._count=0,this.currTimer=Q.now(),this._lastTimer=Q.now(),b.timer&&b.timer.frameLoop(1,this,this._update)}var c;f(a,"laya.utils.Timer");var d=a.prototype;return d._update=function(){if(this.scale<=0)return void(this._lastTimer=Q.now());var a=this.currFrame=this.currFrame+this.scale,b=Q.now();this._delta=(b-this._lastTimer)*this.scale;var c=this.currTimer=this.currTimer+this._delta;this._lastTimer=b;var d=this._handlers;for(this._count=0,g=0,h=d.length;g<h;g++)if(i=d[g],null!==i.method){var e=i.userFrame?a:c;e>=i.exeTime&&(i.repeat?e>i.exeTime&&(i.exeTime+=i.delay,i.run(!1),e>i.exeTime&&(i.exeTime+=Math.ceil((e-i.exeTime)/i.delay)*i.delay)):i.run(!0))}else this._count++;(this._count>30||a%200==0)&&this._clearHandlers();for(var f=this._laters,g=0,h=f.length-1;g<=h;g++){var i=f[g];null!==i.method&&(this._map[i.key]=null,i.run(!1)),this._recoverHandler(i),g===h&&(h=f.length-1)}f.length=0},d._clearHandlers=function(){for(var a=this._handlers,b=0,c=a.length;b<c;b++){var d=a[b];null!==d.method?this._temp.push(d):this._recoverHandler(d)}this._handlers=this._temp,this._temp=a,this._temp.length=0},d._recoverHandler=function(b){this._map[b.key]=null,b.clear(),a._pool.push(b)},d._create=function(b,d,e,f,g,h,i){if(!e)return void g.apply(f,h);if(i){var j=this._getHandler(f,g);if(j)return j.repeat=d,j.userFrame=b,j.delay=e,j.caller=f,j.method=g,j.args=h,void(j.exeTime=e+(b?this.currFrame:Q.now()))}j=a._pool.length>0?a._pool.pop():new c,j.repeat=d,j.userFrame=b,j.delay=e,j.caller=f,j.method=g,j.args=h,j.exeTime=e+(b?this.currFrame:Q.now()),this._indexHandler(j),this._handlers.push(j)},d._indexHandler=function(a){var b=a.caller,c=a.method,d=b?b.$_GID||(b.$_GID=ga.getGID()):0,e=c.$_TID||(c.$_TID=1e5*this._mid++);a.key=d+e,this._map[a.key]=a},d.once=function(a,b,c,d,e){void 0===e&&(e=!0),this._create(!1,!1,a,b,c,d,e)},d.loop=function(a,b,c,d,e){void 0===e&&(e=!0),this._create(!1,!0,a,b,c,d,e)},d.frameOnce=function(a,b,c,d,e){void 0===e&&(e=!0),this._create(!0,!1,a,b,c,d,e)},d.frameLoop=function(a,b,c,d,e){void 0===e&&(e=!0),this._create(!0,!0,a,b,c,d,e)},d.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+a._pool.length},d.clear=function(a,b){var c=this._getHandler(a,b);c&&(this._map[c.key]=null,c.key=0,c.clear())},d.clearAll=function(a){if(a)for(var b=0,c=this._handlers.length;b<c;b++){var d=this._handlers[b];d.caller===a&&(this._map[d.key]=null,d.key=0,d.clear())}},d._getHandler=function(a,b){var c=a?a.$_GID||(a.$_GID=ga.getGID()):0,d=b.$_TID||(b.$_TID=1e5*this._mid++);return this._map[c+d]},d.callLater=function(b,d,e){if(null==this._getHandler(b,d)){if(a._pool.length)var f=a._pool.pop();else f=new c;f.caller=b,f.method=d,f.args=e,this._indexHandler(f),this._laters.push(f)}},d.runCallLater=function(a,b){var c=this._getHandler(a,b);c&&null!=c.method&&(this._map[c.key]=null,c.run(!0))},d.s=function(a,b){this.runCallLater(a,b)},g(0,d,"delta",function(){return this._delta}),a._pool=[],a.__init$=function(){c=function(){function a(){this.key=0,this.repeat=!1,this.delay=0,this.userFrame=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null}f(a,"");var b=a.prototype;return b.clear=function(){this.caller=null,this.method=null,this.args=null},b.run=function(a){var b=this.caller;if(b&&b.destroyed)return this.clear();var c=this.method,d=this.args;a&&this.clear(),null!=c&&(d?c.apply(b,d):c.call(b))},a}()},a}(),fa=function(){function a(){this.gid=0}f(a,"laya.utils.Tween");var c=a.prototype;return c.to=function(a,b,c,d,e,f,g){return void 0===f&&(f=0),void 0===g&&(g=!1),this._create(a,b,c,d,e,f,g,!0,!1,!0)},c.from=function(a,b,c,d,e,f,g){return void 0===f&&(f=0),void 0===g&&(g=!1),this._create(a,b,c,d,e,f,g,!1,!1,!0)},c._create=function(c,d,e,f,g,h,i,j,k,l){if(!c)throw Error("Tween:target is null");this._target=c,this._duration=e,this._ease=f||d.ease||a.easeNone,this._complete=g||d.complete,this._delay=h,this._props=[],this._usedTimer=0,this._startTimer=Q.now(),this._usedPool=k,this.update=d.update;var m=c.$_GID||(c.$_GID=ga.getGID());return a.tweenMap[m]?(i&&a.clearTween(c),a.tweenMap[m].push(this)):a.tweenMap[m]=[this],l?h<=0?this.firstStart(c,d,j):b.timer.once(h,this,this.firstStart,[c,d,j]):this._initProps(c,d,j),this},c.firstStart=function(a,b,c){if(a.destroyed)return void this.clear();this._initProps(a,b,c),this._beginLoop()},c._initProps=function(a,b,c){for(var d in b)if("number"==typeof a[d]){var e=c?a[d]:b[d],f=c?b[d]:a[d];this._props.push([d,e,f-e]),c||(a[d]=e)}},c._beginLoop=function(){b.timer.frameLoop(1,this,this._doEase)},c._doEase=function(){this._updateEase(Q.now())},c._updateEase=function(b){var c=this._target;if(c){if(c.destroyed)return a.clearTween(c);var d=this._usedTimer=b-this._startTimer-this._delay;if(!(d<0)){if(d>=this._duration)return this.complete();for(var e=d>0?this._ease(d,0,1,this._duration):0,f=this._props,g=0,h=f.length;g<h;g++){var i=f[g];c[i[0]]=i[1]+e*i[2]}this.update&&this.update.run()}}},c.complete=function(){if(this._target){b.timer.s(this,this.firstStart);for(var a=this._target,c=this._props,d=this._complete,e=0,f=c.length;e<f;e++){var g=c[e];a[g[0]]=g[1]+g[2]}this.update&&this.update.run(),this.clear(),d&&d.run()}},c.pause=function(){b.timer.clear(this,this._beginLoop),b.timer.clear(this,this._doEase)},c.setStartTime=function(a){this._startTimer=a},c.clear=function(){this._target&&(this._remove(),this._clear())},c._clear=function(){this.pause(),b.timer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._usedPool&&(this.update=null,aa.recover("tween",this))},c.recover=function(){this._usedPool=!0,this._clear()},c._remove=function(){var b=a.tweenMap[this._target.$_GID];if(b)for(var c=0,d=b.length;c<d;c++)if(b[c]===this){b.splice(c,1);break}},c.restart=function(){this.pause(),this._usedTimer=0,this._startTimer=Q.now();for(var a=this._props,c=0,d=a.length;c<d;c++){var e=a[c];this._target[e[0]]=e[1]}b.timer.once(this._delay,this,this._beginLoop)},c.resume=function(){
this._usedTimer>=this._duration||(this._startTimer=Q.now()-this._usedTimer-this._delay,this._beginLoop())},g(0,c,"progress",null,function(a){var b=a*this._duration;this._startTimer=Q.now()-this._delay-b}),a.to=function(b,c,d,e,f,g,h,i){return void 0===g&&(g=0),void 0===h&&(h=!1),void 0===i&&(i=!0),aa.getItemByClass("tween",a)._create(b,c,d,e,f,g,h,!0,i,!0)},a.from=function(b,c,d,e,f,g,h,i){return void 0===g&&(g=0),void 0===h&&(h=!1),void 0===i&&(i=!0),aa.getItemByClass("tween",a)._create(b,c,d,e,f,g,h,!1,i,!0)},a.clearAll=function(b){if(b&&b.$_GID){var c=a.tweenMap[b.$_GID];if(c){for(var d=0,e=c.length;d<e;d++)c[d]._clear();c.length=0}}},a.clear=function(a){a.clear()},a.clearTween=function(b){a.clearAll(b)},a.easeNone=function(a,b,c,d){return c*a/d+b},a.tweenMap={},a}(),ga=function(){function a(){}return f(a,"laya.utils.Utils"),a.toRadian=function(b){return b*a._pi2},a.toAngle=function(b){return b*a._pi},a.toHexColor=function(a){if(a<0||isNaN(a))return null;for(var b=a.toString(16);b.length<6;)b="0"+b;return"#"+b},a.getGID=function(){return a._gid++},a.concatArray=function(a,b){if(!b)return a;if(!a)return b;var c=0,d=b.length;for(c=0;c<d;c++)a.push(b[c]);return a},a.clearArray=function(a){return a?(a.length=0,a):a},a.copyArray=function(a,b){if(a||(a=[]),!b)return a;a.length=b.length;var c=0,d=b.length;for(c=0;c<d;c++)a[c]=b[c];return a},a.getGlobalRecByPoints=function(a,b,c,d,e){var f;f=new E(b,c),f=a.localToGlobal(f);var g;return g=new E(d,e),g=a.localToGlobal(g),F._getWrapRec([f.x,f.y,g.x,g.y])},a.getGlobalPosAndScale=function(b){return a.getGlobalRecByPoints(b,0,0,1,1)},a.bind=function(a,b){return a.bind(b)},a.measureText=function(a,b){return i.measureText(a,b)},a.updateOrder=function(a){if(!a||a.length<2)return!1;for(var b,c=1,d=0,e=a.length,f=NaN;c<e;){for(d=c,b=a[d],f=a[d]._zOrder;--d>-1&&a[d]._zOrder>f;)a[d+1]=a[d];a[d+1]=b,c++}var g=b.parent.conchModel;if(g)if(null!=g.updateZOrder)g.updateZOrder();else{for(c=0;c<e;c++)g.removeChild(a[c].conchModel);for(c=0;c<e;c++)g.addChildAt(a[c].conchModel,c)}return!0},a.transPointList=function(a,b,c){var d=0,e=a.length;for(d=0;d<e;d+=2)a[d]+=b,a[d+1]+=c},a.parseInt=function(a,b){void 0===b&&(b=0);var c=Q.window.parseInt(a,b);return isNaN(c)?0:c},a.getFileExtension=function(b){a._extReg.lastIndex=b.lastIndexOf(".");var c=a._extReg.exec(b);return c&&c.length>1?c[1].toLowerCase():null},a._gid=1,a._pi=180/Math.PI,a._pi2=Math.PI/180,a._extReg=/\.(\w+)\??/g,a.parseXMLFromString=function(a){var b;if(a=a.replace(/>\s+</g,"><"),b=(new DOMParser).parseFromString(a,"text/xml"),b.firstChild.textContent.indexOf("This page contains the following errors")>-1)throw Error(b.firstChild.firstChild.textContent);return b},a}(),ha=function(){function a(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],J.isWebGL&&S.regCacheByFunction(ga.bind(this.startDispose,this),ga.bind(this.getCacheList,this))}f(a,"laya.utils.VectorGraphManager");var b=a.prototype;return b.getId=function(){return this._id++},b.addShape=function(a,b){this.shapeDic[a]=b,this.useDic[a]||(this.useDic[a]=!0)},b.addLine=function(a,b){this.shapeLineDic[a]=b,this.shapeLineDic[a]||(this.shapeLineDic[a]=!0)},b.getShape=function(a){this._checkKey&&null!=this.useDic[a]&&(this.useDic[a]=!0)},b.deleteShape=function(a){this.shapeDic[a]&&(this.shapeDic[a]=null,delete this.shapeDic[a]),this.shapeLineDic[a]&&(this.shapeLineDic[a]=null,delete this.shapeLineDic[a]),null!=this.useDic[a]&&delete this.useDic[a]},b.getCacheList=function(){var a,b=[];for(a in this.shapeDic)b.push(this.shapeDic[a]);for(a in this.shapeLineDic)b.push(this.shapeLineDic[a]);return b},b.startDispose=function(a){var b;for(b in this.useDic)this.useDic[b]=!1;this._checkKey=!0},b.endDispose=function(){if(this._checkKey){var a;for(a in this.useDic)this.useDic[a]||this.deleteShape(a);this._checkKey=!1}},a.getInstance=function(){return a.instance=a.instance||new a},a.instance=null,a}(),ia=function(){function a(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}f(a,"laya.utils.WordText");var b=a.prototype;return b.setText=function(a){this.changed=!0,this._text=a},b.toString=function(){return this._text},b.charCodeAt=function(a){return this._text?this._text.charCodeAt(a):NaN},b.charAt=function(a){return this._text?this._text.charAt(a):null},g(0,b,"length",function(){return this._text?this._text.length:0}),a}(),ja=function(a){function c(){this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this.destroyed=!1,c.__super.call(this),this._childs=c.ARRAY_EMPTY,this._$P=c.PROP_EMPTY,this.timer=b.timer,this.conchModel=J.isConchNode?this.createConchModel():null}f(c,"laya.display.Node",a);var d=c.prototype;return d.createConchModel=function(){return null},d.destroy=function(a){void 0===a&&(a=!0),this.destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(a?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll()},d.destroyChildren=function(){if(this._childs)for(var a=this._childs.length-1;a>-1;a--)this._childs[a].destroy(!0)},d.addChild=function(a){if(!a||this.destroyed||a===this)return a;if(a.zOrder&&this._set$P("hasZorder",!0),a._parent===this){var b=this.getChildIndex(a);b!==this._childs.length-1&&(this._childs.splice(b,1),this._childs.push(a),this.conchModel&&(this.conchModel.removeChild(a.conchModel),this.conchModel.addChildAt(a.conchModel,this._childs.length-1)),this._childChanged())}else a.parent&&a.parent.removeChild(a),this._childs===c.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(a),this.conchModel&&this.conchModel.addChildAt(a.conchModel,this._childs.length-1),a.parent=this,this._childChanged();return a},d.addChildren=function(a){for(var b=arguments,c=0,d=b.length;c<d;)this.addChild(b[c++])},d.addChildAt=function(a,b){if(!a||this.destroyed||a===this)return a;if(a.zOrder&&this._set$P("hasZorder",!0),b>=0&&b<=this._childs.length){if(a._parent===this){var d=this.getChildIndex(a);this._childs.splice(d,1),this._childs.splice(b,0,a),this.conchModel&&(this.conchModel.removeChild(a.conchModel),this.conchModel.addChildAt(a.conchModel,b)),this._childChanged()}else a.parent&&a.parent.removeChild(a),this._childs===c.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(b,0,a),this.conchModel&&this.conchModel.addChildAt(a.conchModel,b),a.parent=this;return a}throw Error("appendChildAt:The index is out of bounds")},d.getChildIndex=function(a){return this._childs.indexOf(a)},d.getChildByName=function(a){for(var b=this._childs,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name===a)return e}return null},d._get$P=function(a){return this._$P[a]},d._set$P=function(a,b){return this.destroyed||(this._$P===c.PROP_EMPTY&&(this._$P={}),this._$P[a]=b),b},d.getChildAt=function(a){return this._childs[a]},d.setChildIndex=function(a,b){var c=this._childs;if(b<0||b>=c.length)throw Error("setChildIndex:The index is out of bounds.");var d=this.getChildIndex(a);if(d<0)throw Error("setChildIndex:node is must child of this object.");return c.splice(d,1),c.splice(b,0,a),this.conchModel&&(this.conchModel.removeChild(a.conchModel),this.conchModel.addChildAt(a.conchModel,b)),this._childChanged(),a},d._childChanged=function(a){},d.removeChild=function(a){if(!this._childs)return a;var b=this._childs.indexOf(a);return this.removeChildAt(b)},d.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},d.removeChildByName=function(a){var b=this.getChildByName(a);return b&&this.removeChild(b),b},d.removeChildAt=function(a){var b=this.getChildAt(a);return b&&(this._childs.splice(a,1),this.conchModel&&this.conchModel.removeChild(b.conchModel),b.parent=null),b},d.removeChildren=function(a,b){if(void 0===a&&(a=0),void 0===b&&(b=2147483647),this._childs&&this._childs.length>0){var d=this._childs;if(0===a&&b>=g){var e=d;this._childs=c.ARRAY_EMPTY}else e=d.splice(a,b-a);for(var f=0,g=e.length;f<g;f++)e[f].parent=null,this.conchModel&&this.conchModel.removeChild(e[f].conchModel)}return this},d.replaceChild=function(a,b){var c=this._childs.indexOf(b);return c>-1?(this._childs.splice(c,1,a),this.conchModel&&(this.conchModel.removeChild(b.conchModel),this.conchModel.addChildAt(a.conchModel,c)),b.parent=null,a.parent=this,a):null},d._setDisplay=function(a){this._displayedInStage!==a&&(this._displayedInStage=a,a?this.event("display"):this.event("undisplay"))},d._displayChild=function(a,b){var c=a._childs;if(c)for(var d=0,e=c.length;d<e;d++){var f=c[d];f._setDisplay(b),f._childs.length&&this._displayChild(f,b)}a._setDisplay(b)},d.contains=function(a){if(a===this)return!0;for(;a;){if(a.parent===this)return!0;a=a.parent}return!1},d.timerLoop=function(a,b,c,d,e){void 0===e&&(e=!0),this.timer._create(!1,!0,a,b,c,d,e)},d.timerOnce=function(a,b,c,d,e){void 0===e&&(e=!0),this.timer._create(!1,!1,a,b,c,d,e)},d.frameLoop=function(a,b,c,d,e){void 0===e&&(e=!0),this.timer._create(!0,!0,a,b,c,d,e)},d.frameOnce=function(a,b,c,d,e){void 0===e&&(e=!0),this.timer._create(!0,!1,a,b,c,d,e)},d.clearTimer=function(a,b){this.timer.clear(a,b)},g(0,d,"numChildren",function(){return this._childs.length}),g(0,d,"parent",function(){return this._parent},function(a){this._parent!==a&&(a?(this._parent=a,this.event("added"),a.displayedInStage&&this._displayChild(this,!0),a._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._displayChild(this,!1),this._parent=a))}),g(0,d,"displayedInStage",function(){return this._displayedInStage}),c.ARRAY_EMPTY=[],c.PROP_EMPTY={},c}(l),ka=function(a){function b(a){this._bgground=null,this._border=null,this._rect=null,this.lineHeight=0,b.__super.call(this),this._padding=b._PADDING,this._spacing=b._SPACING,this._aligns=b._ALIGNS,this._font=p.EMPTY,this._ower=a}f(b,"laya.display.css.CSSStyle",a);var c=b.prototype;return c.destroy=function(){this._ower=null,this._font=null,this._rect=null},c.inherit=function(a){this._font=a._font,this._spacing=a._spacing===b._SPACING?b._SPACING:a._spacing.slice(),this.lineHeight=a.lineHeight},c._widthAuto=function(){return 0!=(262144&this._type)},c.widthed=function(a){return 0!=(8&this._type)},c._calculation=function(a,b){function c(a,b,c){return a*c[0]+b*c[1]+c[2]}function d(a){var b=f.width,d=e.width;g.width&&(e.width=c(b,d,g.width)),g.height&&(e.height=c(b,d,g.height)),g.left&&(e.x=c(b,d,g.left)),g.top&&(e.y=c(b,d,g.top))}if(b.indexOf("%")<0)return!1;var e=this._ower,f=e.parent,g=this._rect;null===g&&(f._getCSSStyle()._type|=524288,f.on("resize",this,d),this._rect=g={input:{}});var h=b.split(" ");return h[0]=parseFloat(h[0])/100,1==h.length?h[1]=h[2]=0:(h[1]=parseFloat(h[1])/100,h[2]=parseFloat(h[2])),g[a]=h,g.input[a]=b,d(a),!0},c.heighted=function(a){return 0!=(8192&this._type)},c.size=function(a,b){var c=this._ower,d=!1;a!==-1&&a!=this._ower.width&&(this._type|=8,this._ower.width=a,d=!0),b!==-1&&b!=this._ower.height&&(this._type|=8192,this._ower.height=b,d=!0),d&&(c._layoutLater(),524288&this._type&&c.event("resize",this))},c._getAlign=function(){return this._aligns[0]},c._getValign=function(){return this._aligns[1]},c._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},c._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new p(this._font))},c.render=function(a,b,c,d){var e=a.width,f=a.height;c-=a.pivotX,d-=a.pivotY,this._bgground&&null!=this._bgground.color&&b.ctx.fillRect(c,d,e,f,this._bgground.color),this._border&&this._border.color&&b.drawRect(c,d,e,f,this._border.color.strColor,this._border.size)},c.getCSSStyle=function(){return this},c.cssText=function(a){this.attrs(b.parseOneCSS(a,";"))},c.attrs=function(a){if(a)for(var b=0,c=a.length;b<c;b++){var d=a[b];this[d[0]]=d[1]}},c.setTransform=function(a){"none"===a?this._tf=o._TF_EMPTY:this.attrs(b.parseOneCSS(a,","))},c.translate=function(a,b){this._tf===o._TF_EMPTY&&(this._tf=new q),this._tf.translateX=a,this._tf.translateY=b},c.scale=function(a,b){this._tf===o._TF_EMPTY&&(this._tf=new q),this._tf.scaleX=a,this._tf.scaleY=b},c._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},g(0,c,"block",a.prototype._$get_block,function(a){a?this._type|=1:this._type&=-2}),g(0,c,"valign",function(){return b._valigndef[this._aligns[1]]},function(a){this._aligns===b._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=b._valigndef[a]}),g(0,c,"height",null,function(a){if(this._type|=8192,"string"==typeof a){if(this._calculation("height",a))return;a=parseInt(a)}this.size(-1,a)}),g(0,c,"width",null,function(a){if(this._type|=8,"string"==typeof a){var b=a.indexOf("auto");if(b>=0&&(this._type|=262144,a=a.substr(0,b)),this._calculation("width",a))return;a=parseInt(a)}this.size(a,-1)}),g(0,c,"fontWeight",function(){return this._font.weight},function(a){this._createFont().weight=a}),g(0,c,"left",null,function(a){var b=this._ower;if("string"==typeof a){if("center"===a?a="50% -50% 0":"right"===a&&(a="100% -100% 0"),this._calculation("left",a))return;a=parseInt(a)}b.x=a}),g(0,c,"_translate",null,function(a){this.translate(a[0],a[1])}),g(0,c,"absolute",function(){return 0!=(4&this._type)}),g(0,c,"top",null,function(a){var b=this._ower;if("string"==typeof a){if("middle"===a?a="50% -50% 0":"bottom"===a&&(a="100% -100% 0"),this._calculation("top",a))return;a=parseInt(a)}b.y=a}),g(0,c,"align",function(){return b._aligndef[this._aligns[0]]},function(a){this._aligns===b._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=b._aligndef[a]}),g(0,c,"bold",function(){return this._font.bold},function(a){this._createFont().bold=a}),g(0,c,"padding",function(){return this._padding},function(a){this._padding=a}),g(0,c,"leading",function(){return this._spacing[1]},function(a){"string"==typeof a&&(a=parseInt(a+"")),this._spacing===b._SPACING&&(this._spacing=[0,0]),this._spacing[1]=a}),g(0,c,"lineElement",function(){return 0!=(65536&this._type)},function(a){a?this._type|=65536:this._type&=-65537}),g(0,c,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(a){this.lineElement=!1,"right"===a?this._type|=32768:this._type&=-32769}),g(0,c,"textDecoration",function(){return this._font.decoration},function(a){this._createFont().decoration=a}),g(0,c,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(a){"nowrap"===a&&(this._type|=131072),"none"===a&&(this._type&=-131073)}),g(0,c,"background",null,function(a){if(!a)return void(this._bgground=null);this._bgground||(this._bgground={}),this._bgground.color=a,this._ower.conchModel&&this._ower.conchModel.bgColor(a),this._type|=16384,this._ower._renderType|=256}),g(0,c,"wordWrap",function(){return 0==(131072&this._type)},function(a){a?this._type&=-131073:this._type|=131072}),g(0,c,"color",function(){return this._font.color},function(a){this._createFont().color=a}),g(0,c,"password",function(){return this._font.password},function(a){this._createFont().password=a}),g(0,c,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(a){"none"===a?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=a),this._ower.conchModel&&this._ower.conchModel.bgColor(a),this._ower._renderType|=256}),g(0,c,"font",function(){return""+this._font},function(a){this._createFont().set(a)}),g(0,c,"weight",null,function(a){this._createFont().weight=a}),g(0,c,"letterSpacing",function(){return this._spacing[0]},function(a){"string"==typeof a&&(a=parseInt(a+"")),this._spacing===b._SPACING&&(this._spacing=[0,0]),this._spacing[0]=a}),g(0,c,"fontSize",function(){return this._font.size},function(a){this._createFont().size=a}),g(0,c,"italic",function(){return this._font.italic},function(a){this._createFont().italic=a}),g(0,c,"fontFamily",function(){return this._font.family},function(a){this._createFont().family=a}),g(0,c,"stroke",function(){return this._font.stroke[0]},function(a){this._createFont().stroke===p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=a}),g(0,c,"strokeColor",function(){return this._font.stroke[1]},function(a){this._createFont().stroke===p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=a}),g(0,c,"border",function(){return this._border?this._border.value:""},function(a){if("none"==a)return void(this._border=null);this._border||(this._border={}),this._border.value=a;var b=a.split(" ");if(this._border.color=U.create(b[b.length-1]),1==b.length)return this._border.size=1,void(this._border.type="solid");var c=0;b[0].indexOf("px")>0?(this._border.size=parseInt(b[0]),c++):this._border.size=1,this._border.type=b[c],this._ower._renderType|=256}),g(0,c,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(a){if(!a)return void(this._border=null);this._border||(this._border={size:1,type:"solid"}),this._border.color=null==a?null:U.create(a),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256}),g(0,c,"position",function(){return 4&this._type?"absolute":""},function(a){"absolute"==a?this._type|=4:this._type&=-5}),g(0,c,"display",null,function(a){switch(a){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),g(0,c,"paddingLeft",function(){return this.padding[3]}),g(0,c,"paddingTop",function(){return this.padding[0]}),g(0,c,"_scale",null,function(a){this._ower.scale(a[0],a[1])}),g(0,c,"_rotate",null,function(a){this._ower.rotation=a}),b.parseOneCSS=function(a,c){for(var d,e=[],f=a.split(c),g=0,h=f.length;g<h;g++){var i=f[g],j=i.indexOf(":"),k=i.substr(0,j).replace(/^\s+|\s+$/g,"");if(0!=k.length){var l=i.substr(j+1).replace(/^\s+|\s+$/g,""),m=[k,l];switch(k){case"italic":case"bold":m[1]="true"==l;break;case"line-height":m[0]="lineHeight",m[1]=parseInt(l);break;case"font-size":m[0]="fontSize",m[1]=parseInt(l);break;case"padding":d=l.split(" "),d.length>1||(d[1]=d[2]=d[3]=d[0]),m[1]=[parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3])];break;case"rotate":m[0]="_rotate",m[1]=parseFloat(l);break;case"scale":d=l.split(" "),m[0]="_scale",m[1]=[parseFloat(d[0]),parseFloat(d[1])];break;case"translate":d=l.split(" "),m[0]="_translate",m[1]=[parseInt(d[0]),parseInt(d[1])];break;default:(m[0]=b._CSSTOVALUE[k])||(m[0]=k)}e.push(m)}}return e},b.parseCSS=function(a,c){for(var d;null!=(d=b._parseCSSRegExp.exec(a));)b.styleSheets[d[1]]=b.parseOneCSS(d[2],";")},b.EMPTY=new b(null),b._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},b._parseCSSRegExp=RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),b._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},b._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},b.styleSheets={},b.ALIGN_CENTER=1,b.ALIGN_RIGHT=2,b.VALIGN_MIDDLE=1,b.VALIGN_BOTTOM=2,b._CSS_BLOCK=1,b._DISPLAY_NONE=2,b._ABSOLUTE=4,b._WIDTH_SET=8,b._PADDING=[0,0,0,0],b._RECT=[-1,-1,-1,-1],b._SPACING=[0,0],b._ALIGNS=[0,0,0],b.ADDLAYOUTED=512,b._NEWFONT=4096,b._HEIGHT_SET=8192,b._BACKGROUND_SET=16384,b._FLOAT_RIGHT=32768,b._LINE_ELEMENT=65536,b._NOWARP=131072,b._WIDTHAUTO=262144,b._LISTERRESZIE=524288,b}(o),la=function(a){function b(){this.url=null,this.audio=null,this.loaded=!1,b.__super.call(this)}f(b,"laya.media.h5audio.AudioSound",a);var c=b.prototype;return c.dispose=function(){var a=b._audioCache[this.url];a&&(a.src="",delete b._audioCache[this.url])},c.load=function(a){function c(){e(),g.loaded=!0,g.event("complete")}function d(){f.load=null,e(),g.event("error")}function e(){f.removeEventListener("canplaythrough",c),f.removeEventListener("error",d)}this.url=a;var f=b._audioCache[a];if(f&&f.readyState>=2)return void this.event("complete");f||(f=Q.createElement("audio"),f.src=a,b._audioCache[a]=f),f.addEventListener("canplaythrough",c),f.addEventListener("error",d);var g=this;this.audio=f,f.load?f.load():d()},c.play=function(a,c){if(void 0===a&&(a=0),void 0===c&&(c=0),!this.url)return null;var d;if(!(d=b._audioCache[this.url]))return null;var e;e=aa.getItem("audio:"+this.url),e=e?e:d.cloneNode(!0);var f=new za(e);return f.url=this.url,f.loops=c,f.startTime=a,f.play(),G.addChannel(f),f},g(0,c,"duration",function(){var a;return a=b._audioCache[this.url],a?a.duration:0}),b._audioCache={},b}(l),ma=function(a){function b(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.completeHandler=null,b.__super.call(this)}f(b,"laya.media.SoundChannel",a);var c=b.prototype;return c.play=function(){},c.stop=function(){},c.__runComplete=function(a){a&&a.run()},g(0,c,"volume",function(){return 1},function(a){}),g(0,c,"position",function(){return 0}),g(0,c,"duration",function(){return 0}),b}(l),na=function(a){function b(){b.__super.call(this)}f(b,"laya.media.Sound",a);var c=b.prototype;return c.load=function(a){},c.play=function(a,b){return void 0===a&&(a=0),void 0===b&&(b=0),null},c.dispose=function(){},g(0,c,"duration",function(){return 0}),b}(l),oa=function(a){function b(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,b.__super.call(this)}f(b,"laya.media.webaudio.WebAudioSound",a);var c=b.prototype;return c.load=function(a){var c=this;if(this.url=a,this.audioBuffer=b._dataCache[a],this.audioBuffer)return void this._loaded(this.audioBuffer);if(b.e.on("loaded:"+a,this,this._loaded),b.e.on("err:"+a,this,this._err),!b.__loadingSound[a]){b.__loadingSound[a]=!0;var d=new Q.window.XMLHttpRequest;d.open("GET",a,!0),d.responseType="arraybuffer",d.onload=function(){c.data=d.response,b.buffs.push({buffer:c.data,url:c.url}),b.decode()},d.onerror=function(a){c._err()},d.send()}},c._err=function(){this._removeLoadEvents(),b.__loadingSound[this.url]=!1,this.event("error")},c._loaded=function(a){this._removeLoadEvents(),this.audioBuffer=a,b._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event("complete")},c._removeLoadEvents=function(){b.e.off("loaded:"+this.url,this,this._loaded),b.e.off("err:"+this.url,this,this._err)},c.__playAfterLoaded=function(){if(this.__toPlays){var a,b=0,c=0;a=this.__toPlays,c=a.length;var d;for(b=0;b<c;b++)d=a[b],d[2]&&!d[2].isStopped&&this.play(d[0],d[1],d[2]);this.__toPlays.length=0}},c.play=function(a,b,c){return void 0===a&&(a=0),void 0===b&&(b=0),c=c?c:new Aa,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([a,b,c]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),c.url=this.url,c.loops=b,c.audioBuffer=this.audioBuffer,c.startTime=a,c.play(),G.addChannel(c),c},c.dispose=function(){delete b._dataCache[this.url],delete b.__loadingSound[this.url]},g(0,c,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),b.decode=function(){b.buffs.length<=0||b.isDecoding||(b.isDecoding=!0,b.tInfo=b.buffs.shift(),b.ctx.decodeAudioData(b.tInfo.buffer,b._done,b._fail))},b._done=function(a){b.e.event("loaded:"+b.tInfo.url,a),b.isDecoding=!1,b.decode()},b._fail=function(){b.e.event("err:"+b.tInfo.url,null),b.isDecoding=!1,b.decode()},b._playEmptySound=function(){if(null!=b.ctx){var a=b.ctx.createBufferSource();a.buffer=b._miniBuffer,a.connect(b.ctx.destination),a.start(0,0,0)}},b._unlock=function(){b._unlocked||(b._playEmptySound(),"running"==b.ctx.state&&(Q.document.removeEventListener("mousedown",b._unlock,!0),Q.document.removeEventListener("touchend",b._unlock,!0),b._unlocked=!0))},b.initWebAudio=function(){"running"!=b.ctx.state&&(b._unlock(),Q.document.addEventListener("mousedown",b._unlock,!0),Q.document.addEventListener("touchend",b._unlock,!0))},b._dataCache={},b.buffs=[],b.isDecoding=!1,b._unlocked=!1,b.tInfo=null,b.__loadingSound={},e(b,["window",function(){return this.window=Q.window},"webAudioEnabled",function(){return this.webAudioEnabled=b.window.AudioContext||b.window.webkitAudioContext||b.window.mozAudioContext},"ctx",function(){return this.ctx=b.webAudioEnabled?new(b.window.AudioContext||b.window.webkitAudioContext||b.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=b.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new l}]),b}(l),pa=function(a){function b(){this._responseType=null,this._data=null,b.__super.call(this),this._http=new Q.window.XMLHttpRequest}f(b,"laya.net.HttpRequest",a);var c=b.prototype;return c.send=function(a,b,c,d,e){void 0===c&&(c="get"),void 0===d&&(d="text"),this._responseType=d,this._data=null;var f=this,g=this._http;if(g.open(c,a,!0),e)for(var h=0;h<e.length;h++)g.setRequestHeader(e[h++],e[h]);else b&&"string"!=typeof b?g.setRequestHeader("Content-Type","application/json"):g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");g.responseType="arraybuffer"!==d?"text":"arraybuffer",g.onerror=function(a){f._onError(a)},g.onabort=function(a){f._onAbort(a)},g.onprogress=function(a){f._onProgress(a)},g.onload=function(a){f._onLoad(a)},g.send(b)},c._onProgress=function(a){a&&a.lengthComputable&&this.event("progress",a.loaded/a.total)},c._onAbort=function(a){this.error("Request was aborted by user")},c._onError=function(a){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},c._onLoad=function(a){var b=this._http,c=void 0!==b.status?b.status:200;200===c||204===c||0===c?this.complete():this.error("["+b.status+"]"+b.statusText+":"+b.responseURL)},c.error=function(a){this.clear(),this.event("error",a)},c.complete=function(){this.clear();var a=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=ga.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(b){a=!1,this.error(b.message)}a&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},c.clear=function(){var a=this._http;a.onerror=a.onabort=a.onprogress=a.onload=null},g(0,c,"url",function(){return this._http.responseURL}),g(0,c,"http",function(){return this._http}),g(0,c,"data",function(){return this._data}),b}(l),qa=function(a){function c(){this._data=null,this._url=null,this._type=null,this._cache=!1,this._http=null,c.__super.call(this)}f(c,"laya.net.Loader",a);var d=c.prototype;return d.load=function(a,b,d,e,f){if(void 0===d&&(d=!0),void 0===f&&(f=!1),0===a.indexOf("data:image")&&(b="image"),a=I.formatURL(a),this._url=a,this._type=b||(b=this.getTypeFromUrl(a)),this._cache=d,this._data=null,!f&&c.loadedMap[a])return this._data=c.loadedMap[a],this.event("progress",1),void this.event("complete",this._data);if(e&&c.setGroup(a,e),null!=c.parserMap[b])return void(c.parserMap[b]instanceof laya.utils.Handler?c.parserMap[b].runWith(this):c.parserMap[b].call(null,this));if("image"===b||"htmlimage"===b||"nativeimage"===b)return this._loadImage(a);if("sound"===b)return this._loadSound(a);this._http||(this._http=new pa,this._http.on("progress",this,this.onProgress),this._http.on("error",this,this.onError),this._http.on("complete",this,this.onLoaded));var g;switch(b){case"atlas":g="json";break;case"font":g="xml";break;default:g=b}this._http.send(a,null,"get",g)},d.getTypeFromUrl=function(a){var b=ga.getFileExtension(a);return b?c.typeMap[b]:(console.log("Not recognize the resources suffix",a),"text")},d._loadImage=function(a){function b(){c.onload=null,c.onerror=null}var c,d=this,e=function(){b(),d.onLoaded(c)},f=function(){b(),d.event("error","Load image failed")};"nativeimage"===this._type?(c=new Q.window.Image,c.crossOrigin="",c.onload=e,c.onerror=f,c.src=a):new Na.create(a,{onload:e,onerror:f,onCreate:function(a){c=a}})},d._loadSound=function(a){function b(){d(),f.onLoaded(e)}function c(){d(),e.dispose(),f.event("error","Load sound failed")}function d(){e.offAll()}var e=new G._soundClass,f=this;e.on("complete",this,b),e.on("error",this,c),e.load(a)},d.onProgress=function(a){"atlas"===this._type?this.event("progress",.3*a):this.event("progress",a)},d.onError=function(a){this.event("error",a)},d.onLoaded=function(a){var b=this._type;if("image"===b){var d=new wa(a);d.url=this._url,this.complete(d)}else if("sound"===b||"htmlimage"===b||"nativeimage"===b)this.complete(a);else if("atlas"===b){if(!a.src&&!a._setContext){if(!this._data){if(this._data=a,a.meta&&a.meta.image){var e=a.meta.image.split(","),f=this._url.indexOf("/")>=0?"/":"\\",g=this._url.lastIndexOf(f),h=g>=0?this._url.substr(0,g+1):"";g=this._url.indexOf("?");var i;i=g>=0?this._url.substr(g):"";for(var j=0,k=e.length;j<k;j++)e[j]=h+e[j]+i}else e=[this._url.replace(".json",".png")];e.reverse(),a.toLoads=e,a.pics=[]}return this.event("progress",.3+1/e.length*.6),this._loadImage(I.formatURL(e.pop()))}if(this._data.pics.push(a),this._data.toLoads.length>0)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(I.formatURL(this._data.toLoads.pop()));var l=this._data.frames,m=this._url.split("?")[0],o=this._data.meta&&this._data.meta.prefix?I.basePath+this._data.meta.prefix:m.substring(0,m.lastIndexOf("."))+"/",p=this._data.pics,q=c.atlasMap[this._url]||(c.atlasMap[this._url]=[]);q.dir=o;for(var r in l){var s=l[r],t=p[s.frame.idx?s.frame.idx:0],u=o+r;c.cacheRes(u,wa.create(t,s.frame.x,s.frame.y,s.frame.w,s.frame.h,s.spriteSourceSize.x,s.spriteSourceSize.y,s.sourceSize.w,s.sourceSize.h)),c.loadedMap[u].url=u,q.push(u)}this.complete(this._data)}else if("font"==b){if(!a.src)return this._data=a,this.event("progress",.5),this._loadImage(I.formatURL(this._url.replace(".fnt",".png")));var v;v=new n,v.parseFont(this._data,a);var w=this._url.split(".fnt")[0].split("/"),x=w[w.length-1];Da.registerBitmapFont(x,v),this._data=v,this.complete(this._data)}else this.complete(a)},d.complete=function(a){this._data=a,c._loaders.push(this),c._isWorking||c.checkNext()},d.endLoad=function(a){a&&(this._data=a),this._cache&&c.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},g(0,d,"url",function(){return this._url}),g(0,d,"data",function(){return this._data}),g(0,d,"cache",function(){return this._cache}),g(0,d,"type",function(){return this._type}),c.checkNext=function(){c._isWorking=!0;for(var a=Q.now();c._startIndex<c._loaders.length;)if(Q.now(),c._loaders[c._startIndex].endLoad(),c._startIndex++,Q.now()-a>c.maxTimeOut)return console.log("loader callback cost a long time:"+(Q.now()-a)+" url="+c._loaders[c._startIndex-1].url),void b.timer.frameOnce(1,null,c.checkNext);c._loaders.length=0,c._startIndex=0,c._isWorking=!1},c.clearRes=function(a,b){void 0===b&&(b=!1),a=I.formatURL(a);var d=c.atlasMap[a];if(d){for(var e=0,f=d.length;e<f;e++){var g=d[e],h=c.getRes(g);h&&h.destroy(b),delete c.loadedMap[g]}d.length=0,delete c.atlasMap[a],delete c.loadedMap[a]}else{var i=c.loadedMap[a];i&&(i instanceof laya.resource.Texture&&i.bitmap&&i.destroy(b),delete c.loadedMap[a])}},c.getRes=function(a){return c.loadedMap[I.formatURL(a)]},c.getAtlas=function(a){return c.atlasMap[I.formatURL(a)]},c.cacheRes=function(a,b){a=I.formatURL(a),null!=c.loadedMap[a]?console.log("Resources already exist,is repeated loading:",a):c.loadedMap[a]=b},c.setGroup=function(a,b){c.groupMap[b]||(c.groupMap[b]=[]),c.groupMap[b].push(a)},c.clearResByGroup=function(a){if(c.groupMap[a]){var b=c.groupMap[a],d=0,e=b.length;for(d=0;d<e;d++)c.clearRes(b[d]);b.length=0}},c.TEXT="text",c.JSON="json",c.XML="xml",c.BUFFER="arraybuffer",c.IMAGE="image",c.SOUND="sound",c.ATLAS="atlas",c.FONT="font",c.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font"},c.parserMap={},c.loadedMap={},c.groupMap={},c.maxTimeOut=100,c.atlasMap={},c._loaders=[],c._isWorking=!1,c._startIndex=0,c}(l),ra=function(a){function b(){this.retryNum=1,this.maxLoader=5,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},b.__super.call(this)
;for(var a=0;a<this._maxPriority;a++)this._resInfos[a]=[]}var c;f(b,"laya.net.LoaderManager",a);var d=b.prototype;return d.create=function(a,b,c,d,e,f,g){function h(a,c){l++,a.progress=1,l===k&&b&&b.run()}function i(a,b){a.progress=b;for(var c=0,d=0;d<k;d++){c+=j[d].progress}var e=c/k;n.runWith(e)}if(void 0===f&&(f=1),void 0===g&&(g=!0),a instanceof Array){var j=a,k=j.length,l=0;if(c)var n=m.create(c.caller,c.method,c.args,!1);for(var o=0;o<k;o++){var p=j[o];"string"==typeof p&&(p=j[o]={url:p}),p.progress=0;var q=c?m.create(null,i,[p],!1):null,r=c||b?m.create(null,h,[p]):null;this._create(p.url,r,q,p.clas||d,p.params||e,p.priority||f,g)}return!0}return this._create(a,b,c,d,e,f,g)},d._create=function(a,c,d,e,f,g,h){function i(b){j&&j.onAsynLoaded.call(j,a,b,f),c&&c.run()}void 0===g&&(g=1),void 0===h&&(h=!0);var j=this.getRes(a);if(j)d&&d.runWith(1),c&&c.run();else{var k=ga.getFileExtension(a),l=b.createMap[k];e||(e=l[0]);var n=l[1];if("atlas"==k)this.load(a,c,d,n,g,h);else if(e===wa&&(n="htmlimage"),j=e?new e:null,this.load(a,m.create(null,i),d,n,g,!1,null,!0),h){var o=I.formatURL(a);b.cacheRes(o,j),j.url=o}}return j},d.load=function(a,d,e,f,g,h,i,j){if(void 0===g&&(g=1),void 0===h&&(h=!0),void 0===j&&(j=!1),a instanceof Array)return this._loadAssets(a,d,e,f,g,h,i);a=I.formatURL(a);var k=qa.getRes(a);if(null!=k)e&&e.runWith(1),d&&d.runWith(k),this._loaderCount||this.event("complete");else{var l=b._resMap[a];l?(d&&l._createListener("complete",d.caller,d.method,d.args,!1,!1),e&&l._createListener("progress",e.caller,e.method,e.args,!1,!1)):(l=this._infoPool.length?this._infoPool.pop():new c,l.url=a,l.type=f,l.cache=h,l.group=i,l.ignoreCache=j,d&&l.on("complete",d.caller,d.method,d.args),e&&l.on("progress",e.caller,e.method,e.args),b._resMap[a]=l,g=g<this._maxPriority?g:this._maxPriority-1,this._resInfos[g].push(l),this._next())}return this},d._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var a=0;a<this._maxPriority;a++){var b=this._resInfos[a];if(b.length>0){var c=b.shift();if(c)return this._doLoad(c)}}this._loaderCount||this.event("complete")}},d._doLoad=function(a){function b(b){c.offAll(),c._data=null,d._loaders.push(c),d._endLoad(a,b instanceof Array?[b]:b),d._loaderCount--,d._next()}this._loaderCount++;var c=this._loaders.length?this._loaders.pop():new qa;c.on("complete",null,b),c.on("progress",null,function(b){a.event("progress",b)}),c.on("error",null,function(a){b(null)});var d=this;c.load(a.url,a.type,a.cache,a.group,a.ignoreCache)},d._endLoad=function(a,c){if(null===c){var d=this._failRes[a.url]||0;if(d<this.retryNum)return console.log("[warn]Retry to load:",a.url),this._failRes[a.url]=d+1,void this._resInfos[this._maxPriority-1].push(a);console.log("[error]Failed to load:",a.url),this.event("error",a.url)}delete b._resMap[a.url],a.event("complete",c),a.offAll(),this._infoPool.push(a)},d.clearRes=function(a,b){void 0===b&&(b=!1),qa.clearRes(a,b)},d.getRes=function(a){return qa.getRes(a)},d.clearUnLoaded=function(){for(var a=0;a<this._maxPriority;a++){for(var c=this._resInfos[a],d=c.length-1;d>-1;d--){var e=c[d];e&&(e.offAll(),this._infoPool.push(e))}c.length=0}this._loaderCount=0,b._resMap={}},d.cancelLoadByUrls=function(a){if(a)for(var b=0,c=a.length;b<c;b++)this.cancelLoadByUrl(a[b])},d.cancelLoadByUrl=function(a){a=I.formatURL(a);for(var c=0;c<this._maxPriority;c++)for(var d=this._resInfos[c],e=d.length-1;e>-1;e--){var f=d[e];f&&f.url===a&&(d[e]=null,f.offAll(),this._infoPool.push(f))}b._resMap[a]&&delete b._resMap[a]},d._loadAssets=function(a,b,c,d,e,f,g){function h(a,c){k++,a.progress=1,k===j&&b&&b.run()}function i(a,b){if(null!=c){a.progress=b;for(var d=0,e=0;e<n.length;e++){var f=n[e];d+=f.size*f.progress}var g=d/l;c.runWith(g)}}void 0===e&&(e=1),void 0===f&&(f=!0);for(var j=a.length,k=0,l=0,n=[],o=d||"image",p=0;p<j;p++){var q=a[p];"string"==typeof q&&(q={url:q,type:o,size:1,priority:e}),q.size||(q.size=1),q.progress=0,l+=q.size,n.push(q);var r=c?m.create(null,i,[q],!1):null,s=b||c?m.create(null,h,[q]):null;this.load(q.url,s,r,q.type,q.priority||1,f,q.group||g)}return this},b.cacheRes=function(a,b){qa.cacheRes(a,b)},b._resMap={},e(b,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),b.__init$=function(){c=function(a){function b(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,b.__super.call(this)}return f(b,"",a),b}(l)},b}(l),sa=function(a){function c(a){c.__super.call(this),a||(a=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var b=0,d=0,e=0;e<20;e++)e%5!=4?this._mat[b++]=a[e]:this._alpha[d++]=a[e];this._action=i.createFilterAction(32),this._action.data=this}f(c,"laya.filters.ColorFilter",a);var d=c.prototype;return b.imps(d,{"laya.filters.IFilter":!0}),d.callNative=function(a){a._$P.cf=this;a.conchModel&&a.conchModel.setFilterMatrix&&a.conchModel.setFilterMatrix(this._mat,this._alpha)},g(0,d,"type",function(){return 32}),g(0,d,"action",function(){return this._action}),g(1,c,"DEFAULT",function(){return c._DEFAULT||(c._DEFAULT=new c([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0])),c._DEFAULT},laya.filters.Filter._$SET_DEFAULT),g(1,c,"GRAY",function(){return c._GRAY||(c._GRAY=new c([.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0])),c._GRAY},laya.filters.Filter._$SET_GRAY),c._DEFAULT=null,c._GRAY=null,c}(x),ta=function(a){function b(a,c,d){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===c&&(c=0),b.__super.call(this),this._byteClass=d,this._byteClass=this._byteClass?this._byteClass:R,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,a&&c>0&&c<65535&&this.connect(a,c)}f(b,"laya.net.Socket",a);var c=b.prototype;return c.connect=function(a,b){var c="ws://"+a+":"+b;this.connectByUrl(c)},c.connectByUrl=function(a){var b=this;null!=this._socket&&this.close(),this._socket&&this._cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new Q.window.WebSocket(a,this.protocols):this._socket=new Q.window.WebSocket(a),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(a){b._onOpen(a)},this._socket.onmessage=function(a){b._onMessage(a)},this._socket.onclose=function(a){b._onClose(a)},this._socket.onerror=function(a){b._onError(a)}},c._cleanSocket=function(){try{this._socket.close()}catch(a){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},c.close=function(){null!=this._socket&&this._cleanSocket()},c._onOpen=function(a){this._connected=!0,this.event("open",a)},c._onMessage=function(a){if(a&&a.data){var b=a.data;if(this.disableInput&&b)return void this.event("message",b);this._input.length>0&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var c=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,b&&("string"==typeof b?this._input.writeUTFBytes(b):this._input.writeArrayBuffer(b),this._addInputPosition=this._input.pos,this._input.pos=c),this.event("message",b)}},c._onClose=function(a){this._connected=!1,this.event("close",a)},c._onError=function(a){this.event("error",a)},c.send=function(a){this._socket.send(a)},c.flush=function(){if(this._output&&this._output.length>0){var a;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(b){a=b}this._output.endian=this.endian,this._output.clear(),a&&this.event("error",a)}},g(0,c,"input",function(){return this._input}),g(0,c,"output",function(){return this._output}),g(0,c,"connected",function(){return this._connected}),g(0,c,"endian",function(){return this._endian},function(a){this._endian=a,null!=this._input&&(this._input.endian=a),null!=this._output&&(this._output.endian=a)}),b.LITTLE_ENDIAN="littleEndian",b.BIG_ENDIAN="bigEndian",b}(l),ua=function(a){function b(){this.worker=null,b.__super.call(this);var a=this;this.worker=new Q.window.Worker(b.workerPath),this.worker.onmessage=function(b){a.workerMessage(b.data)}}f(b,"laya.net.WorkerLoader",a);var c=b.prototype;return c.workerMessage=function(a){if(a)switch(a.type){case"Image":this.imageLoaded(a);break;case"Msg":this.event("image_msg",a.msg)}},c.imageLoaded=function(a){if(a&&a.buffer&&a.buffer.length<10)return b._enable=!1,this._myTrace("buffer lost when postmessage ,disable workerloader"),this.event(a.url,null),void this.event("image_err",a.url+"\n"+a.msg);if(!a.dataType)return this.event(a.url,null),void this.event("image_err",a.url+"\n"+a.msg);var c,d=new Ia("2D");c=d.source.getContext("2d");var e;switch(a.dataType){case"buffer":e=c.createImageData(a.width,a.height),e.data.set(a.buffer),d.size(e.width,e.height),c.putImageData(e,0,0);break;case"imagedata":e=a.imagedata,d.size(e.width,e.height),c.putImageData(e,0,0),e=a.imagedata;break;case"imageBitmap":e=a.imageBitmap,d.size(e.width,e.height),c.drawImage(e,0,0)}J.isWebGL&&(d=new laya.webgl.resource.WebGLImage(d,a.url)),this.event(a.url,d)},c._myTrace=function(a){var b=arguments,c=[],d=0,e=b.length;for(d=0;d<e;d++)c.push(b[d]);this.event("image_msg",c.join(" "))},c.loadImage=function(a){var b;b={},b.type="load",b.url=a,this.worker.postMessage(b)},c._loadImage=function(a){function c(){laya.net.WorkerLoader.I.off(a,d,e)}var d=this;if(!b._enable||a.toLowerCase().indexOf(".png")<0)return void b._preLoadFun.call(d,a);var e=function(e){c(),e?d.onLoaded(e):b._preLoadFun.call(d,a)};laya.net.WorkerLoader.I.on(a,d,e),laya.net.WorkerLoader.I.loadImage(a)},g(1,b,"enable",function(){return b._enable},function(a){b._enable=a,b._enable&&null==b._preLoadFun&&b.__init__()}),b.__init__=function(){return null==b._preLoadFun&&(!!Q.window.Worker&&(b._preLoadFun=qa.prototype._loadImage,qa.prototype._loadImage=b.prototype._loadImage,b.I||(b.I=new b),!0))},b.t=function(){return!!Q.window.Worker},b.IMAGE_LOADED="image_loaded",b.IMAGE_ERR="image_err",b.IMAGE_MSG="image_msg",b.I=null,b._preLoadFun=null,b._enable=!1,b.workerPath="libs/worker.js",b}(l),va=function(a){function c(){this._id=0,this._lastUseFrameCount=0,this._memorySize=0,this._name=null,this._url=null,this._loaded=!1,this._released=!1,this._disposed=!1,this._resourceManager=null,this.lock=!1,c.__super.call(this),this._$1__id=++c._uniqueIDCounter,c._loadedResources.push(this),c._isLoadedResourcesSorted=!1,this._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,N.currentResourceManager&&N.currentResourceManager.addResource(this)}f(c,"laya.resource.Resource",a);var d=c.prototype;return b.imps(d,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),d.recreateResource=function(){this.startCreate(),this.completeCreate()},d.detoryResource=function(){},d.activeResource=function(a){void 0===a&&(a=!1),this._lastUseFrameCount=ca.loopCount,(this._released||a)&&this.recreateResource()},d.releaseResource=function(a){return void 0===a&&(a=!1),!(!a&&this.lock)&&(!(this._released&&!a)&&(this.detoryResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},d.setUniqueName=function(a){for(var b=!0,d=0;d<c._loadedResources.length;d++)if(c._loadedResources[d]._name===a&&c._loadedResources[d]!==this)return void(b=!1);b?this.name!=a&&(this.name=a,c._isLoadedResourcesSorted=!1):this.setUniqueName(a.concat("-copy"))},d.onAsynLoaded=function(a,b,c){throw Error("Resource: must override this function!")},d.dispose=function(){if(null!==this._resourceManager)throw Error("附属于resourceManager的资源不能独立释放！");this._disposed=!0,this.lock=!1,this.releaseResource();var a=c._loadedResources.indexOf(this);a!==-1&&(c._loadedResources.splice(a,1),c._isLoadedResourcesSorted=!1),qa.clearRes(this.url)},d.startCreate=function(){this.event("recovering",this)},d.completeCreate=function(){this._released=!1,this.event("recovered",this)},g(0,d,"loaded",function(){return this._loaded}),g(0,d,"id",function(){return this._$1__id}),g(0,d,"url",function(){return this._url},function(a){this._url=a}),g(0,d,"name",function(){return this._name},function(a){!a&&""===a||this.name===a||(this._name=a,c._isLoadedResourcesSorted=!1)}),g(0,d,"disposed",function(){return this._disposed}),g(0,d,"released",function(){return this._released}),g(0,d,"resourceManager",function(){return this._resourceManager}),g(0,d,"lastUseFrameCount",function(){return this._lastUseFrameCount}),g(0,d,"memorySize",function(){return this._memorySize},function(a){var b=a-this._memorySize;this._memorySize=a,this.resourceManager&&this.resourceManager.addSize(b)}),g(1,c,"sortedLoadedResourcesByName",function(){return c._isLoadedResourcesSorted||(c._isLoadedResourcesSorted=!0,c._loadedResources.sort(c.compareResourcesByName)),c._loadedResources},laya.events.EventDispatcher._$SET_sortedLoadedResourcesByName),c.getLoadedResourceByIndex=function(a){return c._loadedResources[a]},c.getLoadedResourcesCount=function(){return c._loadedResources.length},c.compareResourcesByName=function(a,b){if(a===b)return 0;var c=a.name,d=b.name;if(null===c)return null===d?0:-1;if(null==d)return 1;var e=c.localeCompare(d);return 0!=e?e:(b.setUniqueName(d),d=b.name,c.localeCompare(d))},c._uniqueIDCounter=0,c._loadedResources=[],c._isLoadedResourcesSorted=!1,c}(l),wa=function(a){function c(a,b){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,c.__super.call(this),a&&a.useNum++,this.setTo(a,b)}f(c,"laya.resource.Texture",a);var d=c.prototype;return d.setTo=function(a,b){if(this.bitmap=a,this.uv=b||c.DEF_UV,a){this._w=a.width,this._h=a.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=this._w>0;var d=this;if(this._loaded)i.addToAtlas&&i.addToAtlas(d);else{var e=a;e instanceof laya.resource.HTMLImage&&e.image&&e.image.addEventListener("load",function(a){i.addToAtlas&&i.addToAtlas(d)},!1)}}},d.active=function(){this.bitmap.activeResource()},d.destroy=function(a){void 0===a&&(a=!1),this.bitmap&&this.bitmap.useNum>0&&(a?(this.bitmap.dispose(),this.bitmap.useNum=0):0==--this.bitmap.useNum&&this.bitmap.dispose(),this.bitmap=null,this.url&&this===b.loader.getRes(this.url)&&b.loader.clearRes(this.url,a),this._loaded=!1)},d.load=function(a){var b=this;this._loaded=!1;var c=this.bitmap||(this.bitmap=Na.create(I.formatURL(a)));c&&c.useNum++;var d=this;c.onload=function(){c.onload=null,d._loaded=!0,b.sourceWidth=b._w=c.width,b.sourceHeight=b._h=c.height,d.event("loaded",this),i.addToAtlas&&i.addToAtlas(d)}},d.addTextureToAtlas=function(a){i.addTextureToAtlas(this)},d.getPixels=function(a,b,c,d){return J.isWebGL?i.getTexturePixels(this,a,b,c,d):(Q.canvas.size(c,d),Q.canvas.clear(),Q.context.drawTexture(this,-a,-b,this.width,this.height,0,0),Q.context.getImageData(0,0,c,d).data)},d.onAsynLoaded=function(a,b){b&&b.useNum++,this.setTo(b,this.uv)},g(0,d,"source",function(){return this.bitmap.activeResource(),this.bitmap.source}),g(0,d,"loaded",function(){return this._loaded}),g(0,d,"released",function(){return this.bitmap.released}),g(0,d,"width",function(){return this._w?this._w:this.uv&&this.uv!==c.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(a){this._w=a,this.sourceWidth||(this.sourceWidth=a)}),g(0,d,"repeat",function(){return!J.isWebGL||!this.bitmap||this.bitmap.repeat},function(a){a&&J.isWebGL&&this.bitmap&&(this.bitmap.repeat=a,a&&(this.bitmap.enableMerageInAtlas=!1))}),g(0,d,"height",function(){return this._h?this._h:this.uv&&this.uv!==c.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(a){this._h=a,this.sourceHeight||(this.sourceHeight=a)}),g(0,d,"isLinearSampling",function(){return!J.isWebGL||9728!=this.bitmap.minFifter},function(a){!a&&J.isWebGL&&(a||this.bitmap.minFifter!=-1||this.bitmap.magFifter!=-1||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),c.moveUV=function(a,b,c){for(var d=0;d<8;d+=2)c[d]+=a,c[d+1]+=b;return c},c.create=function(a,b,d,e,f,g,h,i,j){void 0===g&&(g=0),void 0===h&&(h=0),void 0===i&&(i=0),void 0===j&&(j=0);var k=a instanceof laya.resource.Texture,l=k?a.uv:c.DEF_UV,m=k?a.bitmap:a,n=new c(m,null);m.width&&b+e>m.width&&(e=m.width-b),m.height&&d+f>m.height&&(f=m.height-d),n.width=e,n.height=f,n.offsetX=g,n.offsetY=h,n.sourceWidth=i||e,n.sourceHeight=j||f;var o=1/m.width,p=1/m.height;b*=o,d*=p,e*=o,f*=p;var q=n.uv[0],r=n.uv[1],s=n.uv[4],t=n.uv[5],u=s-q,v=t-r,w=c.moveUV(l[0],l[1],[b,d,b+e,d,b+e,d+f,b,d+f]);return n.uv=[q+w[0]*u,r+w[1]*v,s-(1-w[2])*u,r+w[3]*v,s-(1-w[4])*u,t-(1-w[5])*v,q+w[6]*u,t-(1-w[7])*v],n},c.createFromTexture=function(a,b,d,e,f){var g=F.TEMP.setTo(b-a.offsetX,d-a.offsetY,e,f),h=g.intersection(c._rect1.setTo(0,0,a.width,a.height),c._rect2);if(!h)return null;var i=c.create(a,h.x,h.y,h.width,h.height,h.x-g.x,h.y-g.y,e,f);return i.bitmap.useNum--,i},c.DEF_UV=[0,0,1,0,1,1,0,1],c.INV_UV=[0,1,1,1,1,0,0,0],c._rect1=new F,c._rect2=new F,c}(l),xa=function(a){function c(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,c.__super.call(this)}var d;f(c,"laya.utils.TimeLine",a);var e=c.prototype;return e.to=function(a,b,c,d,e){return void 0===e&&(e=0),this._create(a,b,c,d,e,!0)},e.from=function(a,b,c,d,e){return void 0===e&&(e=0),this._create(a,b,c,d,e,!1)},e._create=function(a,b,c,e,f,g){var h=new d;return h.isTo=g,h.type=0,h.target=a,h.duration=c,h.data=b,h.startTime=this._startTime+f,h.endTime=h.startTime+h.duration,h.ease=e,this._startTime=Math.max(h.endTime,this._startTime),this._tweenDataList.push(h),this._startTimeSort=!0,this._endTimeSort=!0,this},e.addLabel=function(a,b){var c=new d;return c.type=1,c.data=a,c.endTime=c.startTime=this._startTime+b,this._labelDic||(this._labelDic={}),this._labelDic[a]=c,this._tweenDataList.push(c),this},e.removeLabel=function(a){if(this._labelDic&&this._labelDic[a]){var b=this._labelDic[a];if(b){var c=this._tweenDataList.indexOf(b);c>-1&&this._tweenDataList.splice(c,1)}delete this._labelDic[a]}},e.gotoTime=function(a){function b(a,b){return a.endTime>b.endTime?1:a.endTime<b.endTime?-1:0}if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var c,d;for(var e in this._firstTweenDic)if(d=this._firstTweenDic[e])for(var f in d)d.diyTarget.hasOwnProperty(f)&&(d.diyTarget[f]=d[f]);for(e in this._tweenDic)c=this._tweenDic[e],c.clear(),delete this._tweenDic[e];this._index=0,this._gidIndex=0,this._currTime=a,this._lastTime=Q.now();var g;null==this._endTweenDataList||this._endTimeSort?(this._endTimeSort=!1,this._endTweenDataList=g=this._tweenDataList.concat(),g.sort(b)):g=this._endTweenDataList;for(var h,i=0,j=g.length;i<j;i++)if(h=g[i],0==h.type){if(!(a>=h.endTime))break;this._index=Math.max(this._index,i+1);var k=h.data;for(var l in k)h.isTo&&(h.target[l]=k[l])}for(i=0,j=this._tweenDataList.length;i<j;i++)h=this._tweenDataList[i],0==h.type&&a>=h.startTime&&a<h.endTime&&(this._index=Math.max(this._index,i+1),this._gidIndex++,c=aa.getItemByClass("tween",fa),c._create(h.target,h.data,h.duration,h.ease,m.create(this,this._animComplete,[this._gidIndex]),0,!1,h.isTo,!0,!1),c.setStartTime(this._currTime-(a-h.startTime)),c._updateEase(this._currTime),c.gid=this._gidIndex,this._tweenDic[this._gidIndex]=c)}},e.gotoLabel=function(a){if(null!=this._labelDic){var b=this._labelDic[a];b&&this.gotoTime(b.startTime)}},e.pause=function(){b.timer.clear(this,this._update)},e.resume=function(){this.play(this._currTime,this._loopKey)},e.play=function(a,c){function d(a,b){return a.startTime>b.startTime?1:a.startTime<b.startTime?-1:0}if(void 0===a&&(a=0),void 0===c&&(c=!1),this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(d);for(var e=0,f=this._tweenDataList.length;e<f;e++){var g=this._tweenDataList[e];if(null!=g&&0==g.type){var h=g.target,i=h.$_GID||(h.$_GID=ga.getGID()),j=null;null==this._firstTweenDic[i]?(j={},j.diyTarget=h,this._firstTweenDic[i]=j):j=this._firstTweenDic[i];for(var k in g.data)null==j[k]&&(j[k]=h[k])}}}"string"==typeof a?this.gotoLabel(a):this.gotoTime(a),this._loopKey=c,this._lastTime=Q.now(),b.timer.frameLoop(1,this,this._update)},e._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var a in this._tweenDic)e=this._tweenDic[a],e.complete();return this._complete(),void this.pause()}this._complete(),this.gotoTime(0)}var b=Q.now(),c=b-this._lastTime,d=this._currTime+=c*this.scale;this._lastTime=b;var e;if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var f=this._tweenDataList[this._index];d>=f.startTime&&(this._index++,0==f.type?(this._gidIndex++,e=aa.getItemByClass("tween",fa),e._create(f.target,f.data,f.duration,f.ease,new m(this,this._animComplete,[this._gidIndex]),0,!1,f.isTo,!0,!1),e.setStartTime(d),e.gid=this._gidIndex,this._tweenDic[this._gidIndex]=e):this.event("label",f.data))}for(a in this._tweenDic)e=this._tweenDic[a],e._updateEase(d)},e._animComplete=function(a){this._tweenDic[a]&&delete this._tweenDic[a]},e._complete=function(){this.event("complete")},e.reset=function(){var a;if(this._labelDic)for(a in this._labelDic)delete this._labelDic[a];var c;for(a in this._tweenDic)c=this._tweenDic[a],c.clear(),delete this._tweenDic[a];for(a in this._firstTweenDic)delete this._firstTweenDic[a];this._endTweenDataList=null,this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,b.timer.clear(this,this._update)},e.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},g(0,e,"index",function(){return this._frameIndex},function(a){this._frameIndex=a,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),g(0,e,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),c.to=function(a,b,d,e,f){return void 0===f&&(f=0),(new c).to(a,b,d,e,f)},c.from=function(a,b,d,e,f){return void 0===f&&(f=0),(new c).from(a,b,d,e,f)},c.__init$=function(){d=function(){function a(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return f(a,""),a}()},c}(l),ya=function(a){function c(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,c.__super.call(this),this._style=o.EMPTY}f(c,"laya.display.Sprite",a);var d=c.prototype;return b.imps(d,{"laya.display.ILayout":!0}),d.createConchModel=function(){return new ConchNode},d.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._style&&this._style.destroy(),this._transform=null,this._style=null,this._graphics=null},d.updateZOrder=function(){ga.updateOrder(this._childs)&&this.repaint()},d.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0)},d.setBounds=function(a){this._set$P("uBounds",a)},d.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new F),F._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},d.getSelfBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new F),F._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds)},d._boundPointsToParent=function(a){void 0===a&&(a=!1);var b=0,c=0;this._style&&(b=this._style._tf.translateX,c=this._style._tf.translateY,a=a||0!==this._style._tf.rotate,this._style.scrollRect&&(b+=this._style.scrollRect.x,c+=this._style.scrollRect.y));var d=this._getBoundPointsM(a);if(!d||d.length<1)return d;if(8!=d.length&&(d=a?B.scanPList(d):F._getWrapRec(d,F.TEMP)._getBoundPoints()),!this.transform)return ga.transPointList(d,this.x-b,this.y-c),d;var e=E.TEMP,f=0,g=d.length;for(f=0;f<g;f+=2)e.x=d[f],e.y=d[f+1],this.toParentPoint(e),d[f]=e.x,d[f+1]=e.y;return d},d.getGraphicBounds=function(){return this._graphics?this._graphics.getBounds():F.TEMP.setTo(0,0,0,0)},d._getBoundPointsM=function(a){if(void 0===a&&(a=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var b=ga.clearArray(this._$P.temBM),c=F.TEMP;return c.copyFrom(this.scrollRect),ga.concatArray(b,c._getBoundPoints()),b}var d,e,f,g=this._graphics?this._graphics.getBoundPoints():ga.clearArray(this._$P.temBM);f=this._childs;for(var h=0,i=f.length;h<i;h++)(d=f[h])instanceof laya.display.Sprite&&1==d.visible&&(e=d._boundPointsToParent(a))&&(g=g?ga.concatArray(g,e):e);return g},d.getStyle=function(){return this._style===o.EMPTY&&(this._style=new o),this._style},d.setStyle=function(a){this._style=a},d._adjustTransform=function(){"use strict";this._tfChanged=!1;var a,b=this._style,c=b._tf,d=c.scaleX,e=c.scaleY;if(c.rotate||1!==d||1!==e||c.skewX||c.skewY){a=this._transform||(this._transform=D.create()),a.bTransform=!0;var f=.0174532922222222*(c.rotate-c.skewX),g=.0174532922222222*(c.rotate+c.skewY),h=Math.cos(g),i=Math.sin(g),j=Math.sin(f),k=Math.cos(f);return a.a=d*h,a.b=d*i,a.c=-e*j,a.d=e*k,a.tx=a.ty=0,a}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,a},d.pos=function(a,b,c){if(void 0===c&&(c=!1),this._x!==a||this._y!==b){if(this.destroyed)return this;if(c){this._x=a,this._y=b,this.conchModel&&this.conchModel.pos(this._x,this._y);var d=this._parent;d&&0===d._repaint&&(d._repaint=1,d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=a,this.y=b}return this},d.pivot=function(a,b){return this.pivotX=a,this.pivotY=b,this},d.size=function(a,b){return this.width=a,this.height=b,this},d.scale=function(a,b,c){void 0===c&&(c=!1);var d=this.getStyle(),e=d._tf;if(e.scaleX!=a||e.scaleY!=b){if(this.destroyed)return this;if(c){d.setScale(a,b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(a,b),this._renderType|=4;var f=this._parent;f&&0===f._repaint&&(f._repaint=1,f.parentRepaint())}else this.scaleX=a,this.scaleY=b}return this},d.skew=function(a,b){return this.skewX=a,this.skewY=b,this},d.render=function(a,b,c){ca.spriteCount++,L.renders[this._renderType]._fun(this,a,b+this._x,c+this._y),this._repaint=0},d.drawToCanvas=function(a,b,c,d){return i.drawToCanvas(this,this._renderType,a,b,c,d)},d.customRender=function(a,b,c){this._renderType|=1024},d._applyFilters=function(){if(!J.isWebGL){var a;if((a=this._$P.filters)&&!(a.length<1))for(var b=0,c=a.length;b<c;b++)a[b].action.apply(this._$P.cacheCanvas)}},d._isHaveGlowFilter=function(){var a=0,b=0;if(this.filters)for(a=0;a<this.filters.length;a++)if(8==this.filters[a].type)return!0;for(a=0,b=this._childs.length;a<b;a++)if(this._childs[a]._isHaveGlowFilter())return!0;return!1},d.localToGlobal=function(a,c){if(void 0===c&&(c=!1),!this._displayedInStage||!a)return a;c===!0&&(a=new E(a.x,a.y));for(var d=this;d&&d!=b.stage;)a=d.toParentPoint(a),d=d.parent;return a},d.globalToLocal=function(a,c){if(void 0===c&&(c=!1),!this._displayedInStage||!a)return a;c&&(a=new E(a.x,a.y));for(var d=this,e=[];d&&d!=b.stage;)e.push(d),d=d.parent;for(var f=e.length-1;f>=0;)d=e[f],a=d.fromParentPoint(a),f--;return a},d.toParentPoint=function(a){if(!a)return a;a.x-=this.pivotX,a.y-=this.pivotY,this.transform&&this._transform.transformPoint(a),a.x+=this._x,a.y+=this._y;var b=this._style.scrollRect;return b&&(a.x-=b.x,a.y-=b.y),a},d.fromParentPoint=function(a){if(!a)return a;a.x-=this._x,a.y-=this._y;var b=this._style.scrollRect;return b&&(a.x+=b.x,a.y+=b.y),this.transform&&this._transform.invertTransformPoint(a),a.x+=this.pivotX,a.y+=this.pivotY,a},d.on=function(a,b,c,d){return 1!==this._mouseEnableState&&this.isMouseEvent(a)&&(this._displayedInStage?this._$2__onDisplay():laya.events.EventDispatcher.prototype.once.call(this,"display",this,this._$2__onDisplay)),laya.events.EventDispatcher.prototype.on.call(this,a,b,c,d)},d.once=function(a,b,c,d){return 1!==this._mouseEnableState&&this.isMouseEvent(a)&&(this._displayedInStage?this._$2__onDisplay():laya.events.EventDispatcher.prototype.once.call(this,"display",this,this._$2__onDisplay)),laya.events.EventDispatcher.prototype.once.call(this,a,b,c,d)},d._$2__onDisplay=function(){if(1!==this._mouseEnableState)for(var a=this;a&&1!==a._mouseEnableState;)a.mouseEnabled=!0,a=a.parent},d.loadImage=function(a,b,c,d,e,f){function g(a){h.destroyed||(h.size(b+(d||a.width),c+(e||a.height)),h.repaint(),f&&f.runWith(a))}var h=this;return void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),this.graphics.loadImage(a,b,c,d,e,g),this},d.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},d._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},d._childChanged=function(a){this._childs.length?this._renderType|=2048:this._renderType&=-2049,a&&this._get$P("hasZorder")&&b.timer.callLater(this,this.updateZOrder),this.repaint()},d.parentRepaint=function(){var a=this._parent;a&&0===a._repaint&&(a._repaint=1,a.parentRepaint())},d.startDrag=function(a,b,c,d,e,f,g){void 0===b&&(b=!1),void 0===c&&(c=0),void 0===d&&(d=300),void 0===f&&(f=!1),void 0===g&&(g=.92),this._$P.dragging||this._set$P("dragging",new W),this._$P.dragging.start(this,a,b,c,d,e,f,g)},d.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},d._setDisplay=function(b){if(!b&&this._$P.cacheCanvas&&this._$P.cacheCanvas.ctx&&(aa.recover("RenderContext",this._$P.cacheCanvas.ctx),this._$P.cacheCanvas.ctx.canvas.size(0,0),this._$P.cacheCanvas.ctx=null),!b){var c=this._$P._filterCache;c&&(c.destroy(),c.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1)}a.prototype._setDisplay.call(this,b)},d.hitTestPoint=function(a,b){var c=this.globalToLocal(E.TEMP.setTo(a,b));return(this._$P.hitArea?this._$P.hitArea:F.TEMP.setTo(0,0,this._width,this._height)).contains(c.x,c.y)},d.getMousePoint=function(){return this.globalToLocal(E.TEMP.setTo(b.stage.mouseX,b.stage.mouseY))},d._getWords=function(){return null},d._addChildsToLayout=function(a){var b=this._getWords();if(null==b&&0==this._childs.length)return!1;if(b)for(var c=0,d=b.length;c<d;c++)a.push(b[c]);return this._childs.forEach(function(b,c,d){b._style._enableLayout()&&b._addToLayout(a)}),!0},d._addToLayout=function(a){this._style.absolute||(this._style.block?a.push(this):this._addChildsToLayout(a)&&(this.x=this.y=0))},d._isChar=function(){return!1},d._getCSSStyle=function(){return this._style.getCSSStyle()},d._setAttributes=function(a,b){switch(a){case"x":this.x=parseFloat(b);break;case"y":this.y=parseFloat(b);break;case"width":this.width=parseFloat(b);break;case"height":this.height=parseFloat(b);break;default:this[a]=b}},d._layoutLater=function(){this.parent&&this.parent._layoutLater()},g(0,d,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(a){this._optimizeScrollRect!=a&&(this._optimizeScrollRect=a,this.conchModel&&this.conchModel.optimizeScrollRect(a))}),g(0,d,"customRenderEnable",null,function(a){if(a&&(this._renderType|=1024,J.isConchNode)){c.CustomList.push(this);var b=new Ia("2d");b._setContext(new CanvasRenderingContext2D),this.customContext=new K(0,0,b),b.context.setCanvasType&&b.context.setCanvasType(2),this.conchModel.custom(b.context)}}),g(0,d,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(a){this.cacheAs=a?this._$P.hasFilter?"none":"normal":"none"}),
g(0,d,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(a){var b=this._$P.cacheCanvas;a!==(b?b.type:"none")&&("none"!==a?(b||(b=this._set$P("cacheCanvas",aa.getItemByClass("cacheCanvas",Object))),b.type=a,b.reCache=!0,this._renderType|=16,"bitmap"==a&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1)):this._$P.hasFilter?this._set$P("cacheForFilters",!0):(b&&aa.recover("cacheCanvas",b),this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)),this.repaint())}),g(0,d,"zOrder",function(){return this._zOrder},function(a){this._zOrder!=a&&(this._zOrder=a,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(a),this._parent&&(a&&this._parent._set$P("hasZorder",!0),b.timer.callLater(this._parent,this.updateZOrder)))}),g(0,d,"rotation",function(){return this._style._tf.rotate},function(a){var b=this.getStyle();if(b._tf.rotate!==a){b.setRotate(a),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(a),this._renderType|=4;var c=this._parent;c&&0===c._repaint&&(c._repaint=1,c.parentRepaint())}}),g(0,d,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(a){this._width!==a&&(this._width=a,this.conchModel&&this.conchModel.size(a,this._height),this.repaint())}),g(0,d,"x",function(){return this._x},function(a){if(this._x!==a){if(this.destroyed)return;this._x=a,this.conchModel&&this.conchModel.pos(a,this._y);var b=this._parent;b&&0===b._repaint&&(b._repaint=1,b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),g(0,d,"globalScaleY",function(){for(var a=1,c=this;c&&c!==b.stage;)a*=c.scaleX,c=c.parent;return a}),g(0,d,"hitArea",function(){return this._$P.hitArea},function(a){this._set$P("hitArea",a)}),g(0,d,"staticCache",function(){return this._$P.staticCache},function(a){this._set$P("staticCache",a),!a&&this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0)}),g(0,d,"texture",function(){return this._texture},function(a){this._texture!=a&&(this._texture=a,this.graphics.cleanByTexture(a,0,0))}),g(0,d,"y",function(){return this._y},function(a){if(this._y!==a){if(this.destroyed)return;this._y=a,this.conchModel&&this.conchModel.pos(this._x,a);var b=this._parent;b&&0===b._repaint&&(b._repaint=1,b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),g(0,d,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(a){this._height!==a&&(this._height=a,this.conchModel&&this.conchModel.size(this._width,a),this.repaint())}),g(0,d,"blendMode",function(){return this._style.blendMode},function(a){this.getStyle().blendMode=a,this.conchModel&&this.conchModel.blendMode(a),a&&"source-over"!=a?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),g(0,d,"scaleX",function(){return this._style._tf.scaleX},function(a){var b=this.getStyle();if(b._tf.scaleX!==a){b.setScaleX(a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(a,b._tf.scaleY),this._renderType|=4;var c=this._parent;c&&0===c._repaint&&(c._repaint=1,c.parentRepaint())}}),g(0,d,"scaleY",function(){return this._style._tf.scaleY},function(a){var b=this.getStyle();if(b._tf.scaleY!==a){b.setScaleY(a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(b._tf.scaleX,a),this._renderType|=4;var c=this._parent;c&&0===c._repaint&&(c._repaint=1,c.parentRepaint())}}),g(0,d,"stage",function(){return b.stage}),g(0,d,"skewX",function(){return this._style._tf.skewX},function(a){var b=this.getStyle();if(b._tf.skewX!==a){b.setSkewX(a),this._tfChanged=!0,this._renderType|=4;var c=this._parent;c&&0===c._repaint&&(c._repaint=1,c.parentRepaint())}}),g(0,d,"scrollRect",function(){return this._style.scrollRect},function(a){this.getStyle().scrollRect=a,this.repaint(),a?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(a.x,a.y,a.width,a.height)):(this._renderType&=-129,this.conchModel&&(c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),g(0,d,"skewY",function(){return this._style._tf.skewY},function(a){var b=this.getStyle();if(b._tf.skewY!==a){b.setSkewY(a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(b._tf.skewX,a),this._renderType|=4;var c=this._parent;c&&0===c._repaint&&(c._repaint=1,c.parentRepaint())}}),g(0,d,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(a){this._tfChanged=!1,this._transform=a,a&&(this._x=a.tx,this._y=a.ty,a.tx=a.ty=0,this.conchModel&&this.conchModel.transform(a.a,a.b,a.c,a.d,this._x,this._y)),a?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),g(0,d,"pivotX",function(){return this._style._tf.translateX},function(a){this.getStyle().setTranslateX(a),this.conchModel&&this.conchModel.pivot(a,this._style._tf.translateY),this.repaint()}),g(0,d,"pivotY",function(){return this._style._tf.translateY},function(a){this.getStyle().setTranslateY(a),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,a),this.repaint()}),g(0,d,"alpha",function(){return this._style.alpha},function(a){this._style&&this._style.alpha!==a&&(a=a<0?0:a>1?1:a,this.getStyle().alpha=a,this.conchModel&&this.conchModel.alpha(a),1!==a?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),g(0,d,"visible",function(){return this._style.visible},function(a){this._style&&this._style.visible!==a&&(this.getStyle().visible=a,this.conchModel&&this.conchModel.visible(a),this.parentRepaint())}),g(0,d,"graphics",function(){return this._graphics||(this.graphics=i.createGraphics())},function(a){this._graphics&&(this._graphics._sp=null),this._graphics=a,a?(this._renderType&=-2,this._renderType|=512,a._sp=this,this.conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),g(0,d,"filters",function(){return this._$P.filters},function(a){a&&0===a.length&&(a=null),this._$P.filters!=a&&(this._set$P("filters",a?a.slice():null),J.isConchApp&&(this.conchModel&&(c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),J.isWebGL&&(a&&a.length?this._renderType|=32:this._renderType&=-33),a&&a.length>0?J.isWebGL&&1==a.length&&a[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(J.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0)):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),g(0,d,"mask",function(){return this._$P._mask},function(a){a&&this.mask&&this.mask._$P.maskParent||(a?(this.cacheAs="bitmap",this._set$P("_mask",a),a._set$P("maskParent",this)):(this.cacheAs="none",this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",a)),this.conchModel&&this.conchModel.mask(a?a.conchModel:null),this._renderType|=64,this.parentRepaint())}),g(0,d,"mouseEnabled",function(){return this._mouseEnableState>1},function(a){this._mouseEnableState=a?2:1}),g(0,d,"globalScaleX",function(){for(var a=1,c=this;c&&c!==b.stage;)a*=c.scaleX,c=c.parent;return a}),g(0,d,"mouseX",function(){return this.getMousePoint().x}),g(0,d,"mouseY",function(){return this.getMousePoint().y}),c.fromImage=function(a){return(new c).loadImage(a)},c.CustomList=[],e(c,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=window.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),c}(ja),za=function(a){function c(a){this._audio=null,this._onEnd=null,this._resumePlay=null,c.__super.call(this),this._onEnd=ga.bind(this.__onEnd,this),this._resumePlay=ga.bind(this.__resumePlay,this),a.addEventListener("ended",this._onEnd),this._audio=a}f(c,"laya.media.h5audio.AudioSoundChannel",a);var d=c.prototype;return d.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(b.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");this.loops>0&&this.loops--,this.play()},d.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,Q.container.appendChild(this._audio),this._audio.play()}catch(a){this.event("error")}},d.play=function(){try{this._audio.playbackRate=G.playbackRate,this._audio.currentTime=this.startTime}catch(a){return void this._audio.addEventListener("canplay",this._resumePlay)}Q.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()},d.stop=function(){this.isStopped=!0,G.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),aa.recover("audio:"+this.url,this._audio),Q.removeElement(this._audio),this._audio=null)},g(0,d,"position",function(){return this._audio?this._audio.currentTime:0}),g(0,d,"duration",function(){return this._audio?this._audio.duration:0}),g(0,d,"volume",function(){return this._audio?this._audio.volume:1},function(a){this._audio&&(this._audio.volume=a)}),c}(ma),Aa=function(a){function c(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._onPlayEnd=null,this.context=oa.ctx,c.__super.call(this),this._onPlayEnd=ga.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}f(c,"laya.media.webaudio.WebAudioSoundChannel",a);var d=c.prototype;return d.play=function(){if(this._clearBufferSource(),this.audioBuffer){var a=this.context,b=this.gain,c=a.createBufferSource();this.bufferSource=c,c.buffer=this.audioBuffer,c.connect(b),b&&b.disconnect(),b.connect(a.destination),c.onended=this._onPlayEnd,this._startTime=Q.now(),this.gain.gain.value=this._volume,0==this.loops&&(c.loop=!0),c.playbackRate.value=G.playbackRate,c.start(0,this.startTime),this._currentTime=0}},d.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(b.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");this.loops>0&&this.loops--,this.play()},d._clearBufferSource=function(){if(this.bufferSource){var a=this.bufferSource;a.stop?a.stop(0):a.noteOff(0),a.disconnect(0),a.onended=null,c._tryCleanFailed||this._tryClearBuffer(a),this.bufferSource=null}},d._tryClearBuffer=function(a){try{a.buffer=oa._miniBuffer}catch(a){c._tryCleanFailed=!0}},d.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,G.removeChannel(this),this.completeHandler=null},g(0,d,"position",function(){return this.bufferSource?(Q.now()-this._startTime)/1e3+this.startTime:0}),g(0,d,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),g(0,d,"volume",function(){return this._volume},function(a){this.isStopped||(this._volume=a,this.gain.gain.value=a)}),c._tryCleanFailed=!1,c}(ma),Ba=function(a){function b(){this.useNum=0,b.__super.call(this),this._w=0,this._h=0}f(b,"laya.resource.Bitmap",a);var c=b.prototype;return c.dispose=function(){this._resourceManager.removeResource(this),a.prototype.dispose.call(this)},g(0,c,"width",function(){return this._w}),g(0,c,"height",function(){return this._h}),g(0,c,"source",function(){return this._source}),b}(va),Ca=function(a){function b(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,b.__super.call(this),this._interval=k.animationInterval}f(b,"laya.display.AnimationPlayerBase",a);var c=b.prototype;return c.play=function(a,b,c){void 0===a&&(a=0),void 0===b&&(b=!0),void 0===c&&(c=""),this._isPlaying=!0,this.index="string"==typeof a?this._getFrameByLabel(a):a,this.loop=b,this._actionName=c,this._isReverse=1==this.wrapMode,this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0)},c._getFrameByLabel=function(a){var b=0;for(b=0;b<this._count;b++)if(this._labels[b]==a)return b;return 0},c._frameLoop=function(){if(this._isReverse){if(--this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=this._count>0?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(++this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=this._count-2>=0?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},c._setControlNode=function(a){this._controlNode&&(this._controlNode.off("display",this,this._$3__onDisplay),this._controlNode.off("undisplay",this,this._$3__onDisplay)),this._controlNode=a,a&&a!=this&&(a.on("display",this,this._$3__onDisplay),a.on("undisplay",this,this._$3__onDisplay))},c._setDisplay=function(b){a.prototype._setDisplay.call(this,b),this._$3__onDisplay()},c._$3__onDisplay=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},c.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},c.addLabel=function(a,b){this._labels||(this._labels={}),this._labels[b]=a},c.removeLabel=function(a){if(a){if(this._labels)for(var b in this._labels)if(this._labels[b]===a){delete this._labels[b];break}}else this._labels=null},c.gotoAndStop=function(a){this.index="string"==typeof a?this._getFrameByLabel(a):a,this.stop()},c._displayToIndex=function(a){},c.clear=function(){this.stop(),this._labels=null},g(0,c,"interval",function(){return this._interval},function(a){this._interval!=a&&(this._frameRateChanged=!0,this._interval=a,this._isPlaying&&a>0&&this.timerLoop(a,this,this._frameLoop,null,!0))}),g(0,c,"isPlaying",function(){return this._isPlaying}),g(0,c,"index",function(){return this._index},function(a){this._index=a,this._displayToIndex(a),this._labels&&this._labels[a]&&this.event("label",this._labels[a])}),g(0,c,"count",function(){return this._count}),b}(ya),Da=function(a){function c(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,c.__super.call(this),this.overflow=c.VISIBLE,this._style=new ka(this),this._style.wordWrap=!1}f(c,"laya.display.Text",a);var d=c.prototype;return d.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._lines=null,this._words&&(this._words.length=0,this._words=null)},d._getBoundPointsM=function(a){void 0===a&&(a=!1);var b=F.TEMP;return b.setTo(0,0,this.width,this.height),b._getBoundPoints()},d.getGraphicBounds=function(){var a=F.TEMP;return a.setTo(0,0,this.width,this.height),a},d._getCSSStyle=function(){return this._style},d.lang=function(a,b,d,e,f,g,h,i,j,k,l){if(a=c.langPacks&&c.langPacks[a]?c.langPacks[a]:a,arguments.length<2)this._text=a;else{for(var m=0,n=arguments.length;m<n;m++)a=a.replace("{"+m+"}",arguments[m+1]);this._text=a}},d.renderText=function(a,b){var c=this.graphics;c.clear();var d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;Q.context.font=d;var e=this.padding,f=e[3],g="left",h=this._lines,i=this.leading+this._charSize.height,j=this._currBitmapFont;j&&(i=this.leading+j.getMaxHeight());var k=e[0];if(!j&&this._width>0&&this._textWidth<=this._width&&("right"==this.align?(g="right",f=this._width-e[1]):"center"==this.align&&(g="center",f=.5*this._width+e[3]-e[1])),this._height>0){var l=this._textHeight>this._height?"top":this.valign;"middle"===l?k=.5*(this._height-b*i)+e[0]-e[2]:"bottom"===l&&(k=this._height-b*i-e[2])}var m=this._style;if(j&&j.autoScaleSize)var n=j.fontSize/this.fontSize;if(this._clipPoint)if(c.save(),j&&j.autoScaleSize){var o=0,p=0;o=this._width?this._width-e[3]-e[1]:this._textWidth,p=this._height?this._height-e[0]-e[2]:this._textHeight,o*=n,p*=n,c.clipRect(e[3],e[0],o,p)}else c.clipRect(e[3],e[0],this._width?this._width-e[3]-e[1]:this._textWidth,this._height?this._height-e[0]-e[2]:this._textHeight);var q=m.password;"prompt"in this&&this.prompt==this._text&&(q=!1);for(var r=0,s=0,t=Math.min(this._lines.length,b+a)||1,u=a;u<t;u++){var v,w=h[u];if(q){var x=w.length;w="";for(var y=x;y>0;y--)w+="●"}if(r=f-(this._clipPoint?this._clipPoint.x:0),s=k+i*u-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(g,r,s,u),j){var z=this.width;j.autoScaleSize&&(z=this.width*n),j.drawText(w,this,r,s,this.align,z)}else J.isWebGL?(this._words||(this._words=[]),v=this._words.length>u-a?this._words[u-a]:new ia,v.setText(w)):v=w,m.stroke?c.fillBorderText(v,r,s,d,this.color,m.strokeColor,m.stroke,g):c.fillText(v,r,s,d,this.color,g)}if(j&&j.autoScaleSize){var A=1/n;this.scale(A,A)}this._clipPoint&&c.restore(),this._startX=f,this._startY=k},d.drawUnderline=function(a,b,c,d){var e=this._lineWidths[d];switch(a){case"center":b-=e/2;break;case"right":b-=e;break;case"left":}c+=this._charSize.height,this._graphics.drawLine(b,c,b+e,c,this.underlineColor||this.color,1)},d.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear();Q.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new E(0,0)):this._clipPoint=null;var a=this._lines.length;if(this.overflow!=c.VISIBLE){var b=this.overflow==c.HIDDEN?Math.floor:Math.ceil;a=Math.min(a,b((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var d=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(d,a),this.repaint()},d.evalTextSize=function(){var a=NaN,b=NaN;a=Math.max.apply(this,this._lineWidths),b=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],a==this._textWidth&&b==this._textHeight||(this._textWidth=a,this._textHeight=b,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},d.checkEnabledViewportOrNot=function(){return this.overflow==c.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)},d.changeText=function(a){this._text!==a&&(this.lang(a+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},d.parseLines=function(a){var b=this.wordWrap||this.overflow==c.HIDDEN;if(b)var d=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var e=Q.context.measureText(c._testWord);this._charSize.width=e.width,this._charSize.height=e.height||this.fontSize}for(var f=a.replace(/\r\n/g,"\n").split("\n"),g=0,h=f.length;g<h;g++){var i=f[g];b?this.parseLine(i,d):(this._lineWidths.push(this.getTextWidth(i)),this._lines.push(i))}},d.parseLine=function(a,b){var d,e=(Q.context,this._lines),f=0,g=NaN,h=NaN,i=0;if((g=this.getTextWidth(a))<=b)return e.push(a),void this._lineWidths.push(g);g=this._charSize.width,f=Math.floor(b/g),0==f&&(f=1),g=this.getTextWidth(a.substring(0,f)),h=g;for(var j=f,k=a.length;j<k;j++)if(g=this.getTextWidth(a.charAt(j)),(h+=g)>b)if(this.wordWrap){var l=a.substring(i,j);if(l.charCodeAt(l.length-1)<255&&(d=/[^\x20-]+$/.exec(l))&&(j=d.index+i,0==d.index?j+=l.length:l=a.substring(i,j)),e.push(l),this._lineWidths.push(h-g),i=j,!(j+f<k)){e.push(a.substring(i,k)),this._lineWidths.push(this.getTextWidth(e[e.length-1])),i=-1;break}j+=f,g=this.getTextWidth(a.substring(i,j)),h=g,j--}else if(this.overflow==c.HIDDEN)return e.push(a.substring(0,j)),void this._lineWidths.push(this.getTextWidth(e[e.length-1]));this.wordWrap&&i!=-1&&(e.push(a.substring(i,k)),this._lineWidths.push(this.getTextWidth(e[e.length-1])))},d.getTextWidth=function(a){return this._currBitmapFont?this._currBitmapFont.getTextWidth(a):Q.context.measureText(a).width},d.getWordWrapWidth=function(){var a=this.padding,b=NaN;return b=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width,b<=0&&(b=this.wordWrap?100:Q.width),b<=0&&(b=100),b-a[3]-a[1]},d.getCharPoint=function(a,c){this._isChanged&&b.timer.runCallLater(this,this.typeset);for(var d=0,e=this._lines,f=0,g=0,h=e.length;g<h;g++){if(d+=e[g].length,a<d){var i=g;break}f=d}var j=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;Q.context.font=j;var k=this.getTextWidth(this._text.substring(f,a));return(c||new E).setTo(this._startX+k-(this._clipPoint?this._clipPoint.x:0),this._startY+i*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},g(0,d,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(b){b!=this._width&&(a.prototype._$set_width.call(this,b),this.isChanged=!0)}),g(0,d,"textWidth",function(){return this._isChanged&&b.timer.runCallLater(this,this.typeset),this._textWidth}),g(0,d,"height",function(){return this._height?this._height:this.textHeight+this.padding[0]+this.padding[2]},function(b){b!=this._height&&(a.prototype._$set_height.call(this,b),this.isChanged=!0)}),g(0,d,"textHeight",function(){return this._isChanged&&b.timer.runCallLater(this,this.typeset),this._textHeight}),g(0,d,"padding",function(){return this._getCSSStyle().padding},function(a){this._getCSSStyle().padding=a,this.isChanged=!0}),g(0,d,"bold",function(){return this._getCSSStyle().bold},function(a){this._getCSSStyle().bold=a,this.isChanged=!0}),g(0,d,"text",function(){return this._text||""},function(a){this._text!==a&&(this.lang(a+""),this.isChanged=!0,this.event("change"))}),g(0,d,"color",function(){return this._getCSSStyle().color},function(a){this._getCSSStyle().color!=a&&(this._getCSSStyle().color=a,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),g(0,d,"font",function(){return this._getCSSStyle().fontFamily},function(a){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),c._bitmapFonts&&c._bitmapFonts[a]&&(this._currBitmapFont=c._bitmapFonts[a]),this._getCSSStyle().fontFamily=a,this.isChanged=!0}),g(0,d,"fontSize",function(){return this._getCSSStyle().fontSize},function(a){this._getCSSStyle().fontSize=a,this.isChanged=!0}),g(0,d,"italic",function(){return this._getCSSStyle().italic},function(a){this._getCSSStyle().italic=a,this.isChanged=!0}),g(0,d,"align",function(){return this._getCSSStyle().align},function(a){this._getCSSStyle().align=a,this.isChanged=!0}),g(0,d,"valign",function(){return this._getCSSStyle().valign},function(a){this._getCSSStyle().valign=a,this.isChanged=!0}),g(0,d,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(a){this._getCSSStyle().wordWrap=a,this.isChanged=!0}),g(0,d,"leading",function(){return this._getCSSStyle().leading},function(a){this._getCSSStyle().leading=a,this.isChanged=!0}),g(0,d,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(a){this._getCSSStyle().backgroundColor=a,this.isChanged=!0}),g(0,d,"borderColor",function(){return this._getCSSStyle().borderColor},function(a){this._getCSSStyle().borderColor=a,this.isChanged=!0}),g(0,d,"stroke",function(){return this._getCSSStyle().stroke},function(a){this._getCSSStyle().stroke=a,this.isChanged=!0}),g(0,d,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(a){this._getCSSStyle().strokeColor=a,this.isChanged=!0}),g(0,d,"isChanged",null,function(a){this._isChanged!==a&&(this._isChanged=a,a&&b.timer.callLater(this,this.typeset))}),g(0,d,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(a){if(!(this.overflow!=c.SCROLL||this.textWidth<this._width)&&this._clipPoint){a=a<this.padding[3]?this.padding[3]:a;var b=this._textWidth-this._width;a=a>b?b:a;var d=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=a,this.renderText(this._lastVisibleLineIndex,d)}}),g(0,d,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(a){if(!(this.overflow!=c.SCROLL||this.textHeight<this._height)&&this._clipPoint){a=a<this.padding[0]?this.padding[0]:a;var b=this._textHeight-this._height;a=a>b?b:a;var d=a/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=d;var e=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=a,this.renderText(d,e)}}),g(0,d,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),g(0,d,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),g(0,d,"lines",function(){return this._lines}),g(0,d,"underlineColor",function(){return this._underlineColor},function(a){this._underlineColor=a,this._isChanged=!0,this.typeset()}),c.registerBitmapFont=function(a,b){c._bitmapFonts||(c._bitmapFonts={}),c._bitmapFonts[a]=b},c.unregisterBitmapFont=function(a,b){if(void 0===b&&(b=!0),c._bitmapFonts&&c._bitmapFonts[a]){var d=c._bitmapFonts[a];b&&d.destroy(),delete c._bitmapFonts[a]}},c._testWord="游",c.langPacks=null,c.VISIBLE="visible",c.SCROLL="scroll",c.HIDDEN="hidden",c._bitmapFonts=null,c}(ya),Ea=function(a){function c(){function a(){"hidden"==Q.document[e]?(b._isVisibility=!1,d._isInputting()&&(Ma.inputElement.target.focus=!1)):b._isVisibility=!0,d.event("visibilitychange")}this.focus=null,this.frameRate="fast",this.desginWidth=0,this.desginHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._safariOffsetY=0,this._frameStartTime=NaN,this._previousOrientation=0,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this.v=null,c.__super.call(this),this.offset=new E,this._canvasTransform=new D;var b=this;this.transform=D.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var window=Q.window,d=this;window.addEventListener("focus",function(){b._isFocused=!0,d.event("focus"),d.event("focuschange")}),window.addEventListener("blur",function(){b._isFocused=!1,d.event("blur"),d.event("focuschange"),d._isInputting()&&(Ma.inputElement.target.focus=!1)});var e="visibilityState",f="visibilitychange",g=window.document;void 0!==g.hidden?(f="visibilitychange",e="visibilityState"):void 0!==g.mozHidden?(f="mozvisibilitychange",e="mozVisibilityState"):void 0!==g.msHidden?(f="msvisibilitychange",e="msVisibilityState"):void 0!==g.webkitHidden&&(f="webkitvisibilitychange",e="webkitVisibilityState"),window.document.addEventListener(f,a),window.addEventListener("resize",function(){var a=Q.window.orientation;null!=a&&a!=b._previousOrientation&&d._isInputting()&&(Ma.inputElement.target.focus=!1),b._previousOrientation=a,d._isInputting()||(Q.onSafari&&(d._safariOffsetY=(Q.window.__innerHeight||Q.document.body.clientHeight||Q.document.documentElement.clientHeight)-Q.window.innerHeight),d._resetCanvas())}),window.addEventListener("orientationchange",function(a){d._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),Q.onMobile&&this.on("mousedown",this,this._onmouseMove)}f(c,"laya.display.Stage",a);var d=c.prototype;return d._isInputting=function(){return Q.onMobile&&Ma.isInputting},d._changeCanvasSize=function(){this.setScreenSize(Q.clientWidth*Q.pixelRatio,Q.clientHeight*Q.pixelRatio)},d._resetCanvas=function(){var a=J._mainCanvas,c=a.source.style;a.size(1,1),c.transform=c.webkitTransform=c.msTransform=c.mozTransform=c.oTransform="",this.visible=!1,b.timer.once(100,this,this._changeCanvasSize)},d.setScreenSize=function(a,b){var c=!1;if("none"!==this._screenMode){if(c=(a/b<1?"vertical":"horizontal")!==this._screenMode){var d=b;b=a,a=d}}this.canvasRotation=c;var e=J._mainCanvas,f=e.source.style,g=this._canvasTransform.identity(),h=this._scaleMode,j=a/this.desginWidth,k=b/this.desginHeight,l=this.desginWidth,m=this.desginHeight,n=a,o=b,p=Q.pixelRatio;switch(this._width=this.desginWidth,this._height=this.desginHeight,h){case"noscale":j=k=1,n=this.desginWidth,o=this.desginHeight;break;case"showall":j=k=Math.min(j,k),l=n=Math.round(this.desginWidth*j),m=o=Math.round(this.desginHeight*k);break;case"noborder":j=k=Math.max(j,k),n=Math.round(this.desginWidth*j),o=Math.round(this.desginHeight*k);break;case"full":j=k=1,this._width=l=a,this._height=m=b;break;case"fixedwidth":k=j,this._height=b/j,m=Math.round(b/j);break;case"fixedheight":j=k,this._width=a/k,l=Math.round(a/k)}j*=this.scaleX,k*=this.scaleY,1===j&&1===k?this.transform.identity():(this.transform.a=this._formatData(j/(n/l)),this.transform.d=this._formatData(k/(o/m)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),e.size(l,m),i.changeWebGLSize(l,m),g.scale(n/l/p,o/m/p),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=a-n:this.offset.x=.5*(a-n)/p,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=b-o:this.offset.y=.5*(b-o)/p,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),g.translate(this.offset.x,this.offset.y),this._safariOffsetY&&g.translate(0,this._safariOffsetY),this.canvasDegree=0,c&&("horizontal"===this._screenMode?(g.rotate(Math.PI/2),g.translate(b/p,0),this.canvasDegree=90):(g.rotate(-Math.PI/2),g.translate(0,a/p),this.canvasDegree=-90)),g.a=this._formatData(g.a),g.d=this._formatData(g.d),g.tx=this._formatData(g.tx),g.ty=this._formatData(g.ty),f.transformOrigin=f.webkitTransformOrigin=f.msTransformOrigin=f.mozTransformOrigin=f.oTransformOrigin="0px 0px 0px",f.transform=f.webkitTransform=f.msTransform=f.mozTransform=f.oTransform="matrix("+g+")",this._safariOffsetY&&g.translate(0,-this._safariOffsetY),g.translate(parseInt(f.left)||0,parseInt(f.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},d._formatData=function(a){return Math.abs(a)<1e-6?0:Math.abs(1-a)<.001?a>0?1:-1:a},d.getMousePoint=function(){return E.TEMP.setTo(this.mouseX,this.mouseY)},d.repaint=function(){this._repaint=1},d.parentRepaint=function(){},d._loop=function(){return this.render(J.context,0,0),!0},d._onmouseMove=function(a){this._mouseMoveTime=Q.now()},d.getTimeFromFrameStart=function(){return Q.now()-this._frameStartTime},d.render=function(c,d,e){if("sleep"===this.frameRate){var f=Q.now();if(!(f-this._frameStartTime>=1e3))return;this._frameStartTime=f}if(this._renderCount++,J.isFlash&&this.repaint(),!this.visible)return void(this._renderCount%5==0&&(ca.loopCount++,w.instance.runEvent(),b.timer._update()));this._frameStartTime=Q.now();var g="mouse"===this.frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this.frameRate,h="slow"!==g,j=this._renderCount%2==0;if(ca.renderSlow=!h,h||j){ca.loopCount++,w.instance.runEvent(),b.timer._update();var k,l=0,m=0;if(J.isConchNode)for(l=0,m=this._scenes.length;l<m;l++)(k=this._scenes[l])&&k.$();else for(l=0,m=this._scenes.length;l<m;l++)(k=this._scenes[l])&&k._updateScene();if(J.isConchNode){var n=ya.CustomList;for(l=0,m=n.length;l<m;l++){var o=n[l];o.customRender(o.customContext,0,0)}return}J.isWebGL&&this.renderingEnabled&&(c.clear(),a.prototype.render.call(this,c,d,e))}J.isConchNode||!this.renderingEnabled||!h&&j||(J.isWebGL?(i.clear(this._bgColor),i.beginFlush(),c.flush(),i.endFinish(),
ha.instance&&ha.getInstance().endDispose()):(i.clear(this._bgColor),a.prototype.render.call(this,c,d,e)))},d._requestFullscreen=function(){var a=Q.document.documentElement;a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()},d._fullScreenChanged=function(){b.stage.event("fullscreenchange")},d.exitFullscreen=function(){var a=Q.document;a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitExitFullscreen&&a.webkitExitFullscreen()},g(0,d,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),g(0,d,"width",a.prototype._$get_width,function(c){this.desginWidth=c,a.prototype._$set_width.call(this,c),b.timer.callLater(this,this._changeCanvasSize)}),g(0,d,"isFocused",function(){return this._isFocused}),g(0,d,"alignH",function(){return this._alignH},function(a){this._alignH=a,b.timer.callLater(this,this._changeCanvasSize)}),g(0,d,"height",a.prototype._$get_height,function(c){this.desginHeight=c,a.prototype._$set_height.call(this,c),b.timer.callLater(this,this._changeCanvasSize)}),g(0,d,"isVisibility",function(){return this._isVisibility}),g(0,d,"scaleMode",function(){return this._scaleMode},function(a){this._scaleMode=a,b.timer.callLater(this,this._changeCanvasSize)}),g(0,d,"alignV",function(){return this._alignV},function(a){this._alignV=a,b.timer.callLater(this,this._changeCanvasSize)}),g(0,d,"bgColor",function(){return this._bgColor},function(a){this._bgColor=a,this.conchModel&&this.conchModel.bgColor(a),J.isWebGL&&(this.v=a&&"black"!==a&&"#000000"!==a?U.create(a)._color:null),J.canvas.style.background=a?a:"none"}),g(0,d,"mouseX",function(){return Math.round(w.instance.mouseX/this.clientScaleX)}),g(0,d,"mouseY",function(){return Math.round(w.instance.mouseY/this.clientScaleY)}),g(0,d,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),g(0,d,"screenMode",function(){return this._screenMode},function(a){this._screenMode=a}),g(0,d,"visible",a.prototype._$get_visible,function(b){if(this.visible!==b){a.prototype._$set_visible.call(this,b);J._mainCanvas.source.style.visibility=b?"visible":"hidden"}}),g(0,d,"fullScreenEnabled",null,function(a){var b=Q.document,c=J.canvas;a?(c.addEventListener("mousedown",this._requestFullscreen),c.addEventListener("touchstart",this._requestFullscreen),b.addEventListener("fullscreenchange",this._fullScreenChanged),b.addEventListener("mozfullscreenchange",this._fullScreenChanged),b.addEventListener("webkitfullscreenchange",this._fullScreenChanged),b.addEventListener("msfullscreenchange",this._fullScreenChanged)):(c.removeEventListener("mousedown",this._requestFullscreen),c.removeEventListener("touchstart",this._requestFullscreen),b.removeEventListener("fullscreenchange",this._fullScreenChanged),b.removeEventListener("mozfullscreenchange",this._fullScreenChanged),b.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),b.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),c.SCALE_NOSCALE="noscale",c.SCALE_EXACTFIT="exactfit",c.SCALE_SHOWALL="showall",c.SCALE_NOBORDER="noborder",c.SCALE_FULL="full",c.SCALE_FIXED_WIDTH="fixedwidth",c.SCALE_FIXED_HEIGHT="fixedheight",c.ALIGN_LEFT="left",c.ALIGN_RIGHT="right",c.ALIGN_CENTER="center",c.ALIGN_TOP="top",c.ALIGN_MIDDLE="middle",c.ALIGN_BOTTOM="bottom",c.SCREEN_NONE="none",c.SCREEN_HORIZONTAL="horizontal",c.SCREEN_VERTICAL="vertical",c.FRAME_FAST="fast",c.FRAME_SLOW="slow",c.FRAME_MOUSE="mouse",c.FRAME_SLEEP="sleep",c}(ya),Fa=function(a){function b(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,b.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}f(b,"laya.media.SoundNode",a);var c=b.prototype;return c._onParentChange=function(){this.target=this.parent},c.play=function(a,b){void 0===a&&(a=1),isNaN(a)&&(a=1),this.url&&(this.stop(),this._channel=G.playSound(this.url,a,b))},c.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},c._setPlayAction=function(a,b,c,d){void 0===d&&(d=!0),this[c]&&a&&(d?a.on(b,this,this[c]):a.off(b,this,this[c]))},c._setPlayActions=function(a,b,c,d){if(void 0===d&&(d=!0),a&&b){var e=b.split(","),f=0,g=0;for(g=e.length,f=0;f<g;f++)this._setPlayAction(a,e[f],c,d)}},g(0,c,"playEvent",null,function(a){this._playEvents=a,a&&this._tar&&this._setPlayActions(this._tar,a,"play")}),g(0,c,"target",null,function(a){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=a,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),g(0,c,"stopEvent",null,function(a){this._stopEvents=a,a&&this._tar&&this._setPlayActions(this._tar,a,"stop")}),b}(ya),Ga=function(a){function b(){b.__super.call(this),this.createChildren()}f(b,"laya.scene.Scene2D",a);var c=b.prototype;return c.createChildren=function(){},c.createView=function(a){T.createByJson(a,this,this)},b}(ya),Ha=function(a){function b(){this._src=null,this._onload=null,this._onerror=null,b.__super.call(this)}f(b,"laya.resource.FileBitmap",a);var c=b.prototype;return g(0,c,"src",function(){return this._src},function(a){this._src=a}),g(0,c,"onload",null,function(a){}),g(0,c,"onerror",null,function(a){}),b}(Ba),Ia=function(a){function b(a,c){this._is2D=!1,b.__super.call(this);var d=this;if(this._source=this,"2D"===a||"AUTO"===a&&!J.isWebGL){this._is2D=!0,this._source=c||Q.createElement("canvas");var e=this;e.getContext=function(a,b){if(d._ctx)return d._ctx;var c=d._ctx=d._source.getContext(a,b);return c&&(c._canvas=e,J.isFlash||(c.size=function(a,b){})),c}}else this._source={}}f(b,"laya.resource.HTMLCanvas",a);var c=b.prototype;return c.clear=function(){this._ctx&&this._ctx.clear()},c.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null},c.release=function(){},c._setContext=function(a){this._ctx=a},c.getContext=function(a,c){return this._ctx?this._ctx:this._ctx=b._createContext(this)},c.getMemSize=function(){return 0},c.size=function(a,b){this._w==a&&this._h==b||(this._w=a,this._h=b,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(a,b),this._source&&(this._source.height=b,this._source.width=a))},g(0,c,"context",function(){return this._ctx}),g(0,c,"asBitmap",null,function(a){}),b.create=function(a,c){return new b(a,c)},b.TYPE2D="2D",b.TYPE3D="3D",b.TYPEAUTO="AUTO",b._createContext=null,b}(Ba),Ja=function(a){function b(a,c,d,e,f,g,h,i){throw b.__super.call(this),Error("不允许new！")}return f(b,"laya.resource.HTMLSubImage",a),b.create=function(a,c,d,e,f,g,h,i){return void 0===i&&(i=!1),new b(a,c,d,e,f,g,h,i)},b}(Ba),Ka=function(a){function c(){this._frames=null,this._url=null,c.__super.call(this),this._setControlNode(this)}f(c,"laya.display.Animation",a);var d=c.prototype;return d.destroy=function(a){void 0===a&&(a=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,a),this._frames=null,this._labels=null},d.play=function(a,b,c){void 0===a&&(a=0),void 0===b&&(b=!0),void 0===c&&(c=""),c&&this._setFramesFromCache(c),this._isPlaying=!0,this.index="string"==typeof a?this._getFrameByLabel(a):a,this.loop=b,this._actionName=c,this._isReverse=1==this.wrapMode,this._frames&&this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0)},d._setFramesFromCache=function(a){return this._url&&(a=this._url+"#"+a),!(!a||!c.framesMap[a])&&(this._frames=c.framesMap[a],this._count=this._frames.length,!this._frameRateChanged&&c.framesMap[a+"$len"]&&(this._interval=c.framesMap[a+"$len"]),!0)},d._frameLoop=function(){this._style.visible&&this._style.alpha>.01&&a.prototype._frameLoop.call(this)},d._displayToIndex=function(a){this._frames&&(this.graphics=this._frames[a])},d.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},d.loadImages=function(a,b){return void 0===b&&(b=""),this._url="",this._setFramesFromCache(b)||(this.frames=c.framesMap[b]?c.framesMap[b]:c.createFrames(a,b)),this},d.loadAtlas=function(a,d,e){function f(b){a===b&&(g.frames=c.framesMap[e]?c.framesMap[e]:c.createFrames(a,e),d&&d.run())}void 0===e&&(e=""),this._url="";var g=this;return g._setFramesFromCache(e)||(qa.getAtlas(a)?f(a):b.loader.load(a,m.create(null,f,[a]),null,"atlas")),this},d.loadAnimation=function(a,d){function e(b){if(a===b){if(c.framesMap[a+"#"])f._frameRateChanged||(f._interval=c.framesMap[a+"#$len"]),f.frames=c.framesMap[a+"#"];else{var e=f._parseGraphicAnimation(qa.getRes(a));if(!e)return;var g=e.animationDic,h=!0;for(var i in g){var j=g[i];j.frames.length?(c.framesMap[a+"#"+i]=j.frames,c.framesMap[a+"#"+i+"$len"]=j.interval):h=!1}f._frameRateChanged||(f._interval=e.animationList[0].interval),f.frames=e.animationList[0].frames,h&&(c.framesMap[a+"#$len"]=e.animationList[0].interval,c.framesMap[a+"#"]=f.frames)}d&&d.run()}}this._url=a;var f=this;return f._setFramesFromCache("")?d&&d.run():(qa.getRes(a)?e(a):b.loader.load(a,m.create(null,e,[a]),null,"json"),qa.clearRes(a)),this},d._parseGraphicAnimation=function(a){return Oa.parseAnimationData(a)},g(0,d,"frames",function(){return this._frames},function(a){this._frames=a,a&&(this._count=a.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),g(0,d,"autoPlay",null,function(a){a?this.play():this.stop()}),g(0,d,"source",null,function(a){a.indexOf(".ani")>-1?this.loadAnimation(a):a.indexOf(".json")>-1||a.indexOf("als")>-1||a.indexOf("atlas")>-1?this.loadAtlas(a):this.loadImages(a.split(","))}),c.createFrames=function(a,b){var d;if("string"==typeof a){var e=qa.getAtlas(a);if(e&&e.length){d=[];for(var f=0,g=e.length;f<g;f++){var h=new r;h.drawTexture(qa.getRes(e[f]),0,0),d.push(h)}}}else if(a instanceof Array)for(d=[],f=0,g=a.length;f<g;f++)h=new r,h.loadImage(a[f],0,0),d.push(h);return b&&(c.framesMap[b]=d),d},c.clearCache=function(a){var b,d=c.framesMap,e=a+"#";for(b in d)b!==a&&0!=b.indexOf(e)||delete c.framesMap[b]},c.framesMap={},c}(Ca),La=function(a){function b(){this._targetDic=null,this._animationData=null,b.__super.call(this),null==b._sortIndexFun&&(b._sortIndexFun=C.sortByKey("index",!1,!0))}f(b,"laya.display.FrameAnimation",a);var c=b.prototype;return c._setUp=function(a,b){this._labels=null,this._targetDic=a,this._animationData=b,this.interval=1e3/b.frameRate,b.parsed?this._count=b.count:this._calculateDatas(),b.parsed=!0,b.count=this._count},c.clear=function(){a.prototype.clear.call(this),this._targetDic=null,this._animationData=null},c._displayToIndex=function(a){if(this._animationData){a<0&&(a=0),a>this._count&&(a=this._count);var b=this._animationData.nodes,c=0,d=b.length;for(c=0;c<d;c++)this._displayNodeToFrame(b[c],a)}},c._displayNodeToFrame=function(a,b,c){c||(c=this._targetDic);var d=c[a.target];if(d){var e,f,g,h=a.frames,i=a.keys,j=0,k=i.length;for(j=0;j<k;j++)e=i[j],f=h[e],g=f.length>b?f[b]:f[f.length-1],d[e]=g}},c._calculateDatas=function(){if(this._animationData){var a,b=this._animationData.nodes,c=0,d=b.length;for(this._count=0,c=0;c<d;c++)a=b[c],this._calculateNodeKeyFrames(a);this._count+=1}},c._calculateNodeKeyFrames=function(a){var c,d,e=a.keyframes,f=a.target;a.frames||(a.frames={}),a.keys?a.keys.length=0:a.keys=[];for(c in e)d=e[c],a.frames[c]||(a.frames[c]=[]),d.sort(b._sortIndexFun),a.keys.push(c),this._calculateNodePropFrames(d,a.frames[c],c,f)},c._calculateNodePropFrames=function(a,b,c,d){var e=0,f=a.length-1;for(b.length=a[f].index+1,e=0;e<f;e++)this._dealKeyFrame(a[e]),this._calculateFrameValues(a[e],a[e+1],b);0==f&&(b[0]=a[0].value),this._dealKeyFrame(a[e])},c._dealKeyFrame=function(a){a.label&&""!=a.label&&this.addLabel(a.label,a.index)},c._calculateFrameValues=function(a,b,c){var d,e=0,f=a.index,g=b.index,h=a.value,i=b.value-a.value,j=g-f;if(g>this._count&&(this._count=g),a.tween)for(d=X[a.tweenMethod],null==d&&(d=X.linearNone),e=f;e<g;e++)c[e]=d(e-f,h,i,j);else for(e=f;e<g;e++)c[e]=h;c[b.index]=b.value},b._sortIndexFun=null,b}(Ca),Ma=function(a){function c(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",c.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=Da.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}f(c,"laya.display.Input",a);var d=c.prototype;return d.setSelection=function(a,b){laya.display.Input.inputElement.selectionStart=a,laya.display.Input.inputElement.selectionEnd=b},d._onUnDisplay=function(a){this.focus=!1},d._onMouseDown=function(a){this.focus=!0,b.stage.on("mousedown",this,this._checkBlur)},d._checkBlur=function(a){a.nativeEvent.target!=laya.display.Input.input&&a.nativeEvent.target!=laya.display.Input.area&&a.target!=this&&(this.focus=!1)},d.render=function(a,b,c){laya.display.Sprite.prototype.render.call(this,a,b,c)},d._syncInputTransform=function(){var a,d=(this.nativeInput.style,b.stage);a=ga.getGlobalPosAndScale(this);var e=d._canvasTransform.clone(),f=e.clone();f.rotate(-Math.PI/180*b.stage.canvasDegree),f.scale(b.stage.clientScaleX,b.stage.clientScaleY);var g=b.stage.canvasDegree%180!=0,h=g?f.d:f.a,i=g?f.a:f.d;f.destroy();var j=this.padding[3],k=this.padding[0];0==b.stage.canvasDegree?(j+=a.x,k+=a.y,j*=h,k*=i,j+=e.tx,k+=e.ty):90==b.stage.canvasDegree?(j+=a.y,k+=a.x,j*=h,k*=i,j=e.tx-j,k+=e.ty):(j+=a.y,k+=a.x,j*=h,k*=i,j+=e.tx,k=e.ty-k);var l=Math.atan2(a.height,a.width)-.785,m=Math.sin(l),n=Math.cos(l),o=n*a.width+m*a.height,p=n*a.height-m*a.width;h*=g?p:o,i*=g?o:p,e.tx=0,e.ty=0,l*=180/3.1415,c.inputContainer.style.transform="scale("+h+","+i+") rotate("+(b.stage.canvasDegree+l)+"deg)",c.inputContainer.style.webkitTransform="scale("+h+","+i+") rotate("+(b.stage.canvasDegree+l)+"deg)",c.inputContainer.setPos(j,k),e.destroy();var q=this._width-this.padding[1]-this.padding[3],r=this._height-this.padding[0]-this.padding[2];this.nativeInput.setSize(q,r),J.isConchApp&&(this.nativeInput.setPos(j,k),this.nativeInput.setScale(h,i))},d.select=function(){this.nativeInput.select()},d._setInputMethod=function(){c.input.parentElement&&c.inputContainer.removeChild(c.input),c.area.parentElement&&c.inputContainer.removeChild(c.area),c.inputElement=this._multiline?c.area:c.input,c.inputContainer.appendChild(c.inputElement)},d._focusIn=function(){laya.display.Input.isInputting=!0;var a=this.nativeInput;this._focus=!0;var c=a.style;c.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),a.readOnly=!this._editable,a.maxLength=this._maxChars;this.padding;a.type=this._type,a.value=this._content,a.placeholder=this._prompt,b.stage.off("keydown",this,this._onKeyDown),b.stage.on("keydown",this,this._onKeyDown),b.stage.focus=this,this.event("focus"),Q.onPC&&a.focus();this._text;this._text=null,this.typeset(),a.setColor(this._originColor),a.setFontSize(this.fontSize),a.setFontFace(this.font),J.isConchApp&&a.setMultiAble&&a.setMultiAble(this._multiline),c.lineHeight=this.leading+this.fontSize+"px",c.fontStyle=this.italic?"italic":"normal",c.fontWeight=this.bold?"bold":"normal",c.textAlign=this.align,c.padding="0 0",this._syncInputTransform(),!J.isConchApp&&Q.onPC&&b.timer.frameLoop(1,this,this._syncInputTransform)},d._setPromptColor=function(){c.promptStyleDOM=Q.getElementById("promptStyle"),c.promptStyleDOM||(c.promptStyleDOM=Q.createElement("style"),Q.document.head.appendChild(c.promptStyleDOM)),c.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},d._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(a.prototype._$set_text.call(this,this._content),a.prototype._$set_color.call(this,this._originColor)):(a.prototype._$set_text.call(this,this._prompt),a.prototype._$set_color.call(this,this._promptColor)),b.stage.off("keydown",this,this._onKeyDown),b.stage.focus=null,this.event("blur"),J.isConchApp&&this.nativeInput.blur(),Q.onPC&&b.timer.clear(this,this._syncInputTransform),b.stage.off("mousedown",this,this._checkBlur)},d._onKeyDown=function(a){13===a.keyCode&&(Q.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},d.changeText=function(b){this._content=b,this._focus?(this.nativeInput.value=b||"",this.event("change")):a.prototype.changeText.call(this,b)},g(0,d,"color",a.prototype._$get_color,function(b){this._focus&&this.nativeInput.setColor(b),a.prototype._$set_color.call(this,this._content?b:this._promptColor),this._originColor=b}),g(0,d,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),g(0,d,"multiline",function(){return this._multiline},function(a){this._multiline=a,this.valign=a?"top":"middle"}),g(0,d,"maxChars",function(){return this._maxChars},function(a){a<=0&&(a=1e5),this._maxChars=a}),g(0,d,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(b){a.prototype._$set_color.call(this,this._originColor),b+="",this._focus?(this.nativeInput.value=b||"",this.event("change")):(this._multiline||(b=b.replace(/\r?\n/g,"")),this._content=b,b?a.prototype._$set_text.call(this,b):(a.prototype._$set_text.call(this,this._prompt),a.prototype._$set_color.call(this,this.promptColor)))}),g(0,d,"nativeInput",function(){return this._multiline?c.area:c.input}),g(0,d,"prompt",function(){return this._prompt},function(b){!this._text&&b&&a.prototype._$set_color.call(this,this._promptColor),this.promptColor=this._promptColor,this._text?a.prototype._$set_text.call(this,this._text==this._prompt?b:this._text):a.prototype._$set_text.call(this,b),this._prompt=b}),g(0,d,"focus",function(){return this._focus},function(a){var b=this.nativeInput;this._focus!==a&&(a?(b.target&&(b.target.focus=!1),b.target=this,this._setInputMethod(),this._focusIn()):(b.target=null,this._focusOut(),b.blur(),J.isConchApp?b.setPos(-1e4,-1e4):c.inputContainer.contains(b)&&c.inputContainer.removeChild(b)))}),g(0,d,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(a){a?(a="[^"+a+"]",a.indexOf("^^")>-1&&(a=a.replace("^^","")),this._restrictPattern=RegExp(a,"g")):this._restrictPattern=null}),g(0,d,"editable",function(){return this._editable},function(a){this._editable=a}),g(0,d,"promptColor",function(){return this._promptColor},function(b){this._promptColor=b,this._content||a.prototype._$set_color.call(this,b)}),g(0,d,"type",function(){return this._type},function(a){this._getCSSStyle().password="password"==a,this._type=a}),g(0,d,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),g(0,d,"asPassword",function(){return this._getCSSStyle().password},function(a){this._getCSSStyle().password=a,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),c.__init__=function(){c._createInputElement(),Q.onMobile&&J.canvas.addEventListener(c.IOS_IFRAME?"click":"touchend",c._popupInputMethod)},c._popupInputMethod=function(a){if(laya.display.Input.isInputting){laya.display.Input.inputElement.focus()}},c._createInputElement=function(){c._initInput(c.area=Q.createElement("textarea")),c._initInput(c.input=Q.createElement("input")),c.inputContainer=Q.createElement("div"),c.inputContainer.style.position="absolute",c.inputContainer.style.zIndex=1e5,Q.container.appendChild(c.inputContainer),c.inputContainer.setPos=function(a,b){c.inputContainer.style.left=a+"px",c.inputContainer.style.top=b+"px"}},c._initInput=function(a){var b=a.style;b.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",b.resize="none",b.backgroundColor="transparent",b.border="none",b.outline="none",b.zIndex=1,a.addEventListener("input",c._processInputting),a.addEventListener("mousemove",c._stopEvent),a.addEventListener("mousedown",c._stopEvent),a.addEventListener("touchmove",c._stopEvent),J.isConchApp||(a.setColor=function(b){a.style.color=b},a.setFontSize=function(b){a.style.fontSize=b+"px"},a.setSize=function(b,c){a.style.width=b+"px",a.style.height=c+"px"}),a.setFontFace=function(b){a.style.fontFamily=b}},c._processInputting=function(a){var b=laya.display.Input.inputElement.target;if(b){var c=laya.display.Input.inputElement.value;b._restrictPattern&&(c=c.replace(/\u2006|\x27/g,""),b._restrictPattern.test(c)&&(c=c.replace(b._restrictPattern,""),laya.display.Input.inputElement.value=c)),b._text=c,b.event("input")}},c._stopEvent=function(a){"touchmove"==a.type&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()},c.TYPE_TEXT="text",c.TYPE_PASSWORD="password",c.TYPE_EMAIL="email",c.TYPE_URL="url",c.TYPE_NUMBER="number",c.TYPE_RANGE="range",c.TYPE_DATE="date",c.TYPE_MONTH="month",c.TYPE_WEEK="week",c.TYPE_TIME="time",c.TYPE_DATE_TIME="datetime",c.TYPE_DATE_TIME_LOCAL="datetime-local",c.TYPE_SEARCH="search",c.input=null,c.area=null,c.inputElement=null,c.inputContainer=null,c.confirmButton=null,c.promptStyleDOM=null,c.inputHeight=45,c.isInputting=!1,e(c,["IOS_IFRAME",function(){return this.IOS_IFRAME=Q.onIOS&&Q.window.top!=Q.window.self}]),c}(Da),Na=function(a){function b(a,c){this._recreateLock=!1,this._needReleaseAgain=!1,b.__super.call(this),this._init_(a,c)}f(b,"laya.resource.HTMLImage",a);var c=b.prototype;return c._init_=function(a,b){this._src=a,this._source=new Q.window.Image,b&&(b.onload&&(this.onload=b.onload),b.onerror&&(this.onerror=b.onerror),b.onCreate&&b.onCreate(this)),0!=a.indexOf("data:image")&&(this._source.crossOrigin=""),a&&(this._source.src=a)},c.recreateResource=function(){var a=this;if(""===this._src)throw Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.startCreate(),this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0,this.startCreate();var b=this;this._source=new Q.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(b._needReleaseAgain)return b._needReleaseAgain=!1,b._source.onload=null,void(b._source=null);b._source.onload=null,b.memorySize=a._w*a._h*4,b._recreateLock=!1,b.completeCreate()},this._source.src=this._src}},c.detoryResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},c.onresize=function(){this._w=this._source.width,this._h=this._source.height},g(0,c,"onload",null,function(a){var b=this;this._onload=a,this._source&&(this._source.onload=null!=this._onload?function(){b.onresize(),b._onload()}:null)}),g(0,c,"onerror",null,function(a){var b=this;this._onerror=a,this._source&&(this._source.onerror=null!=this._onerror?function(){b._onerror()}:null)}),b.create=function(a,c){return new b(a,c)},b}(Ha),Oa=function(a){function b(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._=null,this.aa=null,b.__super.call(this)}var c;f(b,"laya.display.GraphicAnimation",a);var d=b.prototype;return d._parseNodeList=function(a){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[a.compId]=a.props,a.compId&&this._nodeList.push(a.compId);var b=a.child;if(b){var c=0,d=b.length;for(c=0;c<d;c++)this._parseNodeList(b[c])}},d._calGraphicData=function(a){this._setUp(null,a),this._createGraphicData()},d._createGraphicData=function(){var a=[],b=0,c=this.count;for(b=0;b<c;b++)a.push(this._createFrameGraphic(b));this._gList=a},d._createFrameGraphic=function(a){var c=new r;return b.ba||(b.ba=new D),this.ca(this._,a,c),c},d.da=function(a,b,c,d,e){void 0===e&&(e=1);var f;f=this.aa[a.compId]=this.ea(a.compId,b,this.aa[a.compId]),f.fa||(f.fa=new D);var g;g=f.fa,D.mul(f.transform,c,g);var h;f.skin&&(h=this._getTextureByUrl(f.skin))&&(g._checkTransform()?(d.drawTexture(h,0,0,f.width,f.height,g,f.alpha*e),f.fa=null):d.drawTexture(h,g.tx,g.ty,f.width,f.height,null,f.alpha*e));var i;if(i=a.child){var j=0,k=0;for(k=i.length,j=0;j<k;j++)this.da(i[j],b,g,d,f.alpha*e)}},d.ga=function(a,b){var c;if(a.skin&&(c=this._getTextureByUrl(a.skin))){var d=a.transform;d._checkTransform();var e=!1;e=!d.bTransform,e?b.drawTexture(c,d.tx,d.ty,a.width,a.height,null,a.alpha):b.drawTexture(c,0,0,a.width,a.height,d.clone(),a.alpha)}},d.ca=function(a,b,c){var d;if(d=this.aa[a.compId]=this.ea(a.compId,b,this.aa[a.compId]),!a.child)return void this.ga(d,c);var e=d.transform;e._checkTransform();var f=!1;f=!e.bTransform;var g=!1;g=f&&(0!=e.tx||0!=e.ty);var h=!1;h=e.bTransform||1!=d.alpha,h&&c.save(),1!=d.alpha&&c.alpha(d.alpha),f?g&&c.translate(e.tx,e.ty):c.transform(e.clone());var i;i=a.child;var j;if(d.skin&&(j=this._getTextureByUrl(d.skin))&&c.drawTexture(j,0,0,d.width,d.height),i){var k=0,l=0;for(l=i.length,k=0;k<l;k++)this.ca(i[k],b,c)}h?c.restore():f?g&&c.translate(-e.tx,-e.ty):c.transform(e.clone().invert())},d._calculateNodeKeyFrames=function(b){a.prototype._calculateNodeKeyFrames.call(this,b),this._nodeIDAniDic[b.target]=b},d.getNodeDataByID=function(a){return this._nodeIDAniDic[a]},d._getParams=function(a,c,d,e){var f=b._temParam;f.length=c.length;var g=0,h=c.length;for(g=0;g<h;g++)f[g]=this._getObjVar(a,c[g][0],d,c[g][1],e);return f},d._getObjVar=function(a,b,c,d,e){if(a.hasOwnProperty(b)){var f=a[b];return c>=f.length&&(c=f.length-1),a[b][c]}return e.hasOwnProperty(b)?e[b]:d},d.ea=function(a,d,e){e||(e=new c),e.transform?e.transform.identity():e.transform=new D;var f=this.getNodeDataByID(a);if(!f)return e;var g=f.frames,h=this._getParams(g,b._drawTextureCmd,d,this._nodeDefaultProps[a]),i=h[0],j=NaN,k=NaN,l=h[5],m=h[6],n=h[13],o=h[14],p=h[7],q=h[8],r=h[9],s=h[11],t=h[12];j=h[3],k=h[4];var u;e.skin=i,i&&(u=this._getTextureByUrl(i),u?(j||(j=u.width),k||(k=u.height)):console.log("lost skin:",i)),e.width=j,e.height=k,e.alpha=h[10];var v;v=e.transform,0!=n&&(l=n*j),0!=o&&(m=o*k),0==l&&0==m||v.translate(-l,-m);var w=null;if(r||1!==p||1!==q||s||t){w=b.ha,w.identity(),w.bTransform=!0;var x=.0174532922222222*(r-s),y=.0174532922222222*(r+t),z=Math.cos(y),A=Math.sin(y),B=Math.sin(x),C=Math.cos(x);w.a=p*z,w.b=p*A,w.c=-q*B,w.d=q*C,w.tx=w.ty=0}return w&&(v=D.mul(v,w,v)),v.translate(h[1],h[2]),e},d._getTextureByUrl=function(a){return qa.getRes(a)},d.setAniData=function(a){if(a.animations){this._nodeDefaultProps={},this.aa={},this._nodeList&&(this._nodeList.length=0),this._=a,this._parseNodeList(a);var c,d={},e=[],f=a.animations,g=0,h=f.length;for(g=0;g<h;g++)if(c=f[g]){try{this._calGraphicData(c)}catch(a){console.log("parse animation fail:"+c.name+",empty animation created"),this._gList=[]}var i={};i.interval=1e3/c.frameRate,i.frames=this._gList,e.push(i),d[c.name]=i}this.animationList=e,this.animationDic=d}b._temParam.length=0},d._clear=function(){this.animationList=null,this.animationDic=null,this._gList=null,this.aa=null},b.parseAnimationData=function(a){b._I||(b._I=new b),b._I.setAniData(a);var c;return c={},c.animationList=b._I.animationList,c.animationDic=b._I.animationDic,b._I._clear(),c},b._temParam=[],b._I=null,b.ba=null,e(b,["_drawTextureCmd",function(){return this._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",0],["height",0],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]]},"_tempMt",function(){return this.ha=new D}]),b.__init$=function(){c=function(){function a(){this.skin=null,this.transform=null,this.fa=null,this.width=NaN,this.height=NaN,this.alpha=1}return f(a,""),a}()},b}(La);b.__init([ra,l,Oa,J,Q,ea,H,xa])}(window,a,b),function(window,a,b){var c=(b.un,b.uns,b.static,b.class);b.getset,b.__newvec;new(function(){function a(){}return c(a,"LayaMain"),a}())}(0,0,b),function(window,a,b){var c=(b.un,b.uns,b.static),d=b.class,e=b.getset,f=b.__newvec,g=laya.maths.Arith,h=laya.maths.Bezier,i=laya.resource.Bitmap,j=laya.utils.Browser,k=laya.utils.Color,l=(laya.filters.ColorFilter,b.Config),m=laya.resource.Context,n=(laya.events.Event,laya.filters.Filter),o=laya.display.Graphics,p=laya.resource.HTMLCanvas,q=(laya.utils.HTMLChar,laya.resource.HTMLImage),r=laya.resource.HTMLSubImage,s=(laya.utils.Handler,laya.maths.Matrix),t=laya.maths.Point,u=laya.maths.Rectangle,v=laya.renders.Render,w=(laya.renders.RenderContext,laya.renders.RenderSprite),x=laya.resource.Resource,y=laya.resource.ResourceManager,z=laya.utils.RunDriver,A=laya.display.Sprite,B=laya.utils.Stat,C=laya.utils.StringKey,D=(laya.display.css.Style,laya.system.System),E=laya.resource.Texture,F=laya.utils.Utils,G=laya.utils.VectorGraphManager;laya.utils.WordText;b.interface("laya.webgl.shapes.IShape"),b.interface("laya.webgl.submit.ISubmit"),b.interface("laya.webgl.text.ICharSegment"),b.interface("laya.webgl.canvas.save.ISaveData"),b.interface("laya.webgl.resource.IMergeAtlasBitmap"),b.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var H=function(){function a(){}d(a,"laya.filters.webgl.FilterActionGL");var c=a.prototype;return b.imps(c,{"laya.filters.IFilterActionGL":!0}),c.setValue=function(a){},c.setValueMix=function(a){},c.apply3d=function(a,b,c,d,e){return null},c.apply=function(a){return null},e(0,c,"typeMix",function(){return 0}),a}(),I=function(){function a(){}return d(a,"laya.webgl.shader.ShaderValue"),a}(),J=function(){function a(a,b,d){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new c,void 0===a&&(a=0),void 0===b&&(b=0),void 0===d&&(d=0),this._cells=null,this._rowInfo=null,this._init(a,b),this._atlasID=d}var b,c;d(a,"laya.webgl.atlas.AtlasGrid");var e=a.prototype;return e.getAltasID=function(){return this._atlasID},e.setAltasID=function(a){a>=0&&(this._atlasID=a)},e.addTex=function(a,b,c){var d=this._get(b,c);return 0==d.ret?d:(this._fill(d.x,d.y,b,c,a),this._texCount++,d)},e._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},e._init=function(a,c){if(this._width=a,this._height=c,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=f(this._height);for(var d=0;d<this._height;d++)this._rowInfo[d]=new b;return this._clear(),!0},e._get=function(a,b){var c=new L;if(a>=this._failSize.width&&b>=this._failSize.height)return c;for(var d=-1,e=-1,f=this._width,g=this._height,h=this._cells,i=0;i<g;i++)if(!(this._rowInfo[i].spaceCount<a))for(var j=0;j<f;){var k=3*(i*f+j);if(0!=h[k]||h[k+1]<a||h[k+2]<b)j+=h[k+1];else{d=j,e=i;for(var l=0;l<a;l++)if(h[3*l+k+2]<b){d=-1;break}if(!(d<0))return c.ret=!0,c.x=d,c.y=e,c;j+=h[k+1]}}return c},e._fill=function(a,b,c,d,e){var f=this._width,g=this._height;this._check(a+c<=f&&b+d<=g);for(var h=b;h<d+b;++h){this._check(this._rowInfo[h].spaceCount>=c),this._rowInfo[h].spaceCount-=c;for(var i=0;i<c;i++){var j=3*(a+h*f+i);this._check(0==this._cells[j]),this._cells[j]=e,this._cells[j+1]=c,this._cells[j+2]=d}}if(a>0)for(h=0;h<d;++h){var k=0;for(i=a-1;i>=0&&0==this._cells[3*((b+h)*f+i)];--i,++k);for(i=k;i>0;--i)this._cells[3*((b+h)*f+a-i)+1]=i,this._check(i>0)}if(b>0)for(i=a;i<a+c;++i){for(k=0,h=b-1;h>=0&&0==this._cells[3*(i+h*f)];--h,k++);for(h=k;h>0;--h)this._cells[3*(i+(b-h)*f)+2]=h,this._check(h>0)}},e._check=function(a){0==a&&console.log("xtexMerger 错误啦")},e._clear=function(){this._texCount=0
;for(var a=0;a<this._height;a++)this._rowInfo[a].spaceCount=this._width;for(var b=0;b<this._height;b++)for(var c=0;c<this._width;c++){var d=3*(b*this._width+c);this._cells[d]=0,this._cells[d+1]=this._width-c,this._cells[d+2]=this._width-b}this._failSize.width=this._width+1,this._failSize.height=this._height+1},a.__init$=function(){b=function(){function a(){this.spaceCount=0}return d(a,""),a}(),c=function(){function a(){this.width=0,this.height=0}return d(a,""),a}()},a}(),K=function(){function a(a,b,c,d){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=a,this._height=b,this._gridSize=c,this._maxAtlaserCount=d,this._gridNumX=a/c,this._gridNumY=b/c,this._curAtlasIndex=0,this._atlaserArray=[]}d(a,"laya.webgl.atlas.AtlasResourceManager");var b=a.prototype;return b.setAtlasParam=function(b,c,d,e){if(1==this._setAtlasParam)return a._sid_=0,this._width=b,this._height=c,this._gridSize=d,this._maxAtlaserCount=e,this._gridNumX=b/d,this._gridNumY=c/d,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},b.pushData=function(b){this._setAtlasParam=!1;for(var c=Math.ceil((b.bitmap.width+2)/this._gridSize),d=Math.ceil((b.bitmap.height+2)/this._gridSize),e=!1,f=0;f<2;f++){for(var g=this._maxAtlaserCount,h=0;h<g;h++){var i=(this._curAtlasIndex+h)%g;this._atlaserArray.length-1>=i||this._atlaserArray.push(new ta(this._gridNumX,this._gridNumY,this._width,this._height,a._sid_++));var j=this._atlaserArray[i],k=b.bitmap,l=j.inAtlasWebGLImagesKey.indexOf(k),m=0,n=0;if(l!=-1){var o=j.InAtlasWebGLImagesOffsetValue[l];m=o[0],n=o[1],j.addToAtlas(b,m,n),e=!0,this._curAtlasIndex=i;break}var p=j.addTex(1,c,d);if(p.ret){m=p.x*this._gridSize+1,n=p.y*this._gridSize+1,k.lock=!0,j.addToAtlasTexture(k,m,n),j.addToAtlas(b,m,n),e=!0,this._curAtlasIndex=i;break}}if(e)break;this._atlaserArray.push(new ta(this._gridNumX,this._gridNumY,this._width,this._height,a._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return e||console.log(">>>AtlasManager pushData error"),e},b.addToAtlas=function(a){laya.webgl.atlas.AtlasResourceManager.instance.pushData(a)},b.garbageCollection=function(){if(this._needGC===!0){for(var a=this._atlaserArray.length-this._maxAtlaserCount,b=0;b<a;b++)this._atlaserArray[b].dispose();this._atlaserArray.splice(0,a),this._needGC=!1}return!0},b.freeAll=function(){for(var a=0,b=this._atlaserArray.length;a<b;a++)this._atlaserArray[a].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},b.getAtlaserCount=function(){return this._atlaserArray.length},b.getAtlaserByIndex=function(a){return this._atlaserArray[a]},e(1,a,"instance",function(){return a._Instance||(a._Instance=new a(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),a._Instance}),e(1,a,"enabled",function(){return a._enabled}),e(1,a,"atlasLimitWidth",function(){return a._atlasLimitWidth},function(b){a._atlasLimitWidth=b}),e(1,a,"atlasLimitHeight",function(){return a._atlasLimitHeight},function(b){a._atlasLimitHeight=b}),a._enable=function(){a._enabled=!0,l.atlasEnable=!0},a._disable=function(){a._enabled=!1,l.atlasEnable=!1},a.__init__=function(){a.atlasTextureWidth=2048,a.atlasTextureHeight=2048,a.maxTextureCount=6,a.atlasLimitWidth=512,a.atlasLimitHeight=512},a._enabled=!1,a._atlasLimitWidth=0,a._atlasLimitHeight=0,a.gridSize=16,a.atlasTextureWidth=0,a.atlasTextureHeight=0,a.maxTextureCount=0,a._atlasRestore=0,a.BOARDER_TYPE_NO=0,a.BOARDER_TYPE_RIGHT=1,a.BOARDER_TYPE_LEFT=2,a.BOARDER_TYPE_BOTTOM=4,a.BOARDER_TYPE_TOP=8,a.BOARDER_TYPE_ALL=15,a._sid_=0,a._Instance=null,a}(),L=function(){function a(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return d(a,"laya.webgl.atlas.MergeFillInfo"),a}(),M=function(){function a(){}return d(a,"laya.webgl.canvas.BlendMode"),a._init_=function(b){a.fns=[a.BlendNormal,a.BlendAdd,a.BlendMultiply,a.BlendScreen,a.BlendOverlay,a.BlendLight,a.BlendMask,a.BlendDestinationOut],a.targetFns=[a.BlendNormalTarget,a.BlendAddTarget,a.BlendMultiplyTarget,a.BlendScreenTarget,a.BlendOverlayTarget,a.BlendLightTarget,a.BlendMask,a.BlendDestinationOut]},a.BlendNormal=function(a){a.blendFuncSeparate(770,771,1,1)},a.BlendAdd=function(a){a.blendFunc(770,772)},a.BlendMultiply=function(a){a.blendFunc(774,771)},a.BlendScreen=function(a){a.blendFunc(770,1)},a.BlendOverlay=function(a){a.blendFunc(1,769)},a.BlendLight=function(a){a.blendFunc(770,1)},a.BlendNormalTarget=function(a){a.blendFuncSeparate(770,771,1,771)},a.BlendAddTarget=function(a){a.blendFunc(770,772)},a.BlendMultiplyTarget=function(a){a.blendFunc(774,771)},a.BlendScreenTarget=function(a){a.blendFunc(770,1)},a.BlendOverlayTarget=function(a){a.blendFunc(1,769)},a.BlendLightTarget=function(a){a.blendFunc(770,1)},a.BlendMask=function(a){a.blendFunc(0,770)},a.BlendDestinationOut=function(a){a.blendFunc(0,0)},a.activeBlendFunction=null,a.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],a.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},a.NORMAL="normal",a.ADD="add",a.MULTIPLY="multiply",a.SCREEN="screen",a.LIGHT="light",a.OVERLAY="overlay",a.DESTINATIONOUT="destination-out",a.fns=[],a.targetFns=[],a}(),N=function(){function a(a){this._color=k.create("black"),this.setValue(a)}d(a,"laya.webgl.canvas.DrawStyle");var b=a.prototype;return b.setValue=function(a){if(a){if("string"==typeof a)return void(this._color=k.create(a));if(a instanceof laya.utils.Color)return void(this._color=a)}},b.reset=function(){this._color=k.create("black")},b.equal=function(a){return"string"==typeof a?this._color.strColor===a:a instanceof laya.utils.Color&&this._color.numColor===a.numColor},b.toColorStr=function(){return this._color.strColor},a.create=function(b){if(b){var c;if("string"==typeof b?c=k.create(b):b instanceof laya.utils.Color&&(c=b),c)return c._drawStyle||(c._drawStyle=new a(b))}return null},a.DEFAULT=new a("#000000"),a}(),O=function(){function a(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];ma.mainContext;this.ib=Qa.create(35048),this.vb=Ra.create(5)}d(a,"laya.webgl.canvas.Path");var b=a.prototype;return b.addPoint=function(a,b){this.tempArray.push(a,b)},b.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},b.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},b.polygon=function(a,b,c,d,e,f){var g;return this.geomatrys.push(this._curGeomatry=g=new xa(a,b,c,d,e,f)),d||(g.fill=!1),void 0==f&&(g.borderWidth=0),g},b.setGeomtry=function(a){this.geomatrys.push(this._curGeomatry=a)},b.drawLine=function(a,b,c,d,e){var f;return this.closePath?this.geomatrys.push(this._curGeomatry=f=new wa(a,b,c,d,e)):this.geomatrys.push(this._curGeomatry=f=new va(a,b,c,d,e)),f.fill=!1,f},b.update=function(){var a=this.ib.byteLength,b=this.geomatrys.length;this.offset=a;for(var c=this.geoStart;c<b;c++)this.geomatrys[c].getData(this.ib,this.vb,this.vb.byteLength/20);this.geoStart=b,this.count=(this.ib.byteLength-a)/ia.BYTES_PIDX},b.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},a}(),P=function(){function a(){}d(a,"laya.webgl.canvas.save.SaveBase");var c=a.prototype;return b.imps(c,{"laya.webgl.canvas.save.ISaveData":!0}),c.isSaveMark=function(){return!1},c.restore=function(b){this._dataObj[this._valueName]=this._value,a._cache[a._cache._length++]=this,this._newSubmit&&(b._curSubmit=$.RENDERBASE,b._renderKey=0)},a._createArray=function(){var a=[];return a._length=0,a},a._init=function(){var b=a._namemap={};return b[1]="ALPHA",b[2]="fillStyle",b[8]="font",b[256]="lineWidth",b[512]="strokeStyle",b[8192]="_mergeID",b[1024]=b[2048]=b[4096]=[],b[16384]="textBaseline",b[32768]="textAlign",b[65536]="_nBlendType",b[524288]="shader",b[1048576]="filters",b},a.save=function(b,c,d,e){if((b._saveMark._saveuse&c)!==c){b._saveMark._saveuse|=c;var f=a._cache,g=f._length>0?f[--f._length]:new a;g._value=d[g._valueName=a._namemap[c]],g._dataObj=d,g._newSubmit=e;var h=b._save;h[h._length++]=g}},a._cache=laya.webgl.canvas.save.SaveBase._createArray(),a._namemap=a._init(),a}(),Q=function(){function a(){this._clipRect=new u}d(a,"laya.webgl.canvas.save.SaveClipRect");var c=a.prototype;return b.imps(c,{"laya.webgl.canvas.save.ISaveData":!0}),c.isSaveMark=function(){return!1},c.restore=function(b){b._clipRect=this._clipSaveRect,a._cache[a._cache._length++]=this,this._submitScissor.submitLength=b._submits._length-this._submitScissor.submitIndex,b._curSubmit=$.RENDERBASE,b._renderKey=0},a.save=function(b,c){if(131072!=(131072&b._saveMark._saveuse)){b._saveMark._saveuse|=131072;var d=a._cache,e=d._length>0?d[--d._length]:new a;e._clipSaveRect=b._clipRect,b._clipRect=e._clipRect.copyFrom(b._clipRect),e._submitScissor=c;var f=b._save;f[f._length++]=e}},a._cache=P._createArray(),a}(),R=function(){function a(){this._saveuse=0}d(a,"laya.webgl.canvas.save.SaveMark");var c=a.prototype;return b.imps(c,{"laya.webgl.canvas.save.ISaveData":!0}),c.isSaveMark=function(){return!0},c.restore=function(b){b._saveMark=this._preSaveMark,a._no[a._no._length++]=this},a.Create=function(b){var c=a._no,d=c._length>0?c[--c._length]:new a;return d._saveuse=0,d._preSaveMark=b._saveMark,b._saveMark=d,d},a._no=P._createArray(),a}(),S=function(){function a(){this._matrix=new s}d(a,"laya.webgl.canvas.save.SaveTransform");var c=a.prototype;return b.imps(c,{"laya.webgl.canvas.save.ISaveData":!0}),c.isSaveMark=function(){return!1},c.restore=function(b){b._curMat=this._savematrix,a._no[a._no._length++]=this},a.save=function(b){var c=b._saveMark;if(2048!=(2048&c._saveuse)){c._saveuse|=2048;var d=a._no,e=d._length>0?d[--d._length]:new a;e._savematrix=b._curMat,b._curMat=b._curMat.copyTo(e._matrix);var f=b._save;f[f._length++]=e}},a._no=P._createArray(),a}(),T=function(){function a(){}d(a,"laya.webgl.canvas.save.SaveTranslate");var c=a.prototype;return b.imps(c,{"laya.webgl.canvas.save.ISaveData":!0}),c.isSaveMark=function(){return!1},c.restore=function(b){b._curMat;b._x=this._x,b._y=this._y,a._no[a._no._length++]=this},a.save=function(b){var c=a._no,d=c._length>0?c[--c._length]:new a;d._x=b._x,d._y=b._y;var e=b._save;e[e._length++]=d},a._no=P._createArray(),a}(),U=function(){function a(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new u}d(a,"laya.webgl.resource.RenderTargetMAX");var c=a.prototype;return c.ia=function(a){this._sp=a},c.size=function(a,c){var d=this;if(this._width===a&&this._height===c)return void this.target.size(a,c);this.repaint=!0,this._width=a,this._height=c,this.target?this.target.size(a,c):this.target=Ba.create(a,c),this.target.hasListener("recovered")||this.target.on("recovered",this,function(a){b.timer.callLater(d._sp,d._sp.repaint)})},c._flushToTarget=function(a,b){if(!b._destroy){var c=ka.worldScissorTest,d=ka.worldClipRect;ka.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,ka.worldScissorTest=!1,ma.mainContext.disable(3089);var e=ka.worldAlpha,f=ka.worldMatrix4,g=ka.worldMatrix,h=ka.worldFilters,i=ka.worldShaderDefines;if(ka.worldMatrix=s.EMPTY,ka.restoreTempArray(),ka.worldMatrix4=ka.TEMPMAT4_ARRAY,ka.worldAlpha=1,ka.worldFilters=null,ka.worldShaderDefines=null,Aa.activeShader=null,b.start(),l.showCanvasMark?b.clear(0,1,0,.3):b.clear(0,0,0,0),a.flush(),b.end(),Aa.activeShader=null,ka.worldAlpha=e,ka.worldMatrix4=f,ka.worldMatrix=g,ka.worldFilters=h,ka.worldShaderDefines=i,ka.worldScissorTest=c,c){var j=ka.height-d.y-d.height;ma.mainContext.scissor(d.x,j,d.width,d.height),ma.mainContext.enable(3089)}ka.worldClipRect=d}},c.flush=function(a){this.repaint&&(this._flushToTarget(a,this.target),this.repaint=!1)},c.drawTo=function(a,b,c,d,e){a.drawTexture(this.target.getTexture(),b,c,d,e,0,0)},c.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},a}(),V=function(){function a(){this.ALPHA=1,this.shaderType=0,this.defines=new ua}return d(a,"laya.webgl.shader.d2.Shader2D"),a.__init__=function(){Ma.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),Ma.addInclude("parts/ColorFilter_ps_logic.glsl","gl_FragColor = gl_FragColor * colorMat + colorAlpha/255.0;"),Ma.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),Ma.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4Color += texture2D(texture, v_texcoord + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);"),Ma.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),Ma.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform float strength;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\nfloat sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\nfloat sig2 = sigma*sigma;\nfloat _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\nfloat gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return gauss1*exp(-(x*x+y*y)/_2sig2);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),Ma.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),Ma.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);");var a,b;a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",b='precision mediump float;\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',Ma.preCompile2D(0,1,a,b,null),a="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",b='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',Ma.preCompile2D(0,2,a,b,null),a="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",b="precision mediump float;\n//precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n}",Ma.preCompile2D(0,4,a,b,null),a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",b='precision highp float;\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',Ma.preCompile2D(0,256,a,b,null),a="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_texcoord = texcoord;  \n}",b="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor.a = gl_FragColor.a * alpha;\n}",Ma.preCompile2D(0,512,a,b,null)},a}(),W=function(){function a(a,b,c){this._value=0,this._name2int=a,this._int2name=b,this._int2nameMap=c}d(a,"laya.webgl.shader.ShaderDefines");var b=a.prototype;return b.add=function(a){return"string"==typeof a&&(a=this._name2int[a]),this._value|=a,this._value},b.addInt=function(a){return this._value|=a,this._value},b.remove=function(a){return"string"==typeof a&&(a=this._name2int[a]),this._value&=~a,this._value},b.isDefine=function(a){return(this._value&a)===a},b.getValue=function(){return this._value},b.setValue=function(a){this._value=a},b.toNameDic=function(){var b=this._int2nameMap[this._value];return b?b:a._toText(this._value,this._int2name,this._int2nameMap)},a._reg=function(a,b,c,d){c[a]=b,d[b]=a},a._toText=function(a,b,c){var d=c[a];if(d)return d;for(var e={},f=1,g=0;g<32&&!((f=1<<g)>a);g++)if(a&f){var h=b[f];h&&(e[h]="")}return c[a]=e,e},a._toInt=function(a,b){for(var c=a.split("."),d=0,e=0,f=c.length;e<f;e++){var g=b[c[e]];if(!g)throw Error("Defines to int err:"+a+"/"+c[e]);d|=g}return d},a}(),X=function(){function a(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMat16=ka.getMatrArray()}d(a,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var b=a.prototype;return b.init=function(b,c,d){if(c)this._vs=c;else{this._vs=[];var e=b.width,f=b.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(e,0,1,0,1,1,1,1),this._vs.push(e,f,1,1,1,1,1,1),this._vs.push(0,f,0,1,1,1,1,1)}d?this._ps=d:(a._defaultPS||(a._defaultPS=[],a._defaultPS.push(0,1,3,3,1,2)),this._ps=a._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=b},b.init2=function(a,b,c,d,e){this.transform&&(this.transform=null),c?this._ps=c:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=d,this._uvs=e,this.mEleNum=this._ps.length,this.mTexture=a,(v.isConchNode||v.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},b._initMyData=function(){var b=0,c=0,d=this._verticles.length,e=4*d;this._vs=a._tempVS;var f=!1;if(v.isConchNode||v.isConchApp?(this._vs.length=e,f=!0):this._vs.length<e&&(this._vs.length=e,f=!0),a._tVSLen=e,f)for(;b<e;)this._vs[b]=this._verticles[c],this._vs[b+1]=this._verticles[c+1],this._vs[b+2]=this._uvs[c],this._vs[b+3]=this._uvs[c+1],this._vs[b+4]=1,this._vs[b+5]=1,this._vs[b+6]=1,this._vs[b+7]=1,b+=8,c+=2;else for(;b<e;)this._vs[b]=this._verticles[c],this._vs[b+1]=this._verticles[c+1],this._vs[b+2]=this._uvs[c],this._vs[b+3]=this._uvs[c+1],b+=8,c+=2},b.getData2=function(b,c,d){this.mVBBuffer=b,this.mIBBuffer=c,this._initMyData(),b.appendEx2(this._vs,Float32Array,a._tVSLen,4),this._indexStart=c.byteLength;var e;e=a._tempIB,e.length<this._ps.length&&(e.length=this._ps.length);for(var f=0,g=this._ps.length;f<g;f++)e[f]=this._ps[f]+d;c.appendEx2(e,Uint16Array,this._ps.length,2)},b.getData=function(a,b,c){if(this.mVBBuffer=a,this.mIBBuffer=b,a.append(this.mVBData),this._indexStart=b.byteLength,this.mIBData.start!=c){for(var d=0,e=this._ps.length;d<e;d++)this.mIBData[d]=this._ps[d]+c;this.mIBData.start=c}b.append(this.mIBData)},b.render=function(a,b,c){if(v.isWebGL&&this.mTexture){a._renderKey=0,a._shader2D.glTexture=null,Y.getInstance().addSkinMesh(this);var d=$.createShape(a,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,qa.create(512,0));this.transform||(this.transform=s.EMPTY),this.transform.translate(b,c),s.mul16(this.transform,a._curMat,this._tempMat16),this.transform.translate(-b,-c);var e=d.shaderValue;e.textureHost=this.mTexture,e.offsetX=0,e.offsetY=0,e.u_mmat2=this._tempMat16,e.ALPHA=a._shader2D.ALPHA,a._submits[a._submits._length++]=d}else v.isConchApp&&this.mTexture&&(this.transform||(this.transform=s.EMPTY),a.setSkinMesh&&a.setSkinMesh(b,c,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},a._tempVS=[],a._tempIB=[],a._defaultPS=null,a._tVSLen=0,a}(),Y=function(){function a(){this.ib=null,this.vb=null;ma.mainContext;this.ib=Qa.create(35048),this.vb=Ra.create(8)}d(a,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var b=a.prototype;return b.addSkinMesh=function(a){a.getData2(this.vb,this.ib,this.vb.byteLength/32)},b.reset=function(){this.vb.clear(),this.ib.clear()},a.getInstance=function(){return a.instance=a.instance||new a},a.instance=null,a}(),Z=function(){function a(a,b,c,d,e,f,g,h,i){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===i&&(i=0),this.x=a,this.y=b,this.width=c,this.height=d,this.edges=e,this.color=f,this.borderWidth=g,this.borderColor=h}d(a,"laya.webgl.shapes.BasePoly");var c=a.prototype;return b.imps(c,{"laya.webgl.shapes.IShape":!0}),c.getData=function(a,b,c){},c.rebuild=function(a){},c.setMatrix=function(a){},c.needUpdate=function(a){return!0},c.sector=function(a,b,c){var d=this.x,e=this.y,f=this.edges,g=(this.r1-this.r0)/f,h=this.width,i=this.height,j=this.color,k=(j>>16&255)/255,l=(j>>8&255)/255,m=(255&j)/255;a.push(d,e,k,l,m);for(var n=0;n<f+1;n++)a.push(d+Math.sin(g*n+this.r0)*h,e+Math.cos(g*n+this.r0)*i),a.push(k,l,m);for(n=0;n<f;n++)b.push(c,c+n+1,c+n+2)},c.createLine2=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=a.concat(),B=e,C=this.borderColor,D=(C>>16&255)/255,E=(C>>8&255)/255,F=(255&C)/255,G=A.length/2,H=d,I=c/2;i=A[0],j=A[1],k=A[2],l=A[3],o=-(j-l),p=i-k,z=Math.sqrt(o*o+p*p),o=o/z*I,p=p/z*I,B.push(i-o+this.x,j-p+this.y,D,E,F,i+o+this.x,j+p+this.y,D,E,F);for(var J=1;J<G-1;J++)i=A[2*(J-1)],j=A[2*(J-1)+1],k=A[2*J],l=A[2*J+1],m=A[2*(J+1)],n=A[2*(J+1)+1],o=-(j-l),p=i-k,z=Math.sqrt(o*o+p*p),o=o/z*I,p=p/z*I,q=-(l-n),r=k-m,z=Math.sqrt(q*q+r*r),q=q/z*I,r=r/z*I,s=-p+j-(-p+l),t=-o+k-(-o+i),u=(-o+i)*(-p+l)-(-o+k)*(-p+j),v=-r+n-(-r+l),w=-q+k-(-q+m),x=(-q+m)*(-r+l)-(-q+k)*(-r+n),y=s*w-v*t,Math.abs(y)<.1?(y+=10.1,B.push(k-o+this.x,l-p+this.y,D,E,F,k+o+this.x,l+p+this.y,D,E,F)):(g=(t*x-w*u)/y,h=(v*u-s*x)/y,(g-k)*(g-k)+(h-l)+(h-l),B.push(g+this.x,h+this.y,D,E,F,k-(g-k)+this.x,l-(h-l)+this.y,D,E,F));i=A[A.length-4],j=A[A.length-3],k=A[A.length-2],l=A[A.length-1],o=-(j-l),p=i-k,z=Math.sqrt(o*o+p*p),o=o/z*I,p=p/z*I,B.push(k-o+this.x,l-p+this.y,D,E,F,k+o+this.x,l+p+this.y,D,E,F);var K=f;for(J=1;J<K;J++)b.push(H+2*(J-1),H+2*(J-1)+1,H+2*J+1,H+2*J+1,H+2*J,H+2*(J-1));return B},c.createLine=function(a,b,c,d){var e=a.concat(),f=a,g=this.borderColor,h=(g>>16&255)/255,i=(g>>8&255)/255,j=(255&g)/255;e.splice(0,5);var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=e.length/5,F=d,G=c/2;m=e[0],n=e[1],o=e[5],p=e[6],s=-(n-p),t=m-o,D=Math.sqrt(s*s+t*t),s=s/D*G,t=t/D*G,f.push(m-s,n-t,h,i,j,m+s,n+t,h,i,j);for(var H=1;H<E-1;H++)m=e[5*(H-1)],n=e[5*(H-1)+1],o=e[5*H],p=e[5*H+1],q=e[5*(H+1)],r=e[5*(H+1)+1],s=-(n-p),t=m-o,D=Math.sqrt(s*s+t*t),s=s/D*G,t=t/D*G,u=-(p-r),v=o-q,D=Math.sqrt(u*u+v*v),u=u/D*G,v=v/D*G,w=-t+n-(-t+p),x=-s+o-(-s+m),y=(-s+m)*(-t+p)-(-s+o)*(-t+n),z=-v+r-(-v+p),A=-u+o-(-u+q),B=(-u+q)*(-v+p)-(-u+o)*(-v+r),C=w*A-z*x,Math.abs(C)<.1?(C+=10.1,f.push(o-s,p-t,h,i,j,o+s,p+t,h,i,j)):(k=(x*B-A*y)/C,l=(z*y-w*B)/C,(k-o)*(k-o)+(l-p)+(l-p),f.push(k,l,h,i,j,o-(k-o),p-(l-p),h,i,j));m=e[e.length-10],n=e[e.length-9],o=e[e.length-5],p=e[e.length-4],s=-(n-p),t=m-o,D=Math.sqrt(s*s+t*t),s=s/D*G,t=t/D*G,f.push(o-s,p-t,h,i,j,o+s,p+t,h,i,j);var I=this.edges+1;for(H=1;H<I;H++)b.push(F+2*(H-1),F+2*(H-1)+1,F+2*H+1,F+2*H+1,F+2*H,F+2*(H-1));return f},c.createLoopLine=function(a,b,c,d,e,f){var g=a.concat(),h=e?e:a,i=this.borderColor,j=(i>>16&255)/255,k=(i>>8&255)/255,l=(255&i)/255;g.splice(0,5);var m=[g[0],g[1]],n=[g[g.length-5],g[g.length-4]],o=n[0]+.5*(m[0]-n[0]),p=n[1]+.5*(m[1]-n[1]);g.unshift(o,p,0,0,0),g.push(o,p,0,0,0);var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=g.length/5,L=d,M=c/2;s=g[0],t=g[1],u=g[5],v=g[6],y=-(t-v),z=s-u,J=Math.sqrt(y*y+z*z),y=y/J*M,z=z/J*M,h.push(s-y,t-z,j,k,l,s+y,t+z,j,k,l);for(var N=1;N<K-1;N++)s=g[5*(N-1)],t=g[5*(N-1)+1],u=g[5*N],v=g[5*N+1],w=g[5*(N+1)],x=g[5*(N+1)+1],y=-(t-v),z=s-u,J=Math.sqrt(y*y+z*z),y=y/J*M,z=z/J*M,A=-(v-x),B=u-w,J=Math.sqrt(A*A+B*B),A=A/J*M,B=B/J*M,C=-z+t-(-z+v),D=-y+u-(-y+s),E=(-y+s)*(-z+v)-(-y+u)*(-z+t),F=-B+x-(-B+v),G=-A+u-(-A+w),H=(-A+w)*(-B+v)-(-A+u)*(-B+x),I=C*G-F*D,Math.abs(I)<.1?(I+=10.1,h.push(u-y,v-z,j,k,l,u+y,v+z,j,k,l)):(q=(D*H-G*E)/I,r=(F*E-C*H)/I,(q-u)*(q-u)+(r-v)+(r-v),h.push(q,r,j,k,l,u-(q-u),v-(r-v),j,k,l));f&&(b=f);var O=this.edges+1;for(N=1;N<O;N++)b.push(L+2*(N-1),L+2*(N-1)+1,L+2*N+1,L+2*N+1,L+2*N,L+2*(N-1));return b.push(L+2*(N-1),L+2*(N-1)+1,L+1,L+1,L,L+2*(N-1)),h},a}(),$=(function(){function a(a,b,c,d,e,f,g){this.lineWidth=a,this.lineColor=b,this.lineAlpha=c,this.fillColor=d,this.fillAlpha=e,this.shape=g,this.fill=f}d(a,"laya.webgl.shapes.GeometryData");var b=a.prototype;b.clone=function(){return new a(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},b.getIndexData=function(){return null},b.getVertexData=function(){return null},b.destroy=function(){this.shape=null},a}(),function(){function a(a){if(a instanceof Float32Array)this.points=a;else if(a instanceof Array){a.length;this.points=new Float32Array(a)}}d(a,"laya.webgl.shapes.Vertex");var c=a.prototype;b.imps(c,{"laya.webgl.shapes.IShape":!0}),c.getData=function(a,b,c){},c.needUpdate=function(a){return!1},c.rebuild=function(a){},c.setMatrix=function(a){},a}(),function(){function a(a){void 0===a&&(a=1e4),this._renderType=a}d(a,"laya.webgl.submit.Submit");var c=a.prototype;return b.imps(c,{"laya.webgl.submit.ISubmit":!0}),c.releaseRender=function(){var b=a._cache;b[b._length++]=this,this.shaderValue.release(),this._vb=null},c.getRenderType=function(){return this._renderType},c.renderSubmit=function(){if(0===this._numEle)return 1;var a=this.shaderValue.textureHost;if(a){var b=a.source;if(!a.bitmap||!b)return 1;this.shaderValue.texture=b}this._vb.bind_upload(this._ib);var c=ma.mainContext;return this.shaderValue.upload(),M.activeBlendFunction!==this._blendFn&&(c.enable(3042),this._blendFn(c),M.activeBlendFunction=this._blendFn),B.drawCall++,B.trianglesFaces+=this._numEle/3,c.drawElements(4,this._numEle,5123,this._startIdx),1},a.__init__=function(){var b=a.RENDERBASE=new a(-1);b.shaderValue=new qa(0,0),b.shaderValue.ALPHA=-1234},a.create=function(b,c,d,e,f){var g=a._cache._length?a._cache[--a._cache._length]:new a;null==d&&(d=g._selfVb||(g._selfVb=Ra.create(-1)),d.clear(),e=0),g._ib=c,g._vb=d,g._startIdx=e*ia.BYTES_PIDX,g._numEle=0;var h=b._nBlendType;g._blendFn=b._targets?M.targetFns[h]:M.fns[h],g.shaderValue=f,g.shaderValue.setValue(b._shader2D);var i=b._shader2D.filters;return i&&g.shaderValue.setFilters(i),g},a.createShape=function(b,c,d,e,f,g){var h=a._cache._length?a._cache[--a._cache._length]:new a;h._ib=c,h._vb=d,h._numEle=e,h._startIdx=f,h.shaderValue=g,h.shaderValue.setValue(b._shader2D);var i=b._nBlendType;return h._blendFn=b._targets?M.targetFns[i]:M.fns[i],h},a.TYPE_2D=1e4,a.TYPE_CANVAS=10003,a.TYPE_CMDSETRT=10004,a.TYPE_CUSTOM=10005,a.TYPE_BLURRT=10006,a.TYPE_CMDDESTORYPRERT=10007,a.TYPE_DISABLESTENCIL=10008,a.TYPE_OTHERIBVB=10009,a.TYPE_PRIMITIVE=10010,a.TYPE_RT=10011,a.TYPE_BLUR_RT=10012,a.TYPE_TARGET=10013,a.TYPE_CHANGE_VALUE=10014,a.TYPE_SHAPE=10015,a.TYPE_TEXTURE=10016,a.TYPE_FILLTEXTURE=10017,a.RENDERBASE=null,a._cache=(a._cache=[],a._cache._length=0,a._cache),a}()),_=function(){function a(){this.fun=null,this.args=null}d(a,"laya.webgl.submit.SubmitCMD");var c=a.prototype;return b.imps(c,{"laya.webgl.submit.ISubmit":!0}),c.renderSubmit=function(){return this.fun.apply(null,this.args),1},c.getRenderType=function(){return 0},c.releaseRender=function(){var b=a._cache;b[b._length++]=this},a.create=function(b,c){var d=a._cache._length?a._cache[--a._cache._length]:new a;return d.fun=c,d.args=b,d},a._cache=(a._cache=[],a._cache._length=0,a._cache),a}(),aa=function(){function a(){this.variables={}}d(a,"laya.webgl.submit.SubmitCMDScope");var b=a.prototype;return b.getValue=function(a){return this.variables[a]},b.addValue=function(a,b){return this.variables[a]=b},b.setValue=function(a,b){return this.variables.hasOwnProperty(a)?this.variables[a]=b:null},b.clear=function(){for(var a in this.variables)delete this.variables[a]},b.recycle=function(){this.clear(),a.POOL.push(this)},a.create=function(){var b=a.POOL.pop();return b||(b=new a),b},a.POOL=[],a}(),ba=function(){function a(){this.offset=0,this.startIndex=0,this._mat=s.create()}d(a,"laya.webgl.submit.SubmitOtherIBVB");var c=a.prototype;return b.imps(c,{
"laya.webgl.submit.ISubmit":!0}),c.releaseRender=function(){var b=a._cache;b[b._length++]=this},c.getRenderType=function(){return 10009},c.renderSubmit=function(){var b=this._shaderValue.textureHost;if(b){var c=b.source;if(!b.bitmap||!c)return 1;this._shaderValue.texture=c}this._vb.bind_upload(this._ib);var d=ka.worldMatrix4,e=s.TEMP;s.mulPre(this._mat,d[0],d[1],d[4],d[5],d[12],d[13],e);var f=ka.worldMatrix4=a.tempMatrix4;f[0]=e.a,f[1]=e.b,f[4]=e.c,f[5]=e.d,f[12]=e.tx,f[13]=e.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var g=ma.mainContext;return M.activeBlendFunction!==this._blendFn&&(g.enable(3042),this._blendFn(g),M.activeBlendFunction=this._blendFn),B.drawCall++,B.trianglesFaces+=this._numEle/3,g.drawElements(4,this._numEle,5123,this.startIndex),ka.worldMatrix4=d,Aa.activeShader=null,1},a.create=function(b,c,d,e,f,g,h,i,j){void 0===j&&(j=0);var k=a._cache._length?a._cache[--a._cache._length]:new a;k._ib=d,k._vb=c,k._numEle=e,k._shader=f,k._shaderValue=g;var l=b._nBlendType;switch(k._blendFn=b._targets?M.targetFns[l]:M.fns[l],j){case 0:k.offset=0,k.startIndex=i/(ia.BYTES_PE*c.vertexStride)*1.5,k.startIndex*=ia.BYTES_PIDX;break;case 1:k.startIndex=h,k.offset=i}return k},a._cache=(a._cache=[],a._cache._length=0,a._cache),a.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a}(),ca=function(){function a(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new u,this.screenRect=new u}d(a,"laya.webgl.submit.SubmitScissor");var c=a.prototype;return b.imps(c,{"laya.webgl.submit.ISubmit":!0}),c._scissor=function(a,b,c,d){var e=ka.worldMatrix4,f=e[0],g=e[5],h=e[12],i=e[13];if(a=a*f+h,b=b*g+i,c*=f,d*=g,c<1||d<1)return!1;var j=a+c,k=b+d;a<0&&(a=0,c=j-a),b<0&&(b=0,d=k-b);var l=ka.worldClipRect;if(a=Math.max(a,l.x),b=Math.max(b,l.y),c=Math.min(j,l.right)-a,d=Math.min(k,l.bottom)-b,c<1||d<1)return!1;var m=ka.worldScissorTest;return this.screenRect.copyFrom(l),l.x=a,l.y=b,l.width=c,l.height=d,ka.worldScissorTest=!0,b=ka.height-b-d,ma.mainContext.scissor(a,b,c,d),ma.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),m?(b=ka.height-this.screenRect.y-this.screenRect.height,ma.mainContext.scissor(this.screenRect.x,b,this.screenRect.width,this.screenRect.height),ma.mainContext.enable(3089)):(ma.mainContext.disable(3089),ka.worldScissorTest=!1),l.copyFrom(this.screenRect),!0},c._scissorWithTagart=function(a,b,c,d){if(c<1||d<1)return!1;var e=a+c,f=b+d;a<0&&(a=0,c=e-a),b<0&&(b=0,d=f-b);var g=ka.worldClipRect;if(a=Math.max(a,g.x),b=Math.max(b,g.y),c=Math.min(e,g.right)-a,d=Math.min(f,g.bottom)-b,c<1||d<1)return!1;var h=ka.worldScissorTest;return this.screenRect.copyFrom(g),ka.worldScissorTest=!0,g.x=a,g.y=b,g.width=c,g.height=d,b=ka.height-b-d,ma.mainContext.scissor(a,b,c,d),ma.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),h?(b=ka.height-this.screenRect.y-this.screenRect.height,ma.mainContext.scissor(this.screenRect.x,b,this.screenRect.width,this.screenRect.height),ma.mainContext.enable(3089)):(ma.mainContext.disable(3089),ka.worldScissorTest=!1),g.copyFrom(this.screenRect),!0},c.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1?this.submitLength+1:(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height),this.submitLength+1)},c.getRenderType=function(){return 0},c.releaseRender=function(){var b=a._cache;b[b._length++]=this,this.context=null},a.create=function(b){var c=a._cache._length?a._cache[--a._cache._length]:new a;return c.context=b,c},a._cache=(a._cache=[],a._cache._length=0,a._cache),a}(),da=function(){function a(){this.step=0,this.blendMode=null,this.level=0}d(a,"laya.webgl.submit.SubmitStencil");var c=a.prototype;return b.imps(c,{"laya.webgl.submit.ISubmit":!0}),c.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6()}return 1},c.getRenderType=function(){return 0},c.releaseRender=function(){var b=a._cache;b[b._length++]=this},c.do1=function(){var a=ma.mainContext;a.enable(2960),a.clear(1024),a.colorMask(!1,!1,!1,!1),a.stencilFunc(514,this.level,255),a.stencilOp(7680,7680,7682)},c.do2=function(){var a=ma.mainContext;a.stencilFunc(514,this.level+1,255),a.colorMask(!0,!0,!0,!0),a.stencilOp(7680,7680,7680)},c.do3=function(){var a=ma.mainContext;a.colorMask(!0,!0,!0,!0),a.stencilOp(7680,7680,7680),a.clear(1024),a.disable(2960)},c.do4=function(){var a=ma.mainContext;a.enable(2960),a.clear(1024),a.colorMask(!1,!1,!1,!1),a.stencilFunc(519,this.level,255),a.stencilOp(7680,7680,5386)},c.do5=function(){var a=ma.mainContext;a.stencilFunc(514,255,255),a.colorMask(!0,!0,!0,!0),a.stencilOp(7680,7680,7680)},c.do6=function(){var a=ma.mainContext;M.targetFns[M.TOINT[this.blendMode]](a)},a.create=function(b){var c=a._cache._length?a._cache[--a._cache._length]:new a;return c.step=b,c},a._cache=(a._cache=[],a._cache._length=0,a._cache),a}(),ea=function(){function a(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}d(a,"laya.webgl.submit.SubmitTarget");var c=a.prototype;return b.imps(c,{"laya.webgl.submit.ISubmit":!0}),c.renderSubmit=function(){this._vb.bind_upload(this._ib);var a=this.scope.getValue(this.proName);return a&&(this.shaderValue.texture=a.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[a.width,a.height]),this.shaderValue.upload(),this.blend(),B.drawCall++,B.trianglesFaces+=this._numEle/3,ma.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},c.blend=function(){if(M.activeBlendFunction!==M.fns[this.blendType]){var a=ma.mainContext;a.enable(3042),M.fns[this.blendType](a),M.activeBlendFunction=M.fns[this.blendType]}},c.getRenderType=function(){return 0},c.releaseRender=function(){var b=a._cache;b[b._length++]=this},a.create=function(b,c,d,e,f,g){var h=a._cache._length?a._cache[--a._cache._length]:new a;return h._ib=c,h._vb=d,h.proName=g,h._startIdx=e*ia.BYTES_PIDX,h._numEle=0,h.blendType=b._nBlendType,h.shaderValue=f,h.shaderValue.setValue(b._shader2D),h},a._cache=(a._cache=[],a._cache._length=0,a._cache),a}(),fa=function(){function a(){this._sourceStr=null}d(a,"laya.webgl.text.CharSegment");var c=a.prototype;return b.imps(c,{"laya.webgl.text.ICharSegment":!0}),c.textToSpit=function(a){this._sourceStr=a},c.getChar=function(a){return this._sourceStr.charAt(a)},c.getCharCode=function(a){return this._sourceStr.charCodeAt(a)},c.length=function(){return this._sourceStr.length},a}(),ga=function(){function a(){}var c;return d(a,"laya.webgl.text.DrawText"),a.__init__=function(){a._charsTemp=[],a._drawValue=new c,a._charSeg=new fa},a.customCharSeg=function(b){a._charSeg=b},a.getChar=function(b,c,d){return a._charsCache[c]=Ja.createOneChar(b,d)},a._drawSlow=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q,r=a._drawValue.value(g,i,j,k,n,o),s=0,t=0,u=a._charsTemp,v=0,w=NaN;if(e)for(u.length=e.length,s=0,t=e.length;s<t;s++)q=e[s],w=q.charNum+r.txtID,u[s]=p=a._charsCache[w]||a.getChar(q.char,w,r),p.active();else{d instanceof laya.utils.WordText?a._charSeg.textToSpit(""+d):a._charSeg.textToSpit(d);var x=a._charSeg.length();for(u.length=x,s=0,t=x;s<t;s++)w=a._charSeg.getCharCode(s)+r.txtID,u[s]=p=a._charsCache[w]||a.getChar(a._charSeg.getChar(s),w,r),p.active(),v+=p.cw}var y=0;null!==h&&"left"!==h&&(y=-("center"==h?v/2:v));var z,A,B=NaN,C=0;if(e)for(s=0,t=u.length;s<t;s++)p=u[s],p.isSpace||(q=e[s],B=p.borderSize,z=p.texture,c._drawText(z,l+y+q.x*n-B,m+q.y*o-B,z.width,z.height,f,0,0,0,0));else{for(s=0,t=u.length;s<t;s++)p=u[s],p.isSpace||(B=p.borderSize,z=p.texture,c._drawText(z,l+y-B,m-B,z.width,z.height,f,0,0,0,0),b&&(A=b[C++],A||(A=b[C-1]=[]),A[0]=z,A[1]=y-B,A[2]=-B)),y+=p.cw;b&&(b.length=C)}},a._drawFast=function(a,b,c,d,e){for(var f,g,h=0,i=a.length;h<i;h++)g=a[h],f=g[0],f.active(),b._drawText(f,d+g[1],e+g[2],f.width,f.height,c,0,0,0,0)},a.drawText=function(c,d,e,f,g,h,i,j,k,m,n){if(!(d&&0===d.length||e&&0===e.length)){var o=f.a,p=f.d;(0!==f.b||0!==f.c)&&(o=p=1);var q=1!==o||1!==p;if(q&&b.stage.transform){var r=b.stage.transform;q=r.a===o&&r.d===p}else q=!1;if(q?(f=f.copyTo(pa._tmpMatrix),f.scale(1/o,1/p),f._checkTransform(),m*=o,n*=p):o=p=1,e)a._drawSlow(null,c,d,e,f,g,h,i,j,k,m,n,o,p);else{if(null===d.toUpperCase){var s=o+1e5*p,t=d;return void(t.changed||t.id!==s?(t.id=s,t.changed=!1,a._drawSlow(t.save,c,d,e,f,g,h,i,j,k,m,n,o,p)):a._drawFast(t.save,c,f,m,n))}var u=d+""+g+i+j+k+o+p+h,v=a._textsCache[u];v?a._drawFast(v,c,f,m,n):(a._textsCache.__length||(a._textsCache.__length=0),a._textsCache.__length>l.WebGLTextCacheCount&&(a._textsCache={},a._textsCache.__length=0,a._curPoolIndex=0),a._textCachesPool[a._curPoolIndex]?(v=a._textsCache[u]=a._textCachesPool[a._curPoolIndex],v.length=0):a._textCachesPool[a._curPoolIndex]=v=a._textsCache[u]=[],a._textsCache.__length++,a._curPoolIndex++,a._drawSlow(v,c,d,e,f,g,h,i,j,k,m,n,o,p))}}},a._charsTemp=null,a._textCachesPool=[],a._curPoolIndex=0,a._charsCache={},a._textsCache={},a._drawValue=null,a.d=[],a._charSeg=null,a.__init$=function(){c=function(){function a(){}return d(a,""),a.prototype.value=function(b,c,d,e,f,g){this.font=b,this.fillColor=c,this.borderColor=d,this.lineWidth=e,this.scaleX=f,this.scaleY=g;var h=""+b+f+g+e+c+d;return this.txtID=a._keymap[h],this.txtID||(this.txtID=1e-7*++a._keymapCount,a._keymap[h]=this.txtID),this},a.clear=function(){a._keymap={},a._keymapCount=1},a._keymap={},a._keymapCount=1,a}()},a}(),ha=function(){function a(a){this._index=0,this._size=14,this._italic=-2,this.setFont(a||"14px Arial")}d(a,"laya.webgl.text.FontInContext");var b=a.prototype;return b.setFont=function(a){this._words=a.split(" ");for(var b=0,c=this._words.length;b<c;b++)if(this._words[b].indexOf("px")>0){this._index=b;break}this._size=parseInt(this._words[this._index]),this._text=null,this._italic=-2},b.getItalic=function(){return this._italic===-2&&(this._italic=this.hasType("italic")),this._italic},b.hasType=function(a){for(var b=0,c=this._words.length;b<c;b++)if(this._words[b]===a)return b;return-1},b.removeType=function(a){for(var b=0,c=this._words.length;b<c;b++)if(this._words[b]===a){this._words.splice(b,1),this._index>b&&this._index--;break}this._text=null,this._italic=-2},b.copyTo=function(a){return a._text=this._text,a._size=this._size,a._index=this._index,a._words=this._words.slice(),a._italic=-2,a},b.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},e(0,b,"size",function(){return this._size},function(a){this._size=a,this._words[this._index]=a+"px",this._text=null}),a.create=function(b){var c=a._cache[b];return c?c:c=a._cache[b]=new a(b)},a.EMPTY=new a,a._cache={},a}(),ia=function(){function a(){}return d(a,"laya.webgl.utils.CONST3D2D"),a.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],a.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],a._TMPARRAY=[],a._OFFSETX=0,a._OFFSETY=0,c(a,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),a}(),ja=function(){function a(){}return d(a,"laya.webgl.utils.GlUtils"),a.make2DProjection=function(a,b,c){return[2/a,0,0,0,0,-2/b,0,0,0,0,2/c,0,-1,1,0,1]},a.fillIBQuadrangle=function(a,b){if(b>65535/4)throw Error("IBQuadrangle count:"+b+" must<:"+Math.floor(65535/4));b=Math.floor(b),a._resizeBuffer(6*(b+1)*2,!1),a.byteLength=a.bufferLength;for(var c=a.getUint16Array(),d=0,e=0;e<b;e++)c[d++]=4*e,c[d++]=4*e+2,c[d++]=4*e+1,c[d++]=4*e,c[d++]=4*e+3,c[d++]=4*e+2;return a.setNeedUpload(),!0},a.expandIBQuadrangle=function(b,c){b.bufferLength>=6*c*2||a.fillIBQuadrangle(b,c)},a.mathCeilPowerOfTwo=function(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,++a},a.fillQuadrangleImgVb=function(a,b,c,d,e,f,g,h){"use strict";var i=16+(a._byteLength>>2);a.byteLength=i<<2;var j=a.getFloat32Array();i-=16,j[i+2]=e[0],j[i+3]=e[1],j[i+6]=e[2],j[i+7]=e[3],j[i+10]=e[4],j[i+11]=e[5],j[i+14]=e[6],j[i+15]=e[7];var k=f.a,l=f.b,m=f.c,n=f.d;if(1!==k||0!==l||0!==m||1!==n){f.bTransform=!0;var o=f.tx+g,p=f.ty+h;j[i]=(d[0]+b)*k+(d[1]+c)*m+o,j[i+1]=(d[0]+b)*l+(d[1]+c)*n+p,j[i+4]=(d[2]+b)*k+(d[3]+c)*m+o,j[i+5]=(d[2]+b)*l+(d[3]+c)*n+p,j[i+8]=(d[4]+b)*k+(d[5]+c)*m+o,j[i+9]=(d[4]+b)*l+(d[5]+c)*n+p,j[i+12]=(d[6]+b)*k+(d[7]+c)*m+o,j[i+13]=(d[6]+b)*l+(d[7]+c)*n+p}else f.bTransform=!1,b+=f.tx+g,c+=f.ty+h,j[i]=b+d[0],j[i+1]=c+d[1],j[i+4]=b+d[2],j[i+5]=c+d[3],j[i+8]=b+d[4],j[i+9]=c+d[5],j[i+12]=b+d[6],j[i+13]=c+d[7];return a._upload=!0,!0},a.fillTranglesVB=function(a,b,c,d,e,f,g){"use strict";var h=(a._byteLength>>2)+d.length;a.byteLength=h<<2;var i=a.getFloat32Array();h-=d.length;for(var j=d.length,k=e.a,l=e.b,m=e.c,n=e.d,o=0;o<j;o+=4)if(i[h+o+2]=d[o+2],i[h+o+3]=d[o+3],1!==k||0!==l||0!==m||1!==n){e.bTransform=!0;var p=e.tx+f,q=e.ty+g;i[h+o]=(d[o]+b)*k+(d[o+1]+c)*m+p,i[h+o+1]=(d[o]+b)*l+(d[o+1]+c)*n+q}else e.bTransform=!1,b+=e.tx+f,c+=e.ty+g,i[h+o]=b+d[o],i[h+o+1]=c+d[o+1];return a._upload=!0,!0},a.copyPreImgVb=function(a,b,c){var d=a._byteLength>>2;a.byteLength=d+16<<2;for(var e=a.getFloat32Array(),f=0,g=d-16;f<4;f++)e[d]=e[g]+b,++d,++g,e[d]=e[g]+c,++d,++g,e[d]=e[g],++d,++g,e[d]=e[g],++d,++g;a._upload=!0},a.fillRectImgVb=function(a,b,c,d,e,f,g,h,i,j,k,l,m){void 0===m&&(m=!1);var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=1,E=h.a,F=h.b,G=h.c,H=h.d,I=b.width<99999999;if(1!==E||0!==F||0!==G||1!==H?(h.bTransform=!0,0===F&&0===G&&(D=23,v=e+c,w=f+d,x=h.tx+i,y=h.ty+j,n=E*c+x,p=E*v+x,o=H*d+y,q=H*w+y)):(D=23,h.bTransform=!1,n=c+h.tx+i,p=n+e,o=d+h.ty+j,q=o+f),I&&(r=b.x,s=b.y,t=b.width+r,u=b.height+s),1!==D&&(Math.min(n,p)>=t||Math.min(o,q)>=u||Math.max(p,n)<=r||Math.max(q,o)<=s))return!1;var J=a._byteLength>>2;a.byteLength=J+16<<2;var K=a.getFloat32Array();switch(K[J+2]=g[0],K[J+3]=g[1],K[J+6]=g[2],K[J+7]=g[3],K[J+10]=g[4],K[J+11]=g[5],K[J+14]=g[6],K[J+15]=g[7],D){case 1:x=h.tx+i,y=h.ty+j,v=e+c,w=f+d;var L=c,M=d,N=E*L,O=G*M,P=H*M,Q=F*L,R=E*v,S=G*w,T=H*w,U=F*v;m?(z=N+O+x,B=Math.round(z)-z,A=P+Q+y,C=Math.round(A)-A,K[J]=z+B,K[J+1]=A+C,K[J+4]=R+O+x+B,K[J+5]=P+U+y+C,K[J+8]=R+S+x+B,K[J+9]=T+U+y+C,K[J+12]=N+S+x+B,K[J+13]=T+Q+y+C):(K[J]=N+O+x,K[J+1]=P+Q+y,K[J+4]=R+O+x,K[J+5]=P+U+y,K[J+8]=R+S+x,K[J+9]=T+U+y,K[J+12]=N+S+x,K[J+13]=T+Q+y);break;case 23:m?(z=n+k,B=Math.round(z)-z,A=o,C=Math.round(A)-A,K[J]=z+B,K[J+1]=A+C,K[J+4]=p+k+B,K[J+5]=o+C,K[J+8]=p+B,K[J+9]=q+C,K[J+12]=n+B,K[J+13]=q+C):(K[J]=n+k,K[J+1]=o,K[J+4]=p+k,K[J+5]=o,K[J+8]=p,K[J+9]=q,K[J+12]=n,K[J+13]=q)}return a._upload=!0,!0},a.fillLineVb=function(b,c,d,e,f,g,h,i){"use strict";var j=.5*h,k=a._fillLineArray,l=-(e-g),m=d-f,n=Math.sqrt(l*l+m*m);l/=n,m/=n,l*=j,m*=j,k[0]=d-l,k[1]=e-m,k[4]=d+l,k[5]=e+m,k[8]=f+l,k[9]=g+m,k[12]=f-l,k[13]=g-m,i&&i.transformPointArray(k,k);var o=16+(b._byteLength>>2);return b.byteLength=o<<2,b.insertData(k,o-16),!0},a._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a}(),ka=(function(){function a(){}d(a,"laya.webgl.utils.MatirxArray"),a.ArrayMul=function(b,c,d){if(!b)return void a.copyArray(c,d);if(!c)return void a.copyArray(b,d);for(var e=NaN,f=NaN,g=NaN,h=NaN,i=0;i<4;i++)e=b[i],f=b[i+4],g=b[i+8],h=b[i+12],d[i]=e*c[0]+f*c[1]+g*c[2]+h*c[3],d[i+4]=e*c[4]+f*c[5]+g*c[6]+h*c[7],d[i+8]=e*c[8]+f*c[9]+g*c[10]+h*c[11],d[i+12]=e*c[12]+f*c[13]+g*c[14]+h*c[15]},a.copyArray=function(a,b){if(a&&b)for(var c=0;c<a.length;c++)b[c]=a[c]},a}(),function(){function a(){}return d(a,"laya.webgl.utils.RenderState2D"),a.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},a.mat2MatArray=function(a,b){var c=a,d=b;return d[0]=c.a,d[1]=c.b,d[4]=c.c,d[5]=c.d,d[12]=c.tx,d[13]=c.ty,b},a.restoreTempArray=function(){a.TEMPMAT4_ARRAY[0]=1,a.TEMPMAT4_ARRAY[1]=0,a.TEMPMAT4_ARRAY[4]=0,a.TEMPMAT4_ARRAY[5]=1,a.TEMPMAT4_ARRAY[12]=0,a.TEMPMAT4_ARRAY[13]=0},a.clear=function(){a.worldScissorTest=!1,a.worldShaderDefines=null,a.worldFilters=null,a.worldAlpha=1,a.worldClipRect.x=a.worldClipRect.y=0,a.worldClipRect.width=a.width,a.worldClipRect.height=a.height,a.curRenderTarget=null},a._MAXSIZE=99999999,a.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a.worldMatrix4=a.TEMPMAT4_ARRAY,a.worldAlpha=1,a.worldScissorTest=!1,a.worldFilters=null,a.worldShaderDefines=null,a.worldClipRect=new u(0,0,99999999,99999999),a.curRenderTarget=null,a.width=0,a.height=0,c(a,["worldMatrix",function(){return this.worldMatrix=new s}]),a}()),la=function(){function a(a,c,d,e,f){function g(a){for(var b=a.split(" "),c=[],d=0;d<b.length;d++)b[d].length>0&&c.push(b[d]);return c}function h(a){var c,d,e=0,h=0,i=0,j=new b(0,null,null,null),k=j,l=a.split("\n");for(e=0,h=l.length;e<h;e++){var m=l[e];if(m.indexOf("#ifdef")>=0)c=g(m),k=new b(1,c[1],"",k);else if(m.indexOf("#else")>=0)d=k.condition,k=new b(2,null,"",k.parent),k.condition=d;else if(m.indexOf("#endif")>=0)k=k.parent;else if(m.indexOf("#include")>=0){c=g(m);var n=c[1],o=n.charAt(0);'"'!==o&&"'"!==o||(n=n.substr(1,n.length-2),(i=n.lastIndexOf(o))>0&&(n=n.substr(0,i))),i=c[0].indexOf("?");var p=i>0?c[0].substr(i+1):c[0];new b(1,p,f[n],k)}else k.childs.length>0&&0===k.childs[k.childs.length-1].type?k.childs[k.childs.length-1].text+="\n"+m:new b(0,null,m,k)}return j}this._VSTXT=c,this._PSTXT=d,this._VS=h(c),this._PS=h(d),this._nameMap=e}var b;return d(a,"laya.webgl.utils.ShaderCompile"),a.prototype.createShader=function(a,b,c){var d={},e="";if(a)for(var f in a)e+="#define "+f+"\n",d[f]=!0;var g=this._VS.toscript(d,[]),h=this._PS.toscript(d,[]);return(c||Ma.create)(e+g.join("\n"),e+h.join("\n"),b,this._nameMap)},a.IFDEF_NO=0,a.IFDEF_YES=1,a.IFDEF_ELSE=2,a.__init$=function(){b=function(){function a(a,b,c,d){if(this.childs=[],this.type=a,this.text=c,this.parent=d,d&&d.childs.push(this),b){for(var e="",f=!1,g=!1,h=0,i=b.length;h<i;h++){var j=b.charAt(h);g="!&|() \t".indexOf(j)<0,f!=g&&(g&&(e+="this."),f=g),e+=j}this.condition=z.createShaderCondition(e)}}return d(a,""),a.prototype.toscript=function(a,b){if(0===this.type&&this.text&&b.push(this.text),this.childs.length<1&&!this.text)return b;if(0!==this.type){var c=!!this.condition.call(a);if(2===this.type&&(c=!c),!c)return b;this.text&&b.push(this.text)}return this.childs.length>0&&this.childs.forEach(function(c,d,e){c.toscript(a,b)}),b},a}()},a}(),ma=function(){function a(){}return d(a,"laya.webgl.WebGL"),a._arrayBufferSlice=function(){for(var a=this,b=a.length,c=new ArrayBuffer(a.length),d=0;d<b;d++)c[d]=a[d];return c},a._uint8ArraySlice=function(){for(var a=this,b=a.length,c=new Uint8Array(a.length),d=0;d<b;d++)c[d]=a[d];return c},a._float32ArraySlice=function(){for(var a=this,b=a.length,c=new Float32Array(a.length),d=0;d<b;d++)c[d]=a[d];return c},a._uint16ArraySlice=function(a){var b,c=arguments,d=this,e=0,f=0;if(0===c.length)for(e=d.length,b=new Uint16Array(e),f=0;f<e;f++)b[f]=d[f];else if(2===c.length){var g=c[0],h=c[1];if(h>g)for(e=h-g,b=new Uint16Array(e),f=g;f<h;f++)b[f-g]=d[f];else b=new Uint16Array(0)}return b},a.expandContext=function(){var a=m.prototype,b=CanvasRenderingContext2D.prototype;b.fillTrangles=a.fillTrangles,Na.__int__(null),b.setIBVB=function(a,b,c,d,e,f,g,h,i,j){void 0===i&&(i=0),void 0===j&&(j=0),null===c&&(this._ib=this._ib||Qa.QuadrangleIB,c=this._ib,ja.expandIBQuadrangle(c,d.byteLength/64+8)),this._setIBVB(a,b,c,d,e,f,g,h,i,j)},b.fillTrangles=function(a,b,c,d,e){this._curMat=this._curMat||s.create(),this._vb=this._vb||Ra.create(),this._ib||(this._ib=Qa.create(),ja.fillIBQuadrangle(this._ib,g/4));var f=this._vb,g=d.length>>4;ja.fillTranglesVB(f,b,c,d,e||this._curMat,0,0),ja.expandIBQuadrangle(this._ib,f.byteLength/64+8);var h=new qa(1,0);h.textureHost=a;var i=new Pa("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; void main() {vec4 color= texture2D(texture, v_texcoord); color.a*=1.0; gl_FragColor= color;}");f._vertType=3,this._setIBVB(b,c,this._ib,f,6*g,e,i,h,0,0)}},a.enable=function(){if(j.__init__(),v.isConchApp&&!v.isConchWebGL)return z.skinAniSprite=function(){return new X},a.expandContext(),!1;if(a.mainContext=a.ja(v._mainCanvas),null==a.mainContext)return!1;if(v.isWebGL)return!0;q.create=function(a,b){return new Sa(a,b)},r.create=function(a,b,c,d,e,f,g){return new La(a,b,c,d,e,f,g)},v.WebGL=a,v.isWebGL=!0,ga.__init__(),z.createRenderSprite=function(a,b){return new ra(a,b)},z.createWebGLContext2D=function(a){return new pa(a)},z.changeWebGLSize=function(a,b){laya.webgl.WebGL.onStageResize(a,b)},z.createGraphics=function(){return new oa};var c=z.createFilterAction;return z.createFilterAction=c?c:function(a){return new sa},z.clear=function(a){ka.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var c=v.context.ctx,d=0==c._submits._length||l.j?k.create(a)._color:b.stage.v;d&&c.clearBG(d[0],d[1],d[2],d[3]),ka.clear()},z.addToAtlas=function(a,c){void 0===c&&(c=!1);var d=a.bitmap;if(!v.optimizeTextureMemory(a.url,a))return void(d.enableMerageInAtlas=!1);b.__typeof(d,"laya.webgl.resource.IMergeAtlasBitmap")&&d.allowMerageInAtlas&&d.on("recovered",a,a.addTextureToAtlas)},K._enable(),z.beginFlush=function(){for(var a=K.instance,b=a.getAtlaserCount(),c=0;c<b;c++){var d=a.getAtlaserByIndex(c).texture;d._flashCacheImageNeedFlush&&z.flashFlushImage(d)}},z.drawToCanvas=function(a,b,c,d,e,f){var g=new Ba(c,d,6408,5121,0,!1);g.start(),g.clear(1,0,0,1),a.render(v.context,-e,ka.height-d-f),v.context.flush(),g.end();var h=g.getData(0,0,g.width,g.height);return g.dispose(),h},z.createFilterAction=function(a){var b;switch(a){case 32:b=new sa}return b},z.addTextureToAtlas=function(a){a._uvID++,K._atlasRestore++,a.bitmap.enableMerageInAtlas&&K.instance.addToAtlas(a)},z.getTexturePixels=function(a,b,c,d,e){v.context.ctx.clear();var f=new A;f.graphics.drawTexture(a,-b,-c);var g=Ba.create(d,e);g.start(),g.clear(0,0,0,0),f.render(v.context,0,0),v.context.ctx.flush(),g.end();for(var h=g.getData(0,0,d,e),i=[],j=0,k=e-1;k>=0;k--)for(var l=0;l<d;l++)j=4*(k*d+l),i.push(h[j]),i.push(h[j+1]),i.push(h[j+2]),i.push(h[j+3]);return i},z.skinAniSprite=function(){return new X},n._filterStart=function(a,b,c,d,e){var f=a.getValue("bounds"),g=Ba.create(f.width,f.height);if(g.start(),g.clear(0,0,0,0),a.addValue("src",g),a.addValue("ScissorTest",ka.worldScissorTest),ka.worldScissorTest){var h=new u;h.copyFrom(c.ctx._clipRect),a.addValue("clipRect",h),ka.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},n._filterEnd=function(a,b,c,d,e){var f=a.getValue("bounds");a.getValue("src").end();var g=Ba.create(f.width,f.height);g.start(),g.clear(0,0,0,0),a.addValue("out",g),b._set$P("_filterCache",g),b._set$P("_isHaveGlowFilter",a.getValue("_isHaveGlowFilter"))},n._EndTarget=function(a,b){if(a.getValue("src").recycle(),a.getValue("out").end(),a.getValue("ScissorTest")){ka.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),b.ctx.save();var c=a.getValue("clipRect");b.ctx.clipRect(c.x,c.y,c.width,c.height)}},n._useSrc=function(a){var b=a.getValue("out");b.end(),b=a.getValue("src"),b.start(),b.clear(0,0,0,0)},n._endSrc=function(a){a.getValue("src").end()},n._useOut=function(a){var b=a.getValue("src");b.end(),b=a.getValue("out"),b.start(),b.clear(0,0,0,0)},n._endOut=function(a){a.getValue("out").end()},n._recycleScope=function(a){a.recycle()},n._filter=function(a,b,c,d){var e=this._next;if(e){var f=a.filters,g=f.length;if(1==g&&32==f[0].type)return b.ctx.save(),b.ctx.setFilters([f[0]]),e._fun.call(e,a,b,c,d),void b.ctx.restore();var h,i,j=aa.create(),k=t.TEMP,l=b.ctx._getTransformMatrix(),m=s.create();l.copyTo(m);var o=0,p=0,q=!1,r=a._$P._filterCache?a._$P._filterCache:null;if(!r||a._repaint){q=a._isHaveGlowFilter(),j.addValue("_isHaveGlowFilter",q),q&&(o=50,p=25),i=new u,i.copyFrom(a.getSelfBounds()),i.x+=a.x,i.y+=a.y,i.x-=a.pivotX+4,i.y-=a.pivotY+4;var v=i.x,w=i.y;if(i.width+=o+8,i.height+=o+8,k.x=i.x*m.a+i.y*m.c,k.y=i.y*m.d+i.x*m.b,i.x=k.x,i.y=k.y,k.x=i.width*m.a+i.height*m.c,k.y=i.height*m.d+i.width*m.b,i.width=k.x,i.height=k.y,i.width<=0||i.height<=0)return;r&&r.recycle(),j.addValue("bounds",i);var x=_.create([j,a,b,0,0],n._filterStart);b.addRenderObject(x),b.ctx._renderKey=0,b.ctx._shader2D.glTexture=null;var y=a.x-v+p,z=a.y-w+p;e._fun.call(e,a,b,y,z),x=_.create([j,a,b,0,0],n._filterEnd),b.addRenderObject(x);for(var A=0;A<g;A++){0!=A&&(x=_.create([j],n._useSrc),b.addRenderObject(x),h=qa.create(1,0),s.TEMP.identity(),b.ctx.drawTarget(j,0,0,i.width,i.height,s.TEMP,"out",h,null,M.TOINT.overlay),x=_.create([j],n._useOut),b.addRenderObject(x));f[A].action.apply3d(j,a,b,0,0)}x=_.create([j,b],n._EndTarget),b.addRenderObject(x)}else{if(q=!!a._$P._isHaveGlowFilter&&a._$P._isHaveGlowFilter,q&&(o=50,p=25),i=a.getBounds(),i.width<=0||i.height<=0)return;i.width+=o,i.height+=o,k.x=i.x*m.a+i.y*m.c,k.y=i.y*m.d+i.x*m.b,i.x=k.x,i.y=k.y,k.x=i.width*m.a+i.height*m.c,k.y=i.height*m.d+i.width*m.b,i.width=k.x,i.height=k.y,j.addValue("out",r)}c=c-p-a.x,d=d-p-a.y,k.setTo(c,d),m.transformPoint(k),c=k.x+i.x,d=k.y+i.y,h=qa.create(1,0),s.TEMP.identity(),b.ctx.drawTarget(j,c,d,i.width,i.height,s.TEMP,"out",h,null,M.TOINT.overlay),x=_.create([j],n._recycleScope),b.addRenderObject(x),m.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=a._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=a._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=a._uint8ArraySlice),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=a._arrayBufferSlice),!0},a.ja=function(b){for(var c,d=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=0;e<4;e++){try{c=b.getContext(d[e],{stencil:l.i,alpha:l.isAlpha,antialias:l.isAntialias,premultipliedAlpha:l.premultipliedAlpha,j:l.j})}catch(a){}if(c)return 0!==e&&(a._isExperimentalWebgl=!0),c}return null},a.onStageResize=function(b,c){null!=a.mainContext&&(a.mainContext.viewport(0,0,b,c),ka.width=b,ka.height=c)},a.isExperimentalWebgl=function(){return a._isExperimentalWebgl},a.addRenderFinish=function(){(a._isExperimentalWebgl||v.isFlash)&&(z.endFinish=function(){v.context.ctx.finish()})},a.removeRenderFinish=function(){a._isExperimentalWebgl&&(z.endFinish=function(){})},a.onInvalidGLRes=function(){K.instance.freeAll(),y.releaseContentManagers(!0),a.doNodeRepaint(b.stage),a.mainContext.viewport(0,0,ka.width,ka.height),b.stage.event("devicelost")},a.doNodeRepaint=function(b){0==b.numChildren&&b.repaint();for(var c=0;c<b.numChildren;c++)a.doNodeRepaint(b.getChildAt(c))},a.init=function(b,c,d){a.mainCanvas=b,p._createContext=function(a){return new pa(a)},a._isExperimentalWebgl=a._isExperimentalWebgl&&(j.onWeiXin||j.onMQQBrowser),a.frameShaderHighPrecision=!1;var e=laya.webgl.WebGL.mainContext;try{e.getShaderPrecisionFormat(35632,36338).precision?a.frameShaderHighPrecision=!0:a.frameShaderHighPrecision=!1}catch(a){}if(e.deleteTexture1=e.deleteTexture,e.deleteTexture=function(a){a==na.curBindTexValue&&(na.curBindTexValue=null),e.deleteTexture1(a)},a.onStageResize(c,d),null==a.mainContext)throw Error("webGL getContext err!");D.__init__(),K.__init__(),ua.__init__(),$.__init__(),pa.__init__(),qa.__init__(),V.__init__(),Na.__int__(e),M._init_(e),v.isConchApp&&conch.setOnInvalidGLRes(a.onInvalidGLRes)},a.mainCanvas=null,a.mainContext=null,a.antialias=!0,a.frameShaderHighPrecision=!1,a._bg_null=[0,0,0,0],a._isExperimentalWebgl=!1,a}(),na=function(){function a(){}return d(a,"laya.webgl.WebGLContext"),a.UseProgram=function(b){return a._useProgram!==b&&(ma.mainContext.useProgram(b),a._useProgram=b,!0)},a.setDepthTest=function(b,c){c!==a._depthTest&&(a._depthTest=c,c?b.enable(2929):b.disable(2929))},a.setDepthMask=function(b,c){c!==a._depthMask&&(a._depthMask=c,b.depthMask(c))},a.setDepthFunc=function(b,c){c!==a._depthFunc&&(a._depthFunc=c,b.depthFunc(c))},a.setBlend=function(b,c){c!==a._blend&&(a._blend=c,c?b.enable(3042):b.disable(3042))},a.setBlendFunc=function(b,c,d){(c!==a._sFactor||d!==a._dFactor)&&(a._sFactor=c,a._dFactor=d,b.blendFunc(c,d))},a.setCullFace=function(b,c){c!==a._cullFace&&(a._cullFace=c,c?b.enable(2884):b.disable(2884))},a.setFrontFace=function(b,c){c!==a._frontFace&&(a._frontFace=c,b.frontFace(c))},a.bindTexture=function(b,c,d){b.bindTexture(c,d),a.curBindTexTarget=c,a.curBindTexValue=d},a.DEPTH_BUFFER_BIT=256,a.STENCIL_BUFFER_BIT=1024,a.COLOR_BUFFER_BIT=16384,a.POINTS=0,a.LINES=1,a.LINE_LOOP=2,a.LINE_STRIP=3,a.TRIANGLES=4,a.TRIANGLE_STRIP=5,a.TRIANGLE_FAN=6,a.ZERO=0,a.ONE=1,a.SRC_COLOR=768,a.ONE_MINUS_SRC_COLOR=769,a.SRC_ALPHA=770,a.ONE_MINUS_SRC_ALPHA=771,a.DST_ALPHA=772,a.ONE_MINUS_DST_ALPHA=773,a.DST_COLOR=774,a.ONE_MINUS_DST_COLOR=775,a.SRC_ALPHA_SATURATE=776,a.FUNC_ADD=32774,a.BLEND_EQUATION=32777,a.BLEND_EQUATION_RGB=32777,a.BLEND_EQUATION_ALPHA=34877,a.FUNC_SUBTRACT=32778,a.FUNC_REVERSE_SUBTRACT=32779,a.BLEND_DST_RGB=32968,a.BLEND_SRC_RGB=32969,a.BLEND_DST_ALPHA=32970,a.BLEND_SRC_ALPHA=32971,a.CONSTANT_COLOR=32769,a.ONE_MINUS_CONSTANT_COLOR=32770,a.CONSTANT_ALPHA=32771,a.ONE_MINUS_CONSTANT_ALPHA=32772,a.BLEND_COLOR=32773,a.ARRAY_BUFFER=34962,a.ELEMENT_ARRAY_BUFFER=34963,a.ARRAY_BUFFER_BINDING=34964,a.ELEMENT_ARRAY_BUFFER_BINDING=34965,a.STREAM_DRAW=35040,a.STATIC_DRAW=35044,a.DYNAMIC_DRAW=35048,a.BUFFER_SIZE=34660,a.BUFFER_USAGE=34661,a.CURRENT_VERTEX_ATTRIB=34342,a.FRONT=1028,a.BACK=1029,a.CULL_FACE=2884,a.FRONT_AND_BACK=1032,a.BLEND=3042,a.DITHER=3024,a.STENCIL_TEST=2960,a.DEPTH_TEST=2929,a.SCISSOR_TEST=3089,a.POLYGON_OFFSET_FILL=32823,a.SAMPLE_ALPHA_TO_COVERAGE=32926,a.SAMPLE_COVERAGE=32928,a.NO_ERROR=0,a.INVALID_ENUM=1280,a.INVALID_VALUE=1281,a.INVALID_OPERATION=1282,a.OUT_OF_MEMORY=1285,a.CW=2304,a.CCW=2305,a.LINE_WIDTH=2849,a.ALIASED_POINT_SIZE_RANGE=33901,a.ALIASED_LINE_WIDTH_RANGE=33902,a.CULL_FACE_MODE=2885,a.FRONT_FACE=2886,a.DEPTH_RANGE=2928,a.DEPTH_WRITEMASK=2930,a.DEPTH_CLEAR_VALUE=2931,a.DEPTH_FUNC=2932,a.STENCIL_CLEAR_VALUE=2961,a.STENCIL_FUNC=2962,a.STENCIL_FAIL=2964,a.STENCIL_PASS_DEPTH_FAIL=2965,a.STENCIL_PASS_DEPTH_PASS=2966,a.STENCIL_REF=2967,a.STENCIL_VALUE_MASK=2963,a.STENCIL_WRITEMASK=2968,a.STENCIL_BACK_FUNC=34816,a.STENCIL_BACK_FAIL=34817,a.STENCIL_BACK_PASS_DEPTH_FAIL=34818,a.STENCIL_BACK_PASS_DEPTH_PASS=34819,a.STENCIL_BACK_REF=36003,a.STENCIL_BACK_VALUE_MASK=36004,a.STENCIL_BACK_WRITEMASK=36005,a.VIEWPORT=2978,a.SCISSOR_BOX=3088,a.COLOR_CLEAR_VALUE=3106,a.COLOR_WRITEMASK=3107,a.UNPACK_ALIGNMENT=3317,a.PACK_ALIGNMENT=3333,a.MAX_TEXTURE_SIZE=3379,a.MAX_VIEWPORT_DIMS=3386,a.SUBPIXEL_BITS=3408,a.RED_BITS=3410,a.GREEN_BITS=3411,a.BLUE_BITS=3412,a.ALPHA_BITS=3413,a.DEPTH_BITS=3414,a.STENCIL_BITS=3415,a.POLYGON_OFFSET_UNITS=10752,a.POLYGON_OFFSET_FACTOR=32824,a.TEXTURE_BINDING_2D=32873,a.SAMPLE_BUFFERS=32936,a.SAMPLES=32937,a.SAMPLE_COVERAGE_VALUE=32938,a.SAMPLE_COVERAGE_INVERT=32939,a.NUM_COMPRESSED_TEXTURE_FORMATS=34466,a.COMPRESSED_TEXTURE_FORMATS=34467,a.DONT_CARE=4352,a.FASTEST=4353,a.NICEST=4354,a.GENERATE_MIPMAP_HINT=33170,a.BYTE=5120,a.UNSIGNED_BYTE=5121,a.SHORT=5122,a.UNSIGNED_SHORT=5123,a.INT=5124,a.UNSIGNED_INT=5125,a.FLOAT=5126,a.DEPTH_COMPONENT=6402,a.ALPHA=6406,a.RGB=6407,a.RGBA=6408,a.LUMINANCE=6409,a.LUMINANCE_ALPHA=6410,a.UNSIGNED_SHORT_4_4_4_4=32819,a.UNSIGNED_SHORT_5_5_5_1=32820,a.UNSIGNED_SHORT_5_6_5=33635,a.FRAGMENT_SHADER=35632,a.VERTEX_SHADER=35633,a.MAX_VERTEX_ATTRIBS=34921,a.MAX_VERTEX_UNIFORM_VECTORS=36347,a.MAX_VARYING_VECTORS=36348,a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,a.MAX_TEXTURE_IMAGE_UNITS=34930,a.MAX_FRAGMENT_UNIFORM_VECTORS=36349,a.SHADER_TYPE=35663,a.DELETE_STATUS=35712,a.LINK_STATUS=35714,
a.VALIDATE_STATUS=35715,a.ATTACHED_SHADERS=35717,a.ACTIVE_UNIFORMS=35718,a.ACTIVE_ATTRIBUTES=35721,a.SHADING_LANGUAGE_VERSION=35724,a.CURRENT_PROGRAM=35725,a.NEVER=512,a.LESS=513,a.EQUAL=514,a.LEQUAL=515,a.GREATER=516,a.NOTEQUAL=517,a.GEQUAL=518,a.ALWAYS=519,a.KEEP=7680,a.REPLACE=7681,a.INCR=7682,a.DECR=7683,a.INVERT=5386,a.INCR_WRAP=34055,a.DECR_WRAP=34056,a.VENDOR=7936,a.RENDERER=7937,a.VERSION=7938,a.NEAREST=9728,a.LINEAR=9729,a.NEAREST_MIPMAP_NEAREST=9984,a.LINEAR_MIPMAP_NEAREST=9985,a.NEAREST_MIPMAP_LINEAR=9986,a.LINEAR_MIPMAP_LINEAR=9987,a.TEXTURE_MAG_FILTER=10240,a.TEXTURE_MIN_FILTER=10241,a.TEXTURE_WRAP_S=10242,a.TEXTURE_WRAP_T=10243,a.TEXTURE_2D=3553,a.TEXTURE=5890,a.TEXTURE_CUBE_MAP=34067,a.TEXTURE_BINDING_CUBE_MAP=34068,a.TEXTURE_CUBE_MAP_POSITIVE_X=34069,a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,a.MAX_CUBE_MAP_TEXTURE_SIZE=34076,a.TEXTURE0=33984,a.TEXTURE1=33985,a.TEXTURE2=33986,a.TEXTURE3=33987,a.TEXTURE4=33988,a.TEXTURE5=33989,a.TEXTURE6=33990,a.TEXTURE7=33991,a.TEXTURE8=33992,a.TEXTURE9=33993,a.TEXTURE10=33994,a.TEXTURE11=33995,a.TEXTURE12=33996,a.TEXTURE13=33997,a.TEXTURE14=33998,a.TEXTURE15=33999,a.TEXTURE16=34e3,a.TEXTURE17=34001,a.TEXTURE18=34002,a.TEXTURE19=34003,a.TEXTURE20=34004,a.TEXTURE21=34005,a.TEXTURE22=34006,a.TEXTURE23=34007,a.TEXTURE24=34008,a.TEXTURE25=34009,a.TEXTURE26=34010,a.TEXTURE27=34011,a.TEXTURE28=34012,a.TEXTURE29=34013,a.TEXTURE30=34014,a.TEXTURE31=34015,a.ACTIVE_TEXTURE=34016,a.REPEAT=10497,a.CLAMP_TO_EDGE=33071,a.MIRRORED_REPEAT=33648,a.FLOAT_VEC2=35664,a.FLOAT_VEC3=35665,a.FLOAT_VEC4=35666,a.INT_VEC2=35667,a.INT_VEC3=35668,a.INT_VEC4=35669,a.BOOL=35670,a.BOOL_VEC2=35671,a.BOOL_VEC3=35672,a.BOOL_VEC4=35673,a.FLOAT_MAT2=35674,a.FLOAT_MAT3=35675,a.FLOAT_MAT4=35676,a.SAMPLER_2D=35678,a.SAMPLER_CUBE=35680,a.VERTEX_ATTRIB_ARRAY_ENABLED=34338,a.VERTEX_ATTRIB_ARRAY_SIZE=34339,a.VERTEX_ATTRIB_ARRAY_STRIDE=34340,a.VERTEX_ATTRIB_ARRAY_TYPE=34341,a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,a.VERTEX_ATTRIB_ARRAY_POINTER=34373,a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,a.COMPILE_STATUS=35713,a.LOW_FLOAT=36336,a.MEDIUM_FLOAT=36337,a.HIGH_FLOAT=36338,a.LOW_INT=36339,a.MEDIUM_INT=36340,a.HIGH_INT=36341,a.FRAMEBUFFER=36160,a.RENDERBUFFER=36161,a.RGBA4=32854,a.RGB5_A1=32855,a.RGB565=36194,a.DEPTH_COMPONENT16=33189,a.STENCIL_INDEX=6401,a.STENCIL_INDEX8=36168,a.DEPTH_STENCIL=34041,a.RENDERBUFFER_WIDTH=36162,a.RENDERBUFFER_HEIGHT=36163,a.RENDERBUFFER_INTERNAL_FORMAT=36164,a.RENDERBUFFER_RED_SIZE=36176,a.RENDERBUFFER_GREEN_SIZE=36177,a.RENDERBUFFER_BLUE_SIZE=36178,a.RENDERBUFFER_ALPHA_SIZE=36179,a.RENDERBUFFER_DEPTH_SIZE=36180,a.RENDERBUFFER_STENCIL_SIZE=36181,a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,a.COLOR_ATTACHMENT0=36064,a.DEPTH_ATTACHMENT=36096,a.STENCIL_ATTACHMENT=36128,a.DEPTH_STENCIL_ATTACHMENT=33306,a.NONE=0,a.FRAMEBUFFER_COMPLETE=36053,a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,a.FRAMEBUFFER_UNSUPPORTED=36061,a.FRAMEBUFFER_BINDING=36006,a.RENDERBUFFER_BINDING=36007,a.MAX_RENDERBUFFER_SIZE=34024,a.INVALID_FRAMEBUFFER_OPERATION=1286,a.UNPACK_FLIP_Y_WEBGL=37440,a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,a.CONTEXT_LOST_WEBGL=37442,a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,a.BROWSER_DEFAULT_WEBGL=37444,a._useProgram=null,a._depthTest=!0,a._depthMask=!0,a._blend=!1,a._cullFace=!1,a.curBindTexTarget=null,a.curBindTexValue=null,c(a,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),a}(),oa=function(a){function b(){b.__super.call(this)}d(b,"laya.webgl.display.GraphicsGL",a);var c=b.prototype;return c.setShader=function(a){this._saveToCmd(v.context._setShader,[a])},c.setIBVB=function(a,b,c,d,e,f){this._saveToCmd(v.context._setIBVB,[a,b,c,d,e,f])},c.drawParticle=function(a,b,c){var d=z.createParticleTemplate2D(c);d.x=a,d.y=b,this._saveToCmd(v.context._drawParticle,[d])},b}(o),pa=function(a){function f(a){this._x=0,this._y=0,this._id=++f._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=[],this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,f.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=f.MAXCLIPRECT,this._shader2D=new V,this.mOutPoint,this._canvas=a,this._curMat=s.create(),v.isFlash?(this._ib=Qa.create(35044),ja.fillIBQuadrangle(this._ib,16)):this._ib=Qa.QuadrangleIB,this._vb=Ra.create(-1),this._other=g.DEFAULT,this._save=[R.Create(this)],this._save.length=10,this.clear()}var g;d(f,"laya.webgl.canvas.WebGLContext2D",a);var i=f.prototype;return i.setIsMainContext=function(){this._isMain=!0},i.clearBG=function(a,b,c,d){var e=ma.mainContext;e.clearColor(a,b,c,d),e.clear(16384)},i._getSubmits=function(){return this._submits},i.destroy=function(){this._curMat&&this._curMat.destroy(),this._targets&&this._targets.destroy(),this._vb&&this._vb.releaseResource(),this._ib&&this._ib!=Qa.QuadrangleIB&&this._ib.releaseResource()},i.clear=function(){this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=g.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=f.MAXCLIPRECT,this._curSubmit=$.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=N.DEFAULT;for(var a=0,b=this._submits._length;a<b;a++)this._submits[a].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},i.size=function(a,b){this._width=a,this._height=b,this._targets&&this._targets.size(a,b),this._canvas.memorySize-=this._canvas.memorySize},i._getTransformMatrix=function(){return this._curMat},i.translate=function(a,b){0===a&&0===b||(T.save(this),this._curMat.bTransform&&(S.save(this),this._curMat.transformPointN(t.TEMP.setTo(a,b)),a=t.TEMP.x,b=t.TEMP.y),this._x+=a,this._y+=b)},i.save=function(){this._save[this._save._length++]=R.Create(this)},i.restore=function(){var a=this._save._length;if(!(a<1))for(var b=a-1;b>=0;b--){var c=this._save[b];if(c.restore(this),c.isSaveMark())return void(this._save._length=b)}},i._fillText=function(a,b,c,d,e,f,g,h,i){var j=this._shader2D,l=this._curSubmit.shaderValue,m=e?ha.create(e):this._other.font;if(K.enabled)j.ALPHA!==l.ALPHA&&(j.glTexture=null),ga.drawText(this,a,b,this._curMat,m,i||this._other.textAlign,f,g,h,c,d);else{var n=(this._shader2D.defines.getValue(),f?k.create(f)._color:j.colorAdd);j.ALPHA===l.ALPHA&&n===j.colorAdd&&l.colorAdd===j.colorAdd||(j.glTexture=null,j.colorAdd=n),ga.drawText(this,a,b,this._curMat,m,i||this._other.textAlign,f,g,h,c,d)}},i.fillWords=function(a,b,c,d,e){this._fillText(null,a,b,c,d,e,null,-1,null)},i.fillText=function(a,b,c,d,e,f){this._fillText(a,null,b,c,d,e,null,-1,f)},i.strokeText=function(a,b,c,d,e,f,g){this._fillText(a,null,b,c,d,null,e,f||1,g)},i.fillBorderText=function(a,b,c,d,e,f,g,h){this._fillBorderText(a,null,b,c,d,e,f,g,h)},i._fillBorderText=function(a,b,c,d,e,g,h,i,j){if(!K.enabled)return this._fillText(a,b,c,d,e,null,h,i||1,j),void this._fillText(a,b,c,d,e,g,null,-1,j);var k=this._shader2D,l=this._curSubmit.shaderValue;k.ALPHA!==l.ALPHA&&(k.glTexture=null);var m=e?(f._fontTemp.setFont(e),f._fontTemp):this._other.font;ga.drawText(this,a,b,this._curMat,m,j||this._other.textAlign,g,h,i||1,c,d)},i.fillBorderWords=function(a,b,c,d,e,f,g){this._fillBorderText(null,a,b,c,d,e,f,g,null)},i.fillRect=function(a,b,c,d,e){var f=this._vb;if(ja.fillRectImgVb(f,this._clipRect,a,b,c,d,E.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var g=this._shader2D.fillStyle;e&&(this._shader2D.fillStyle=N.create(e));var h=this._shader2D,i=this._curSubmit.shaderValue;if(h.fillStyle!==i.fillStyle||h.ALPHA!==i.ALPHA){h.glTexture=null;var j=this._curSubmit=$.create(this,this._ib,f,(f._byteLength-64)/32*3,qa.create(2,0));j.shaderValue.color=h.fillStyle._color._color,j.shaderValue.ALPHA=h.ALPHA,this._submits[this._submits._length++]=j}this._curSubmit._numEle+=6,this._shader2D.fillStyle=g}},i.fillTexture=function(a,c,d,e,f,g,h,i){if(!(a.loaded&&a.bitmap&&a.source))return void(this.sprite&&b.timer.callLater(this,this._repaintSprite));var j=this._vb,k=a.bitmap.width,l=a.bitmap.height,m=a.uv,n=h.x%a.width,o=h.y%a.height;if(k!=i.w||l!=i.h){if(!i.w&&!i.h)switch(i.oy=i.ox=0,g){case"repeat":i.width=e,i.height=f;break;case"repeat-x":i.width=e,o<0?a.height+o>f?i.height=f:i.height=a.height+o:(i.oy=o,a.height+o>f?i.height=f-o:i.height=a.height);break;case"repeat-y":n<0?a.width+n>e?i.width=e:i.width=a.width+n:(i.ox=n,a.width+n>e?i.width=e-n:i.width=a.width),i.height=f;break;default:i.width=e,i.height=f}i.w=k,i.h=l,i.uv=[0,0,i.width/k,0,i.width/k,i.height/l,0,i.height/l]}if(c+=i.ox,d+=i.oy,n-=i.ox,o-=i.oy,ja.fillRectImgVb(j,this._clipRect,c,d,i.width,i.height,i.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var p=za.create(this,this._ib,j,(j._byteLength-64)/32*3,qa.create(256,0));this._submits[this._submits._length++]=p;var q=p.shaderValue;q.textureHost=a;var r=m[0]*k,s=m[1]*l,t=(m[2]-m[0])*k,u=(m[5]-m[3])*l,v=-n/k,w=-o/l;q.u_TexRange[0]=r/k,q.u_TexRange[1]=t/k,q.u_TexRange[2]=s/l,q.u_TexRange[3]=u/l,q.u_offset[0]=v,q.u_offset[1]=w,K.enabled&&!this._isMain&&p.addTexture(a,(j._byteLength>>2)-16),this._curSubmit=p,p._renderType=10017,p._numEle+=6}},i.setShader=function(a){P.save(this,524288,this._shader2D,!0),this._shader2D.shader=a},i.setFilters=function(a){P.save(this,1048576,this._shader2D,!0),this._shader2D.filters=a,this._curSubmit=$.RENDERBASE,this._renderKey=0,this._drawCount++},i.drawTexture=function(a,b,c,d,e,f,g){this._drawTextureM(a,b,c,d,e,f,g,null,1)},i.addTextureVb=function(a,b,c){var d=this._curSubmit._vb||this._vb,e=d._byteLength>>2;d.byteLength=e+16<<2;for(var f=d.getFloat32Array(),g=0;g<16;g+=4)f[e++]=a[g]+b,f[e++]=a[g+1]+c,f[e++]=a[g+2],f[e++]=a[g+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),d._upload=!0},i.willDrawTexture=function(a,c){if(!(a.loaded&&a.bitmap&&a.source))return this.sprite&&b.timer.callLater(this,this._repaintSprite),0;var d=a.bitmap,e=d.id+this._shader2D.ALPHA*c+10016;if(e==this._renderKey)return e;var f=this._shader2D,g=f.ALPHA,h=this._curSubmit.shaderValue;f.ALPHA*=c,this._renderKey=e,this._drawCount++,f.glTexture=d;var i=this._vb,j=null,k=i._byteLength/32*3;return j=za.create(this,this._ib,i,k,qa.create(1,0)),this._submits[this._submits._length++]=j,j.shaderValue.textureHost=a,j._renderType=10016,j._preIsSameTextureShader=10016===this._curSubmit._renderType&&f.ALPHA===h.ALPHA,this._curSubmit=j,f.ALPHA=g,e},i.drawTextures=function(a,c,d,e){if(!(a.loaded&&a.bitmap&&a.source))return void(this.sprite&&b.timer.callLater(this,this._repaintSprite));var g=this._clipRect;if(this._clipRect=f.MAXCLIPRECT,!this._drawTextureM(a,c[0],c[1],a.width,a.height,d,e,null,1))return void alert("drawTextures err");if(this._clipRect=g,B.drawCall+=c.length/2,!(c.length<4)){for(var h=this._curSubmit._vb||this._vb,i=this._curMat.a,j=this._curMat.d,k=2,l=c.length;k<l;k+=2)ja.copyPreImgVb(h,(c[k]-c[k-2])*i,(c[k+1]-c[k-1])*j),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}},i._drawTextureM=function(a,c,d,e,f,g,h,i,j){if(!(a.loaded&&a.bitmap&&a.source))return this.sprite&&b.timer.callLater(this,this._repaintSprite),!1;var k=this._curSubmit._vb||this._vb,l=a.bitmap;c+=g,d+=h,this._drawCount++;var m=l.id+this._shader2D.ALPHA*j+10016;if(m!=this._renderKey){this._renderKey=m;var n=this._curSubmit.shaderValue,o=this._shader2D,p=o.ALPHA;o.ALPHA*=j,o.glTexture=l;var q=this._vb,r=null,s=q._byteLength/32*3;r=za.create(this,this._ib,q,s,qa.create(1,0)),this._submits[this._submits._length++]=r,r.shaderValue.textureHost=a,r._renderType=10016,r._preIsSameTextureShader=10016===this._curSubmit._renderType&&o.ALPHA===n.ALPHA,this._curSubmit=r,k=this._curSubmit._vb||this._vb,o.ALPHA=p}return!!ja.fillRectImgVb(k,this._clipRect,c,d,e||a.width,f||a.height,a.uv,i||this._curMat,this._x,this._y,0,0)&&(K.enabled&&!this._isMain&&this._curSubmit.addTexture(a,(k._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},i._repaintSprite=function(){this.sprite.repaint()},i._drawText=function(a,b,c,d,e,f,g,h,i,j){var k=a.bitmap;this._drawCount++;var l=k.id+this._shader2D.ALPHA+10016;if(l!=this._renderKey){this._renderKey=l;var m=this._curSubmit.shaderValue,n=this._shader2D;n.glTexture=k;var o=this._vb,p=null,q=o._byteLength/32*3;p=K.enabled?za.create(this,this._ib,o,q,qa.create(1,0)):za.create(this,this._ib,o,q,Oa.create()),p._preIsSameTextureShader=10016===this._curSubmit._renderType&&n.ALPHA===m.ALPHA,this._submits[this._submits._length++]=p,p.shaderValue.textureHost=a,p._renderType=10016,this._curSubmit=p}a.active();var r=this._curSubmit._vb||this._vb;ja.fillRectImgVb(r,this._clipRect,b+g,c+h,d||a.width,e||a.height,a.uv,f||this._curMat,this._x,this._y,i,j,!0)&&(K.enabled&&!this._isMain&&this._curSubmit.addTexture(a,(r._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},i.drawTextureWithTransform=function(a,b,c,d,e,g,h,i,j){var k=this._curMat,l=this._x,m=this._y;(0!==h||0!==i)&&(this._x=h*k.a+i*k.c,this._y=i*k.d+h*k.b),g&&k.bTransform?(s.mul(g,k,f._tmpMatrix),g=f._tmpMatrix,g._checkTransform()):(this._x+=k.tx,this._y+=k.ty),this._drawTextureM(a,b,c,d,e,0,0,g,j),this._x=l,this._y=m},i.fillQuadrangle=function(a,b,c,d,e){var f=this._curSubmit,g=this._vb,h=this._shader2D,i=f.shaderValue;if(this._renderKey=0,a.bitmap){var j=a.bitmap;h.glTexture==j&&h.ALPHA===i.ALPHA||(h.glTexture=j,f=this._curSubmit=$.create(this,this._ib,g,g._byteLength/32*3,qa.create(1,0)),f.shaderValue.glTexture=j,this._submits[this._submits._length++]=f),ja.fillQuadrangleImgVb(g,b,c,d,a.uv,e||this._curMat,this._x,this._y)}else f.shaderValue.fillStyle&&f.shaderValue.fillStyle.equal(a)&&h.ALPHA===i.ALPHA||(h.glTexture=null,f=this._curSubmit=$.create(this,this._ib,g,g._byteLength/32*3,qa.create(2,0)),f.shaderValue.defines.add(2),f.shaderValue.fillStyle=N.create(a),this._submits[this._submits._length++]=f),ja.fillQuadrangleImgVb(g,b,c,d,E.DEF_UV,e||this._curMat,this._x,this._y);f._numEle+=6},i.drawTexture2=function(a,b,c,d,e,g,h,i){var j=this._curMat;if(this._x=a*j.a+b*j.c,this._y=b*j.d+a*j.b,e&&(j.bTransform||e.bTransform?(s.mul(e,j,f._tmpMatrix),e=f._tmpMatrix):(this._x+=e.tx+j.tx,this._y+=e.ty+j.ty,e=s.EMPTY)),1!==g||h){var k=this._shader2D.ALPHA,l=this._nBlendType;this._shader2D.ALPHA=g,h&&(this._nBlendType=M.TOINT(h)),this._drawTextureM(i[0],i[1]-c,i[2]-d,i[3],i[4],0,0,e,1),this._shader2D.ALPHA=k,this._nBlendType=l}else this._drawTextureM(i[0],i[1]-c,i[2]-d,i[3],i[4],0,0,e,1);this._x=this._y=0},i.drawCanvas=function(a,b,c,d,e){var f=a.context;if(this._renderKey=0,f._targets)this._submits[this._submits._length++]=ya.create(f,0,null),this._curSubmit=$.RENDERBASE,f._targets.drawTo(this,b,c,d,e);else{var g=this._submits[this._submits._length++]=ya.create(f,this._shader2D.ALPHA,this._shader2D.filters),h=d/a.width,i=e/a.height,j=g._matrix;this._curMat.copyTo(j),1!=h&&1!=i&&j.scale(h,i);var k=j.tx,m=j.ty;j.tx=j.ty=0,j.transformPoint(t.TEMP.setTo(b,c)),j.translate(t.TEMP.x+k,t.TEMP.y+m),this._curSubmit=$.RENDERBASE}l.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=f._targets?"yellow":"green",this.strokeRect(b-1,c-1,d+2,e+2,1),this.strokeRect(b,c,d,e,1),this.restore())},i.drawTarget=function(a,b,c,d,e,f,g,h,i,j){void 0===j&&(j=-1);var k=this._vb;if(ja.fillRectImgVb(k,this._clipRect,b,c,d,e,i||E.DEF_UV,f||this._curMat,this._x,this._y,0,0)){this._renderKey=0;this._shader2D.glTexture=null;var l=(this._curSubmit.shaderValue,this._curSubmit=ea.create(this,this._ib,k,(k._byteLength-64)/32*3,h,g));l.blendType=j==-1?this._nBlendType:j,l.scope=a,this._submits[this._submits._length++]=l,this._curSubmit._numEle+=6}},i.transform=function(a,b,c,d,e,f){S.save(this),s.mul(s.TEMP.setTo(a,b,c,d,e,f),this._curMat,this._curMat),this._curMat._checkTransform()},i.setTransformByMatrix=function(a){a.copyTo(this._curMat)},i.transformByMatrix=function(a){S.save(this),s.mul(a,this._curMat,this._curMat),this._curMat._checkTransform()},i.rotate=function(a){S.save(this),this._curMat.rotateEx(a)},i.scale=function(a,b){S.save(this),this._curMat.scaleEx(a,b)},i.clipRect=function(a,b,c,d){c*=this._curMat.a,d*=this._curMat.d;var e=t.TEMP;this._curMat.transformPoint(e.setTo(a,b)),this._renderKey=0;var f=this._curSubmit=ca.create(this);this._submits[this._submits._length++]=f,f.submitIndex=this._submits._length,f.submitLength=9999999,Q.save(this,f);var g=this._clipRect,h=g.x,i=g.y,j=e.x+c,k=e.y+d;h<e.x&&(g.x=e.x),i<e.y&&(g.y=e.y),g.width=Math.min(j,h+g.width)-g.x,g.height=Math.min(k,i+g.height)-g.y,this._shader2D.glTexture=null,f.clipRect.copyFrom(g),this._curSubmit=$.RENDERBASE},i.setIBVB=function(a,b,c,d,e,f,g,h,i,j,k){if(void 0===i&&(i=0),void 0===j&&(j=0),void 0===k&&(k=0),null===c){if(v.isFlash){var l=d;l._selfIB||(l._selfIB=Qa.create(35044)),l._selfIB.clear(),c=l._selfIB}else c=this._ib;ja.expandIBQuadrangle(c,d.byteLength/(4*d.vertexStride*4))}if(!h||!g)throw Error("setIBVB must input:shader shaderValues");var m=ba.create(this,d,c,e,g,h,i,j,k);f||(f=s.EMPTY),f.translate(a,b),s.mul(f,this._curMat,m._mat),f.translate(-a,-b),this._submits[this._submits._length++]=m,this._curSubmit=$.RENDERBASE,this._renderKey=0},i.addRenderObject=function(a){this._submits[this._submits._length++]=a},i.fillTrangles=function(a,b,c,d,e){var f=this._curSubmit,g=this._vb,h=this._shader2D,i=f.shaderValue,j=d.length>>4,k=a.bitmap;this._renderKey=0,h.glTexture==k&&h.ALPHA===i.ALPHA||(f=this._curSubmit=$.create(this,this._ib,g,g._byteLength/32*3,qa.create(1,0)),f.shaderValue.textureHost=a,this._submits[this._submits._length++]=f),ja.fillTranglesVB(g,b,c,d,e||this._curMat,this._x,this._y),f._numEle+=6*j},i.submitElement=function(a,b){var c=this._submits;for(b<0&&(b=c._length);a<b;)a+=c[a].renderSubmit()},i.finish=function(){ma.mainContext.finish()},i.flush=function(){var a=Math.max(this._vb.byteLength/64,this._maxNumEle/6)+8;if(a>this._ib.bufferLength/12&&ja.expandIBQuadrangle(this._ib,a),!this._isMain&&K.enabled&&K._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=K._atlasRestore;for(var b=this._submits,c=0,d=b._length;c<d;c++){var e=b[c];10016===e.getRenderType()&&e.checkTexture()}}return this.submitElement(0,this._submits._length),this._path&&this._path.reset(),Y.instance&&Y.getInstance().reset(),this._curSubmit=$.RENDERBASE,this._renderKey=0,this._submits._length},i.setPathId=function(a){if(this.mId=a,this.mId!=-1){this.mHaveKey=!1;var b=G.getInstance();b.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,b.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},i.movePath=function(a,b){var c=a,d=b;a=this._curMat.a*c+this._curMat.c*d+this._curMat.tx,b=this._curMat.b*c+this._curMat.d*d+this._curMat.ty,this.mX+=a,this.mY+=b},i.beginPath=function(){var a=this._getPath();a.tempArray.length=0,a.closePath=!1,this.mX=0,this.mY=0},i.closePath=function(){this._path.closePath=!0},i.fill=function(a){void 0===a&&(a=!1);var b=this._getPath();this.drawPoly(0,0,b.tempArray,this.fillStyle._color.numColor,0,0,a)},i.stroke=function(){var a=this._getPath();if(this.lineWidth>0){if(this.mId==-1)a.drawLine(0,0,a.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var b=G.getInstance().shapeLineDic[this.mId];b.rebuild(a.tempArray),a.setGeomtry(b)}else G.getInstance().addLine(this.mId,a.drawLine(0,0,a.tempArray,this.lineWidth,this.strokeStyle._color.numColor));a.update();var c=[this.mX,this.mY],d=$.createShape(this,a.ib,a.vb,a.count,a.offset,qa.create(4,0));d.shaderValue.ALPHA=this._shader2D.ALPHA,d.shaderValue.u_pos=c,d.shaderValue.u_mmat2=ka.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=d}},i.line=function(a,b,c,d,e,f){var g=this._curSubmit,h=this._vb;if(ja.fillLineVb(h,this._clipRect,a,b,c,d,e,f)){this._renderKey=0;var i=this._shader2D,j=g.shaderValue;i.strokeStyle===j.strokeStyle&&i.ALPHA===j.ALPHA||(i.glTexture=null,g=this._curSubmit=$.create(this,this._ib,h,(h._byteLength-64)/32*3,qa.create(2,0)),g.shaderValue.strokeStyle=i.strokeStyle,g.shaderValue.mainID=2,g.shaderValue.ALPHA=i.ALPHA,this._submits[this._submits._length++]=g),g._numEle+=6}},i.moveTo=function(a,b,c){void 0===c&&(c=!0);var d=this._getPath();if(c){var e=a,f=b;a=this._curMat.a*e+this._curMat.c*f,b=this._curMat.b*e+this._curMat.d*f}d.addPoint(a,b)},i.lineTo=function(a,b,c){void 0===c&&(c=!0);var d=this._getPath();if(c){var e=a,f=b;a=this._curMat.a*e+this._curMat.c*f,b=this._curMat.b*e+this._curMat.d*f}d.addPoint(a,b)},i.drawCurves=function(a,b,c){this.setPathId(-1),this.beginPath(),this.strokeStyle=c[3],this.lineWidth=c[4];var d=c[2];a+=c[0],b+=c[1],this.movePath(a,b),this.moveTo(d[0],d[1]);for(var e=2,f=d.length;e<f;)this.quadraticCurveTo(d[e++],d[e++],d[e++],d[e++]);this.stroke()},i.arcTo=function(a,b,c,d,e){if(this.mId==-1||!this.mHaveKey){var f=this._getPath(),g=f.getEndPointX(),h=f.getEndPointY(),i=NaN,j=NaN,k=NaN,l=NaN,m=NaN,n=NaN,o=NaN,p=NaN,q=NaN,r=NaN,s=!1,u=a,v=b;a=this._curMat.a*u+this._curMat.c*v,b=this._curMat.b*u+this._curMat.d*v,u=c,v=d,c=this._curMat.a*u+this._curMat.c*v,d=this._curMat.b*u+this._curMat.d*v,e=this._curMat.a*e+this._curMat.c*e,i=g-a,j=h-b,k=c-a,l=d-b,t.TEMP.setTo(i,j),t.TEMP.normalize(),i=t.TEMP.x,j=t.TEMP.y,t.TEMP.setTo(k,l),t.TEMP.normalize(),k=t.TEMP.x,l=t.TEMP.y,m=Math.acos(i*k+j*l);if((n=e/Math.tan(m/2))>1e4)return void this.lineTo(a,b);i*l-k*j<=0?(o=a+i*n+j*e,p=b+j*n-i*e,q=Math.atan2(i,-j),r=Math.atan2(-k,l),s=!1):(o=a+i*n-j*e,p=b+j*n+i*e,q=Math.atan2(-i,j),r=Math.atan2(k,-l),s=!0),this.arc(o,p,e,q,r,s,!1)}},i.arc=function(a,b,c,d,e,f,g){if(void 0===f&&(f=!1),void 0===g&&(g=!0),this.mId!=-1){var h=G.getInstance().shapeDic[this.mId];if(h&&this.mHaveKey&&!h.needUpdate(this._curMat))return;a=0,b=0}var i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0;if(j=e-d,f)if(Math.abs(j)>=2*Math.PI)j=2*-Math.PI;else for(;j>0;)j-=2*Math.PI;else if(Math.abs(j)>=2*Math.PI)j=2*Math.PI;else for(;j<0;)j+=2*Math.PI;r=c<101?Math.max(10,j*c/5):c<201?Math.max(10,j*c/20):Math.max(10,j*c/40),k=j/r/2,l=Math.abs(4/3*(1-Math.cos(k))/Math.sin(k)),f&&(l=-l);var s=this._getPath(),t=NaN,u=NaN;for(q=0;q<=r;q++)i=d+j*(q/r),m=Math.cos(i),n=Math.sin(i),o=a+m*c,p=b+n*c,g&&(t=o,u=p,o=this._curMat.a*t+this._curMat.c*u,p=this._curMat.b*t+this._curMat.d*u),o==this._path.getEndPointX()&&p==this._path.getEndPointY()||s.addPoint(o,p);m=Math.cos(e),n=Math.sin(e),o=a+m*c,p=b+n*c,g&&(t=o,u=p,o=this._curMat.a*t+this._curMat.c*u,p=this._curMat.b*t+this._curMat.d*u),o==this._path.getEndPointX()&&p==this._path.getEndPointY()||s.addPoint(o,p)},i.quadraticCurveTo=function(a,b,c,d){var e=h.I,f=c,g=d;c=this._curMat.a*f+this._curMat.c*g,d=this._curMat.b*f+this._curMat.d*g,f=a,g=b,a=this._curMat.a*f+this._curMat.c*g,b=this._curMat.b*f+this._curMat.d*g;for(var i=e.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),a,b,c,d],30,2),j=0,k=i.length/2;j<k;j++)this.lineTo(i[2*j],i[2*j+1],!1);this.lineTo(c,d,!1)},i.rect=function(a,b,c,d){this._other=this._other.make(),this._other.path||(this._other.path=new O),this._other.path.rect(a,b,c,d)},i.strokeRect=function(a,b,c,d,e){var f=.5*e;this.line(a-f,b,a+c+f,b,e,this._curMat),this.line(a+c,b,a+c,b+d,e,this._curMat),this.line(a,b,a,b+d,e,this._curMat),this.line(a-f,b+d,a+c+f,b+d,e,this._curMat)},i.clip=function(){},i.drawPoly=function(a,b,c,d,e,f,g){void 0===g&&(g=!1),this._renderKey=0,this._shader2D.glTexture=null;var h=this._getPath();if(this.mId==-1)h.polygon(a,b,c,d,e?e:1,f);else if(this.mHaveKey){var i=G.getInstance().shapeDic[this.mId];i.setMatrix(this._curMat),i.rebuild(h.tempArray),h.setGeomtry(i)}else{var j=h.polygon(a,b,c,d,e?e:1,f);G.getInstance().addShape(this.mId,j),j.setMatrix(this._curMat)}h.update();var k,l=[this.mX,this.mY];if(!g){var m=da.create(4);this.addRenderObject(m),k=$.createShape(this,h.ib,h.vb,h.count,h.offset,qa.create(4,0)),k.shaderValue.ALPHA=this._shader2D.ALPHA,k.shaderValue.u_pos=l,k.shaderValue.u_mmat2=ka.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=k,m=da.create(5),this.addRenderObject(m)}if(k=$.createShape(this,h.ib,h.vb,h.count,h.offset,qa.create(4,0)),k.shaderValue.ALPHA=this._shader2D.ALPHA,k.shaderValue.u_pos=l,k.shaderValue.u_mmat2=ka.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=k,g||(m=da.create(3),this.addRenderObject(m)),e>0){if(this.mHaveLineKey){var n=G.getInstance().shapeLineDic[this.mId];n.rebuild(h.tempArray),h.setGeomtry(n)}else G.getInstance().addShape(this.mId,h.drawLine(a,b,c,e,f));h.update(),k=$.createShape(this,h.ib,h.vb,h.count,h.offset,qa.create(4,0)),k.shaderValue.ALPHA=this._shader2D.ALPHA,k.shaderValue.u_mmat2=ka.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=k}},i.drawParticle=function(a,b,c){c.x=a,c.y=b,this._submits[this._submits._length++]=c},i._getPath=function(){return this._path||(this._path=new O)},e(0,i,"globalCompositeOperation",function(){return M.NAMES[this._nBlendType]},function(a){var b=M.TOINT[a];null==b||this._nBlendType===b||(P.save(this,65536,this,!0),this._curSubmit=$.RENDERBASE,this._renderKey=0,this._nBlendType=b)}),e(0,i,"strokeStyle",function(){return this._shader2D.strokeStyle},function(a){this._shader2D.strokeStyle.equal(a)||(P.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=N.create(a))}),e(0,i,"globalAlpha",function(){return this._shader2D.ALPHA},function(a){(a=Math.floor(1e3*a)/1e3)!=this._shader2D.ALPHA&&(P.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=a)}),e(0,i,"asBitmap",null,function(a){if(a){if(this._targets||(this._targets=new U),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.ia(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),e(0,i,"fillStyle",function(){return this._shader2D.fillStyle},function(a){this._shader2D.fillStyle.equal(a)||(P.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=N.create(a))}),e(0,i,"textAlign",function(){return this._other.textAlign},function(a){this._other.textAlign===a||(this._other=this._other.make(),P.save(this,32768,this._other,!1),this._other.textAlign=a)}),e(0,i,"lineWidth",function(){return this._other.lineWidth},function(a){this._other.lineWidth===a||(this._other=this._other.make(),P.save(this,256,this._other,!1),this._other.lineWidth=a)}),e(0,i,"textBaseline",function(){return this._other.textBaseline},function(a){this._other.textBaseline===a||(this._other=this._other.make(),P.save(this,16384,this._other,!1),this._other.textBaseline=a)}),e(0,i,"font",null,function(a){a!=""+this._other.font&&(this._other=this._other.make(),P.save(this,8,this._other,!1),this._other.font===ha.EMPTY?this._other.font=new ha(a):this._other.font.setFont(a))}),f.__init__=function(){g.DEFAULT=new g},f._SUBMITVBSIZE=32e3,f._MAXSIZE=99999999,f._RECTVBSIZE=16,f.MAXCLIPRECT=new u(0,0,99999999,99999999),f._COUNT=0,f._tmpMatrix=new s,c(f,["_fontTemp",function(){return this._fontTemp=new ha},"_drawStyleTemp",function(){return this._drawStyleTemp=new N(null)}]),f.__init$=function(){g=function(){function a(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=ha.EMPTY}d(a,"");var b=a.prototype;return b.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=ha.EMPTY},b.make=function(){return this===a.DEFAULT?new a:this},a.DEFAULT=null,a}()},f}(m),qa=function(a){function b(a,c){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,b.__super.call(this),this.defines=new ua,this.position=b._POSITION,this.mainID=a,this.subID=c,this.textureHost=null,this.texture=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=a|c,this._inClassCache=b._cache[this._cacheID],a>0&&!this._inClassCache&&(this._inClassCache=b._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}d(b,"laya.webgl.shader.d2.value.Value2D",a);var c=b.prototype;return c.setValue=function(a){},c.refresh=function(){var a=this.size;return a[0]=ka.width,a[1]=ka.height,this.alpha=this.ALPHA*ka.worldAlpha,this.mmat=ka.worldMatrix4,this},c._ShaderWithCompile=function(){return Ma.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,Pa.create)},c._withWorldShaderDefines=function(){var a=ka.worldShaderDefines,b=Ma.sharders[this.mainID|this.defines._value|a.getValue()];if(!b){var c,d,e={};c=this.defines.toNameDic();for(d in c)e[d]="";c=a.toNameDic();for(d in c)e[d]="";b=Ma.withCompile2D(0,this.mainID,e,this.mainID|this.defines._value|a.getValue(),Pa.create)}var f=ka.worldFilters;if(!f)return b;for(var g,h=f.length,i=0;i<h;i++)(g=f[i])&&g.action.setValue(this);return b},c.upload=function(){var a=ka;this.alpha=this.ALPHA*a.worldAlpha,ka.worldMatrix4!==ka.TEMPMAT4_ARRAY&&this.defines.add(128);var b,c=a.worldShaderDefines?this._withWorldShaderDefines():Ma.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=a.width,this.size[1]=a.height,this.mmat=a.worldMatrix4,Aa.activeShader!==c?(c._shaderValueWidth!==a.width||c._shaderValueHeight!==a.height?(c._shaderValueWidth=a.width,c._shaderValueHeight=a.height):b=c._params2dQuick2||c._make2dQuick2(),c.upload(this,b)):(c._shaderValueWidth!==a.width||c._shaderValueHeight!==a.height?(c._shaderValueWidth=a.width,c._shaderValueHeight=a.height):b=c._params2dQuick1||c._make2dQuick1(),c.upload(this,b))},c.setFilters=function(a){if(this.filters=a,a)for(var b,c=a.length,d=0;d<c;d++)(b=a[d])&&(this.defines.add(b.type),b.action.setValue(this))},c.clear=function(){this.defines.setValue(this.subID)},c.release=function(){this._inClassCache[this._inClassCache._length++]=this,this.fillStyle=null,this.strokeStyle=null,this.clear()},b._initone=function(a,c){b._typeClass[a]=c,b._cache[a]=[],b._cache[a]._length=0},b.__init__=function(){b._POSITION=[2,5126,!1,4*ia.BYTES_PE,0],b._TEXCOORD=[2,5126,!1,4*ia.BYTES_PE,2*ia.BYTES_PE],b._initone(2,Ea),b._initone(4,Ha),b._initone(256,Fa),b._initone(512,Da),b._initone(1,Ga),b._initone(65,Oa),b._initone(9,Ga)},b.create=function(a,c){var d=b._cache[a|c];return d._length?d[--d._length]:new b._typeClass[a|c](c)},b._POSITION=null,b._TEXCOORD=null,b._cache=[],b._typeClass=[],b.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b}(I),ra=function(a){function b(a,c){b.__super.call(this,a,c)}d(b,"laya.webgl.utils.RenderSprite3D",a);var e=b.prototype;return e.onCreate=function(a){switch(a){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},e._mask=function(a,c,d,e){var f,g,h=this._next,i=a.mask;if(i){c.ctx.save();var j=c.ctx.globalCompositeOperation,k=new u;if(k.copyFrom(i.getBounds()),k.width=Math.round(k.width),k.height=Math.round(k.height),k.x=Math.round(k.x),k.y=Math.round(k.y),k.width>0&&k.height>0){var l=aa.create();l.addValue("bounds",k),f=_.create([l,c],laya.webgl.utils.RenderSprite3D.tmpTarget),c.addRenderObject(f),i.render(c,-k.x,-k.y),f=_.create([l],laya.webgl.utils.RenderSprite3D.endTmpTarget),c.addRenderObject(f),c.ctx.save(),c.clipRect(d+k.x,e+k.y,k.width,k.height),h._fun.call(h,a,c,d,e),c.ctx.restore(),g=da.create(6),j=c.ctx.globalCompositeOperation,g.blendMode="mask",c.addRenderObject(g),s.TEMP.identity();var m=qa.create(1,0),n=E.INV_UV,o=k.width,p=k.height;(k.width<32||k.height<32)&&(n=b.tempUV,n[0]=0,n[1]=0,n[2]=k.width>=32?1:k.width/32,n[3]=0,n[4]=k.width>=32?1:k.width/32,n[5]=k.height>=32?1:k.height/32,n[6]=0,
n[7]=k.height>=32?1:k.height/32,k.width=k.width>=32?k.width:32,k.height=k.height>=32?k.height:32,n[1]*=-1,n[3]*=-1,n[5]*=-1,n[7]*=-1,n[1]+=1,n[3]+=1,n[5]+=1,n[7]+=1),c.ctx.drawTarget(l,d+k.x,e+k.y,o,p,s.TEMP,"tmpTarget",m,n,6),f=_.create([l],laya.webgl.utils.RenderSprite3D.recycleTarget),c.addRenderObject(f),g=da.create(6),g.blendMode=j,c.addRenderObject(g)}c.ctx.restore()}else h._fun.call(h,a,c,d,e)},e._blend=function(a,b,c,d){var e=a._style,f=this._next;e.blendMode?(b.ctx.save(),b.ctx.globalCompositeOperation=e.blendMode,f._fun.call(f,a,b,c,d),b.ctx.restore()):f._fun.call(f,a,b,c,d)},e._transform=function(a,b,c,d){"use strict";var e=a.transform,f=this._next;if(e&&f!=w.NORENDER){var g=b.ctx;a._style;e.tx=c,e.ty=d;var h=g._getTransformMatrix(),i=h.clone();s.mul(e,h,h),h._checkTransform(),e.tx=e.ty=0,f._fun.call(f,a,b,0,0),i.copyTo(h),i.destroy()}else f._fun.call(f,a,b,c,d)},b.tmpTarget=function(a,b){var c=a.getValue("bounds"),d=Ba.create(c.width,c.height);d.start(),d.clear(0,0,0,0),a.addValue("tmpTarget",d)},b.endTmpTarget=function(a){a.getValue("tmpTarget").end()},b.recycleTarget=function(a){a.getValue("tmpTarget").recycle(),a.recycle()},c(b,["tempUV",function(){return this.tempUV=Array(8)}]),b}(w),sa=function(a){function c(){this.data=null,c.__super.call(this)}d(c,"laya.filters.webgl.ColorFilterActionGL",a);var e=c.prototype;return b.imps(e,{"laya.filters.IFilterActionGL":!0}),e.setValue=function(a){a.colorMat=this.data._mat,a.colorAlpha=this.data._alpha},e.apply3d=function(a,b,c,d,e){var f=a.getValue("bounds"),g=qa.create(1,0);g.setFilters([this.data]);var h=s.TEMP;h.identity(),c.ctx.drawTarget(a,0,0,f.width,f.height,h,"src",g)},c}(H),ta=function(a){function b(a,c,d,e,f){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,b.__super.call(this,a,c,f),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey=[],this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new Ia,this._atlasCanvas.width=d,this._atlasCanvas.height=e,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}d(b,"laya.webgl.atlas.Atlaser",a);var c=b.prototype;return c.computeUVinAtlasTexture=function(a,b,c,d){var e=K.atlasTextureWidth,f=K.atlasTextureHeight,g=c/e,h=d/f,i=(c+a.bitmap.width)/e,j=(d+a.bitmap.height)/f,k=a.bitmap.width/e,l=a.bitmap.height/f;a.uv=[g+b[0]*k,h+b[1]*l,i-(1-b[2])*k,h+b[3]*l,i-(1-b[4])*k,j-(1-b[5])*l,g+b[6]*k,j-(1-b[7])*l]},c.addToAtlasTexture=function(a,b,c){a instanceof laya.webgl.resource.WebGLImage&&(this._InAtlasWebGLImagesKey.push(a),this._InAtlasWebGLImagesOffsetValue.push([b,c])),this._atlasCanvas.texSubImage2D(b,c,a.atlasSource),a.clearAtlasSource()},c.addToAtlas=function(a,b,c){var d=a.uv.slice(),e=a.bitmap;this._inAtlasTextureKey.push(a),this._inAtlasTextureOriUVValue.push(d),this._inAtlasTextureBitmapValue.push(e),this.computeUVinAtlasTexture(a,d,b,c),a.bitmap=this._atlasCanvas},c.clear=function(){for(var a=0,b=this._inAtlasTextureKey.length;a<b;a++)this._inAtlasTextureKey[a].bitmap=this._inAtlasTextureBitmapValue[a],this._inAtlasTextureKey[a].uv=this._inAtlasTextureOriUVValue[a],this._inAtlasTextureKey[a].bitmap.lock=!1,this._inAtlasTextureKey[a].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey.length=0,this._InAtlasWebGLImagesOffsetValue.length=0},c.dispose=function(){this.clear(),this._atlasCanvas.dispose()},e(0,c,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),e(0,c,"texture",function(){return this._atlasCanvas}),e(0,c,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),b}(J),ua=function(a){function b(){b.__super.call(this,b.__name2int,b.__int2name,b.__int2nameMap)}return d(b,"laya.webgl.shader.d2.ShaderDefines2D",a),b.__init__=function(){b.reg("TEXTURE2D",1),b.reg("COLOR2D",2),b.reg("PRIMITIVE",4),b.reg("GLOW_FILTER",8),b.reg("BLUR_FILTER",16),b.reg("COLOR_FILTER",32),b.reg("COLOR_ADD",64),b.reg("WORLDMAT",128),b.reg("FILLTEXTURE",256)},b.reg=function(a,c){W._reg(a,c,b.__name2int,b.__int2name)},b.toText=function(a,b,c){return W._toText(a,b,c)},b.toInt=function(a){return W._toInt(a,b.__name2int)},b.TEXTURE2D=1,b.COLOR2D=2,b.PRIMITIVE=4,b.FILTERGLOW=8,b.FILTERBLUR=16,b.FILTERCOLOR=32,b.COLORADD=64,b.WORLDMAT=128,b.FILLTEXTURE=256,b.SKINMESH=512,b.__name2int={},b.__int2name=[],b.__int2nameMap=[],b}(W),va=(function(a){function b(a,c,d,e,f,g,h){b.__super.call(this,a,c,d,e,40,f,g,h)}d(b,"laya.webgl.shapes.Ellipse",a),b}(Z),function(a){function b(a,c,d,e,f){this._points=[],this.rebuild(d),b.__super.call(this,a,c,0,0,0,f,e,f,0)}d(b,"laya.webgl.shapes.Line",a);var c=b.prototype;return c.rebuild=function(a){var b=a.length;b!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(b/2-1)),this.mFloat32Array=new Float32Array(5*b)),this._points.length=0;for(var c=NaN,d=NaN,e=-1,f=-1,g=a.length/2,h=0;h<g;h++)c=a[2*h],d=a[2*h+1],(Math.abs(e-c)>.01||Math.abs(f-d)>.01)&&this._points.push(c,d),e=c,f=d},c.getData=function(a,b,c){var d=[],e=[];this.borderWidth>0&&this.createLine2(this._points,d,this.borderWidth,c,e,this._points.length/2),this.mUint16Array.set(d,0),this.mFloat32Array.set(e,0),a.append(this.mUint16Array),b.append(this.mFloat32Array)},b}(Z)),wa=function(a){function b(a,c,d,e,f){this._points=[];for(var g=NaN,h=NaN,i=-1,j=-1,k=d.length/2-1,l=0;l<k;l++)g=d[2*l],h=d[2*l+1],(Math.abs(i-g)>.01||Math.abs(j-h)>.01)&&this._points.push(g,h),i=g,j=h;g=d[2*k],h=d[2*k+1],i=this._points[0],j=this._points[1],(Math.abs(i-g)>.01||Math.abs(j-h)>.01)&&this._points.push(g,h),b.__super.call(this,a,c,0,0,this._points.length/2,0,e,f)}d(b,"laya.webgl.shapes.LoopLine",a);var c=b.prototype;return c.getData=function(a,b,c){if(this.borderWidth>0){for(var d=this.color,e=(d>>16&255)/255,f=(d>>8&255)/255,g=(255&d)/255,h=[],i=0,j=0,k=[],l=Math.floor(this._points.length/2),m=0;m<l;m++)i=this._points[2*m],j=this._points[2*m+1],h.push(this.x+i,this.y+j,e,f,g);this.createLoopLine(h,k,this.borderWidth,c+h.length/5),a.append(new Uint16Array(k)),b.append(new Float32Array(h))}},c.createLoopLine=function(a,b,c,d,e,f){var g=(a.length,a.concat()),h=e?e:a,i=this.borderColor,j=(i>>16&255)/255,k=(i>>8&255)/255,l=(255&i)/255,m=[g[0],g[1]],n=[g[g.length-5],g[g.length-4]],o=n[0]+.5*(m[0]-n[0]),p=n[1]+.5*(m[1]-n[1]);g.unshift(o,p,0,0,0),g.push(o,p,0,0,0);var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=g.length/5,L=d,M=c/2;s=g[0],t=g[1],u=g[5],v=g[6],y=-(t-v),z=s-u,J=Math.sqrt(y*y+z*z),y=y/J*M,z=z/J*M,h.push(s-y,t-z,j,k,l,s+y,t+z,j,k,l);for(var N=1;N<K-1;N++)s=g[5*(N-1)],t=g[5*(N-1)+1],u=g[5*N],v=g[5*N+1],w=g[5*(N+1)],x=g[5*(N+1)+1],y=-(t-v),z=s-u,J=Math.sqrt(y*y+z*z),y=y/J*M,z=z/J*M,A=-(v-x),B=u-w,J=Math.sqrt(A*A+B*B),A=A/J*M,B=B/J*M,C=-z+t-(-z+v),D=-y+u-(-y+s),E=(-y+s)*(-z+v)-(-y+u)*(-z+t),F=-B+x-(-B+v),G=-A+u-(-A+w),H=(-A+w)*(-B+v)-(-A+u)*(-B+x),I=C*G-F*D,Math.abs(I)<.1?(I+=10.1,h.push(u-y,v-z,j,k,l,u+y,v+z,j,k,l)):(q=(D*H-G*E)/I,r=(F*E-C*H)/I,(q-u)*(q-u)+(r-v)+(r-v),h.push(q,r,j,k,l,u-(q-u),v-(r-v),j,k,l));f&&(b=f);var O=this.edges+1;for(N=1;N<O;N++)b.push(L+2*(N-1),L+2*(N-1)+1,L+2*N+1,L+2*N+1,L+2*N,L+2*(N-1));return b.push(L+2*(N-1),L+2*(N-1)+1,L+1,L+1,L,L+2*(N-1)),h},b}(Z),xa=function(a){function b(a,c,d,e,f,g){this._points=null,this._start=-1,this._repaint=!1,this._mat=s.create(),this._points=d.slice(0,d.length),b.__super.call(this,a,c,0,0,this._points.length/2,e,f,g)}d(b,"laya.webgl.shapes.Polygon",a);var c=b.prototype;return c.rebuild=function(a){this._repaint||(this._points.length=0,this._points=this._points.concat(a))},c.setMatrix=function(a){a.copyTo(this._mat)},c.needUpdate=function(a){return this._repaint=this._mat.a==a.a&&this._mat.b==a.b&&this._mat.c==a.c&&this._mat.d==a.d&&this._mat.tx==a.tx&&this._mat.ty==a.ty,!this._repaint},c.getData=function(a,b,c){var d,e=0,f=this._points,g=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=c){for(this._start=c,d=[],g=Math.floor(f.length/2),e=2;e<g;e++)d.push(c,c+e-1,c+e);this.mUint16Array=new Uint16Array(d)}}else{this._start=c,d=[];var h=[],i=this.color,j=(i>>16&255)/255,k=(i>>8&255)/255,l=(255&i)/255;for(g=Math.floor(f.length/2),e=0;e<g;e++)h.push(this.x+f[2*e],this.y+f[2*e+1],j,k,l);for(e=2;e<g;e++)d.push(c,c+e-1,c+e);this.mUint16Array=new Uint16Array(d),this.mFloat32Array=new Float32Array(h)}a.append(this.mUint16Array),b.append(this.mFloat32Array)},b}(Z),ya=function(a){function b(){this._matrix=new s,this._matrix4=ia.defaultMatrix4.concat(),b.__super.call(this,1e4),this.shaderValue=new qa(0,0)}d(b,"laya.webgl.submit.SubmitCanvas",a);var c=b.prototype;return c.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var a=ka.worldAlpha,b=ka.worldMatrix4,c=ka.worldMatrix,d=ka.worldFilters,e=ka.worldShaderDefines,f=this.shaderValue,g=this._matrix,h=this._matrix4,i=s.TEMP;return s.mul(g,c,i),h[0]=i.a,h[1]=i.b,h[4]=i.c,h[5]=i.d,h[12]=i.tx,h[13]=i.ty,ka.worldMatrix=i.clone(),ka.worldMatrix4=h,ka.worldAlpha=ka.worldAlpha*f.alpha,f.filters&&f.filters.length&&(ka.worldFilters=f.filters,ka.worldShaderDefines=f.defines),this._ctx_src.flush(),ka.worldAlpha=a,ka.worldMatrix4=b,ka.worldMatrix.destroy(),ka.worldMatrix=c,ka.worldFilters=d,ka.worldShaderDefines=e,1},c.releaseRender=function(){var a=b._cache;a[a._length++]=this},c.getRenderType=function(){return 10003},b.create=function(a,c,d){var e=b._cache._length?b._cache[--b._cache._length]:new b;e._ctx_src=a;var f=e.shaderValue;return f.alpha=c,f.defines.setValue(0),d&&d.length&&f.setFilters(d),e},b._cache=(b._cache=[],b._cache._length=0,b._cache),b}($),za=function(a){function b(a){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=[],this._texsID=[],this._vbPos=[],void 0===a&&(a=1e4),b.__super.call(this,a)}d(b,"laya.webgl.submit.SubmitTexture",a);var c=b.prototype;return c.releaseRender=function(){var a=b._cache;a[a._length++]=this,this.shaderValue.release(),this._preIsSameTextureShader=!1,this._vb=null,this._texs.length=0,this._vbPos.length=0,this._isSameTexture=!0},c.addTexture=function(a,b){this._texsID[this._texs.length]=a._uvID,this._texs.push(a),this._vbPos.push(b)},c.checkTexture=function(){if(this._texs.length<1)return void(this._isSameTexture=!0);var a=this.shaderValue.textureHost,b=a.bitmap;if(null!==b)for(var c=this._vb.getFloat32Array(),d=0,e=this._texs.length;d<e;d++){var f=this._texs[d];f.active();var g=f.uv;if(this._texsID[d]!==f._uvID){this._texsID[d]=f._uvID;var h=this._vbPos[d];c[h+2]=g[0],c[h+3]=g[1],c[h+6]=g[2],c[h+7]=g[3],c[h+10]=g[4],c[h+11]=g[5],c[h+14]=g[6],c[h+15]=g[7],this._vb.setNeedUpload()}f.bitmap!==b&&(this._isSameTexture=!1)}},c.renderSubmit=function(){if(0===this._numEle)return b._shaderSet=!1,1;var a=this.shaderValue.textureHost;if(a){var c=a.source;if(!a.bitmap||!c)return b._shaderSet=!1,1;this.shaderValue.texture=c}this._vb.bind_upload(this._ib);var d=ma.mainContext;if(M.activeBlendFunction!==this._blendFn&&(d.enable(3042),this._blendFn(d),M.activeBlendFunction=this._blendFn),B.drawCall++,B.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&Aa.activeShader&&b._shaderSet?Aa.activeShader.uploadTexture2D(this.shaderValue.texture):this.shaderValue.upload(),b._shaderSet=!0,this._texs.length>1&&!this._isSameTexture)for(var e=a.bitmap,f=0,g=Aa.activeShader,h=0,i=this._texs.length;h<i;h++){var j=this._texs[h];j.bitmap===e&&h+1!==i||(g.uploadTexture2D(j.source),d.drawElements(4,6*(h-f+1),5123,this._startIdx+6*f*ia.BYTES_PIDX),e=j.bitmap,f=h)}else d.drawElements(4,this._numEle,5123,this._startIdx);return 1},b.create=function(a,c,d,e,f){var g=b._cache._length?b._cache[--b._cache._length]:new b;null==d&&(d=g._selfVb||(g._selfVb=Ra.create(-1)),d.clear(),e=0),g._ib=c,g._vb=d,g._startIdx=e*ia.BYTES_PIDX,g._numEle=0;var h=a._nBlendType;g._blendFn=a._targets?M.targetFns[h]:M.fns[h],g.shaderValue=f,g.shaderValue.setValue(a._shader2D);var i=a._shader2D.filters;return i&&g.shaderValue.setFilters(i),g},b._cache=(b._cache=[],b._cache._length=0,b._cache),b._shaderSet=!0,b}($),Aa=function(a){function b(){b.__super.call(this)}return d(b,"laya.webgl.shader.BaseShader",a),b.activeShader=null,b.bindShader=null,b}(x),Ba=function(a){function c(a,b,d,e,f,g,h,i,j){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===d&&(d=6408),void 0===e&&(e=5121),void 0===f&&(f=34041),void 0===g&&(g=!1),void 0===h&&(h=!1),void 0===i&&(i=-1),void 0===j&&(j=-1),this._type=1,this._w=a,this._h=b,this._surfaceFormat=d,this._surfaceType=e,this._depthStencilFormat=f,this._mipMap=g,this._repeat=h,this._minFifter=i,this._magFifter=j,this._createWebGLRenderTarget(),this.bitmap.lock=!0,c.__super.call(this,this.bitmap,E.INV_UV)}d(c,"laya.webgl.resource.RenderTarget2D",a);var f=c.prototype;return b.imps(f,{"laya.resource.IDispose":!0}),f.getType=function(){return this._type},f.getTexture=function(){return this},f.size=function(a,b){this._w==a&&this._h==b||(this._w=a,this._h=b,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},f.release=function(){this.destroy()},f.recycle=function(){c.POOL.push(this)},f.start=function(){var a=ma.mainContext;return this._preRenderTarget=ka.curRenderTarget,ka.curRenderTarget=this,a.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(a.viewport(0,0,this._w,this._h),this._svWidth=ka.width,this._svHeight=ka.height,ka.width=this._w,ka.height=this._h,Aa.activeShader=null),this},f.clear=function(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1);var e=ma.mainContext;e.clearColor(a,b,c,d);var f=16384;switch(this._depthStencilFormat){case 33189:f|=256;break;case 36168:f|=1024;break;case 34041:f|=256,f|=1024}e.clear(f)},f.end=function(){var a=ma.mainContext;a.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,ka.curRenderTarget=this._preRenderTarget,1==this._type?(a.viewport(0,0,this._svWidth,this._svHeight),ka.width=this._svWidth,ka.height=this._svHeight,Aa.activeShader=null):a.viewport(0,0,b.stage.width,b.stage.height)},f.getData=function(a,b,c,d){var e=ma.mainContext;if(e.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===e.checkFramebufferStatus(36160)))return e.bindFramebuffer(36160,null),null;var f=new Uint8Array(this._w*this._h*4);return e.readPixels(a,b,c,d,this._surfaceFormat,this._surfaceType,f),e.bindFramebuffer(36160,null),f},f.destroy=function(b){void 0===b&&(b=!1),this._destroy||(this._loaded=!1,this.bitmap.dispose(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,a.prototype.destroy.call(this))},f.dispose=function(){},f._createWebGLRenderTarget=function(){this.bitmap=new Ka(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(a){this.event("recovered")})},e(0,f,"surfaceFormat",function(){return this._surfaceFormat}),e(0,f,"magFifter",function(){return this._magFifter}),e(0,f,"surfaceType",function(){return this._surfaceType}),e(0,f,"mipMap",function(){return this._mipMap}),e(0,f,"depthStencilFormat",function(){return this._depthStencilFormat}),e(0,f,"minFifter",function(){return this._minFifter}),e(0,f,"source",function(){return this._alreadyResolved?a.prototype._$get_source.call(this):null}),c.create=function(a,b,d,e,f,g,h,i,j){void 0===d&&(d=6408),void 0===e&&(e=5121),void 0===f&&(f=34041),void 0===g&&(g=!1),void 0===h&&(h=!1),void 0===i&&(i=-1),void 0===j&&(j=-1);var k=c.POOL.pop();return k||(k=new c(a,b)),k.bitmap&&k._w==a&&k._h==b&&k._surfaceFormat==d&&k._surfaceType==e&&k._depthStencilFormat==f&&k._mipMap==g&&k._repeat==h&&k._minFifter==i&&k._magFifter==j||(k._w=a,k._h=b,k._surfaceFormat=d,k._surfaceType=e,k._depthStencilFormat=f,k._mipMap=g,k._repeat=h,k._minFifter=i,k._magFifter=j,k.release(),k._createWebGLRenderTarget()),k},c.TYPE2D=1,c.TYPE3D=2,c.POOL=[],c}(E),Ca=function(a){function b(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,b.__super.call(this),b._gl=ma.mainContext}d(b,"laya.webgl.utils.Buffer",a);var c=b.prototype;return c._bind=function(){this.activeResource(),b._bindActive[this._bufferType]===this._glBuffer||(b._gl.bindBuffer(this._bufferType,b._bindActive[this._bufferType]=this._glBuffer),Aa.activeShader=null)},c.recreateResource=function(){this.startCreate(),this._glBuffer||(this._glBuffer=b._gl.createBuffer()),this.completeCreate()},c.detoryResource=function(){this._glBuffer&&(ma.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},c.dispose=function(){this.resourceManager.removeResource(this),a.prototype.dispose.call(this)},e(0,c,"byteLength",function(){return this._byteLength}),e(0,c,"bufferType",function(){return this._bufferType}),e(0,c,"bufferUsage",function(){return this._bufferUsage}),b._gl=null,b._bindActive={},b}(x),Da=function(a){function b(a){this.texcoord=null,this.offsetX=300,this.offsetY=0,b.__super.call(this,512,0);var c=8*ia.BYTES_PE;this.position=[2,5126,!1,c,0],this.texcoord=[2,5126,!1,c,2*ia.BYTES_PE],this.color=[4,5126,!1,c,4*ia.BYTES_PE]}return d(b,"laya.webgl.shader.d2.skinAnishader.SkinSV",a),b}(qa),Ea=function(a){function b(a){b.__super.call(this,2,0),this.color=[]}return d(b,"laya.webgl.shader.d2.value.Color2dSV",a),b.prototype.setValue=function(a){a.fillStyle&&(this.color=a.fillStyle._color._color),a.strokeStyle&&(this.color=a.strokeStyle._color._color)},b}(qa),Fa=function(a){function b(a){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=qa._TEXCOORD,b.__super.call(this,256,0)}d(b,"laya.webgl.shader.d2.value.FillTextureSV",a);var c=b.prototype;return c.setValue=function(a){this.ALPHA=a.ALPHA,a.filters&&this.setFilters(a.filters)},c.clear=function(){this.texture=null,this.shader=null,this.defines.setValue(0)},b}(qa),Ga=function(a){function b(a){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=qa._TEXCOORD,void 0===a&&(a=0),b.__super.call(this,1,a)}d(b,"laya.webgl.shader.d2.value.TextureSV",a);var c=b.prototype;return c.setValue=function(a){this.ALPHA=a.ALPHA,a.filters&&this.setFilters(a.filters)},c.clear=function(){this.texture=null,this.shader=null,this.defines.setValue(0)},b}(qa),Ha=function(a){function b(a){this.a_color=null,this.u_pos=[0,0],b.__super.call(this,4,0),this.position=[2,5126,!1,5*ia.BYTES_PE,0],this.a_color=[3,5126,!1,5*ia.BYTES_PE,2*ia.BYTES_PE]}return d(b,"laya.webgl.shader.d2.value.PrimitiveSV",a),b}(qa),Ia=function(a){function b(){this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,b.__super.call(this)}d(b,"laya.webgl.atlas.AtlasWebGLCanvas",a);var c=b.prototype;return c.recreateResource=function(){this.startCreate();var a=ma.mainContext,b=this._source=a.createTexture(),c=na.curBindTexTarget,d=na.curBindTexValue;na.bindTexture(a,3553,b),a.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),a.texParameteri(3553,10241,9729),a.texParameteri(3553,10240,9729),a.texParameteri(3553,10242,33071),a.texParameteri(3553,10243,33071),c&&d&&na.bindTexture(a,c,d),this.memorySize=this._w*this._h*4,this.completeCreate()},c.detoryResource=function(){this._source&&(ma.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},c.texSubImage2D=function(a,b,c){if(v.isFlash){this._flashCacheImage||(this._flashCacheImage=q.create(null),this._flashCacheImage.image.createCanvas(this._w,this._h));var d=c.bitmapdata;a-1>=0&&this._flashCacheImage.image.copyPixels(d,0,0,d.width-1,d.height,a,b),a+1<=this._w&&this._flashCacheImage.image.copyPixels(d,0,0,d.width+1,d.height,a,b),b-1>=0&&this._flashCacheImage.image.copyPixels(d,0,0,d.width,d.height-1,a,b),b+1<=this._h&&this._flashCacheImage.image.copyPixels(d,0,0,d.width+1,d.height,a,b),this._flashCacheImage.image.copyPixels(d,0,0,d.width,d.height,a,b),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var e=ma.mainContext,f=na.curBindTexTarget,g=na.curBindTexValue;na.bindTexture(e,3553,this._source),a-1>=0&&e.texSubImage2D(3553,0,a-1,b,6408,5121,c),a+1<=this._w&&e.texSubImage2D(3553,0,a+1,b,6408,5121,c),b-1>=0&&e.texSubImage2D(3553,0,a,b-1,6408,5121,c),b+1<=this._h&&e.texSubImage2D(3553,0,a,b+1,6408,5121,c),e.texSubImage2D(3553,0,a,b,6408,5121,c),f&&g&&na.bindTexture(e,f,g)}},c.texSubImage2DPixel=function(a,b,c,d,e){var f=ma.mainContext,g=na.curBindTexTarget,h=na.curBindTexValue;na.bindTexture(f,3553,this._source);var i=new Uint8Array(e.data);f.texSubImage2D(3553,0,a,b,c,d,6408,5121,i),g&&h&&na.bindTexture(f,g,h)},e(0,c,"width",a.prototype._$get_width,function(a){this._w=a}),e(0,c,"height",a.prototype._$get_height,function(a){this._h=a}),b}(i),Ja=(function(a){function b(a){this._is2D=!1;var c=this;if(b.__super.call(this),this._canvas=this,"2D"===a||"AUTO"===a&&!v.isWebGL){this._is2D=!0,this._canvas=this._source=j.createElement("canvas"),this.iscpuSource=!0;var d=this;d.getContext=function(a,b){if(c._ctx)return c._ctx;var e=c._ctx=c._canvas.getContext(a,b);return e&&(e._canvas=d,e.size=function(){}),e}}else this._canvas={}}d(b,"laya.webgl.resource.WebGLCanvas",a);var c=b.prototype;c.clear=function(){this._ctx&&this._ctx.clear()},c.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null},c._setContext=function(a){this._ctx=a},c.getContext=function(a,c){return this._ctx?this._ctx:this._ctx=b._createContext(this)},c.size=function(a,b){this._w==a&&this._h==b||(this._w=a,this._h=b,this._ctx&&this._ctx.size(a,b),this._canvas&&(this._canvas.height=b,this._canvas.width=a))},c.recreateResource=function(){this.startCreate(),this.createWebGlTexture(),this.completeCreate()},c.detoryResource=function(){this._source&&!this.iscpuSource&&(ma.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},c.createWebGlTexture=function(){var a=ma.mainContext;if(!this._canvas)throw"create GLTextur err:no data:"+this._canvas;var b=this._source=a.createTexture();this.iscpuSource=!1;var c=na.curBindTexTarget,d=na.curBindTexValue;na.bindTexture(a,3553,b),a.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),a.texParameteri(3553,10240,9729),a.texParameteri(3553,10241,9729),a.texParameteri(3553,10242,33071),a.texParameteri(3553,10243,33071),this.memorySize=this._w*this._h*4,c&&d&&na.bindTexture(a,c,d),this._canvas=null},c.texSubImage2D=function(a,b,c){var d=ma.mainContext,e=na.curBindTexTarget,f=na.curBindTexValue;na.bindTexture(d,3553,this._source),d.texSubImage2D(3553,0,b,c,6408,5121,a._source),e&&f&&na.bindTexture(d,e,f)},e(0,c,"canvas",function(){return this._canvas}),e(0,c,"context",function(){return this._ctx}),e(0,c,"asBitmap",null,function(a){this._ctx&&(this._ctx.asBitmap=a)}),b.create=function(a){return new b(a)},b._createContext=null,b}(i),function(a){function c(a,b){this.CborderSize=12,c.__super.call(this),this.char=a,this.isSpace=" "===a,this.xs=b.scaleX,this.ys=b.scaleY,this.font=""+b.font,this.fontSize=b.font.size,this.fillColor=b.fillColor,this.borderColor=b.borderColor,this.lineWidth=b.lineWidth;var d,e=v.isConchApp;e?(d=ConchTextCanvas,d._source=ConchTextCanvas,d._source.canvas=ConchTextCanvas):d=j.canvas.source,this.canvas=d,this._enableMerageInAtlas=!0,this._ctx=e?d:this.canvas.getContext("2d",void 0);var f=F.measureText(this.char,this.font);this.cw=f.width*this.xs,this.ch=(f.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new E(this)}d(c,"laya.webgl.resource.WebGLCharImage",a);var f=c.prototype;return b.imps(f,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),f.active=function(){this.texture.active()},f.recreateResource=function(){this.startCreate();var a=v.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),a){var b=this.fontSize;1==this.xs&&1==this.ys||(b=parseInt(b*(this.xs>this.ys?this.xs:this.ys)+""));var c="normal 100 "+b+"px Arial";this.borderColor&&(c+=" 1 "+this.borderColor),this._ctx.font=c,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else this._ctx.save(),this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):this.lineWidth===-1?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this._ctx.restore();this.borderSize=this.CborderSize,this.completeCreate()},f.onresize=function(a,b){if(this._w=a,this._h=b,!(this._w<K.atlasLimitWidth&&this._h<K.atlasLimitHeight))throw this._allowMerageInAtlas=!1,Error("文字尺寸超出大图合集限制！");this._allowMerageInAtlas=!0},f.clearAtlasSource=function(){},e(0,f,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),e(0,f,"atlasSource",function(){return this.canvas}),e(0,f,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(a){this._enableMerageInAtlas=a}),c.createOneChar=function(a,b){return new c(a,b)},c}(i)),Ka=function(a){function b(a,c,d,e,f,g,h,i,j){void 0===d&&(d=6408),void 0===e&&(e=5121),void 0===f&&(f=34041),void 0===g&&(g=!1),void 0===h&&(h=!1),void 0===i&&(i=-1),void 0===j&&(j=1),b.__super.call(this),this._w=a,this._h=c,this._surfaceFormat=d,this._surfaceType=e,this._depthStencilFormat=f,this._mipMap=g,this._repeat=h,this._minFifter=i,this._magFifter=j}d(b,"laya.webgl.resource.WebGLRenderTarget",a);var c=b.prototype;return c.recreateResource=function(){this.startCreate();var a=ma.mainContext;this._frameBuffer||(this._frameBuffer=a.createFramebuffer()),this._source||(this._source=a.createTexture());var b=na.curBindTexTarget,c=na.curBindTexValue;na.bindTexture(a,3553,this._source),a.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var d=this._minFifter,e=this._magFifter,f=this._repeat?10497:33071;if(g.isPOT(this._w,this._h)?(this._mipMap?d!==-1||(d=9987):d!==-1||(d=9729),e!==-1||(e=9729),a.texParameteri(3553,10241,d),a.texParameteri(3553,10240,e),a.texParameteri(3553,10242,f),a.texParameteri(3553,10243,f),this._mipMap&&a.generateMipmap(3553)):(d!==-1||(d=9729),e!==-1||(e=9729),a.texParameteri(3553,10241,d),a.texParameteri(3553,10240,e),a.texParameteri(3553,10242,33071),a.texParameteri(3553,10243,33071)),a.bindFramebuffer(36160,this._frameBuffer),a.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=a.createRenderbuffer()),a.bindRenderbuffer(36161,this._depthStencilBuffer),a.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}a.bindFramebuffer(36160,null),b&&c&&na.bindTexture(a,b,c),a.bindRenderbuffer(36161,null),this.memorySize=this._w*this._h*4,this.completeCreate()},c.detoryResource=function(){this._frameBuffer&&(ma.mainContext.deleteTexture(this._source),ma.mainContext.deleteFramebuffer(this._frameBuffer),ma.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},e(0,c,"depthStencilBuffer",function(){return this._depthStencilBuffer}),e(0,c,"frameBuffer",function(){return this._frameBuffer}),b}(i),La=function(a){function c(a,b,d,e,f,g,h){this.offsetX=0,this.offsetY=0,c.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=g,this.canvas=a,this._ctx=a.getContext("2d",void 0),this._w=e,this._h=f,this.offsetX=b,this.offsetY=d,this.src=h,this._enableMerageInAtlas=!0,K.enabled&&this._w<K.atlasLimitWidth&&this._h<K.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}d(c,"laya.webgl.resource.WebGLSubImage",a);var f=c.prototype;return b.imps(f,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),f.size=function(a,b){this._w=a,this._h=b,this._ctx&&this._ctx.size(a,b),this.canvas&&(this.canvas.height=b,this.canvas.width=a)},f.recreateResource=function(){this.startCreate(),this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},f.createWebGlTexture=function(){var a=ma.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var b=this._source=a.createTexture(),c=na.curBindTexTarget,d=na.curBindTexValue;na.bindTexture(a,3553,b),a.texImage2D(3553,0,6408,6408,5121,this.canvas);var e=this.minFifter,f=this.magFifter,h=this.repeat?10497:33071;g.isPOT(this.width,this.height)?(this.mipmap?e!==-1||(e=9987):e!==-1||(e=9729),f!==-1||(f=9729),a.texParameteri(3553,10240,f),a.texParameteri(3553,10241,e),a.texParameteri(3553,10242,h),a.texParameteri(3553,10243,h),this.mipmap&&a.generateMipmap(3553)):(e!==-1||(e=9729),f!==-1||(f=9729),a.texParameteri(3553,10241,e),a.texParameteri(3553,10240,f),a.texParameteri(3553,10242,33071),a.texParameteri(3553,10243,33071)),c&&d&&na.bindTexture(a,c,d),this.canvas=null,this.memorySize=this._w*this._h*4},f.detoryResource=function(){K.enabled&&this._allowMerageInAtlas||!this._source||(ma.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},f.clearAtlasSource=function(){},f.dispose=function(){this.resourceManager.removeResource(this),a.prototype.dispose.call(this)},e(0,f,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),e(0,f,"atlasSource",function(){return this.canvas}),e(0,f,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(a){this._allowMerageInAtlas=a}),c}(i),Ma=function(a){function b(a,c,d,e){if(this.customCompile=!1,this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,b.__super.call(this),!a||!c)throw"Shader Error";(v.isConchApp||v.isFlash)&&(this.customCompile=!0),this._id=++b._count,this._vs=a,this._ps=c,this._nameMap=e?e:{},null!=d&&(b.sharders[d]=this)}d(b,"laya.webgl.shader.Shader",a);var e=b.prototype;return e.recreateResource=function(){this.startCreate(),this._compile(),this.completeCreate(),this.memorySize=0},e.detoryResource=function(){ma.mainContext.deleteShader(this._vshader),ma.mainContext.deleteShader(this._pshader),ma.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},e._compile=function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var a,c=[this._vs,this._ps];this.customCompile&&(a=this._preGetParams(this._vs,this._ps));var d=ma.mainContext;if(this._program=d.createProgram(),this._vshader=b._createShader(d,c[0],35633),this._pshader=b._createShader(d,c[1],35632),d.attachShader(this._program,this._vshader),
d.attachShader(this._program,this._pshader),d.linkProgram(this._program),!this.customCompile&&!d.getProgramParameter(this._program,35714))throw d.getProgramInfoLog(this._program);var e,f,g=0,h=0,i=this.customCompile?a.attributes.length:d.getProgramParameter(this._program,35721);for(g=0;g<i;g++){var j=this.customCompile?a.attributes[g]:d.getActiveAttrib(this._program,g);f=d.getAttribLocation(this._program,j.name),e={vartype:"attribute",ivartype:0,attrib:j,location:f,name:j.name,type:j.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(e)}var k=this.customCompile?a.uniforms.length:d.getProgramParameter(this._program,35718);for(g=0;g<k;g++){var l=this.customCompile?a.uniforms[g]:d.getActiveUniform(this._program,g);f=d.getUniformLocation(this._program,l.name),e={vartype:"uniform",ivartype:1,attrib:j,location:f,name:l.name,type:l.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},e.name.indexOf("[0]")>0&&(e.name=e.name.substr(0,e.name.length-3),e.isArray=!0,e.location=d.getUniformLocation(this._program,e.name)),this._params.push(e)}for(g=0,h=this._params.length;g<h;g++)if(e=this._params[g],e.indexOfParams=g,e.index=1,e.value=[e.location,null],e.codename=e.name,e.name=this._nameMap[e.codename]?this._nameMap[e.codename]:e.codename,this._paramsMap[e.name]=e,e._this=this,e.uploadedValue=[],"attribute"!==e.vartype)switch(e.type){case 5124:e.fun=e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:e.fun=e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:e.fun=e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:e.fun=e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:e.fun=e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:e.fun=this._uniform_sampler2D;break;case 35680:e.fun=this._uniform_samplerCube;break;case 35676:e.fun=this._uniformMatrix4fv;break;case 35670:e.fun=this._uniform1i;break;case 35674:case 35675:throw Error("compile shader err!");default:throw Error("compile shader err!")}else e.fun=this._attribute}},e.getUniform=function(a){return this._paramsMap[a]},e._attribute=function(a,b){var c=ma.mainContext;return c.enableVertexAttribArray(a.location),c.vertexAttribPointer(a.location,b[0],b[1],b[2],b[3],b[4]+this._offset),2},e._uniform1f=function(a,b){var c=a.uploadedValue;return c[0]!==b?(ma.mainContext.uniform1f(a.location,c[0]=b),1):0},e._uniform1fv=function(a,b){if(b.length<4){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]||c[2]!==b[2]||c[3]!==b[3]?(ma.mainContext.uniform1fv(a.location,b),c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],1):0}return ma.mainContext.uniform1fv(a.location,b),1},e._uniform_vec2=function(a,b){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]?(ma.mainContext.uniform2f(a.location,c[0]=b[0],c[1]=b[1]),1):0},e._uniform_vec2v=function(a,b){if(b.length<2){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]||c[2]!==b[2]||c[3]!==b[3]?(ma.mainContext.uniform2fv(a.location,b),c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],1):0}return ma.mainContext.uniform2fv(a.location,b),1},e._uniform_vec3=function(a,b){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]||c[2]!==b[2]?(ma.mainContext.uniform3f(a.location,c[0]=b[0],c[1]=b[1],c[2]=b[2]),1):0},e._uniform_vec3v=function(a,b){return ma.mainContext.uniform3fv(a.location,b),1},e._uniform_vec4=function(a,b){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]||c[2]!==b[2]||c[3]!==b[3]?(ma.mainContext.uniform4f(a.location,c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3]),1):0},e._uniform_vec4v=function(a,b){return ma.mainContext.uniform4fv(a.location,b),1},e._uniformMatrix2fv=function(a,b){return ma.mainContext.uniformMatrix2fv(a.location,!1,b),1},e._uniformMatrix3fv=function(a,b){return ma.mainContext.uniformMatrix3fv(a.location,!1,b),1},e._uniformMatrix4fv=function(a,b){return ma.mainContext.uniformMatrix4fv(a.location,!1,b),1},e._uniform1i=function(a,b){var c=a.uploadedValue;return c[0]!==b?(ma.mainContext.uniform1i(a.location,c[0]=b),1):0},e._uniform1iv=function(a,b){return ma.mainContext.uniform1iv(a.location,b),1},e._uniform_ivec2=function(a,b){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]?(ma.mainContext.uniform2i(a.location,c[0]=b[0],c[1]=b[1]),1):0},e._uniform_ivec2v=function(a,b){return ma.mainContext.uniform2iv(a.location,b),1},e._uniform_vec3i=function(a,b){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]||c[2]!==b[2]?(ma.mainContext.uniform3i(a.location,c[0]=b[0],c[1]=b[1],c[2]=b[2]),1):0},e._uniform_vec3vi=function(a,b){return ma.mainContext.uniform3iv(a.location,b),1},e._uniform_vec4i=function(a,b){var c=a.uploadedValue;return c[0]!==b[0]||c[1]!==b[1]||c[2]!==b[2]||c[3]!==b[3]?(ma.mainContext.uniform4i(a.location,c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3]),1):0},e._uniform_vec4vi=function(a,b){return ma.mainContext.uniform4iv(a.location,b),1},e._uniform_sampler2D=function(a,c){var d=ma.mainContext,e=a.uploadedValue;return null==e[0]?(e[0]=this._curActTexIndex,d.uniform1i(a.location,this._curActTexIndex),d.activeTexture(b._TEXTURES[this._curActTexIndex]),na.bindTexture(d,3553,c),this._curActTexIndex++,1):(d.activeTexture(b._TEXTURES[e[0]]),na.bindTexture(d,3553,c),0)},e._uniform_samplerCube=function(a,c){var d=ma.mainContext,e=a.uploadedValue;return null==e[0]?(e[0]=this._curActTexIndex,d.uniform1i(a.location,this._curActTexIndex),d.activeTexture(b._TEXTURES[this._curActTexIndex]),na.bindTexture(d,34067,c),this._curActTexIndex++,1):(d.activeTexture(b._TEXTURES[e[0]]),na.bindTexture(d,34067,c),0)},e._noSetValue=function(a){console.log("no....:"+a.name)},e.uploadOne=function(a,b){this.activeResource(),na.UseProgram(this._program);var c=this._paramsMap[a];c.fun.call(this,c,b)},e.uploadTexture2D=function(a){B.shaderCall++;var b=ma.mainContext;b.activeTexture(33984),na.bindTexture(b,3553,a)},e.upload=function(a,b){Aa.activeShader=this,Aa.bindShader=this,this.activeResource(),na.UseProgram(this._program),this._reCompile?(b=this._params,this._reCompile=!1):b=b||this._params;for(var c,d,e=b.length,f=0,g=0;g<e;g++)c=b[g],null!==(d=a[c.name])&&(f+=c.fun.call(this,c,d));B.shaderCall+=f},e.uploadArray=function(a,b,c){Aa.activeShader=this,Aa.bindShader=this,this.activeResource(),na.UseProgram(this._program);for(var d,e,f=(this._params,0),g=b-2;g>=0;g-=2)(e=this._paramsMap[a[g]])&&null!=(d=a[g+1])&&(c&&c[e.name]&&c[e.name].bind(),f+=e.fun.call(this,e,d));B.shaderCall+=f},e.getParams=function(){return this._params},e._preGetParams=function(a,b){var c=[a,b],d={},e=[],f=[],g={},h=[];d.attributes=e,d.uniforms=f,d.defines=g;for(var i=RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),j=RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),k=0,l=0,m=0;m<2;m++){c[m]=c[m].replace(i,"");var n,o=c[m].match(j);for(k=0,l=o.length;k<l;k++){var p=o[k];if("attribute"==p||"uniform"==p)k=this.parseOne(e,f,o,k,p,!0);else{if("#define"==p){p=o[++k],h[p]=1;continue}if("#ifdef"==p){n=o[++k];g[n]=g[n]||[];for(k++;k<l;k++)if("attribute"==(p=o[k])||"uniform"==p)k=this.parseOne(e,f,o,k,p,h[n]);else if("#else"==p)for(k++;k<l;k++)if("attribute"==(p=o[k])||"uniform"==p)k=this.parseOne(e,f,o,k,p,!h[n]);else if("#endif"==p)break}}}}return d},e.parseOne=function(a,c,d,e,f,g){var h={type:b.shaderParamsMap[d[e+1]],name:d[e+2],size:isNaN(parseInt(d[e+3]))?1:parseInt(d[e+3])};return g&&("attribute"==f?a.push(h):c.push(h)),":"==d[e+3]&&(h.type=d[e+4],e+=2),e+=2},e.dispose=function(){this.resourceManager.removeResource(this),laya.resource.Resource.prototype.dispose.call(this)},b.getShader=function(a){return b.sharders[a]},b.create=function(a,c,d,e){return new b(a,c,d,e)},b.withCompile=function(a,c,d,e){if(d&&b.sharders[d])return b.sharders[d];var f=b._preCompileShader[2e-4*a];if(!f)throw Error("withCompile shader err!"+a);return f.createShader(c,d,e)},b.withCompile2D=function(a,c,d,e,f){if(e&&b.sharders[e])return b.sharders[e];var g=b._preCompileShader[2e-4*a+c];if(!g)throw Error("withCompile shader err!"+a+" "+c);return g.createShader(d,e,f)},b.addInclude=function(a,c){if(!c||0===c.length)throw Error("add shader include file err:"+a);if(b._includeFiles[a])throw Error("add shader include file err, has add:"+a);b._includeFiles[a]=c},b.preCompile=function(a,c,d,e){var f=2e-4*a;b._preCompileShader[f]=new la(f,c,d,e,b._includeFiles)},b.preCompile2D=function(a,c,d,e,f){var g=2e-4*a+c;b._preCompileShader[g]=new la(g,d,e,f,b._includeFiles)},b._createShader=function(a,b,c){var d=a.createShader(c);if(a.shaderSource(d,b),a.compileShader(d),!a.getShaderParameter(d,35713))throw a.getShaderInfoLog(d);return d},b._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],b._includeFiles={},b._count=0,b._preCompileShader={},b.SHADERNAME2ID=2e-4,b.sharders=(b.sharders=[],b.sharders.length=32,b.sharders),c(b,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new C}]),b}(Aa),Na=function(a){function b(){this._maxsize=0,this._upload=!0,this._uploadSize=0,b.__super.call(this),this.lock=!0}d(b,"laya.webgl.utils.Buffer2D",a);var c=b.prototype;return c._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),B.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,Ca._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Ca._gl.bufferSubData(this._bufferType,0,this._buffer)},c._bufferSubData=function(a,b,c){if(void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),this._maxsize=Math.max(this._maxsize,this._byteLength),B.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,Ca._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),b||c){var d=this._buffer.slice(b,c);Ca._gl.bufferSubData(this._bufferType,a,d)}else Ca._gl.bufferSubData(this._bufferType,a,this._buffer)},c._checkArrayUse=function(){},c._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},c._bind_subUpload=function(a,b,c){return void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(a,b,c),!0)},c._resizeBuffer=function(a,b){if(a<this._buffer.byteLength)return this;if(this.memorySize=a,b&&this._buffer&&this._buffer.byteLength>0){var c=new ArrayBuffer(a);new Uint8Array(c).set(new Uint8Array(this._buffer),0),this._buffer=c}else this._buffer=new ArrayBuffer(a);return this._checkArrayUse(),this._upload=!0,this},c.append=function(a){this._upload=!0;var b,c=0;c=a.byteLength,a instanceof Uint8Array?(this._resizeBuffer(this._byteLength+c,!0),b=new Uint8Array(this._buffer,this._byteLength)):a instanceof Uint16Array?(this._resizeBuffer(this._byteLength+c,!0),b=new Uint16Array(this._buffer,this._byteLength)):a instanceof Float32Array&&(this._resizeBuffer(this._byteLength+c,!0),b=new Float32Array(this._buffer,this._byteLength)),b.set(a,0),this._byteLength+=c,this._checkArrayUse()},c.appendEx=function(a,b){this._upload=!0;var c,d=0;d=a.byteLength,this._resizeBuffer(this._byteLength+d,!0),c=new b(this._buffer,this._byteLength),c.set(a,0),this._byteLength+=d,this._checkArrayUse()},c.appendEx2=function(a,b,c,d){void 0===d&&(d=1),this._upload=!0;var e,f=0;f=c*d,this._resizeBuffer(this._byteLength+f,!0),e=new b(this._buffer,this._byteLength);var g=0;for(g=0;g<c;g++)e[g]=a[g];this._byteLength+=f,this._checkArrayUse()},c.getBuffer=function(){return this._buffer},c.setNeedUpload=function(){this._upload=!0},c.getNeedUpload=function(){return this._upload},c.upload=function(){var a=this._bind_upload();return Ca._gl.bindBuffer(this._bufferType,null),Ca._bindActive[this._bufferType]=null,Aa.activeShader=null,a},c.subUpload=function(a,b,c){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0);var d=this._bind_subUpload();return Ca._gl.bindBuffer(this._bufferType,null),Ca._bindActive[this._bufferType]=null,Aa.activeShader=null,d},c.detoryResource=function(){a.prototype.detoryResource.call(this),this._upload=!0,this._uploadSize=0},c.clear=function(){this._byteLength=0,this._upload=!0},e(0,c,"bufferLength",function(){return this._buffer.byteLength}),e(0,c,"byteLength",a.prototype._$get_byteLength,function(a){this._byteLength!==a&&(a<=this._buffer.byteLength||this._resizeBuffer(2*a+256,!0),this._byteLength=a)}),b.__int__=function(a){Qa.QuadrangleIB=Qa.create(35044),ja.fillIBQuadrangle(Qa.QuadrangleIB,16)},b.FLOAT32=4,b.SHORT=2,b}(Ca),Oa=(function(a){function b(a){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,b.__super.call(this,9)}d(b,"laya.webgl.shader.d2.value.GlowSV",a);var c=b.prototype;c.setValue=function(b){a.prototype.setValue.call(this,b)},c.clear=function(){a.prototype.clear.call(this)},b}(Ga),function(a){function b(a){b.__super.call(this,64),this.defines.add(64)}d(b,"laya.webgl.shader.d2.value.TextSV",a);var c=b.prototype;return c.release=function(){b.pool[b._length++]=this,this.clear()},c.clear=function(){a.prototype.clear.call(this)},b.create=function(){return b._length?b.pool[--b._length]:new b(null)},b.pool=[],b._length=0,b}(Ga)),Pa=function(a){function b(a,c,d,e){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,b.__super.call(this,a,c,d,e)}d(b,"laya.webgl.shader.d2.Shader2X",a);var c=b.prototype;return c.upload2dQuick1=function(a){this.upload(a,this._params2dQuick1||this._make2dQuick1())},c._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var a,b=this._params,c=0,d=b.length;c<d;c++)a=b[c],(v.isFlash||"size"!==a.name&&"mmat"!==a.name&&"position"!==a.name&&"texcoord"!==a.name)&&this._params2dQuick1.push(a)}return this._params2dQuick1},c.detoryResource=function(){a.prototype.detoryResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},c.upload2dQuick2=function(a){this.upload(a,this._params2dQuick2||this._make2dQuick2())},c._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var a,b=this._params,c=0,d=b.length;c<d;c++)a=b[c],(v.isFlash||"size"!==a.name)&&this._params2dQuick2.push(a)}return this._params2dQuick2},b.create=function(a,c,d,e){return new b(a,c,d,e)},b}(Ma),Qa=function(a){function b(a){this._uint8Array=null,this._uint16Array=null,void 0===a&&(a=35044),b.__super.call(this),this._bufferUsage=a,this._bufferType=34963,v.isFlash||(this._buffer=new ArrayBuffer(8))}d(b,"laya.webgl.utils.IndexBuffer2D",a);var c=b.prototype;return c._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},c.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},c.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},b.QuadrangleIB=null,b.create=function(a){return void 0===a&&(a=35044),new b(a)},b}(Na),Ra=function(a){function b(a,c){this._floatArray32=null,this._vertexStride=0,b.__super.call(this),this._vertexStride=a,this._bufferUsage=c,this._bufferType=34962,v.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}d(b,"laya.webgl.utils.VertexBuffer2D",a);var c=b.prototype;return c.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},c.bind=function(a){a&&a._bind(),this._bind()},c.insertData=function(a,b){this.getFloat32Array().set(a,b),this._upload=!0},c.bind_upload=function(a){a._bind_upload()||a._bind(),this._bind_upload()||this._bind()},c._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},c.detoryResource=function(){a.prototype.detoryResource.call(this);for(var b=0;b<10;b++)ma.mainContext.disableVertexAttribArray(b)},e(0,c,"vertexStride",function(){return this._vertexStride}),b.create=function(a,c){return void 0===c&&(c=35048),new b(a,c)},b}(Na),Sa=function(a){function c(a,b){this._image=null,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this.mipmap=!1,this.minFifter=0,this.magFifter=0,c.__super.call(this,a,b),this.repeat=!1,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof a?(this._src=a,this._image=new j.window.Image,b&&(b.onload&&(this.onload=b.onload),b.onerror&&(this.onerror=b.onerror),b.onCreate&&b.onCreate(this)),this._image.crossOrigin=a&&0==a.indexOf("data:")?null:"",a&&(this._image.src=a)):(this._src=b,this._image=a.source,this.onresize()),a&&(this._image.src=a),this._enableMerageInAtlas=!0}d(c,"laya.webgl.resource.WebGLImage",a);var f=c.prototype;return b.imps(f,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),f._init_=function(a,b){},f._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var a=ma.mainContext,b=this._source=a.createTexture(),c=na.curBindTexTarget,d=na.curBindTexValue;na.bindTexture(a,3553,b),a.texImage2D(3553,0,6408,6408,5121,this._image);var e=this.minFifter,f=this.magFifter,h=this.repeat?10497:33071,i=g.isPOT(this._w,this._h);i?(this.mipmap?e!==-1||(e=9987):e!==-1||(e=9729),f!==-1||(f=9729),a.texParameteri(3553,10241,e),a.texParameteri(3553,10240,f),a.texParameteri(3553,10242,h),a.texParameteri(3553,10243,h),this.mipmap&&a.generateMipmap(3553)):(e!==-1||(e=9729),f!==-1||(f=9729),a.texParameteri(3553,10241,e),a.texParameteri(3553,10240,f),a.texParameteri(3553,10242,33071),a.texParameteri(3553,10243,33071)),c&&d&&na.bindTexture(a,c,d),this._image.onload=null,this._image=null,this.memorySize=i?this._w*this._h*4*(1+1/3):this._w*this._h*4,this._recreateLock=!1},f.recreateResource=function(){var a=this;if(null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this.startCreate(),this._allowMerageInAtlas&&this._enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0,this.startCreate();var b=this;this._image=new j.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(b._needReleaseAgain)return b._needReleaseAgain=!1,b._image.onload=null,void(b._image=null);b._allowMerageInAtlas&&b._enableMerageInAtlas?(a.memorySize=0,a._recreateLock=!1):b._createWebGlTexture(),b.completeCreate()},this._image.src=this._src}},f.detoryResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(ma.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},f.onresize=function(){this._w=this._image.width,this._h=this._image.height,K.enabled&&this._w<K.atlasLimitWidth&&this._h<K.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},f.clearAtlasSource=function(){this._image=null},e(0,f,"image",function(){return this._image}),e(0,f,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),e(0,f,"atlasSource",function(){return this._image}),e(0,f,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(a){this._enableMerageInAtlas=a}),e(0,f,"onload",null,function(a){var b=this;this._onload=a,this._image&&(this._image.onload=null!=this._onload?function(){b.onresize(),b._onload()}:null)}),e(0,f,"onerror",null,function(a){var b=this;this._onerror=a,this._image&&(this._image.onerror=null!=this._onerror?function(){b._onerror()}:null)}),c}(q);b.__init([ga,J,pa,la])}(0,0,b),function(window,a,b){var c=(b.un,b.uns,b.static),d=b.class,e=b.getset,f=(b.__newvec,laya.display.Animation),g=laya.utils.ClassUtils,h=laya.filters.ColorFilter,i=laya.utils.Ease,j=laya.events.Event,k=laya.display.css.Font,l=laya.display.FrameAnimation,m=laya.display.Graphics,n=laya.utils.Handler,o=laya.display.Input,p=laya.net.Loader,q=(laya.display.Node,laya.maths.Point),r=laya.maths.Rectangle,s=laya.renders.Render,t=laya.display.Sprite,u=laya.display.Text,v=laya.resource.Texture,w=laya.utils.Tween,x=laya.utils.Utils;b.interface("laya.ui.IItem"),b.interface("laya.ui.ISelect"),b.interface("laya.ui.IRender"),b.interface("laya.ui.IComponent"),b.interface("laya.ui.IBox","IComponent");var y=function(){function a(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return d(a,"laya.ui.LayoutStyle"),c(a,["EMPTY",function(){return this.EMPTY=new a}]),a}(),z=function(){function a(){}return d(a,"laya.ui.Styles"),a.labelColor="#000000",a.buttonStateNum=3,a.scrollBarMinNum=15,a.scrollBarDelayTime=500,c(a,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),a}(),A=function(){function a(){}return d(a,"laya.ui.UIUtils"),a.fillArray=function(a,b,c){var d=a.concat();if(b)for(var e=b.split(","),f=0,g=Math.min(d.length,e.length);f<g;f++){var h=e[f];d[f]="true"==h||"false"!=h&&h,null!=c&&(d[f]=c(h))}return d},a.toColor=function(a){return x.toHexColor(a)},a.gray=function(b,c){void 0===c&&(c=!0),c?a.addFilter(b,a.grayFilter):a.clearFilter(b,h)},a.addFilter=function(a,b){var c=a.filters||[];c.push(b),a.filters=c},a.clearFilter=function(a,c){var d=a.filters;if(null!=d&&d.length>0){for(var e=d.length-1;e>-1;e--){var f=d[e];b.__typeof(f,c)&&d.splice(e,1)}a.filters=d}},c(a,["grayFilter",function(){return this.grayFilter=new h([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])}]),a}(),B=function(){function a(){}return d(a,"UIConfig"),a.touchScrollEnable=!0,a.mouseWheelEnable=!0,a.showButtons=!0,a.popupBgColor="#000000",a.popupBgAlpha=.5,a.closeDialogOnSide=!0,a}(),C=function(a){function c(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,c.__super.call(this)}d(c,"laya.ui.AutoBitmap",a);var f=c.prototype;return f.destroy=function(){a.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},f._setChanged=function(){this._isChanged||(this._isChanged=!0,b.timer.callLater(this,this.changeSource))},f.changeSource=function(){c.cacheCount++>50&&c.clearCache(),this._isChanged=!1;var a=this._source;if(a&&a.bitmap){var b=this.width,d=this.height,e=this._sizeGrid,f=a.sourceWidth,g=a.sourceHeight;if(!e||f===b&&g===d)this.cleanByTexture(a,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,b,d);else{a.$_GID||(a.$_GID=x.getGID());var h=a.$_GID+"."+b+"."+d+"."+e.join(".");if(c.cmdCaches[h])return void(this.cmds=c.cmdCaches[h]);this.clear();var i=e[0],j=e[1],k=e[2],l=e[3],m=e[4];l+j>b&&(j=0),l&&i&&this.drawTexture(c.getTexture(a,0,0,l,i),0,0,l,i),j&&i&&this.drawTexture(c.getTexture(a,f-j,0,j,i),b-j,0,j,i),l&&k&&this.drawTexture(c.getTexture(a,0,g-k,l,k),0,d-k,l,k),j&&k&&this.drawTexture(c.getTexture(a,f-j,g-k,j,k),b-j,d-k,j,k),i&&this.drawBitmap(m,c.getTexture(a,l,0,f-l-j,i),l,0,b-l-j,i),k&&this.drawBitmap(m,c.getTexture(a,l,g-k,f-l-j,k),l,d-k,b-l-j,k),l&&this.drawBitmap(m,c.getTexture(a,0,i,l,g-i-k),0,i,l,d-i-k),j&&this.drawBitmap(m,c.getTexture(a,f-j,i,j,g-i-k),b-j,i,j,d-i-k),this.drawBitmap(m,c.getTexture(a,l,i,f-l-j,g-i-k),l,i,b-l-j,d-i-k),this.autoCacheCmd&&!s.isConchApp&&(c.cmdCaches[h]=this.cmds)}this._repaint()}},f.drawBitmap=function(a,b,c,d,e,f){void 0===e&&(e=0),void 0===f&&(f=0),e<.1||f<.1||(!a||b.width==e&&b.height==f?this.drawTexture(b,c,d,e,f):this.fillTexture(b,c,d,e,f))},e(0,f,"sizeGrid",function(){return this._sizeGrid},function(a){this._sizeGrid=a,this._setChanged()}),e(0,f,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(a){this._width!=a&&(this._width=a,this._setChanged())}),e(0,f,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(a){this._height!=a&&(this._height=a,this._setChanged())}),e(0,f,"source",function(){return this._source},function(a){a?(this._source=a,this._setChanged()):(this._source=null,this.clear())}),c.getTexture=function(a,b,d,e,f){e<=0&&(e=1),f<=0&&(f=1),a.$_GID||(a.$_GID=x.getGID());var g=a.$_GID+"."+b+"."+d+"."+e+"."+f,h=c.textureCache[g];return h||(h=c.textureCache[g]=v.createFromTexture(a,b,d,e,f)),h},c.clearCache=function(){c.cacheCount=0,c.cmdCaches={},c.textureCache={}},c.setCache=function(a,b){c.cacheCount++,c.textureCache[a]=b},c.getCache=function(a){return c.textureCache[a]},c.cmdCaches={},c.cacheCount=0,c.textureCache={},c}(m),D=(function(a){function b(){b.__super.call(this)}d(b,"laya.ui.UIEvent",a),b.SHOW_TIP="showtip",b.HIDE_TIP="hidetip",b}(j),function(a){function c(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,c.__super.call(this),this._layout=y.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}d(c,"laya.ui.Component",a);var f=c.prototype;return b.imps(f,{"laya.ui.IComponent":!0}),f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},f.preinitialize=function(){},f.createChildren=function(){},f.initialize=function(){},f.callLater=function(a,c){b.timer.callLater(this,a,c)},f.runCallLater=function(a){b.timer.runCallLater(this,a)},f.commitMeasure=function(){},f.changeSize=function(){this.event("resize")},f.getLayout=function(){return this._layout===y.EMPTY&&(this._layout=new y),this._layout},f.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},f.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},f.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},f.resetLayoutX=function(){var a=this._layout;isNaN(a.anchorX)||(this.pivotX=a.anchorX*this.width);var b=this.parent;b&&(isNaN(a.centerX)?isNaN(a.left)?isNaN(a.right)||(this.x=Math.round(b.width-this.displayWidth-a.right+this.pivotX*this.scaleX)):(this.x=Math.round(a.left+this.pivotX*this.scaleX),isNaN(a.right)||(this.width=(b._width-a.left-a.right)/this.scaleX)):this.x=Math.round(.5*(b.width-this.displayWidth)+a.centerX+this.pivotX*this.scaleX))},f.resetLayoutY=function(){var a=this._layout;isNaN(a.anchorY)||(this.pivotY=a.anchorY*this.height);var b=this.parent;b&&(isNaN(a.centerY)?isNaN(a.top)?isNaN(a.bottom)||(this.y=Math.round(b.height-this.displayHeight-a.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(a.top+this.pivotY*this.scaleY),isNaN(a.bottom)||(this.height=(b._height-a.top-a.bottom)/this.scaleY)):this.y=Math.round(.5*(b.height-this.displayHeight)+a.centerY+this.pivotY*this.scaleY))},f.onMouseOver=function(a){b.stage.event("showtip",this._toolTip)},f.onMouseOut=function(a){b.stage.event("hidetip",this._toolTip)},e(0,f,"displayWidth",function(){return this.width*this.scaleX}),e(0,f,"width",function(){return this._width?this._width:this.measureWidth},function(a){this._width!=a&&(this._width=a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),e(0,f,"measureWidth",function(){var a=0;this.commitMeasure();for(var b=this.numChildren-1;b>-1;b--){var c=this.getChildAt(b);c.visible&&(a=Math.max(c.x+c.width*c.scaleX,a))}return a}),e(0,f,"layOutEabled",null,function(a){this._layout&&this._layout.enable!=a&&(this._layout.enable=a,this.parent?this.onAdded():(this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved)))}),e(0,f,"displayHeight",function(){return this.height*this.scaleY}),e(0,f,"height",function(){return this._height?this._height:this.measureHeight},function(a){this._height!=a&&(this._height=a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),e(0,f,"dataSource",function(){return this._dataSource},function(a){this._dataSource=a;for(var b in this._dataSource)this.hasOwnProperty(b)&&(this[b]=this._dataSource[b])}),e(0,f,"scaleY",a.prototype._$get_scaleY,function(b){a.prototype._$get_scaleY.call(this)!=b&&(a.prototype._$set_scaleY.call(this,b),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),e(0,f,"measureHeight",function(){var a=0;this.commitMeasure();for(var b=this.numChildren-1;b>-1;b--){var c=this.getChildAt(b);c.visible&&(a=Math.max(c.y+c.height*c.scaleY,a))}return a}),e(0,f,"scaleX",a.prototype._$get_scaleX,function(b){a.prototype._$get_scaleX.call(this)!=b&&(a.prototype._$set_scaleX.call(this,b),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),e(0,f,"top",function(){return this._layout.top},function(a){this.getLayout().top=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"bottom",function(){return this._layout.bottom},function(a){this.getLayout().bottom=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"left",function(){return this._layout.left},function(a){this.getLayout().left=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"right",function(){return this._layout.right},function(a){this.getLayout().right=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"centerX",function(){return this._layout.centerX},function(a){this.getLayout().centerX=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"centerY",function(){return this._layout.centerY},function(a){this.getLayout().centerY=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"anchorX",function(){return this._layout.anchorX},function(a){this.getLayout().anchorX=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"anchorY",function(){return this._layout.anchorY},function(a){this.getLayout().anchorY=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"tag",function(){return this._tag},function(a){this._tag=a}),e(0,f,"toolTip",function(){return this._toolTip},function(a){this._toolTip!=a&&(this._toolTip=a,null!=a?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),e(0,f,"comXml",function(){return this._comXml},function(a){this._comXml=a}),e(0,f,"gray",function(){return this._gray},function(a){a!==this._gray&&(this._gray=a,A.gray(this,a))}),e(0,f,"disabled",function(){return this._disabled},function(a){a!==this._disabled&&(this.gray=this._disabled=a,this.mouseEnabled=!a)}),c}(t)),E=function(a){function c(){this.lockLayer=null,this.popupEffect=function(a){a.scale(1,1),w.from(a,{x:b.stage.width/2,y:b.stage.height/2,scaleX:0,scaleY:0},300,i.backOut)},this.closeEffect=function(a){var c=this;w.to(a,{x:b.stage.width/2,y:b.stage.height/2,scaleX:0,scaleY:0},300,i.strongOut,n.create(c,c._doClose,[a]))},c.__super.call(this),this.maskLayer=new t,this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,b.stage.addChild(this),b.stage.on("resize",this,this._onResize),B.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}d(c,"laya.ui.DialogManager",a);var e=c.prototype;return e._closeOnSide=function(){var a=this.getChildAt(this.numChildren-1);a instanceof laya.ui.Dialog&&a.close("side")},e.setLockView=function(a){this.lockLayer||(this.lockLayer=new F,
this.lockLayer.mouseEnabled=!0,this.lockLayer.size(b.stage.width,b.stage.height)),this.lockLayer.removeChildren(),a&&(a.centerX=a.centerY=0,this.lockLayer.addChild(a))},e._onResize=function(a){var c=this.maskLayer.width=b.stage.width,d=this.maskLayer.height=b.stage.height;this.lockLayer&&this.lockLayer.size(c,d),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,c,d,B.popupBgColor),this.maskLayer.alpha=B.popupBgAlpha;for(var e=this.numChildren-1;e>-1;e--){var f=this.getChildAt(e);f.popupCenter&&this._centerDialog(f)}},e._centerDialog=function(a){a.x=Math.round((b.stage.width-a.width>>1)+a.pivotX),a.y=Math.round((b.stage.height-a.height>>1)+a.pivotY)},e.open=function(a,b){void 0===b&&(b=!1),b&&this.removeChildren(),a.popupCenter&&this._centerDialog(a),this.addChild(a),(a.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),this.popupEffect&&this.popupEffect(a),this.event("open")},e.lock=function(a){this.lockLayer&&(a?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},e.close=function(a){null!=this.closeEffect?this.closeEffect(a):this._doClose(a)},e._doClose=function(a){a.removeSelf(),a.isModal&&this._checkMask(),a.closeHandler&&a.closeHandler.run(),this.event("close")},e.closeAll=function(){this.removeChildren(),this.event("close")},e.getDialogsByGroup=function(a){for(var b=[],c=this.numChildren-1;c>-1;c--){var d=this.getChildAt(c);d.group===a&&b.push(d)}return b},e.closeByGround=function(a){for(var b=[],c=this.numChildren-1;c>-1;c--){var d=this.getChildAt(c);d.group===a&&d.close()}return b},e._checkMask=function(){this.maskLayer.removeSelf();for(var a=this.numChildren-1;a>-1;a--){var b=this.getChildAt(a);if(b&&b.isModal)return void this.addChildAt(this.maskLayer,a)}},c}(t),F=function(a){function c(){c.__super.call(this)}d(c,"laya.ui.Box",a);var f=c.prototype;return b.imps(f,{"laya.ui.IBox":!0}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(a){this._dataSource=a;for(var b in a){var c=this.getChildByName(b);c?c.dataSource=a[b]:this.hasOwnProperty(b)&&(this[b]=a[b])}}),c}(D),G=function(a){function f(a,b){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,f.__super.call(this),this._labelColors=z.buttonLabelColors,this._stateNum=z.buttonStateNum,void 0===b&&(b=""),this.skin=a,this.label=b}d(f,"laya.ui.Button",a);var g=f.prototype;return b.imps(g,{"laya.ui.ISelect":!0}),g.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(b),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},g.createChildren=function(){this.graphics=this._bitmap=new C},g.createText=function(){this._text||(this._text=new u,this._text.overflow=u.HIDDEN,this._text.align="center",this._text.valign="middle")},g.initialize=function(){this.on("mouseover",this,this.onMouse),this.on("mouseout",this,this.onMouse),this.on("mousedown",this,this.onMouse),this.on("mouseup",this,this.onMouse),this.on("click",this,this.onMouse)},g.onMouse=function(a){if(this.toggle!==!1||!this._selected)return"click"===a.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=f.stateMap[a.type]))},g.changeClips=function(){var a=p.getRes(this._skin);if(!a)return void console.log("lose skin",this._skin);var b=a.sourceWidth,c=a.sourceHeight/this._stateNum;a.$_GID||(a.$_GID=x.getGID());var d=a.$_GID+"-"+this._stateNum,e=C.getCache(d);if(e)this._sources=e;else{if(this._sources=[],1===this._stateNum)this._sources.push(a);else for(var f=0;f<this._stateNum;f++)this._sources.push(v.createFromTexture(a,0,c*f,b,c));C.setCache(d,this._sources)}this._autoSize?(this._bitmap.width=this._width||b,this._bitmap.height=this._height||c,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=b)},g.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var a=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[a]),this.label&&(this._text.color=this._labelColors[a],this._strokeColors&&(this._text.strokeColor=this._strokeColors[a]))},g._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},e(0,g,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(a){this.createText(),this._text.strokeColor=a}),e(0,g,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),e(0,g,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this.callLater(this.changeClips),this._setStateChanged())}),e(0,g,"state",function(){return this._state},function(a){this._state!=a&&(this._state=a,this._setStateChanged())}),e(0,g,"text",function(){return this.createText(),this._text}),e(0,g,"stateNum",function(){return this._stateNum},function(a){this._stateNum!=a&&(this._stateNum=a<1?1:a>3?3:a,this.callLater(this.changeClips))}),e(0,g,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(a){this._strokeColors=A.fillArray(z.buttonLabelColors,a,String),this._setStateChanged()}),e(0,g,"labelColors",function(){return this._labelColors.join(",")},function(a){this._labelColors=A.fillArray(z.buttonLabelColors,a,String),this._setStateChanged()}),e(0,g,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),e(0,g,"label",function(){return this._text?this._text.text:null},function(a){(this._text||a)&&(this.createText(),this._text.text!=a&&(a&&!this._text.displayedInStage&&this.addChild(this._text),this._text.text=(a+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),e(0,g,"selected",function(){return this._selected},function(a){this._selected!=a&&(this._selected=a,this.state=this._selected?2:0,this.event("change"))}),e(0,g,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(a){this.createText(),this._text.padding=A.fillArray(z.labelPadding,a,Number)}),e(0,g,"labelSize",function(){return this.createText(),this._text.fontSize},function(a){this.createText(),this._text.fontSize=a}),e(0,g,"labelStroke",function(){return this.createText(),this._text.stroke},function(a){this.createText(),this._text.stroke=a}),e(0,g,"labelBold",function(){return this.createText(),this._text.bold},function(a){this.createText(),this._text.bold=a}),e(0,g,"labelFont",function(){return this.createText(),this._text.font},function(a){this.createText(),this._text.font=a}),e(0,g,"labelAlign",function(){return this.createText(),this._text.align},function(a){this.createText(),this._text.align=a}),e(0,g,"clickHandler",function(){return this._clickHandler},function(a){this._clickHandler=a}),e(0,g,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a){this._bitmap.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,g,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._autoSize&&(this._bitmap.width=b,this._text&&(this._text.width=b))}),e(0,g,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._autoSize&&(this._bitmap.height=b,this._text&&(this._text.height=b))}),e(0,g,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.label=b+"":a.prototype._$set_dataSource.call(this,b)}),e(0,g,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(a){this._bitmap._offset=a?A.fillArray([1,1],a,Number):[]}),c(f,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),f}(D),H=function(a){function c(a,b,d){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,c.__super.call(this),void 0===b&&(b=1),void 0===d&&(d=1),this._clipX=b,this._clipY=d,this.skin=a}d(c,"laya.ui.Clip",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!1),a.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},f.dispose=function(){this.destroy(!0),b.loader.clearRes(this._skin)},f.createChildren=function(){this.graphics=this._bitmap=new C},f.initialize=function(){this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},f._onDisplay=function(a){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this._displayedInStage&&this.play()},f.changeClip=function(){if(this._clipChanged=!1,this._skin){var a=p.getRes(this._skin);a?this.loadComplete(this._skin,a):b.loader.load(this._skin,n.create(this,this.loadComplete,[this._skin]))}},f.loadComplete=function(a,b){if(a===this._skin&&b){var c=this._clipWidth||Math.ceil(b.sourceWidth/this._clipX),d=this._clipHeight||Math.ceil(b.sourceHeight/this._clipY),e=this._skin+c+d,f=C.getCache(e);if(f)this._sources=f;else{this._sources=[];for(var g=0;g<this._clipY;g++)for(var h=0;h<this._clipX;h++)this._sources.push(v.createFromTexture(b,c*h,d*g,c,d));C.setCache(e,this._sources)}this.index=this._index,this.event("loaded"),this.onCompResize()}},f.play=function(){this._isPlaying=!0,this.index=0,this._index++,b.timer.loop(this.interval,this,this._loop)},f._loop=function(){this._style.visible&&this._sources&&(this.index=this._index,this._index++,this._index>=this._sources.length&&(this._index=0))},f.stop=function(){this._isPlaying=!1,b.timer.clear(this,this._loop)},f._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},e(0,f,"interval",function(){return this._interval},function(a){this._interval!=a&&(this._interval=a,this._isPlaying&&this.play())}),e(0,f,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,a?this._setClipChanged():this._bitmap.source=null)}),e(0,f,"sources",function(){return this._sources},function(a){this._sources=a,this.index=this._index,this.event("loaded")}),e(0,f,"clipX",function(){return this._clipX},function(a){this._clipX=a,this._setClipChanged()}),e(0,f,"clipY",function(){return this._clipY},function(a){this._clipY=a,this._setClipChanged()}),e(0,f,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),e(0,f,"clipWidth",function(){return this._clipWidth},function(a){this._clipWidth=a,this._setClipChanged()}),e(0,f,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a){this._bitmap.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,f,"group",function(){return this._group},function(a){a&&this._skin&&p.setGroup(this._skin,a),this._group=a}),e(0,f,"clipHeight",function(){return this._clipHeight},function(a){this._clipHeight=a,this._setClipChanged()}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bitmap.width=b}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bitmap.height=b}),e(0,f,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),e(0,f,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),e(0,f,"index",function(){return this._index},function(a){this._index=a,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[a]),this.event("change")}),e(0,f,"autoPlay",function(){return this._autoPlay},function(a){this._autoPlay!=a&&(this._autoPlay=a,a?this.play():this.stop())}),e(0,f,"isPlaying",function(){return this._isPlaying},function(a){this._isPlaying=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.index=parseInt(b):a.prototype._$set_dataSource.call(this,b)}),e(0,f,"bitmap",function(){return this._bitmap}),c}(D),I=function(a){function c(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,c.__super.call(this)}d(c,"laya.ui.ColorPicker",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._colorPanel&&this._colorPanel.destroy(b),this._colorButton&&this._colorButton.destroy(b),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},f.createChildren=function(){this.addChild(this._colorButton=new G),this._colorPanel=new F,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new t),this._colorPanel.addChild(this._colorBlock=new t),this._colorPanel.addChild(this._colorInput=new o)},f.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},f.onPanelMouseDown=function(a){a.stopPropagation()},f.changePanel=function(){this._panelChanged=!1;var a=this._colorPanel.graphics;a.clear(),a.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,a=this._colorTiles.graphics,a.clear();for(var b=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],c=0;c<12;c++)for(var d=0;d<20;d++){var e=0;e=0===d?b[c]:1===d?0:51*(((3*c+d/6)%3<<0)+3*(c/6<<0))<<16|d%6*51<<8|(c<<0)%6*51;var f=A.toColor(e);this._colors.push(f);var g=d*this._gridSize,h=c*this._gridSize;a.drawRect(g,h,this._gridSize,this._gridSize,f,"#000000")}},f.onColorButtonClick=function(a){this._colorPanel.parent?this.close():this.open()},f.open=function(){var a=this.localToGlobal(new q),c=a.x+this._colorPanel.width<=b.stage.width?a.x:b.stage.width-this._colorPanel.width,d=a.y+this._colorButton.height;d=d+this._colorPanel.height<=b.stage.height?d:a.y-this._colorPanel.height,this._colorPanel.pos(c,d),b.g.addChild(this._colorPanel),b.stage.on("mousedown",this,this.removeColorBox)},f.close=function(){b.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},f.removeColorBox=function(a){this.close()},f.onColorFieldKeyDown=function(a){13==a.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),a.stopPropagation())},f.onColorInputChange=function(a){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},f.onColorTilesClick=function(a){this.selectedColor=this.getColorByMouse(),this.close()},f.onColorTilesMouseMove=function(a){this._colorInput.focus=!1;var b=this.getColorByMouse();this._colorInput.text=b,this.drawBlock(b)},f.getColorByMouse=function(){var a=this._colorTiles.getMousePoint(),b=Math.floor(a.x/this._gridSize),c=Math.floor(a.y/this._gridSize);return this._colors[20*c+b]},f.drawBlock=function(a){var b=this._colorBlock.graphics;b.clear();var c=a?a:"#ffffff";b.drawRect(0,0,50,20,c,this._borderColor),a||b.drawLine(0,0,50,20,"#ff0000")},f.changeColor=function(){var a=this.graphics;a.clear();var b=this._selectedColor||"#000000";a.drawRect(0,0,this._colorButton.width,this._colorButton.height,b)},f._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},e(0,f,"inputBgColor",function(){return this._inputBgColor},function(a){this._inputBgColor=a,this._setPanelChanged()}),e(0,f,"selectedColor",function(){return this._selectedColor},function(a){this._selectedColor!=a&&(this._selectedColor=this._colorInput.text=a,this.drawBlock(a),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",j.EMPTY.setTo("change",this,this)))}),e(0,f,"skin",function(){return this._colorButton.skin},function(a){this._colorButton.skin=a,this.changeColor()}),e(0,f,"bgColor",function(){return this._bgColor},function(a){this._bgColor=a,this._setPanelChanged()}),e(0,f,"borderColor",function(){return this._borderColor},function(a){this._borderColor=a,this._setPanelChanged()}),e(0,f,"inputColor",function(){return this._inputColor},function(a){this._inputColor=a,this._setPanelChanged()}),c}(D),J=function(a){function c(a,b){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._scrollBar=null,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this.itemRender=null,c.__super.call(this),this._itemColors=z.comboBoxItemColors,this.skin=a,this.labels=b}d(c,"laya.ui.ComboBox",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._button&&this._button.destroy(b),this._list&&this._list.destroy(b),this._scrollBar&&this._scrollBar.destroy(b),this._button=null,this._list=null,this._scrollBar=null,this._itemColors=null,this._labels=null,this._selectHandler=null},f.createChildren=function(){this.addChild(this._button=new G),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},f._createList=function(){this._list=new T,this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=n.create(this,this.onlistItemMouse,null,!1),this._scrollBarSkin&&(this._list.addChild(this._scrollBar=new _),this._scrollBar.skin=this._scrollBarSkin,this._scrollBar.name="scrollBar",this._scrollBar.y=1,this._scrollBar.on("mousedown",this,this.onScrollBarDown))},f.onListDown=function(a){a.stopPropagation()},f.onScrollBarDown=function(a){a.stopPropagation()},f.onButtonMouseDown=function(a){this.callLater(this.switchTo,[!this._isOpen])},f.changeList=function(){this._listChanged=!1;var a=this.width-2,b=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:a,height:this._itemHeight,fontSize:this._itemSize,color:b}}]},this._list.repeatY=this._visibleNum,this._scrollBar&&(this._scrollBar.x=this.width-this._scrollBar.width-1),this._list.refresh()},f.onlistItemMouse=function(a,b){var c=a.type;if("mouseover"===c||"mouseout"===c){var d=this._list.getCell(b);if(!d)return;var e=d.getChildByName("label");e&&("mouseover"===c?(e.bgColor=this._itemColors[0],e.color=this._itemColors[1]):(e.bgColor=null,e.color=this._itemColors[2]))}else"click"===c&&(this.selectedIndex=b,this.isOpen=!1)},f.switchTo=function(a){this.isOpen=a},f.changeOpen=function(){this.isOpen=!this._isOpen},f.changeItem=function(){this._itemChanged=!1,this.runCallLater(this.changeList),this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,this._scrollBar&&(this._scrollBar.height=this._listHeight-2);var a=this._list.graphics;a.clear(),a.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3]);var b=this._list.array||[];b.length=0;for(var c=0,d=this._labels.length;c<d;c++)b.push({label:this._labels[c]});this._list.array=b,this._visibleNum>b.length?this._list.height=this._listHeight:this._list.height=0},f.changeSelected=function(){this._button.label=this.selectedLabel},f.removeList=function(a){this.isOpen=!1},e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this._selectedIndex=a,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[j.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),e(0,f,"measureHeight",function(){return this._button.height}),e(0,f,"skin",function(){return this._button.skin},function(a){this._button.skin!=a&&(this._button.skin=a,this._listChanged=!0)}),e(0,f,"measureWidth",function(){return this._button.width}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),e(0,f,"selectedLabel",function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(a){this.selectedIndex=this._labels.indexOf(a)}),e(0,f,"labels",function(){return this._labels.join(",")},function(a){this._labels.length>0&&(this.selectedIndex=-1),a?this._labels=a.split(","):this._labels.length=0,this._itemChanged=!0}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._button.height=this._height}),e(0,f,"selectHandler",function(){return this._selectHandler},function(a){this._selectHandler=a}),e(0,f,"visibleNum",function(){return this._visibleNum},function(a){this._visibleNum=a,this._listChanged=!0}),e(0,f,"labelBold",function(){return this._button.text.bold},function(a){this._button.text.bold=a}),e(0,f,"itemColors",function(){return this._itemColors+""},function(a){this._itemColors=A.fillArray(this._itemColors,a,String),this._listChanged=!0}),e(0,f,"itemSize",function(){return this._itemSize},function(a){this._itemSize=a,this._listChanged=!0}),e(0,f,"scrollBar",function(){return this._scrollBar}),e(0,f,"isOpen",function(){return this._isOpen},function(a){if(this._isOpen!=a)if(this._isOpen=a,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&this.changeList(),this._itemChanged&&this.changeItem();var c=this.localToGlobal(q.TEMP.setTo(0,0)),d=c.y+this._button.height;d=d+this._listHeight<=b.stage.height?d:c.y-this._listHeight,this._list.pos(c.x,d),b.g.addChild(this._list),b.stage.once("mousedown",this,this.removeList),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),e(0,f,"scrollBarSkin",function(){return this._scrollBarSkin},function(a){this._scrollBarSkin=a}),e(0,f,"sizeGrid",function(){return this._button.sizeGrid},function(a){this._button.sizeGrid=a}),e(0,f,"button",function(){return this._button}),e(0,f,"list",function(){return this._list||this._createList(),this._list}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.selectedIndex=parseInt(b):b instanceof Array?this.labels=b.join(","):a.prototype._$set_dataSource.call(this,b)}),e(0,f,"labelColors",function(){return this._button.labelColors},function(a){this._button.labelColors!=a&&(this._button.labelColors=a)}),e(0,f,"labelPadding",function(){return this._button.text.padding.join(",")},function(a){this._button.text.padding=A.fillArray(z.labelPadding,a,Number)}),e(0,f,"labelSize",function(){return this._button.text.fontSize},function(a){this._button.text.fontSize=a}),e(0,f,"labelFont",function(){return this._button.text.font},function(a){this._button.text.font=a}),e(0,f,"stateNum",function(){return this._button.stateNum},function(a){this._button.stateNum=a}),c}(D),K=function(a){function c(a){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,c.__super.call(this),this._showButtons=B.showButtons,this._touchScrollEnable=B.touchScrollEnable,this._mouseWheelEnable=B.mouseWheelEnable,this.skin=a,this.max=1}d(c,"laya.ui.ScrollBar",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),this.stopScroll(),a.prototype.destroy.call(this,b),this.upButton&&this.upButton.destroy(b),this.downButton&&this.downButton.destroy(b),this.slider&&this.slider.destroy(b),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},f.createChildren=function(){this.addChild(this.slider=new L),this.addChild(this.upButton=new G),this.addChild(this.downButton=new G)},f.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},f.onSliderChange=function(){this.value=this.slider.value},f.onButtonMouseDown=function(a){var c=a.currentTarget===this.upButton;this.slide(c),b.timer.once(z.scrollBarDelayTime,this,this.startLoop,[c]),b.stage.once("mouseup",this,this.onStageMouseUp)},f.startLoop=function(a){b.timer.frameLoop(1,this,this.slide,[a])},f.slide=function(a){a?this.value-=this._scrollSize:this.value+=this._scrollSize},f.onStageMouseUp=function(a){b.timer.clear(this,this.startLoop),b.timer.clear(this,this.slide)},f.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions()},f.changeSize=function(){a.prototype.changeSize.call(this),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},f.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},f.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},f.setScroll=function(a,b,c){this.runCallLater(this.changeSize),this.slider.setSlider(a,b,c),this.slider.bar.visible=b>0,!this._hide&&this.autoHide&&(this.visible=!1)},f.onTargetMouseWheel=function(a){this.value-=a.delta*this._scrollSize,this.target=this._target},f.onTargetMouseDown=function(a){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new q),this._lastPoint.setTo(b.stage.mouseX,b.stage.mouseY),b.timer.clear(this,this.tweenMove),w.clearTween(this),b.stage.once("mouseup",this,this.onStageMouseUp2),b.stage.once("mouseout",this,this.onStageMouseUp2),b.timer.frameLoop(1,this,this.loop)},f.loop=function(){var a=b.stage.mouseY,c=b.stage.mouseX;if(this._lastOffset=this.isVertical?a-this._lastPoint.y:c-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?b.stage._canvasTransform.getScaleY():b.stage._canvasTransform.getScaleX()))>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=c,this._lastPoint.y=a,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._checkElastic=!0,this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?this._isElastic=!0:this._isElastic=!1):this._checkElastic=!0),this._checkElastic&&(this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset))},f.onStageMouseUp2=function(a){if(b.stage.off("mouseup",this,this.onStageMouseUp2),b.stage.off("mouseout",this,this.onStageMouseUp2),b.timer.clear(this,this.loop),!this._clickOnly)if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?w.to(this,{value:this.min},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver)):this._value>this.max&&w.to(this,{value:this.max},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver));else{this._offsets.length<1&&(this._offsets[0]=this.isVertical?b.stage.mouseY-this._lastPoint.y:b.stage.mouseX-this._lastPoint.x);for(var c=0,d=Math.min(this._offsets.length,3),e=0;e<d;e++)c+=this._offsets[this._offsets.length-1-e];if(this._lastOffset=c/d,(c=Math.abs(this._lastOffset))<2)return void this.event("end");c>60&&(this._lastOffset=this._lastOffset>0?60:-60),b.timer.frameLoop(1,this,this.tweenMove)}},f.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&w.to(this,{alpha:0},500),this.event("end")},f.tweenMove=function(){this._lastOffset*=this.rollRatio;var a=NaN;if(this.elasticDistance>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,a=.5*-(this.min-this.elasticDistance-this.value),this._lastOffset>a&&(this._lastOffset=a)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,a=.5*-(this.max+this.elasticDistance-this.value),this._lastOffset<a&&(this._lastOffset=a))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(b.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?w.to(this,{value:this.min},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver)):this._value>this.max?w.to(this,{value:this.max},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&w.to(this,{alpha:0},500)}},f.stopScroll=function(){this.onStageMouseUp2(null),b.timer.clear(this,this.tweenMove),w.clearTween(this)},e(0,f,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),e(0,f,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),e(0,f,"max",function(){return this.slider.max},function(a){this.slider.max=a}),e(0,f,"showButtons",function(){return this._showButtons},function(a){this._showButtons=a,this.callLater(this.changeScrollBar)}),e(0,f,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),e(0,f,"min",function(){return this.slider.min},function(a){this.slider.min=a}),e(0,f,"value",function(){return this._value},function(a){a!==this._value&&(this._isElastic?this._value=a:(this.slider.value=a,this._value=this.slider.value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value))}),e(0,f,"isVertical",function(){return this.slider.isVertical},function(a){this.slider.isVertical=a}),e(0,f,"sizeGrid",function(){return this.slider.sizeGrid},function(a){this.slider.sizeGrid=a}),e(0,f,"scrollSize",function(){return this._scrollSize},function(a){this._scrollSize=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.value=+b:a.prototype._$set_dataSource.call(this,b)}),e(0,f,"thumbPercent",function(){return this._thumbPercent},function(a){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),a=a>=1?.99:a,this._thumbPercent=a,
this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*a,z.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*a,z.scrollBarMinNum))}),e(0,f,"target",function(){return this._target},function(a){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),this._target=a,a&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),e(0,f,"hide",function(){return this._hide},function(a){this._hide=a,this.visible=!a}),e(0,f,"touchScrollEnable",function(){return this._touchScrollEnable},function(a){this._touchScrollEnable=a,this.target=this._target}),e(0,f,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(a){this._mouseWheelEnable=a}),e(0,f,"tick",function(){return this.slider.tick},function(a){this.slider.tick=a}),c}(D),L=function(a){function f(a){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,f.__super.call(this),this.skin=a}d(f,"laya.ui.Slider",a);var g=f.prototype;return g.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bg&&this._bg.destroy(b),this._bar&&this._bar.destroy(b),this._bg=null,this._bar=null,this.changeHandler=null},g.createChildren=function(){this.addChild(this._bg=new M),this.addChild(this._bar=new G)},g.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this.allowClickBack=!0},g.onBarMouseDown=function(a){this._globalSacle||(this._globalSacle=new q),this._globalSacle.setTo(this.globalScaleX,this.globalScaleY),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=b.stage.mouseX,this._ty=b.stage.mouseY,b.stage.on("mousemove",this,this.mouseMove),b.stage.once("mouseup",this,this.mouseUp),this.showValueText()},g.showValueText=function(){if(this.showLabel){var a=laya.ui.Slider.label;this.addChild(a),a.textField.changeText(this._value+""),this.isVertical?(a.x=this._bar.x+20,a.y=.5*(this._bar.height-a.height)+this._bar.y):(a.y=this._bar.y-20,a.x=.5*(this._bar.width-a.width)+this._bar.x)}},g.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},g.mouseUp=function(a){b.stage.off("mousemove",this,this.mouseMove),this.sendChangeEvent("changed"),this.hideValueText()},g.mouseMove=function(a){var c=this._value;this.isVertical?(this._bar.y+=(b.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min):(this._bar.x+=(b.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min),this._tx=b.stage.mouseX,this._ty=b.stage.mouseY;var d=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*d)/d,this._value!=c&&this.sendChangeEvent(),this.showValueText()},g.sendChangeEvent=function(a){void 0===a&&(a="change"),this.event(a),this.changeHandler&&this.changeHandler.runWith(this._value)},g.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},g.changeSize=function(){a.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},g.setSlider=function(a,b,c){this._value=-1,this._min=a,this._max=b>a?b:a,this.value=c<a?a:c>b?b:c},g.changeValue=function(){var a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*a)/a,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var b=this._max-this._min;0===b&&(b=1),this.isVertical?this._bar.y=(this._value-this._min)/b*(this.height-this._bar.height):this._bar.x=(this._value-this._min)/b*(this.width-this._bar.width)},g.onBgMouseDown=function(a){var b=this._bg.getMousePoint();this.isVertical?this.value=b.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=b.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},e(0,g,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),e(0,g,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.setBarPoint())}),e(0,g,"allowClickBack",function(){return this._allowClickBack},function(a){this._allowClickBack!=a&&(this._allowClickBack=a,a?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),e(0,g,"max",function(){return this._max},function(a){this._max!=a&&(this._max=a,this.callLater(this.changeValue))}),e(0,g,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),e(0,g,"tick",function(){return this._tick},function(a){this._tick!=a&&(this._tick=a,this.callLater(this.changeValue))}),e(0,g,"sizeGrid",function(){return this._bg.sizeGrid},function(a){this._bg.sizeGrid=a,this._bar.sizeGrid=a}),e(0,g,"min",function(){return this._min},function(a){this._min!=a&&(this._min=a,this.callLater(this.changeValue))}),e(0,g,"value",function(){return this._value},function(a){if(this._value!=a){var b=this._value;this._value=a,this.changeValue(),this._value!=b&&this.sendChangeEvent()}}),e(0,g,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.value=+b:a.prototype._$set_dataSource.call(this,b)}),e(0,g,"bar",function(){return this._bar}),c(f,["label",function(){return this.label=new N}]),f}(D),M=function(a){function c(a){this._bitmap=null,this._skin=null,this._group=null,c.__super.call(this),this.skin=a}d(c,"laya.ui.Image",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null},f.dispose=function(){this.destroy(!0),b.loader.clearRes(this._skin)},f.createChildren=function(){this.graphics=this._bitmap=new C,this._bitmap.autoCacheCmd=!1},f.setSource=function(a,b){a===this._skin&&b&&(this.source=b,this.onCompResize())},e(0,f,"source",function(){return this._bitmap.source},function(a){this._bitmap&&(this._bitmap.source=a,this.event("loaded"),this.repaint())}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"string"==typeof b?this.skin=b:a.prototype._$set_dataSource.call(this,b)}),e(0,f,"measureHeight",function(){return this._bitmap.height}),e(0,f,"skin",function(){return this._skin},function(a){if(this._skin!=a)if(this._skin=a,a){var c=p.getRes(a);c?(this.source=c,this.onCompResize()):b.loader.load(this._skin,n.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),e(0,f,"group",function(){return this._group},function(a){a&&this._skin&&p.setGroup(this._skin,a),this._group=a}),e(0,f,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a){this._bitmap.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,f,"measureWidth",function(){return this._bitmap.width}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bitmap.width=0==b?1e-7:b}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bitmap.height=0==b?1e-7:b}),c}(D),N=function(a){function b(a){this._tf=null,b.__super.call(this),void 0===a&&(a=""),k.defaultColor=z.labelColor,this.text=a}d(b,"laya.ui.Label",a);var f=b.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._tf=null},f.createChildren=function(){this.addChild(this._tf=new u)},f.changeText=function(a){this._tf.changeText(a)},e(0,f,"padding",function(){return this._tf.padding.join(",")},function(a){this._tf.padding=A.fillArray(z.labelPadding,a,Number)}),e(0,f,"bold",function(){return this._tf.bold},function(a){this._tf.bold=a}),e(0,f,"align",function(){return this._tf.align},function(a){this._tf.align=a}),e(0,f,"text",function(){return this._tf.text},function(a){this._tf.text!=a&&(a&&(a=(a+"").replace(b._textReg,"\n")),this._tf.text=a,this.event("change"))}),e(0,f,"italic",function(){return this._tf.italic},function(a){this._tf.italic=a}),e(0,f,"wordWrap",function(){return this._tf.wordWrap},function(a){this._tf.wordWrap=a}),e(0,f,"font",function(){return this._tf.font},function(a){this._tf.font=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.text=b+"":a.prototype._$set_dataSource.call(this,b)}),e(0,f,"color",function(){return this._tf.color},function(a){this._tf.color=a}),e(0,f,"valign",function(){return this._tf.valign},function(a){this._tf.valign=a}),e(0,f,"leading",function(){return this._tf.leading},function(a){this._tf.leading=a}),e(0,f,"fontSize",function(){return this._tf.fontSize},function(a){this._tf.fontSize=a}),e(0,f,"bgColor",function(){return this._tf.bgColor},function(a){this._tf.bgColor=a}),e(0,f,"borderColor",function(){return this._tf.borderColor},function(a){this._tf.borderColor=a}),e(0,f,"stroke",function(){return this._tf.stroke},function(a){this._tf.stroke=a}),e(0,f,"strokeColor",function(){return this._tf.strokeColor},function(a){this._tf.strokeColor=a}),e(0,f,"textField",function(){return this._tf}),e(0,f,"measureWidth",function(){return this._tf.width}),e(0,f,"measureHeight",function(){return this._tf.height}),e(0,f,"width",function(){return this._width||this._tf.text?a.prototype._$get_width.call(this):0},function(b){a.prototype._$set_width.call(this,b),this._tf.width=b}),e(0,f,"height",function(){return this._height||this._tf.text?a.prototype._$get_height.call(this):0},function(b){a.prototype._$set_height.call(this,b),this._tf.height=b}),e(0,f,"overflow",function(){return this._tf.overflow},function(a){this._tf.overflow=a}),e(0,f,"underline",function(){return this._tf.underline},function(a){this._tf.underline=a}),e(0,f,"underlineColor",function(){return this._tf.underlineColor},function(a){this._tf.underlineColor=a}),c(b,["_textReg",function(){return this._textReg=RegExp("\\\\n","g")}]),b}(D),O=function(a){function b(a){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,b.__super.call(this),this.skin=a}d(b,"laya.ui.ProgressBar",a);var c=b.prototype;return c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bg&&this._bg.destroy(b),this._bar&&this._bar.destroy(b),this._bg=this._bar=null,this.changeHandler=null},c.createChildren=function(){this.addChild(this._bg=new M),this.addChild(this._bar=new M),this._bar._bitmap.autoCacheCmd=!1},c.changeValue=function(){if(this.sizeGrid){var a=this.sizeGrid.split(","),b=+a[3],c=+a[1],d=this.width-b-c,e=d*this._value;this._bar.width=b+c+e,this._bar.visible=this._bar.width>b+c}else this._bar.width=this.width*this._value},e(0,c,"measureHeight",function(){return this._bg.height}),e(0,c,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),e(0,c,"measureWidth",function(){return this._bg.width}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bg.height=this._height,this._bar.height=this._height}),e(0,c,"bar",function(){return this._bar}),e(0,c,"value",function(){return this._value},function(a){this._value!=a&&(a=a>1?1:a<0?0:a,this._value=a,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(a))}),e(0,c,"bg",function(){return this._bg}),e(0,c,"sizeGrid",function(){return this._bg.sizeGrid},function(a){this._bg.sizeGrid=this._bar.sizeGrid=a}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bg.width=this._width,this.callLater(this.changeValue)}),e(0,c,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.value=+b:a.prototype._$set_dataSource.call(this,b)}),b}(D),P=(function(a){function c(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,c.__super.call(this),this._tipBox=new D,this._tipBox.addChild(this._tipText=new u),this._tipText.x=this._tipText.y=5,this._tipText.color=c.tipTextColor,this._defaultTipHandler=this._showDefaultTip,b.stage.on("showtip",this,this._onStageShowTip),b.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}d(c,"laya.ui.TipManager",a);var f=c.prototype;f._onStageHideTip=function(a){b.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},f._onStageShowTip=function(a){b.timer.once(c.tipDelay,this,this._showTip,[a],!0)},f._showTip=function(a){if("string"==typeof a){var c=a+"";c&&this._defaultTipHandler(c)}else a instanceof laya.utils.Handler?a.run():"function"==typeof a&&a.apply();b.stage.on("mousemove",this,this._onStageMouseMove),b.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},f._onStageMouseDown=function(a){this.closeAll()},f._onStageMouseMove=function(a){this._showToStage(this,c.offsetX,c.offsetY)},f._showToStage=function(a,c,d){void 0===c&&(c=0),void 0===d&&(d=0);var e=a.getBounds();a.x=b.stage.mouseX+c,a.y=b.stage.mouseY+d,a.x+e.width>b.stage.width&&(a.x-=e.width+c),a.y+e.height>b.stage.height&&(a.y-=e.height+d)},f.closeAll=function(){b.timer.clear(this,this._showTip),b.stage.off("mousemove",this,this._onStageMouseMove),b.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},f.showDislayTip=function(a){this.addChild(a),this._showToStage(this),b.g.addChild(this)},f._showDefaultTip=function(a){this._tipText.text=a;var d=this._tipBox.graphics;d.clear(),d.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,c.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),b.g.addChild(this)},e(0,f,"defaultTipHandler",function(){return this._defaultTipHandler},function(a){this._defaultTipHandler=a}),c.offsetX=10,c.offsetY=15,c.tipTextColor="#ffffff",c.tipBackColor="#111111",c.tipDelay=200,c}(D),function(a){function b(){this._target=null,this._playEvents=null,this.ka={},this.la=null,this.ma=null,b.__super.call(this)}d(b,"laya.ui.EffectAnimation",a);var c=b.prototype;c.na=function(a){a!=this&&this.stop()},c.oa=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this.pa))},c.pa=function(){this._target&&(this._target.event("effectanimationbegin",[this]),this.qa(),this.play(0,!1))},c.qa=function(){if(this.la){var a=0,b=0;b=this.la.length;var c;for(a=0;a<b;a++)c=this.la[a],this.ka[c]=this._target[c]}},c._displayToIndex=function(a){if(this._animationData){a<0&&(a=0),a>this._count&&(a=this._count);var b=this._animationData.nodes,c=0,d=b.length;for(d=d>1?1:d,c=0;c<d;c++)this._displayNodeToFrame(b[c],a)}},c._displayNodeToFrame=function(a,b,c){if(this._target){var d;d=this._target;var e,f,g,h,j=a.frames,k=a.keys,l=0,m=k.length;h=a.ra;var n,o,p,q,r=0;for(l=0;l<m;l++)e=k[l],f=j[e],r=h[e],r==-1?g=this.ka[e]:b<r?(o=a.keyframes[e],p=o[0],p.tween?(n=i[p.tweenMethod],null==n&&(n=i.linearNone),q=o[1],g=n(b,this.ka[e],q.value-this.ka[e],q.index)):g=this.ka[e]):g=f.length>b?f[b]:f[f.length-1],d[e]=g}},c._calculateNodeKeyFrames=function(b){a.prototype._calculateNodeKeyFrames.call(this,b);var c,d,e,f=b.keyframes;b.target;e={},b.ra=e;for(c in f)d=f[c],d.length<=1?e[c]=-1:e[c]=d[1].index},e(0,c,"effectClass",null,function(a){if(this.ma=g.getClass(a),this.ma){var b;if(b=this.ma.uiView){var c;c=b.animations,c&&c[0]&&(this._setUp({},c[0]),c[0].nodes&&c[0].nodes[0]&&(this.la=c[0].nodes[0].keys))}}}),e(0,c,"owner",null,function(a){this.target=a}),e(0,c,"target",function(){return this._target},function(a){this._target&&this._target.off("effectanimationbegin",this,this.na),this._target=a,this._target&&this._target.on("effectanimationbegin",this,this.na),this.oa()}),e(0,c,"playEvent",null,function(a){this._playEvents=a,a&&this.oa()}),b.sa="effectanimationbegin",b}(l),function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.FrameClip",a),b}(l)),Q=function(a){function e(){this._idMap=null,this._aniList=null,e.__super.call(this)}d(e,"laya.ui.View",a);var h=e.prototype;return h.createView=function(a){if(a.animations&&!this._idMap&&(this._idMap={}),e.createComp(a,this,this),a.animations){var b,c,d=[],f=a.animations,g=0,h=f.length;for(g=0;g<h;g++){switch(b=new P,c=f[g],b._setUp(this._idMap,c),this[c.name]=b,b._setControlNode(this),c.action){case 1:b.play(0,!1);break;case 2:b.play(0,!0)}d.push(b)}this._aniList=d}this._width>0&&null==a.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},h.loadUI=function(a){var b=e.uiMap[a];b&&this.createView(b)},h.destroy=function(a){void 0===a&&(a=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,laya.ui.Component.prototype.destroy.call(this,a)},e._regs=function(){var a;for(a in e.uiClassMap)g.regClass(a,e.uiClassMap[a])},e.createComp=function(a,c,d){if(!(c=c||e.getCompInstance(a)))return console.log("can not create:"+a.type),null;var f=a.child;if(f)for(var h=0,i=f.length;h<i;h++){var j=f[h];if(!c.hasOwnProperty("itemRender")||"render"!=j.props.name&&"render"!==j.props.renderType)if("Graphic"==j.type)g.addGraphicsToSprite(j,c);else if(g.isDrawType(j.type))g.addGraphicToSprite(j,c,!0);else{var k=e.createComp(j,null,d);"Script"==j.type?k.owner=c:"mask"==j.props.renderType||"mask"==j.props.name?c.mask=k:k instanceof laya.display.Sprite&&c.addChild(k)}else c.itemRender=j}var l=a.props;for(var m in l){var n=l[m];e.setCompValue(c,m,n,d)}return b.__typeof(c,"laya.ui.IItem")&&c.initItems(),a.compId&&d&&d._idMap&&(d._idMap[a.compId]=c),c},e.setCompValue=function(a,b,c,d){"var"===b&&d?d[c]=a:"x"===b||"y"===b||"width"===b||"height"===b||"number"==typeof a[b]?a[b]=parseFloat(c):a[b]="true"===c||"false"!==c&&c},e.getCompInstance=function(a){var c,d=a.props?a.props.runtime:"";return c=d?e.viewClassMap[d]||e.uiClassMap[d]||b.__classmap[d]:e.uiClassMap[a.type],c?new c:null},e.regComponent=function(a,b){e.uiClassMap[a]=b,g.regClass(a,b)},e.regViewRuntime=function(a,b){e.viewClassMap[a]=b},e.uiMap={},e.viewClassMap={},c(e,["uiClassMap",function(){return this.uiClassMap={ViewStack:$,LinkButton:G,TextArea:ha,ColorPicker:I,Box:F,Button:G,CheckBox:R,Clip:H,ComboBox:J,Component:D,HScrollBar:V,HSlider:Y,Image:M,Label:N,List:T,Panel:U,ProgressBar:O,Radio:X,RadioGroup:fa,ScrollBar:K,Slider:L,Tab:ga,TextInput:aa,View:e,VScrollBar:_,VSlider:ba,Tree:Z,HBox:da,VBox:ea,Sprite:t,Animation:f,Text:u}}]),e.__init$=function(){e._regs()},e}(F),R=function(a){function b(a,c){void 0===c&&(c=""),b.__super.call(this,a,c)}d(b,"laya.ui.CheckBox",a);var c=b.prototype;return c.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},c.initialize=function(){a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},e(0,c,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"boolean"==typeof b?this.selected=b:"string"==typeof b?this.selected="true"===b:a.prototype._$set_dataSource.call(this,b)}),b}(G),S=function(a){function b(){this._space=0,this._align="none",this._itemChanged=!1,b.__super.call(this)}d(b,"laya.ui.LayoutBox",a);var c=b.prototype;return c.addChild=function(a){return a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,a)},c.onResize=function(a){this._setItemChanged()},c.addChildAt=function(a,b){return a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,a,b)},c.removeChild=function(a){return a.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,a)},c.removeChildAt=function(a){return this.getChildAt(a).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,a)},c.refresh=function(){this._setItemChanged()},c.changeItems=function(){this._itemChanged=!1},c.sortItem=function(a){a&&a.sort(function(a,b){return a.y-b.y})},c._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},e(0,c,"space",function(){return this._space},function(a){this._space=a,this._setItemChanged()}),e(0,c,"align",function(){return this._align},function(a){this._align=a,this._setItemChanged()}),b}(F),T=function(a){function c(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,c.__super.call(this),this._cells=[]}d(c,"laya.ui.List",a);var f=c.prototype;return b.imps(f,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),f.destroy=function(a){void 0===a&&(a=!0),this._content&&this._content.destroy(a),this._scrollBar&&this._scrollBar.destroy(a),laya.ui.Component.prototype.destroy.call(this,a),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},f.createChildren=function(){this.addChild(this._content=new F)},f.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=a.prototype._$get_cacheAs.call(this)),a.prototype._$set_cacheAs.call(this,"none"),this._scrollBar.once("end",this,this.onScrollEnd)},f.onScrollEnd=function(){a.prototype._$set_cacheAs.call(this,this._$P.cacheAs)},f.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var a=this.ta(),b=a.width+this._spaceX||1,c=a.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/b):Math.ceil(this._width/b)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/c):Math.round(this._height/c));var d=this._width?this._width:b*this.repeatX-this._spaceX,e=this._height?this._height:c*this.repeatY-this._spaceY;this._cellSize=this._isVertical?c:b,this._cellOffset=this._isVertical?c*Math.max(this._repeatY2,this._repeatY)-e-this._spaceY:b*Math.max(this._repeatX2,this._repeatX)-d-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=e:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=d),this.setContentSize(d,e);var f=this._isVertical?this.repeatX:this.repeatY,g=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,f,g),this._createdLine=g,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},f.ta=function(){return 0===this._cells.length&&this._cells.push(this.createItem()),this._cells[0]},f._createItems=function(a,b,c){var d=this._content,e=this.ta(),f=e.width+this._spaceX,g=e.height+this._spaceY;if(this.cacheContent){var h=new F;h.cacheAsBitmap=!0,h.pos((this._isVertical?0:a)*f,(this._isVertical?a:0)*g),this._content.addChild(h),this._content.optimizeScrollRect=!0,d=h}for(var i=[],j=this._cells.length-1;j>-1;j--){var k=this._cells[j];k.removeSelf(),i.push(k)}this._cells.length=0;for(var l=a;l<c;l++)for(var m=0;m<b;m++)e=i.length?i.pop():this.createItem(),e.x=(this._isVertical?m:l)*f-d.x,e.y=(this._isVertical?l:m)*g-d.y,e.name="item"+(l*b+m),d.addChild(e),this.addCell(e)},f.createItem=function(){return"function"==typeof this._itemRender?new this._itemRender:Q.createComp(this._itemRender)},f.addCell=function(a){a.on("click",this,this.onCellMouse),a.on("rightclick",this,this.onCellMouse),a.on("mouseover",this,this.onCellMouse),a.on("mouseout",this,this.onCellMouse),a.on("mousedown",this,this.onCellMouse),a.on("mouseup",this,this.onCellMouse),this._cells.push(a)},f.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;var a=0;a=0;for(var b=0;b<1e4;b++){var c=this.getChildByName("item"+b);{if(!c)break;this.addCell(c),a++}}this.repeatY=a}},f.setContentSize=function(a,b){this._content.width=a,this._content.height=b,this._scrollBar&&(this._content.scrollRect||(this._content.scrollRect=new r),this._content.scrollRect.setTo(0,0,a,b),this._content.conchModel&&this._content.conchModel.scrollRect(0,0,a,b),this.event("resize"))},f.onCellMouse=function(a){"mousedown"===a.type&&(this._isMoved=!1);var b=a.currentTarget,c=this._startIndex+this._cells.indexOf(b);c<0||("click"===a.type||"rightclick"===a.type?this.selectEnable&&!this._isMoved?this.selectedIndex=c:this.changeCellState(b,!0,0):"mouseover"!==a.type&&"mouseout"!==a.type||this._selectedIndex===c||this.changeCellState(b,"mouseover"===a.type,0),this.mouseHandler&&this.mouseHandler.runWith([a,c]))},f.changeCellState=function(a,b,c){var d=a.getChildByName("selectBox");d&&(this.selectEnable=!0,d.visible=b,d.index=c)},f.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},f.onScrollBarChange=function(a){this.runCallLater(this.changeCells);var b=this._scrollBar.value,c=this._isVertical?this.repeatX:this.repeatY,d=this._isVertical?this.repeatY:this.repeatX,e=Math.floor(b/this._cellSize);if(this.cacheContent)g=d+1,this._createdLine-e<g&&(this._createItems(this._createdLine,c,this._createdLine+g),this._createdLine+=g,this.renderItems(this._createdLine*c,0));else{var f=e*c;if(f>this._startIndex){var g=f-this._startIndex,h=!0,i=this._startIndex+c*(d+1);this._isMoved=!0}else f<this._startIndex&&(g=this._startIndex-f,h=!1,i=this._startIndex-1,this._isMoved=!0);for(var j=0;j<g;j++){if(h){var k=this._cells.shift();this._cells[this._cells.length]=k;var l=i+j}else k=this._cells.pop(),this._cells.unshift(k),l=i-j;var m=Math.floor(l/c)*this._cellSize;this._isVertical?k.y=m:k.x=m,this.renderItem(k,l)}this._startIndex=f,this.changeSelectStatus()}var n=this._content.scrollRect;this._isVertical?n.y=b:n.x=b,this._content.conchModel&&this._content.conchModel.scrollRect(n.x,n.y,n.width,n.height),this.repaint()},f.posCell=function(a,b){if(this._scrollBar){var c=this._isVertical?this.repeatX:this.repeatY,d=(this._isVertical?this.repeatY:this.repeatX,Math.floor(b/c)*this._cellSize);this._isVertical?a.y=d:a.x=d}},f.changeSelectStatus=function(){for(var a=0,b=this._cells.length;a<b;a++)this.changeCellState(this._cells[a],this._selectedIndex===this._startIndex+a,1)},f.renderItems=function(a,b){void 0===a&&(a=0),void 0===b&&(b=0);for(var c=0,d=b||this._cells.length;c<d;c++)this.renderItem(this._cells[c],this._startIndex+c);this.changeSelectStatus()},f.renderItem=function(a,b){b>=0&&b<this._array.length?(a.visible=!0,a.dataSource=this._array[b],this.cacheContent||this.posCell(a,b),this.hasListener("render")&&this.event("render",[a,b]),this.renderHandler&&this.renderHandler.runWith([a,b])):(a.visible=!1,a.dataSource=null)},f.refresh=function(){this.array=this._array},f.getItem=function(a){return a>-1&&a<this._array.length?this._array[a]:null},f.changeItem=function(a,b){a>-1&&a<this._array.length&&(this._array[a]=b,a>=this._startIndex&&a<this._startIndex+this._cells.length&&this.renderItem(this.getCell(a),a))},f.setItem=function(a,b){this.changeItem(a,b)},f.addItem=function(a){this._array.push(a),this.array=this._array},f.addItemAt=function(a,b){this._array.splice(b,0,a),this.array=this._array},f.deleteItem=function(a){this._array.splice(a,1),this.array=this._array},f.getCell=function(a){return this.runCallLater(this.changeCells),a>-1&&this._cells?this._cells[(a-this._startIndex)%this._cells.length]:null},f.scrollTo=function(a){if(this._scrollBar){var b=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(a/b)*this._cellSize}else this.startIndex=a},f.tweenTo=function(a,b,c){if(void 0===b&&(b=200),this._scrollBar){var d=this._isVertical?this.repeatX:this.repeatY;w.to(this._scrollBar,{value:Math.floor(a/d)*this._cellSize},b,null,c,0,!0)}else this.startIndex=a,c&&c.run()},f._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},f.commitMeasure=function(){this.runCallLater(this.changeCells)},e(0,f,"cacheAs",a.prototype._$get_cacheAs,function(b){a.prototype._$set_cacheAs.call(this,b),this._scrollBar&&(this._$P.cacheAs=null,"none"!==b?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),e(0,f,"content",function(){return this._content}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._setCellChanged()}),e(0,f,"itemRender",function(){return this._itemRender},function(a){if(this._itemRender!=a){this._itemRender=a;for(var b=this._cells.length-1;b>-1;b--)this._cells[b].destroy();this._cells.length=0,this._setCellChanged()}}),e(0,f,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(a){this.removeChildByName("scrollBar");var b=new _;b.name="scrollBar",b.right=0,a&&" "!=a&&(b.skin=a),this.scrollBar=b,this.addChild(b),this._setCellChanged()}),e(0,f,"page",function(){return this._page},function(a){this._page=a,this._array&&(this._page=a>0?a:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),e(0,f,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(a){this.removeChildByName("scrollBar");var b=new V;b.name="scrollBar",b.bottom=0,a&&" "!=a&&(b.skin=a),this.scrollBar=b,this.addChild(b),this._setCellChanged()}),e(0,f,"repeatX",function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},function(a){this._repeatX=a,this._setCellChanged()}),e(0,f,"scrollBar",function(){return this._scrollBar},function(a){this._scrollBar!=a&&(this._scrollBar=a,a&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange)))}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._setCellChanged()}),e(0,f,"repeatY",function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},function(a){this._repeatY=a,this._setCellChanged()}),e(0,f,"spaceX",function(){return this._spaceX},function(a){this._spaceX=a,this._setCellChanged()}),e(0,f,"spaceY",function(){return this._spaceY},function(a){this._spaceY=a,this._setCellChanged()}),e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this._selectedIndex=a,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(a))}),e(0,f,"selectedItem",function(){return this._selectedIndex!=-1?this._array[this._selectedIndex]:null},function(a){this.selectedIndex=this._array.indexOf(a)}),e(0,f,"length",function(){return this._array?this._array.length:0}),e(0,f,"selection",function(){return this.getCell(this._selectedIndex)},function(a){this.selectedIndex=this._startIndex+this._cells.indexOf(a)}),e(0,f,"startIndex",function(){return this._startIndex},function(a){this._startIndex=a>0?a:0,this.callLater(this.renderItems)}),e(0,f,"array",function(){return this._array},function(a){this.runCallLater(this.changeCells),this._array=a||[];var b=this._array.length;if(this.totalPage=Math.ceil(b/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<b?this._selectedIndex:b-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll()
;var c=this._isVertical?this.repeatX:this.repeatY,d=this._isVertical?this.repeatY:this.repeatX,e=Math.ceil(b/c);(this._cellOffset>0?this.totalPage+1:this.totalPage)>1?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=d/e,this._scrollBar.setScroll(0,(e-d)*this._cellSize+this._cellOffset,this._scrollBar.value),this._scrollBar.target=this._content):(this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.selectedIndex=parseInt(b):b instanceof Array?this.array=b:a.prototype._$set_dataSource.call(this,b)}),e(0,f,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),c}(F),U=function(a){function b(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,b.__super.call(this),this.width=this.height=100,this._content.optimizeScrollRect=!0}d(b,"laya.ui.Panel",a);var c=b.prototype;return c.destroy=function(a){void 0===a&&(a=!0),laya.ui.Component.prototype.destroy.call(this,a),this._content&&this._content.destroy(a),this._vScrollBar&&this._vScrollBar.destroy(a),this._hScrollBar&&this._hScrollBar.destroy(a),this._vScrollBar=null,this._hScrollBar=null,this._content=null},c.destroyChildren=function(){this._content.destroyChildren()},c.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new F)},c.addChild=function(a){return a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(a)},c.onResize=function(){this._setScrollChanged()},c.addChildAt=function(a,b){return a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(a,b)},c.removeChild=function(a){return a.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(a)},c.removeChildAt=function(a){return this.getChildAt(a).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(a)},c.removeChildren=function(a,b){void 0===a&&(a=0),void 0===b&&(b=2147483647);for(var c=this._content.numChildren-1;c>-1;c--)this._content.removeChildAt(c);return this._setScrollChanged(),this},c.getChildAt=function(a){return this._content.getChildAt(a)},c.getChildByName=function(a){return this._content.getChildByName(a)},c.getChildIndex=function(a){return this._content.getChildIndex(a)},c.changeScroll=function(){this._scrollChanged=!1;var a=this.contentWidth,b=this.contentHeight,c=this._vScrollBar,d=this._hScrollBar,e=c&&b>this._height,f=d&&a>this._width,g=e?this._width-c.width:this._width,h=f?this._height-d.height:this._height;c&&(c.x=this._width-c.width,c.y=0,c.height=this._height-(f?d.height:0),c.scrollSize=Math.max(.033*this._height,1),c.thumbPercent=h/b,c.setScroll(0,b-h,c.value)),d&&(d.x=0,d.y=this._height-d.height,d.width=this._width-(e?c.width:0),d.scrollSize=Math.max(.033*this._width,1),d.thumbPercent=g/a,d.setScroll(0,a-g,d.value))},c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},c.setContentSize=function(a,b){var c=this._content;c.width=a,c.height=b,c.scrollRect||(c.scrollRect=new r),c.scrollRect.setTo(0,0,a,b),c.conchModel&&c.conchModel.scrollRect(0,0,a,b)},c.onScrollBarChange=function(a){var b=this._content.scrollRect;if(b){var c=Math.round(a.value);a.isVertical?b.y=c:b.x=c,this._content.conchModel&&this._content.conchModel.scrollRect(b.x,b.y,b.width,b.height)}},c.scrollTo=function(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this.vScrollBar&&(this.vScrollBar.value=b),this.hScrollBar&&(this.hScrollBar.value=a)},c.refresh=function(){this.changeScroll()},c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=a.prototype._$get_cacheAs.call(this)),a.prototype._$set_cacheAs.call(this,"none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},c.onScrollEnd=function(){a.prototype._$set_cacheAs.call(this,this._$P.cacheAs)},c._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},e(0,c,"numChildren",function(){return this._content.numChildren}),e(0,c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(a){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new V),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=a}),e(0,c,"contentWidth",function(){for(var a=0,b=this._content.numChildren-1;b>-1;b--){var c=this._content.getChildAt(b);a=Math.max(c.x+c.width*c.scaleX,a)}return a}),e(0,c,"contentHeight",function(){for(var a=0,b=this._content.numChildren-1;b>-1;b--){var c=this._content.getChildAt(b);a=Math.max(c.y+c.height*c.scaleY,a)}return a}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._setScrollChanged()}),e(0,c,"hScrollBar",function(){return this._hScrollBar}),e(0,c,"content",function(){return this._content}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._setScrollChanged()}),e(0,c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(a){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new _),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=a}),e(0,c,"vScrollBar",function(){return this._vScrollBar}),e(0,c,"cacheAs",a.prototype._$get_cacheAs,function(b){a.prototype._$set_cacheAs.call(this,b),this._$P.cacheAs=null,"none"!==b?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),b}(F),V=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.HScrollBar",a),b.prototype.initialize=function(){a.prototype.initialize.call(this),this.slider.isVertical=!1},b}(K),W=function(a){function c(a,b){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,c.__super.call(this),this.skin=b,this.labels=a}d(c,"laya.ui.UIGroup",a);var f=c.prototype;return b.imps(f,{"laya.ui.IItem":!0}),f.preinitialize=function(){this.mouseEnabled=!0},f.destroy=function(a){void 0===a&&(a=!0),laya.ui.Component.prototype.destroy.call(this,a),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},f.addItem=function(a,b){void 0===b&&(b=!0);var c=a,d=this._items.length;if(c.name="item"+d,this.addChild(c),this.initItems(),b&&d>0){var e=this._items[d-1];"horizontal"==this._direction?c.x=e.x+e.width+this._space:c.y=e.y+e.height+this._space}else b&&(c.x=0,c.y=0);return d},f.delItem=function(a,b){void 0===b&&(b=!0);var c=this._items.indexOf(a);if(c!=-1){var d=a;this.removeChild(d);for(var e=c+1,f=this._items.length;e<f;e++){var g=this._items[e];g.name="item"+(e-1),b&&("horizontal"==this._direction?g.x-=d.width+this._space:g.y-=d.height+this._space)}if(this.initItems(),this._selectedIndex>-1){var h=0;h=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=h}}},f.initItems=function(){this._items||(this._items=[]),this._items.length=0;for(var a=0;a<1e4;a++){var b=this.getChildByName("item"+a);if(null==b)break;this._items.push(b),b.selected=a===this._selectedIndex,b.clickHandler=n.create(this,this.itemClick,[a],!1)}},f.itemClick=function(a){this.selectedIndex=a},f.setSelect=function(a,b){this._items&&a>-1&&a<this._items.length&&(this._items[a].selected=b)},f.createItem=function(a,b){return null},f.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var a=0,b=0,c=this._items.length;b<c;b++){var d=this._items[b];this._skin&&(d.skin=this._skin),this._labelColors&&(d.labelColors=this._labelColors),this._labelSize&&(d.labelSize=this._labelSize),this._labelStroke&&(d.labelStroke=this._labelStroke),this._labelStrokeColor&&(d.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(d.strokeColors=this._strokeColors),this._labelBold&&(d.labelBold=this._labelBold),this._labelPadding&&(d.labelPadding=this._labelPadding),this._labelAlign&&(d.labelAlign=this._labelAlign),this._stateNum&&(d.stateNum=this._stateNum),"horizontal"===this._direction?(d.y=0,d.x=a,a+=d.width+this._space):(d.x=0,d.y=a,a+=d.height+this._space)}this.changeSize()},f.commitMeasure=function(){this.runCallLater(this.changeLabels)},f._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},e(0,f,"labelStrokeColor",function(){return this._labelStrokeColor},function(a){this._labelStrokeColor!=a&&(this._labelStrokeColor=a,this._setLabelChanged())}),e(0,f,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._setLabelChanged())}),e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=a,this.setSelect(a,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),e(0,f,"labels",function(){return this._labels},function(a){if(this._labels!=a){if(this._labels=a,this.removeChildren(),this._setLabelChanged(),this._labels)for(var b=this._labels.split(","),c=0,d=b.length;c<d;c++){var e=this.createItem(this._skin,b[c]);e.name="item"+c,this.addChild(e)}this.initItems()}}),e(0,f,"strokeColors",function(){return this._strokeColors},function(a){this._strokeColors!=a&&(this._strokeColors=a,this._setLabelChanged())}),e(0,f,"labelColors",function(){return this._labelColors},function(a){this._labelColors!=a&&(this._labelColors=a,this._setLabelChanged())}),e(0,f,"labelStroke",function(){return this._labelStroke},function(a){this._labelStroke!=a&&(this._labelStroke=a,this._setLabelChanged())}),e(0,f,"labelSize",function(){return this._labelSize},function(a){this._labelSize!=a&&(this._labelSize=a,this._setLabelChanged())}),e(0,f,"stateNum",function(){return this._stateNum},function(a){this._stateNum!=a&&(this._stateNum=a,this._setLabelChanged())}),e(0,f,"labelBold",function(){return this._labelBold},function(a){this._labelBold!=a&&(this._labelBold=a,this._setLabelChanged())}),e(0,f,"labelPadding",function(){return this._labelPadding},function(a){this._labelPadding!=a&&(this._labelPadding=a,this._setLabelChanged())}),e(0,f,"direction",function(){return this._direction},function(a){this._direction=a,this._setLabelChanged()}),e(0,f,"space",function(){return this._space},function(a){this._space=a,this._setLabelChanged()}),e(0,f,"items",function(){return this._items}),e(0,f,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(a){this.selectedIndex=this._items.indexOf(a)}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.selectedIndex=parseInt(b):b instanceof Array?this.labels=b.join(","):a.prototype._$set_dataSource.call(this,b)}),c}(F),X=function(a){function b(a,c){this._value=null,void 0===c&&(c=""),b.__super.call(this,a,c)}d(b,"laya.ui.Radio",a);var c=b.prototype;return c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._value=null},c.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},c.initialize=function(){a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},c.onClick=function(a){this.selected=!0},e(0,c,"value",function(){return null!=this._value?this._value:this.label},function(a){this._value=a}),b}(G),Y=function(a){function b(a){b.__super.call(this,a),this.isVertical=!1}return d(b,"laya.ui.HSlider",a),b}(L),Z=function(a){function c(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,c.__super.call(this),this.width=this.height=200}d(c,"laya.ui.Tree",a);var f=c.prototype;return b.imps(f,{"laya.ui.IRender":!0}),f.destroy=function(a){void 0===a&&(a=!0),laya.ui.Component.prototype.destroy.call(this,a),this._list&&this._list.destroy(a),this._list=null,this._source=null,this._renderHandler=null},f.createChildren=function(){this.addChild(this._list=new T),this._list.renderHandler=n.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},f.onListChange=function(a){this.event("change")},f.getArray=function(){var a,b=[];for(var c in this._source)a=this._source[c],this.getParentOpenStatus(a)&&(a.x=this._spaceLeft*this.getDepth(a),b.push(a));return b},f.getDepth=function(a,b){return void 0===b&&(b=0),null==a.nodeParent?b:this.getDepth(a.nodeParent,b+1)},f.getParentOpenStatus=function(a){var b=a.nodeParent;return null==b||!!b.isOpen&&(null==b.nodeParent||this.getParentOpenStatus(b))},f.renderItem=function(a,b){var c=a.dataSource;if(c){a.left=c.x;var d=a.getChildByName("arrow");d&&(c.hasChild?(d.visible=!0,d.index=c.isOpen?1:0,d.tag=b,d.off("click",this,this.onArrowClick),d.on("click",this,this.onArrowClick)):d.visible=!1);var e=a.getChildByName("folder");e&&(2==e.clipY?e.index=c.isDirectory?0:1:e.index=c.isDirectory?c.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([a,b])}},f.onArrowClick=function(a){var b=a.currentTarget,c=b.tag;this._list.array[c].isOpen=!this._list.array[c].isOpen,this._list.array=this.getArray()},f.setItemState=function(a,b){this._list.array[a]&&(this._list.array[a].isOpen=b,this._list.array=this.getArray())},f.fresh=function(){this._list.array=this.getArray(),this.repaint()},f.parseXml=function(a,b,c,d){var e,f=a.childNodes,g=f.length;if(!d){e={};var h,i=a.attributes;for(var j in i){h=i[j];var k=h.nodeName,l=h.nodeValue;e[k]="true"==l||"false"!=l&&l}e.nodeParent=c,g>0&&(e.isDirectory=!0),e.hasChild=g>0,b.push(e)}for(var m=0;m<g;m++){var n=f[m];this.parseXml(n,b,e,!1)}},f.parseOpenStatus=function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e.isDirectory)for(var f=0,g=a.length;f<g;f++){var h=a[f];if(h.isDirectory&&this.isSameParent(h,e)&&e.label==h.label){e.isOpen=h.isOpen;break}}}},f.isSameParent=function(a,b){return null==a.nodeParent&&null==b.nodeParent||null!=a.nodeParent&&null!=b.nodeParent&&(a.nodeParent.label==b.nodeParent.label&&this.isSameParent(a.nodeParent,b.nodeParent))},f.filter=function(a){if(a){var b=[];this.getFilterSource(this._source,b,a),this._list.array=b}else this._list.array=this.getArray()},f.getFilterSource=function(a,b,c){c=c.toLocaleLowerCase();var d;for(var e in a)d=a[e],!d.isDirectory&&(d.label+"").toLowerCase().indexOf(c)>-1&&(d.x=0,b.push(d)),d.child&&d.child.length>0&&this.getFilterSource(d.child,b,c)},e(0,f,"spaceBottom",function(){return this._list.spaceY},function(a){this._list.spaceY=a}),e(0,f,"keepStatus",function(){return this._keepStatus},function(a){this._keepStatus=a}),e(0,f,"itemRender",function(){return this._list.itemRender},function(a){this._list.itemRender=a}),e(0,f,"array",function(){return this._list.array},function(a){this._keepStatus&&this._list.array&&a&&this.parseOpenStatus(this._list.array,a),this._source=a,this._list.array=this.getArray()}),e(0,f,"mouseHandler",function(){return this._list.mouseHandler},function(a){this._list.mouseHandler=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,a.prototype._$set_dataSource.call(this,b)}),e(0,f,"source",function(){return this._source}),e(0,f,"scrollBar",function(){return this._list.scrollBar}),e(0,f,"list",function(){return this._list}),e(0,f,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(a){this._list.vScrollBarSkin=a}),e(0,f,"renderHandler",function(){return this._renderHandler},function(a){this._renderHandler=a}),e(0,f,"selectedIndex",function(){return this._list.selectedIndex},function(a){this._list.selectedIndex=a}),e(0,f,"spaceLeft",function(){return this._spaceLeft},function(a){this._spaceLeft=a}),e(0,f,"selectedItem",function(){return this._list.selectedItem},function(a){this._list.selectedItem=a}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._list.width=b}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._list.height=b}),e(0,f,"xml",null,function(a){var b=[];this.parseXml(a.childNodes[0],b,null,!0),this.array=b}),e(0,f,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),c}(F),$=function(a){function c(){this._items=null,this._selectedIndex=0,c.__super.call(this),this._setIndexHandler=n.create(this,this.setIndex,null,!1)}d(c,"laya.ui.ViewStack",a);var f=c.prototype;return b.imps(f,{"laya.ui.IItem":!0}),f.setItems=function(a){this.removeChildren();for(var b=0,c=0,d=a.length;c<d;c++){var e=a[c];e&&(e.name="item"+b,this.addChild(e),b++)}this.initItems()},f.addItem=function(a){a.name="item"+this._items.length,this.addChild(a),this.initItems()},f.initItems=function(){this._items=[];for(var a=0;a<1e4;a++){var b=this.getChildByName("item"+a);if(null==b)break;this._items.push(b),b.visible=a==this._selectedIndex}},f.setSelect=function(a,b){this._items&&a>-1&&a<this._items.length&&(this._items[a].visible=b)},f.setIndex=function(a){this.selectedIndex=a},e(0,f,"dataSource",a.prototype._$get_dataSource,function(a){if(this._dataSource=a,"number"==typeof a&&Math.floor(a)==a||"string"==typeof a)this.selectedIndex=parseInt(a);else for(var b in this._dataSource)this.hasOwnProperty(b)&&(this[b]=this._dataSource[b])}),e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=a,this.setSelect(this._selectedIndex,!0))}),e(0,f,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(a){this.selectedIndex=this._items.indexOf(a)}),e(0,f,"items",function(){return this._items}),e(0,f,"setIndexHandler",function(){return this._setIndexHandler},function(a){this._setIndexHandler=a}),c}(F),_=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.VScrollBar",a),b}(K),aa=function(a){function b(a){this._bg=null,this._skin=null,b.__super.call(this),void 0===a&&(a=""),this.text=a,this.skin=this.skin}d(b,"laya.ui.TextInput",a);var c=b.prototype;return c.preinitialize=function(){this.mouseEnabled=!0},c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bg&&this._bg.destroy(),this._bg=null},c.createChildren=function(){this.addChild(this._tf=new o),this._tf.padding=z.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},c._onFocus=function(){this.event("focus",this)},c._onBlur=function(){this.event("blur",this)},c._onInput=function(){this.event("input",this)},c._onEnter=function(){this.event("enter",this)},c.initialize=function(){this.width=128,this.height=22},c.select=function(){this._tf.select()},c.setSelection=function(a,b){this._tf.setSelection(a,b)},e(0,c,"bg",function(){return this._bg},function(a){this.graphics=this._bg=a}),e(0,c,"multiline",function(){return this._tf.multiline},function(a){this._tf.multiline=a}),e(0,c,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(a){this._tf.inputElementYAdjuster=a}),e(0,c,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._bg||(this.graphics=this._bg=new C),this._bg.source=p.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),e(0,c,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(a){this._bg||(this.graphics=this._bg=new C),this._bg.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,c,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(a){this._tf.inputElementXAdjuster=a}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bg&&(this._bg.width=b)}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bg&&(this._bg.height=b)}),e(0,c,"editable",function(){return this._tf.editable},function(a){this._tf.editable=a}),e(0,c,"restrict",function(){return this._tf.restrict},function(a){this._tf.restrict=a}),e(0,c,"prompt",function(){return this._tf.prompt},function(a){this._tf.prompt=a}),e(0,c,"promptColor",function(){return this._tf.promptColor},function(a){this._tf.promptColor=a}),e(0,c,"maxChars",function(){return this._tf.maxChars},function(a){this._tf.maxChars=a}),e(0,c,"focus",function(){return this._tf.focus},function(a){this._tf.focus=a}),e(0,c,"type",function(){return this._tf.type},function(a){this._tf.type=a}),e(0,c,"asPassword",function(){return this._tf.asPassword},function(a){this._tf.asPassword=a}),b}(N),ba=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.VSlider",a),b}(L),ca=function(a){function b(){this.popupCenter=!0,this.closeHandler=null,this.group=null,this.isModal=!1,this._dragArea=null,b.__super.call(this)}d(b,"laya.ui.Dialog",a);var c=b.prototype;return c.initialize=function(){this._dealDragArea(),this.on("click",this,this._onClick)},c._dealDragArea=function(){var a=this.getChildByName("drag");a&&(this.dragArea=a.x+","+a.y+","+a.width+","+a.height,a.removeSelf())},c._onClick=function(a){var b=a.target;if(b)switch(b.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(b.name)}},c.show=function(a){void 0===a&&(a=!1),this._open(!1,a)},c.popup=function(a){void 0===a&&(a=!1),this._open(!0,a)},c._open=function(a,c){b.manager.lock(!1),this.isModal=a,b.manager.open(this,c)},c.close=function(a){b.manager.close(this)},c._onMouseDown=function(a){var b=this.getMousePoint();this._dragArea.contains(b.x,b.y)?this.startDrag():this.stopDrag()},e(0,c,"dragArea",function(){return this._dragArea?""+this._dragArea:null},function(a){if(a){var b=A.fillArray([0,0,0,0],a,Number);this._dragArea=new r(b[0],b[1],b[2],b[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),e(0,c,"isPopup",function(){return null!=this.parent}),e(0,c,"zOrder",a.prototype._$get_zOrder,function(c){a.prototype._$set_zOrder.call(this,c),b.manager._checkMask()}),e(1,b,"manager",function(){return b._manager=b._manager||new E},function(a){b._manager=a}),b.setLockView=function(a){b.manager.setLockView(a)},b.lock=function(a){b.manager.lock(a)},b.closeAll=function(){b.manager.closeAll()},b.getDialogsByGroup=function(a){return b.manager.getDialogsByGroup(a)},b.closeByGround=function(a){return b.manager.closeByGround(a)},b.CLOSE="close",b.CANCEL="cancel",b.SURE="sure",b.NO="no",b.OK="ok",b.YES="yes",b._manager=null,b}(Q),da=function(a){function b(){b.__super.call(this)}d(b,"laya.ui.HBox",a);var c=b.prototype;return c.sortItem=function(a){a&&a.sort(function(a,b){return a.x-b.x})},c.changeItems=function(){this._itemChanged=!1;for(var a=[],b=0,c=0,d=this.numChildren;c<d;c++){var e=this.getChildAt(c);e&&(a.push(e),b=Math.max(b,e.height*e.scaleY))}this.sortItem(a);var f=0;for(c=0,d=this.numChildren;c<d;c++)e=a[c],e.x=f,f+=e.width*e.scaleX+this._space,"top"==this._align?e.y=0:"middle"==this._align?e.y=.5*(b-e.height*e.scaleY):"bottom"==this._align&&(e.y=b-e.height*e.scaleY);this.changeSize()},b.NONE="none",b.TOP="top",b.MIDDLE="middle",b.BOTTOM="bottom",b}(S),ea=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.VBox",a),b.prototype.changeItems=function(){this._itemChanged=!1;for(var a=[],b=0,c=0,d=this.numChildren;c<d;c++){var e=this.getChildAt(c);e&&(a.push(e),b=Math.max(b,e.width*e.scaleX))}this.sortItem(a);var f=0;for(c=0,d=this.numChildren;c<d;c++)e=a[c],e.y=f,f+=e.height*e.scaleY+this._space,"left"==this._align?e.x=0:"center"==this._align?e.x=.5*(b-e.width*e.scaleX):"right"==this._align&&(e.x=b-e.width*e.scaleX);this.changeSize()},b.NONE="none",b.LEFT="left",b.CENTER="center",b.RIGHT="right",b}(S),fa=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.RadioGroup",a),b.prototype.createItem=function(a,b){return new X(a,b)},b}(W),ga=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.Tab",a),b.prototype.createItem=function(a,b){return new G(a,b)},b}(W),ha=function(a){function b(a){this._vScrollBar=null,this._hScrollBar=null,void 0===a&&(a=""),b.__super.call(this,a)}d(b,"laya.ui.TextArea",a);var c=b.prototype;return c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},c.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},c.onVBarChanged=function(a){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},c.onHBarChanged=function(a){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},c.changeScroll=function(){var a=this._vScrollBar&&this._tf.maxScrollY>0,b=this._hScrollBar&&this._tf.maxScrollX>0,c=a?this._width-this._vScrollBar.width:this._width,d=b?this._height-this._hScrollBar.height:this._height,e=this._tf.padding||z.labelPadding;this._tf.width=c,this._tf.height=d,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-e[2],this._vScrollBar.y=e[1],this._vScrollBar.height=this._height-(b?this._hScrollBar.height:0)-e[1]-e[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=d/Math.max(this._tf.textHeight,d),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=a),this._hScrollBar&&(this._hScrollBar.x=e[0],this._hScrollBar.y=this._height-this._hScrollBar.height-e[3],this._hScrollBar.width=this._width-(a?this._vScrollBar.width:0)-e[0]-e[2],this._hScrollBar.scrollSize=Math.max(.033*c,1),this._hScrollBar.thumbPercent=c/Math.max(this._tf.textWidth,c),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=b)},c.scrollTo=function(a){this.commitMeasure(),this._tf.scrollY=a},e(0,c,"scrollY",function(){return this._tf.scrollY}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this.callLater(this.changeScroll)}),e(0,c,"hScrollBar",function(){return this._hScrollBar}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this.callLater(this.changeScroll)}),e(0,c,"maxScrollX",function(){return this._tf.maxScrollX}),e(0,c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(a){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new _),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=a}),e(0,c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(a){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new V),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=a}),e(0,c,"vScrollBar",function(){return this._vScrollBar}),e(0,c,"maxScrollY",function(){return this._tf.maxScrollY}),e(0,c,"scrollX",function(){return this._tf.scrollX}),b}(aa);!function(a){function b(){this._uiView=null,b.__super.call(this)}d(b,"laya.ui.AsynDialog",a);var c=b.prototype;c.createView=function(a){this._uiView=a},c.ready=function(){this._uiView&&(laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null),this._dealDragArea(),this.callLater(this.event,["ready"])},c.show=function(a){void 0===a&&(a=!1),ca.manager.lock(!0),this.once("ready",this,this._open,[!1,a]),this.ua()},c.popup=function(a){void 0===a&&(a=!1),ca.manager.lock(!0),this.once("ready",this,this._open,[!0,a]),this.ua()},c.ua=function(){},b}(ca);b.__init([Q])}(0,0,b),function(window,a,b){var c=(b.un,b.uns,b.static),d=b.class,e=b.getset,f=(b.__newvec,laya.display.Animation),g=laya.utils.ClassUtils,h=laya.filters.ColorFilter,i=laya.utils.Ease,j=laya.events.Event,k=laya.display.css.Font,l=laya.display.FrameAnimation,m=laya.display.Graphics,n=laya.utils.Handler,o=laya.display.Input,p=laya.net.Loader,q=(laya.display.Node,laya.maths.Point),r=laya.maths.Rectangle,s=laya.renders.Render,t=laya.display.Sprite,u=laya.display.Text,v=laya.resource.Texture,w=laya.utils.Tween,x=laya.utils.Utils;b.interface("laya.ui.IItem"),b.interface("laya.ui.ISelect"),b.interface("laya.ui.IRender"),b.interface("laya.ui.IComponent"),b.interface("laya.ui.IBox","IComponent");var y=function(){function a(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return d(a,"laya.ui.LayoutStyle"),c(a,["EMPTY",function(){return this.EMPTY=new a}]),a}(),z=function(){function a(){}return d(a,"laya.ui.Styles"),a.labelColor="#000000",a.buttonStateNum=3,a.scrollBarMinNum=15,a.scrollBarDelayTime=500,c(a,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),a}(),A=function(){function a(){}return d(a,"laya.ui.UIUtils"),a.fillArray=function(a,b,c){var d=a.concat();if(b)for(var e=b.split(","),f=0,g=Math.min(d.length,e.length);f<g;f++){var h=e[f];d[f]="true"==h||"false"!=h&&h,null!=c&&(d[f]=c(h))}return d},a.toColor=function(a){return x.toHexColor(a)},a.gray=function(b,c){void 0===c&&(c=!0),c?a.addFilter(b,a.grayFilter):a.clearFilter(b,h)},a.addFilter=function(a,b){var c=a.filters||[];c.push(b),a.filters=c},a.clearFilter=function(a,c){var d=a.filters;if(null!=d&&d.length>0){for(var e=d.length-1;e>-1;e--){var f=d[e];b.__typeof(f,c)&&d.splice(e,1)}a.filters=d}},c(a,["grayFilter",function(){return this.grayFilter=new h([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])}]),a}(),B=function(){function a(){}return d(a,"UIConfig"),a.touchScrollEnable=!0,a.mouseWheelEnable=!0,a.showButtons=!0,a.popupBgColor="#000000",a.popupBgAlpha=.5,a.closeDialogOnSide=!0,a}(),C=function(a){function c(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,c.__super.call(this)}d(c,"laya.ui.AutoBitmap",a);var f=c.prototype;return f.destroy=function(){a.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},f._setChanged=function(){this._isChanged||(this._isChanged=!0,b.timer.callLater(this,this.changeSource))},f.changeSource=function(){c.cacheCount++>50&&c.clearCache(),this._isChanged=!1;var a=this._source;if(a&&a.bitmap){var b=this.width,d=this.height,e=this._sizeGrid,f=a.sourceWidth,g=a.sourceHeight;if(!e||f===b&&g===d)this.cleanByTexture(a,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,b,d);else{a.$_GID||(a.$_GID=x.getGID());var h=a.$_GID+"."+b+"."+d+"."+e.join(".");if(c.cmdCaches[h])return void(this.cmds=c.cmdCaches[h]);this.clear();var i=e[0],j=e[1],k=e[2],l=e[3],m=e[4]
;l+j>b&&(j=0),l&&i&&this.drawTexture(c.getTexture(a,0,0,l,i),0,0,l,i),j&&i&&this.drawTexture(c.getTexture(a,f-j,0,j,i),b-j,0,j,i),l&&k&&this.drawTexture(c.getTexture(a,0,g-k,l,k),0,d-k,l,k),j&&k&&this.drawTexture(c.getTexture(a,f-j,g-k,j,k),b-j,d-k,j,k),i&&this.drawBitmap(m,c.getTexture(a,l,0,f-l-j,i),l,0,b-l-j,i),k&&this.drawBitmap(m,c.getTexture(a,l,g-k,f-l-j,k),l,d-k,b-l-j,k),l&&this.drawBitmap(m,c.getTexture(a,0,i,l,g-i-k),0,i,l,d-i-k),j&&this.drawBitmap(m,c.getTexture(a,f-j,i,j,g-i-k),b-j,i,j,d-i-k),this.drawBitmap(m,c.getTexture(a,l,i,f-l-j,g-i-k),l,i,b-l-j,d-i-k),this.autoCacheCmd&&!s.isConchApp&&(c.cmdCaches[h]=this.cmds)}this._repaint()}},f.drawBitmap=function(a,b,c,d,e,f){void 0===e&&(e=0),void 0===f&&(f=0),e<.1||f<.1||(!a||b.width==e&&b.height==f?this.drawTexture(b,c,d,e,f):this.fillTexture(b,c,d,e,f))},e(0,f,"sizeGrid",function(){return this._sizeGrid},function(a){this._sizeGrid=a,this._setChanged()}),e(0,f,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(a){this._width!=a&&(this._width=a,this._setChanged())}),e(0,f,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(a){this._height!=a&&(this._height=a,this._setChanged())}),e(0,f,"source",function(){return this._source},function(a){a?(this._source=a,this._setChanged()):(this._source=null,this.clear())}),c.getTexture=function(a,b,d,e,f){e<=0&&(e=1),f<=0&&(f=1),a.$_GID||(a.$_GID=x.getGID());var g=a.$_GID+"."+b+"."+d+"."+e+"."+f,h=c.textureCache[g];return h||(h=c.textureCache[g]=v.createFromTexture(a,b,d,e,f)),h},c.clearCache=function(){c.cacheCount=0,c.cmdCaches={},c.textureCache={}},c.setCache=function(a,b){c.cacheCount++,c.textureCache[a]=b},c.getCache=function(a){return c.textureCache[a]},c.cmdCaches={},c.cacheCount=0,c.textureCache={},c}(m),D=(function(a){function b(){b.__super.call(this)}d(b,"laya.ui.UIEvent",a),b.SHOW_TIP="showtip",b.HIDE_TIP="hidetip",b}(j),function(a){function c(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,c.__super.call(this),this._layout=y.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}d(c,"laya.ui.Component",a);var f=c.prototype;return b.imps(f,{"laya.ui.IComponent":!0}),f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},f.preinitialize=function(){},f.createChildren=function(){},f.initialize=function(){},f.callLater=function(a,c){b.timer.callLater(this,a,c)},f.runCallLater=function(a){b.timer.runCallLater(this,a)},f.commitMeasure=function(){},f.changeSize=function(){this.event("resize")},f.getLayout=function(){return this._layout===y.EMPTY&&(this._layout=new y),this._layout},f.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},f.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},f.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},f.resetLayoutX=function(){var a=this._layout;isNaN(a.anchorX)||(this.pivotX=a.anchorX*this.width);var b=this.parent;b&&(isNaN(a.centerX)?isNaN(a.left)?isNaN(a.right)||(this.x=Math.round(b.width-this.displayWidth-a.right+this.pivotX*this.scaleX)):(this.x=Math.round(a.left+this.pivotX*this.scaleX),isNaN(a.right)||(this.width=(b._width-a.left-a.right)/this.scaleX)):this.x=Math.round(.5*(b.width-this.displayWidth)+a.centerX+this.pivotX*this.scaleX))},f.resetLayoutY=function(){var a=this._layout;isNaN(a.anchorY)||(this.pivotY=a.anchorY*this.height);var b=this.parent;b&&(isNaN(a.centerY)?isNaN(a.top)?isNaN(a.bottom)||(this.y=Math.round(b.height-this.displayHeight-a.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(a.top+this.pivotY*this.scaleY),isNaN(a.bottom)||(this.height=(b._height-a.top-a.bottom)/this.scaleY)):this.y=Math.round(.5*(b.height-this.displayHeight)+a.centerY+this.pivotY*this.scaleY))},f.onMouseOver=function(a){b.stage.event("showtip",this._toolTip)},f.onMouseOut=function(a){b.stage.event("hidetip",this._toolTip)},e(0,f,"displayWidth",function(){return this.width*this.scaleX}),e(0,f,"width",function(){return this._width?this._width:this.measureWidth},function(a){this._width!=a&&(this._width=a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),e(0,f,"measureWidth",function(){var a=0;this.commitMeasure();for(var b=this.numChildren-1;b>-1;b--){var c=this.getChildAt(b);c.visible&&(a=Math.max(c.x+c.width*c.scaleX,a))}return a}),e(0,f,"layOutEabled",null,function(a){this._layout&&this._layout.enable!=a&&(this._layout.enable=a,this.parent?this.onAdded():(this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved)))}),e(0,f,"displayHeight",function(){return this.height*this.scaleY}),e(0,f,"height",function(){return this._height?this._height:this.measureHeight},function(a){this._height!=a&&(this._height=a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),e(0,f,"dataSource",function(){return this._dataSource},function(a){this._dataSource=a;for(var b in this._dataSource)this.hasOwnProperty(b)&&(this[b]=this._dataSource[b])}),e(0,f,"scaleY",a.prototype._$get_scaleY,function(b){a.prototype._$get_scaleY.call(this)!=b&&(a.prototype._$set_scaleY.call(this,b),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),e(0,f,"measureHeight",function(){var a=0;this.commitMeasure();for(var b=this.numChildren-1;b>-1;b--){var c=this.getChildAt(b);c.visible&&(a=Math.max(c.y+c.height*c.scaleY,a))}return a}),e(0,f,"scaleX",a.prototype._$get_scaleX,function(b){a.prototype._$get_scaleX.call(this)!=b&&(a.prototype._$set_scaleX.call(this,b),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),e(0,f,"top",function(){return this._layout.top},function(a){this.getLayout().top=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"bottom",function(){return this._layout.bottom},function(a){this.getLayout().bottom=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"left",function(){return this._layout.left},function(a){this.getLayout().left=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"right",function(){return this._layout.right},function(a){this.getLayout().right=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"centerX",function(){return this._layout.centerX},function(a){this.getLayout().centerX=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"centerY",function(){return this._layout.centerY},function(a){this.getLayout().centerY=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"anchorX",function(){return this._layout.anchorX},function(a){this.getLayout().anchorX=a,this.layOutEabled=!0,this.resetLayoutX()}),e(0,f,"anchorY",function(){return this._layout.anchorY},function(a){this.getLayout().anchorY=a,this.layOutEabled=!0,this.resetLayoutY()}),e(0,f,"tag",function(){return this._tag},function(a){this._tag=a}),e(0,f,"toolTip",function(){return this._toolTip},function(a){this._toolTip!=a&&(this._toolTip=a,null!=a?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),e(0,f,"comXml",function(){return this._comXml},function(a){this._comXml=a}),e(0,f,"gray",function(){return this._gray},function(a){a!==this._gray&&(this._gray=a,A.gray(this,a))}),e(0,f,"disabled",function(){return this._disabled},function(a){a!==this._disabled&&(this.gray=this._disabled=a,this.mouseEnabled=!a)}),c}(t)),E=function(a){function c(){this.lockLayer=null,this.popupEffect=function(a){a.scale(1,1),w.from(a,{x:b.stage.width/2,y:b.stage.height/2,scaleX:0,scaleY:0},300,i.backOut)},this.closeEffect=function(a){var c=this;w.to(a,{x:b.stage.width/2,y:b.stage.height/2,scaleX:0,scaleY:0},300,i.strongOut,n.create(c,c._doClose,[a]))},c.__super.call(this),this.maskLayer=new t,this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,b.stage.addChild(this),b.stage.on("resize",this,this._onResize),B.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}d(c,"laya.ui.DialogManager",a);var e=c.prototype;return e._closeOnSide=function(){var a=this.getChildAt(this.numChildren-1);a instanceof laya.ui.Dialog&&a.close("side")},e.setLockView=function(a){this.lockLayer||(this.lockLayer=new F,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(b.stage.width,b.stage.height)),this.lockLayer.removeChildren(),a&&(a.centerX=a.centerY=0,this.lockLayer.addChild(a))},e._onResize=function(a){var c=this.maskLayer.width=b.stage.width,d=this.maskLayer.height=b.stage.height;this.lockLayer&&this.lockLayer.size(c,d),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,c,d,B.popupBgColor),this.maskLayer.alpha=B.popupBgAlpha;for(var e=this.numChildren-1;e>-1;e--){var f=this.getChildAt(e);f.popupCenter&&this._centerDialog(f)}},e._centerDialog=function(a){a.x=Math.round((b.stage.width-a.width>>1)+a.pivotX),a.y=Math.round((b.stage.height-a.height>>1)+a.pivotY)},e.open=function(a,b){void 0===b&&(b=!1),b&&this.removeChildren(),a.popupCenter&&this._centerDialog(a),this.addChild(a),(a.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),this.popupEffect&&this.popupEffect(a),this.event("open")},e.lock=function(a){this.lockLayer&&(a?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},e.close=function(a){null!=this.closeEffect?this.closeEffect(a):this._doClose(a)},e._doClose=function(a){a.removeSelf(),a.isModal&&this._checkMask(),a.closeHandler&&a.closeHandler.run(),this.event("close")},e.closeAll=function(){this.removeChildren(),this.event("close")},e.getDialogsByGroup=function(a){for(var b=[],c=this.numChildren-1;c>-1;c--){var d=this.getChildAt(c);d.group===a&&b.push(d)}return b},e.closeByGround=function(a){for(var b=[],c=this.numChildren-1;c>-1;c--){var d=this.getChildAt(c);d.group===a&&d.close()}return b},e._checkMask=function(){this.maskLayer.removeSelf();for(var a=this.numChildren-1;a>-1;a--){var b=this.getChildAt(a);if(b&&b.isModal)return void this.addChildAt(this.maskLayer,a)}},c}(t),F=function(a){function c(){c.__super.call(this)}d(c,"laya.ui.Box",a);var f=c.prototype;return b.imps(f,{"laya.ui.IBox":!0}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(a){this._dataSource=a;for(var b in a){var c=this.getChildByName(b);c?c.dataSource=a[b]:this.hasOwnProperty(b)&&(this[b]=a[b])}}),c}(D),G=function(a){function f(a,b){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,f.__super.call(this),this._labelColors=z.buttonLabelColors,this._stateNum=z.buttonStateNum,void 0===b&&(b=""),this.skin=a,this.label=b}d(f,"laya.ui.Button",a);var g=f.prototype;return b.imps(g,{"laya.ui.ISelect":!0}),g.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(b),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},g.createChildren=function(){this.graphics=this._bitmap=new C},g.createText=function(){this._text||(this._text=new u,this._text.overflow=u.HIDDEN,this._text.align="center",this._text.valign="middle")},g.initialize=function(){this.on("mouseover",this,this.onMouse),this.on("mouseout",this,this.onMouse),this.on("mousedown",this,this.onMouse),this.on("mouseup",this,this.onMouse),this.on("click",this,this.onMouse)},g.onMouse=function(a){if(this.toggle!==!1||!this._selected)return"click"===a.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=f.stateMap[a.type]))},g.changeClips=function(){var a=p.getRes(this._skin);if(!a)return void console.log("lose skin",this._skin);var b=a.sourceWidth,c=a.sourceHeight/this._stateNum;a.$_GID||(a.$_GID=x.getGID());var d=a.$_GID+"-"+this._stateNum,e=C.getCache(d);if(e)this._sources=e;else{if(this._sources=[],1===this._stateNum)this._sources.push(a);else for(var f=0;f<this._stateNum;f++)this._sources.push(v.createFromTexture(a,0,c*f,b,c));C.setCache(d,this._sources)}this._autoSize?(this._bitmap.width=this._width||b,this._bitmap.height=this._height||c,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=b)},g.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var a=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[a]),this.label&&(this._text.color=this._labelColors[a],this._strokeColors&&(this._text.strokeColor=this._strokeColors[a]))},g._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},e(0,g,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(a){this.createText(),this._text.strokeColor=a}),e(0,g,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),e(0,g,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this.callLater(this.changeClips),this._setStateChanged())}),e(0,g,"state",function(){return this._state},function(a){this._state!=a&&(this._state=a,this._setStateChanged())}),e(0,g,"text",function(){return this.createText(),this._text}),e(0,g,"stateNum",function(){return this._stateNum},function(a){this._stateNum!=a&&(this._stateNum=a<1?1:a>3?3:a,this.callLater(this.changeClips))}),e(0,g,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(a){this._strokeColors=A.fillArray(z.buttonLabelColors,a,String),this._setStateChanged()}),e(0,g,"labelColors",function(){return this._labelColors.join(",")},function(a){this._labelColors=A.fillArray(z.buttonLabelColors,a,String),this._setStateChanged()}),e(0,g,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),e(0,g,"label",function(){return this._text?this._text.text:null},function(a){(this._text||a)&&(this.createText(),this._text.text!=a&&(a&&!this._text.displayedInStage&&this.addChild(this._text),this._text.text=(a+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),e(0,g,"selected",function(){return this._selected},function(a){this._selected!=a&&(this._selected=a,this.state=this._selected?2:0,this.event("change"))}),e(0,g,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(a){this.createText(),this._text.padding=A.fillArray(z.labelPadding,a,Number)}),e(0,g,"labelSize",function(){return this.createText(),this._text.fontSize},function(a){this.createText(),this._text.fontSize=a}),e(0,g,"labelStroke",function(){return this.createText(),this._text.stroke},function(a){this.createText(),this._text.stroke=a}),e(0,g,"labelBold",function(){return this.createText(),this._text.bold},function(a){this.createText(),this._text.bold=a}),e(0,g,"labelFont",function(){return this.createText(),this._text.font},function(a){this.createText(),this._text.font=a}),e(0,g,"labelAlign",function(){return this.createText(),this._text.align},function(a){this.createText(),this._text.align=a}),e(0,g,"clickHandler",function(){return this._clickHandler},function(a){this._clickHandler=a}),e(0,g,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a){this._bitmap.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,g,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._autoSize&&(this._bitmap.width=b,this._text&&(this._text.width=b))}),e(0,g,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._autoSize&&(this._bitmap.height=b,this._text&&(this._text.height=b))}),e(0,g,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.label=b+"":a.prototype._$set_dataSource.call(this,b)}),e(0,g,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(a){this._bitmap._offset=a?A.fillArray([1,1],a,Number):[]}),c(f,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),f}(D),H=function(a){function c(a,b,d){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,c.__super.call(this),void 0===b&&(b=1),void 0===d&&(d=1),this._clipX=b,this._clipY=d,this.skin=a}d(c,"laya.ui.Clip",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!1),a.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},f.dispose=function(){this.destroy(!0),b.loader.clearRes(this._skin)},f.createChildren=function(){this.graphics=this._bitmap=new C},f.initialize=function(){this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},f._onDisplay=function(a){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this._displayedInStage&&this.play()},f.changeClip=function(){if(this._clipChanged=!1,this._skin){var a=p.getRes(this._skin);a?this.loadComplete(this._skin,a):b.loader.load(this._skin,n.create(this,this.loadComplete,[this._skin]))}},f.loadComplete=function(a,b){if(a===this._skin&&b){var c=this._clipWidth||Math.ceil(b.sourceWidth/this._clipX),d=this._clipHeight||Math.ceil(b.sourceHeight/this._clipY),e=this._skin+c+d,f=C.getCache(e);if(f)this._sources=f;else{this._sources=[];for(var g=0;g<this._clipY;g++)for(var h=0;h<this._clipX;h++)this._sources.push(v.createFromTexture(b,c*h,d*g,c,d));C.setCache(e,this._sources)}this.index=this._index,this.event("loaded"),this.onCompResize()}},f.play=function(){this._isPlaying=!0,this.index=0,this._index++,b.timer.loop(this.interval,this,this._loop)},f._loop=function(){this._style.visible&&this._sources&&(this.index=this._index,this._index++,this._index>=this._sources.length&&(this._index=0))},f.stop=function(){this._isPlaying=!1,b.timer.clear(this,this._loop)},f._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},e(0,f,"interval",function(){return this._interval},function(a){this._interval!=a&&(this._interval=a,this._isPlaying&&this.play())}),e(0,f,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,a?this._setClipChanged():this._bitmap.source=null)}),e(0,f,"sources",function(){return this._sources},function(a){this._sources=a,this.index=this._index,this.event("loaded")}),e(0,f,"clipX",function(){return this._clipX},function(a){this._clipX=a,this._setClipChanged()}),e(0,f,"clipY",function(){return this._clipY},function(a){this._clipY=a,this._setClipChanged()}),e(0,f,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),e(0,f,"clipWidth",function(){return this._clipWidth},function(a){this._clipWidth=a,this._setClipChanged()}),e(0,f,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a){this._bitmap.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,f,"group",function(){return this._group},function(a){a&&this._skin&&p.setGroup(this._skin,a),this._group=a}),e(0,f,"clipHeight",function(){return this._clipHeight},function(a){this._clipHeight=a,this._setClipChanged()}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bitmap.width=b}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bitmap.height=b}),e(0,f,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),e(0,f,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),e(0,f,"index",function(){return this._index},function(a){this._index=a,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[a]),this.event("change")}),e(0,f,"autoPlay",function(){return this._autoPlay},function(a){this._autoPlay!=a&&(this._autoPlay=a,a?this.play():this.stop())}),e(0,f,"isPlaying",function(){return this._isPlaying},function(a){this._isPlaying=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.index=parseInt(b):a.prototype._$set_dataSource.call(this,b)}),e(0,f,"bitmap",function(){return this._bitmap}),c}(D),I=function(a){function c(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,c.__super.call(this)}d(c,"laya.ui.ColorPicker",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._colorPanel&&this._colorPanel.destroy(b),this._colorButton&&this._colorButton.destroy(b),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},f.createChildren=function(){this.addChild(this._colorButton=new G),this._colorPanel=new F,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new t),this._colorPanel.addChild(this._colorBlock=new t),this._colorPanel.addChild(this._colorInput=new o)},f.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},f.onPanelMouseDown=function(a){a.stopPropagation()},f.changePanel=function(){this._panelChanged=!1;var a=this._colorPanel.graphics;a.clear(),a.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,a=this._colorTiles.graphics,a.clear();for(var b=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],c=0;c<12;c++)for(var d=0;d<20;d++){var e=0;e=0===d?b[c]:1===d?0:51*(((3*c+d/6)%3<<0)+3*(c/6<<0))<<16|d%6*51<<8|(c<<0)%6*51;var f=A.toColor(e);this._colors.push(f);var g=d*this._gridSize,h=c*this._gridSize;a.drawRect(g,h,this._gridSize,this._gridSize,f,"#000000")}},f.onColorButtonClick=function(a){this._colorPanel.parent?this.close():this.open()},f.open=function(){var a=this.localToGlobal(new q),c=a.x+this._colorPanel.width<=b.stage.width?a.x:b.stage.width-this._colorPanel.width,d=a.y+this._colorButton.height;d=d+this._colorPanel.height<=b.stage.height?d:a.y-this._colorPanel.height,this._colorPanel.pos(c,d),b.g.addChild(this._colorPanel),b.stage.on("mousedown",this,this.removeColorBox)},f.close=function(){b.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},f.removeColorBox=function(a){this.close()},f.onColorFieldKeyDown=function(a){13==a.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),a.stopPropagation())},f.onColorInputChange=function(a){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},f.onColorTilesClick=function(a){this.selectedColor=this.getColorByMouse(),this.close()},f.onColorTilesMouseMove=function(a){this._colorInput.focus=!1;var b=this.getColorByMouse();this._colorInput.text=b,this.drawBlock(b)},f.getColorByMouse=function(){var a=this._colorTiles.getMousePoint(),b=Math.floor(a.x/this._gridSize),c=Math.floor(a.y/this._gridSize);return this._colors[20*c+b]},f.drawBlock=function(a){var b=this._colorBlock.graphics;b.clear();var c=a?a:"#ffffff";b.drawRect(0,0,50,20,c,this._borderColor),a||b.drawLine(0,0,50,20,"#ff0000")},f.changeColor=function(){var a=this.graphics;a.clear();var b=this._selectedColor||"#000000";a.drawRect(0,0,this._colorButton.width,this._colorButton.height,b)},f._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},e(0,f,"inputBgColor",function(){return this._inputBgColor},function(a){this._inputBgColor=a,this._setPanelChanged()}),e(0,f,"selectedColor",function(){return this._selectedColor},function(a){this._selectedColor!=a&&(this._selectedColor=this._colorInput.text=a,this.drawBlock(a),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",j.EMPTY.setTo("change",this,this)))}),e(0,f,"skin",function(){return this._colorButton.skin},function(a){this._colorButton.skin=a,this.changeColor()}),e(0,f,"bgColor",function(){return this._bgColor},function(a){this._bgColor=a,this._setPanelChanged()}),e(0,f,"borderColor",function(){return this._borderColor},function(a){this._borderColor=a,this._setPanelChanged()}),e(0,f,"inputColor",function(){return this._inputColor},function(a){this._inputColor=a,this._setPanelChanged()}),c}(D),J=function(a){function c(a,b){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._scrollBar=null,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this.itemRender=null,c.__super.call(this),this._itemColors=z.comboBoxItemColors,this.skin=a,this.labels=b}d(c,"laya.ui.ComboBox",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._button&&this._button.destroy(b),this._list&&this._list.destroy(b),this._scrollBar&&this._scrollBar.destroy(b),this._button=null,this._list=null,this._scrollBar=null,this._itemColors=null,this._labels=null,this._selectHandler=null},f.createChildren=function(){this.addChild(this._button=new G),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},f._createList=function(){this._list=new T,this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=n.create(this,this.onlistItemMouse,null,!1),this._scrollBarSkin&&(this._list.addChild(this._scrollBar=new _),this._scrollBar.skin=this._scrollBarSkin,this._scrollBar.name="scrollBar",this._scrollBar.y=1,this._scrollBar.on("mousedown",this,this.onScrollBarDown))},f.onListDown=function(a){a.stopPropagation()},f.onScrollBarDown=function(a){a.stopPropagation()},f.onButtonMouseDown=function(a){this.callLater(this.switchTo,[!this._isOpen])},f.changeList=function(){this._listChanged=!1;var a=this.width-2,b=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:a,height:this._itemHeight,fontSize:this._itemSize,color:b}}]},this._list.repeatY=this._visibleNum,this._scrollBar&&(this._scrollBar.x=this.width-this._scrollBar.width-1),this._list.refresh()},f.onlistItemMouse=function(a,b){var c=a.type;if("mouseover"===c||"mouseout"===c){var d=this._list.getCell(b);if(!d)return;var e=d.getChildByName("label");e&&("mouseover"===c?(e.bgColor=this._itemColors[0],e.color=this._itemColors[1]):(e.bgColor=null,e.color=this._itemColors[2]))}else"click"===c&&(this.selectedIndex=b,this.isOpen=!1)},f.switchTo=function(a){this.isOpen=a},f.changeOpen=function(){this.isOpen=!this._isOpen},f.changeItem=function(){this._itemChanged=!1,this.runCallLater(this.changeList),this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,this._scrollBar&&(this._scrollBar.height=this._listHeight-2);var a=this._list.graphics;a.clear(),a.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3]);var b=this._list.array||[];b.length=0;for(var c=0,d=this._labels.length;c<d;c++)b.push({label:this._labels[c]});this._list.array=b,this._visibleNum>b.length?this._list.height=this._listHeight:this._list.height=0},f.changeSelected=function(){this._button.label=this.selectedLabel},f.removeList=function(a){this.isOpen=!1},e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this._selectedIndex=a,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[j.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),e(0,f,"measureHeight",function(){return this._button.height}),e(0,f,"skin",function(){return this._button.skin},function(a){this._button.skin!=a&&(this._button.skin=a,this._listChanged=!0)}),e(0,f,"measureWidth",function(){return this._button.width}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),e(0,f,"selectedLabel",function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(a){this.selectedIndex=this._labels.indexOf(a)}),e(0,f,"labels",function(){return this._labels.join(",")},function(a){this._labels.length>0&&(this.selectedIndex=-1),a?this._labels=a.split(","):this._labels.length=0,this._itemChanged=!0}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._button.height=this._height}),e(0,f,"selectHandler",function(){return this._selectHandler},function(a){this._selectHandler=a}),e(0,f,"visibleNum",function(){return this._visibleNum},function(a){this._visibleNum=a,this._listChanged=!0}),e(0,f,"labelBold",function(){return this._button.text.bold},function(a){this._button.text.bold=a}),e(0,f,"itemColors",function(){return this._itemColors+""},function(a){this._itemColors=A.fillArray(this._itemColors,a,String),this._listChanged=!0}),e(0,f,"itemSize",function(){return this._itemSize},function(a){this._itemSize=a,this._listChanged=!0}),e(0,f,"scrollBar",function(){return this._scrollBar}),e(0,f,"isOpen",function(){return this._isOpen},function(a){if(this._isOpen!=a)if(this._isOpen=a,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&this.changeList(),this._itemChanged&&this.changeItem();var c=this.localToGlobal(q.TEMP.setTo(0,0)),d=c.y+this._button.height;d=d+this._listHeight<=b.stage.height?d:c.y-this._listHeight,this._list.pos(c.x,d),b.g.addChild(this._list),b.stage.once("mousedown",this,this.removeList),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),e(0,f,"scrollBarSkin",function(){return this._scrollBarSkin},function(a){this._scrollBarSkin=a}),e(0,f,"sizeGrid",function(){return this._button.sizeGrid},function(a){this._button.sizeGrid=a}),e(0,f,"button",function(){return this._button}),e(0,f,"list",function(){return this._list||this._createList(),this._list}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,
"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.selectedIndex=parseInt(b):b instanceof Array?this.labels=b.join(","):a.prototype._$set_dataSource.call(this,b)}),e(0,f,"labelColors",function(){return this._button.labelColors},function(a){this._button.labelColors!=a&&(this._button.labelColors=a)}),e(0,f,"labelPadding",function(){return this._button.text.padding.join(",")},function(a){this._button.text.padding=A.fillArray(z.labelPadding,a,Number)}),e(0,f,"labelSize",function(){return this._button.text.fontSize},function(a){this._button.text.fontSize=a}),e(0,f,"labelFont",function(){return this._button.text.font},function(a){this._button.text.font=a}),e(0,f,"stateNum",function(){return this._button.stateNum},function(a){this._button.stateNum=a}),c}(D),K=function(a){function c(a){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,c.__super.call(this),this._showButtons=B.showButtons,this._touchScrollEnable=B.touchScrollEnable,this._mouseWheelEnable=B.mouseWheelEnable,this.skin=a,this.max=1}d(c,"laya.ui.ScrollBar",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),this.stopScroll(),a.prototype.destroy.call(this,b),this.upButton&&this.upButton.destroy(b),this.downButton&&this.downButton.destroy(b),this.slider&&this.slider.destroy(b),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},f.createChildren=function(){this.addChild(this.slider=new L),this.addChild(this.upButton=new G),this.addChild(this.downButton=new G)},f.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},f.onSliderChange=function(){this.value=this.slider.value},f.onButtonMouseDown=function(a){var c=a.currentTarget===this.upButton;this.slide(c),b.timer.once(z.scrollBarDelayTime,this,this.startLoop,[c]),b.stage.once("mouseup",this,this.onStageMouseUp)},f.startLoop=function(a){b.timer.frameLoop(1,this,this.slide,[a])},f.slide=function(a){a?this.value-=this._scrollSize:this.value+=this._scrollSize},f.onStageMouseUp=function(a){b.timer.clear(this,this.startLoop),b.timer.clear(this,this.slide)},f.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions()},f.changeSize=function(){a.prototype.changeSize.call(this),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},f.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},f.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},f.setScroll=function(a,b,c){this.runCallLater(this.changeSize),this.slider.setSlider(a,b,c),this.slider.bar.visible=b>0,!this._hide&&this.autoHide&&(this.visible=!1)},f.onTargetMouseWheel=function(a){this.value-=a.delta*this._scrollSize,this.target=this._target},f.onTargetMouseDown=function(a){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new q),this._lastPoint.setTo(b.stage.mouseX,b.stage.mouseY),b.timer.clear(this,this.tweenMove),w.clearTween(this),b.stage.once("mouseup",this,this.onStageMouseUp2),b.stage.once("mouseout",this,this.onStageMouseUp2),b.timer.frameLoop(1,this,this.loop)},f.loop=function(){var a=b.stage.mouseY,c=b.stage.mouseX;if(this._lastOffset=this.isVertical?a-this._lastPoint.y:c-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?b.stage._canvasTransform.getScaleY():b.stage._canvasTransform.getScaleX()))>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=c,this._lastPoint.y=a,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._checkElastic=!0,this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?this._isElastic=!0:this._isElastic=!1):this._checkElastic=!0),this._checkElastic&&(this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset))},f.onStageMouseUp2=function(a){if(b.stage.off("mouseup",this,this.onStageMouseUp2),b.stage.off("mouseout",this,this.onStageMouseUp2),b.timer.clear(this,this.loop),!this._clickOnly)if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?w.to(this,{value:this.min},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver)):this._value>this.max&&w.to(this,{value:this.max},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver));else{this._offsets.length<1&&(this._offsets[0]=this.isVertical?b.stage.mouseY-this._lastPoint.y:b.stage.mouseX-this._lastPoint.x);for(var c=0,d=Math.min(this._offsets.length,3),e=0;e<d;e++)c+=this._offsets[this._offsets.length-1-e];if(this._lastOffset=c/d,(c=Math.abs(this._lastOffset))<2)return void this.event("end");c>60&&(this._lastOffset=this._lastOffset>0?60:-60),b.timer.frameLoop(1,this,this.tweenMove)}},f.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&w.to(this,{alpha:0},500),this.event("end")},f.tweenMove=function(){this._lastOffset*=this.rollRatio;var a=NaN;if(this.elasticDistance>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,a=.5*-(this.min-this.elasticDistance-this.value),this._lastOffset>a&&(this._lastOffset=a)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,a=.5*-(this.max+this.elasticDistance-this.value),this._lastOffset<a&&(this._lastOffset=a))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(b.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?w.to(this,{value:this.min},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver)):this._value>this.max?w.to(this,{value:this.max},this.elasticBackTime,i.sineOut,n.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&w.to(this,{alpha:0},500)}},f.stopScroll=function(){this.onStageMouseUp2(null),b.timer.clear(this,this.tweenMove),w.clearTween(this)},e(0,f,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),e(0,f,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),e(0,f,"max",function(){return this.slider.max},function(a){this.slider.max=a}),e(0,f,"showButtons",function(){return this._showButtons},function(a){this._showButtons=a,this.callLater(this.changeScrollBar)}),e(0,f,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),e(0,f,"min",function(){return this.slider.min},function(a){this.slider.min=a}),e(0,f,"value",function(){return this._value},function(a){a!==this._value&&(this._isElastic?this._value=a:(this.slider.value=a,this._value=this.slider.value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value))}),e(0,f,"isVertical",function(){return this.slider.isVertical},function(a){this.slider.isVertical=a}),e(0,f,"sizeGrid",function(){return this.slider.sizeGrid},function(a){this.slider.sizeGrid=a}),e(0,f,"scrollSize",function(){return this._scrollSize},function(a){this._scrollSize=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.value=+b:a.prototype._$set_dataSource.call(this,b)}),e(0,f,"thumbPercent",function(){return this._thumbPercent},function(a){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),a=a>=1?.99:a,this._thumbPercent=a,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*a,z.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*a,z.scrollBarMinNum))}),e(0,f,"target",function(){return this._target},function(a){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),this._target=a,a&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),e(0,f,"hide",function(){return this._hide},function(a){this._hide=a,this.visible=!a}),e(0,f,"touchScrollEnable",function(){return this._touchScrollEnable},function(a){this._touchScrollEnable=a,this.target=this._target}),e(0,f,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(a){this._mouseWheelEnable=a}),e(0,f,"tick",function(){return this.slider.tick},function(a){this.slider.tick=a}),c}(D),L=function(a){function f(a){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,f.__super.call(this),this.skin=a}d(f,"laya.ui.Slider",a);var g=f.prototype;return g.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bg&&this._bg.destroy(b),this._bar&&this._bar.destroy(b),this._bg=null,this._bar=null,this.changeHandler=null},g.createChildren=function(){this.addChild(this._bg=new M),this.addChild(this._bar=new G)},g.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this.allowClickBack=!0},g.onBarMouseDown=function(a){this._globalSacle||(this._globalSacle=new q),this._globalSacle.setTo(this.globalScaleX,this.globalScaleY),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=b.stage.mouseX,this._ty=b.stage.mouseY,b.stage.on("mousemove",this,this.mouseMove),b.stage.once("mouseup",this,this.mouseUp),this.showValueText()},g.showValueText=function(){if(this.showLabel){var a=laya.ui.Slider.label;this.addChild(a),a.textField.changeText(this._value+""),this.isVertical?(a.x=this._bar.x+20,a.y=.5*(this._bar.height-a.height)+this._bar.y):(a.y=this._bar.y-20,a.x=.5*(this._bar.width-a.width)+this._bar.x)}},g.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},g.mouseUp=function(a){b.stage.off("mousemove",this,this.mouseMove),this.sendChangeEvent("changed"),this.hideValueText()},g.mouseMove=function(a){var c=this._value;this.isVertical?(this._bar.y+=(b.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min):(this._bar.x+=(b.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min),this._tx=b.stage.mouseX,this._ty=b.stage.mouseY;var d=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*d)/d,this._value!=c&&this.sendChangeEvent(),this.showValueText()},g.sendChangeEvent=function(a){void 0===a&&(a="change"),this.event(a),this.changeHandler&&this.changeHandler.runWith(this._value)},g.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},g.changeSize=function(){a.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},g.setSlider=function(a,b,c){this._value=-1,this._min=a,this._max=b>a?b:a,this.value=c<a?a:c>b?b:c},g.changeValue=function(){var a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*a)/a,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var b=this._max-this._min;0===b&&(b=1),this.isVertical?this._bar.y=(this._value-this._min)/b*(this.height-this._bar.height):this._bar.x=(this._value-this._min)/b*(this.width-this._bar.width)},g.onBgMouseDown=function(a){var b=this._bg.getMousePoint();this.isVertical?this.value=b.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=b.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},e(0,g,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),e(0,g,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.setBarPoint())}),e(0,g,"allowClickBack",function(){return this._allowClickBack},function(a){this._allowClickBack!=a&&(this._allowClickBack=a,a?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),e(0,g,"max",function(){return this._max},function(a){this._max!=a&&(this._max=a,this.callLater(this.changeValue))}),e(0,g,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),e(0,g,"tick",function(){return this._tick},function(a){this._tick!=a&&(this._tick=a,this.callLater(this.changeValue))}),e(0,g,"sizeGrid",function(){return this._bg.sizeGrid},function(a){this._bg.sizeGrid=a,this._bar.sizeGrid=a}),e(0,g,"min",function(){return this._min},function(a){this._min!=a&&(this._min=a,this.callLater(this.changeValue))}),e(0,g,"value",function(){return this._value},function(a){if(this._value!=a){var b=this._value;this._value=a,this.changeValue(),this._value!=b&&this.sendChangeEvent()}}),e(0,g,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.value=+b:a.prototype._$set_dataSource.call(this,b)}),e(0,g,"bar",function(){return this._bar}),c(f,["label",function(){return this.label=new N}]),f}(D),M=function(a){function c(a){this._bitmap=null,this._skin=null,this._group=null,c.__super.call(this),this.skin=a}d(c,"laya.ui.Image",a);var f=c.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null},f.dispose=function(){this.destroy(!0),b.loader.clearRes(this._skin)},f.createChildren=function(){this.graphics=this._bitmap=new C,this._bitmap.autoCacheCmd=!1},f.setSource=function(a,b){a===this._skin&&b&&(this.source=b,this.onCompResize())},e(0,f,"source",function(){return this._bitmap.source},function(a){this._bitmap&&(this._bitmap.source=a,this.event("loaded"),this.repaint())}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"string"==typeof b?this.skin=b:a.prototype._$set_dataSource.call(this,b)}),e(0,f,"measureHeight",function(){return this._bitmap.height}),e(0,f,"skin",function(){return this._skin},function(a){if(this._skin!=a)if(this._skin=a,a){var c=p.getRes(a);c?(this.source=c,this.onCompResize()):b.loader.load(this._skin,n.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),e(0,f,"group",function(){return this._group},function(a){a&&this._skin&&p.setGroup(this._skin,a),this._group=a}),e(0,f,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a){this._bitmap.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,f,"measureWidth",function(){return this._bitmap.width}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bitmap.width=0==b?1e-7:b}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bitmap.height=0==b?1e-7:b}),c}(D),N=function(a){function b(a){this._tf=null,b.__super.call(this),void 0===a&&(a=""),k.defaultColor=z.labelColor,this.text=a}d(b,"laya.ui.Label",a);var f=b.prototype;return f.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._tf=null},f.createChildren=function(){this.addChild(this._tf=new u)},f.changeText=function(a){this._tf.changeText(a)},e(0,f,"padding",function(){return this._tf.padding.join(",")},function(a){this._tf.padding=A.fillArray(z.labelPadding,a,Number)}),e(0,f,"bold",function(){return this._tf.bold},function(a){this._tf.bold=a}),e(0,f,"align",function(){return this._tf.align},function(a){this._tf.align=a}),e(0,f,"text",function(){return this._tf.text},function(a){this._tf.text!=a&&(a&&(a=(a+"").replace(b._textReg,"\n")),this._tf.text=a,this.event("change"))}),e(0,f,"italic",function(){return this._tf.italic},function(a){this._tf.italic=a}),e(0,f,"wordWrap",function(){return this._tf.wordWrap},function(a){this._tf.wordWrap=a}),e(0,f,"font",function(){return this._tf.font},function(a){this._tf.font=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.text=b+"":a.prototype._$set_dataSource.call(this,b)}),e(0,f,"color",function(){return this._tf.color},function(a){this._tf.color=a}),e(0,f,"valign",function(){return this._tf.valign},function(a){this._tf.valign=a}),e(0,f,"leading",function(){return this._tf.leading},function(a){this._tf.leading=a}),e(0,f,"fontSize",function(){return this._tf.fontSize},function(a){this._tf.fontSize=a}),e(0,f,"bgColor",function(){return this._tf.bgColor},function(a){this._tf.bgColor=a}),e(0,f,"borderColor",function(){return this._tf.borderColor},function(a){this._tf.borderColor=a}),e(0,f,"stroke",function(){return this._tf.stroke},function(a){this._tf.stroke=a}),e(0,f,"strokeColor",function(){return this._tf.strokeColor},function(a){this._tf.strokeColor=a}),e(0,f,"textField",function(){return this._tf}),e(0,f,"measureWidth",function(){return this._tf.width}),e(0,f,"measureHeight",function(){return this._tf.height}),e(0,f,"width",function(){return this._width||this._tf.text?a.prototype._$get_width.call(this):0},function(b){a.prototype._$set_width.call(this,b),this._tf.width=b}),e(0,f,"height",function(){return this._height||this._tf.text?a.prototype._$get_height.call(this):0},function(b){a.prototype._$set_height.call(this,b),this._tf.height=b}),e(0,f,"overflow",function(){return this._tf.overflow},function(a){this._tf.overflow=a}),e(0,f,"underline",function(){return this._tf.underline},function(a){this._tf.underline=a}),e(0,f,"underlineColor",function(){return this._tf.underlineColor},function(a){this._tf.underlineColor=a}),c(b,["_textReg",function(){return this._textReg=RegExp("\\\\n","g")}]),b}(D),O=function(a){function b(a){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,b.__super.call(this),this.skin=a}d(b,"laya.ui.ProgressBar",a);var c=b.prototype;return c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bg&&this._bg.destroy(b),this._bar&&this._bar.destroy(b),this._bg=this._bar=null,this.changeHandler=null},c.createChildren=function(){this.addChild(this._bg=new M),this.addChild(this._bar=new M),this._bar._bitmap.autoCacheCmd=!1},c.changeValue=function(){if(this.sizeGrid){var a=this.sizeGrid.split(","),b=+a[3],c=+a[1],d=this.width-b-c,e=d*this._value;this._bar.width=b+c+e,this._bar.visible=this._bar.width>b+c}else this._bar.width=this.width*this._value},e(0,c,"measureHeight",function(){return this._bg.height}),e(0,c,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),e(0,c,"measureWidth",function(){return this._bg.width}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bg.height=this._height,this._bar.height=this._height}),e(0,c,"bar",function(){return this._bar}),e(0,c,"value",function(){return this._value},function(a){this._value!=a&&(a=a>1?1:a<0?0:a,this._value=a,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(a))}),e(0,c,"bg",function(){return this._bg}),e(0,c,"sizeGrid",function(){return this._bg.sizeGrid},function(a){this._bg.sizeGrid=this._bar.sizeGrid=a}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bg.width=this._width,this.callLater(this.changeValue)}),e(0,c,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b||"string"==typeof b?this.value=+b:a.prototype._$set_dataSource.call(this,b)}),b}(D),P=(function(a){function c(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,c.__super.call(this),this._tipBox=new D,this._tipBox.addChild(this._tipText=new u),this._tipText.x=this._tipText.y=5,this._tipText.color=c.tipTextColor,this._defaultTipHandler=this._showDefaultTip,b.stage.on("showtip",this,this._onStageShowTip),b.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}d(c,"laya.ui.TipManager",a);var f=c.prototype;f._onStageHideTip=function(a){b.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},f._onStageShowTip=function(a){b.timer.once(c.tipDelay,this,this._showTip,[a],!0)},f._showTip=function(a){if("string"==typeof a){var c=a+"";c&&this._defaultTipHandler(c)}else a instanceof laya.utils.Handler?a.run():"function"==typeof a&&a.apply();b.stage.on("mousemove",this,this._onStageMouseMove),b.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},f._onStageMouseDown=function(a){this.closeAll()},f._onStageMouseMove=function(a){this._showToStage(this,c.offsetX,c.offsetY)},f._showToStage=function(a,c,d){void 0===c&&(c=0),void 0===d&&(d=0);var e=a.getBounds();a.x=b.stage.mouseX+c,a.y=b.stage.mouseY+d,a.x+e.width>b.stage.width&&(a.x-=e.width+c),a.y+e.height>b.stage.height&&(a.y-=e.height+d)},f.closeAll=function(){b.timer.clear(this,this._showTip),b.stage.off("mousemove",this,this._onStageMouseMove),b.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},f.showDislayTip=function(a){this.addChild(a),this._showToStage(this),b.g.addChild(this)},f._showDefaultTip=function(a){this._tipText.text=a;var d=this._tipBox.graphics;d.clear(),d.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,c.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),b.g.addChild(this)},e(0,f,"defaultTipHandler",function(){return this._defaultTipHandler},function(a){this._defaultTipHandler=a}),c.offsetX=10,c.offsetY=15,c.tipTextColor="#ffffff",c.tipBackColor="#111111",c.tipDelay=200,c}(D),function(a){function b(){this._target=null,this._playEvents=null,this.ka={},this.la=null,this.ma=null,b.__super.call(this)}d(b,"laya.ui.EffectAnimation",a);var c=b.prototype;c.na=function(a){a!=this&&this.stop()},c.oa=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this.pa))},c.pa=function(){this._target&&(this._target.event("effectanimationbegin",[this]),this.qa(),this.play(0,!1))},c.qa=function(){if(this.la){var a=0,b=0;b=this.la.length;var c;for(a=0;a<b;a++)c=this.la[a],this.ka[c]=this._target[c]}},c._displayToIndex=function(a){if(this._animationData){a<0&&(a=0),a>this._count&&(a=this._count);var b=this._animationData.nodes,c=0,d=b.length;for(d=d>1?1:d,c=0;c<d;c++)this._displayNodeToFrame(b[c],a)}},c._displayNodeToFrame=function(a,b,c){if(this._target){var d;d=this._target;var e,f,g,h,j=a.frames,k=a.keys,l=0,m=k.length;h=a.ra;var n,o,p,q,r=0;for(l=0;l<m;l++)e=k[l],f=j[e],r=h[e],r==-1?g=this.ka[e]:b<r?(o=a.keyframes[e],p=o[0],p.tween?(n=i[p.tweenMethod],null==n&&(n=i.linearNone),q=o[1],g=n(b,this.ka[e],q.value-this.ka[e],q.index)):g=this.ka[e]):g=f.length>b?f[b]:f[f.length-1],d[e]=g}},c._calculateNodeKeyFrames=function(b){a.prototype._calculateNodeKeyFrames.call(this,b);var c,d,e,f=b.keyframes;b.target;e={},b.ra=e;for(c in f)d=f[c],d.length<=1?e[c]=-1:e[c]=d[1].index},e(0,c,"effectClass",null,function(a){if(this.ma=g.getClass(a),this.ma){var b;if(b=this.ma.uiView){var c;c=b.animations,c&&c[0]&&(this._setUp({},c[0]),c[0].nodes&&c[0].nodes[0]&&(this.la=c[0].nodes[0].keys))}}}),e(0,c,"owner",null,function(a){this.target=a}),e(0,c,"target",function(){return this._target},function(a){this._target&&this._target.off("effectanimationbegin",this,this.na),this._target=a,this._target&&this._target.on("effectanimationbegin",this,this.na),this.oa()}),e(0,c,"playEvent",null,function(a){this._playEvents=a,a&&this.oa()}),b.sa="effectanimationbegin",b}(l),function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.FrameClip",a),b}(l)),Q=function(a){function e(){this._idMap=null,this._aniList=null,e.__super.call(this)}d(e,"laya.ui.View",a);var h=e.prototype;return h.createView=function(a){if(a.animations&&!this._idMap&&(this._idMap={}),e.createComp(a,this,this),a.animations){var b,c,d=[],f=a.animations,g=0,h=f.length;for(g=0;g<h;g++){switch(b=new P,c=f[g],b._setUp(this._idMap,c),this[c.name]=b,b._setControlNode(this),c.action){case 1:b.play(0,!1);break;case 2:b.play(0,!0)}d.push(b)}this._aniList=d}this._width>0&&null==a.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},h.loadUI=function(a){var b=e.uiMap[a];b&&this.createView(b)},h.destroy=function(a){void 0===a&&(a=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,laya.ui.Component.prototype.destroy.call(this,a)},e._regs=function(){var a;for(a in e.uiClassMap)g.regClass(a,e.uiClassMap[a])},e.createComp=function(a,c,d){if(!(c=c||e.getCompInstance(a)))return console.log("can not create:"+a.type),null;var f=a.child;if(f)for(var h=0,i=f.length;h<i;h++){var j=f[h];if(!c.hasOwnProperty("itemRender")||"render"!=j.props.name&&"render"!==j.props.renderType)if("Graphic"==j.type)g.addGraphicsToSprite(j,c);else if(g.isDrawType(j.type))g.addGraphicToSprite(j,c,!0);else{var k=e.createComp(j,null,d);"Script"==j.type?k.owner=c:"mask"==j.props.renderType||"mask"==j.props.name?c.mask=k:k instanceof laya.display.Sprite&&c.addChild(k)}else c.itemRender=j}var l=a.props;for(var m in l){var n=l[m];e.setCompValue(c,m,n,d)}return b.__typeof(c,"laya.ui.IItem")&&c.initItems(),a.compId&&d&&d._idMap&&(d._idMap[a.compId]=c),c},e.setCompValue=function(a,b,c,d){"var"===b&&d?d[c]=a:"x"===b||"y"===b||"width"===b||"height"===b||"number"==typeof a[b]?a[b]=parseFloat(c):a[b]="true"===c||"false"!==c&&c},e.getCompInstance=function(a){var c,d=a.props?a.props.runtime:"";return c=d?e.viewClassMap[d]||e.uiClassMap[d]||b.__classmap[d]:e.uiClassMap[a.type],c?new c:null},e.regComponent=function(a,b){e.uiClassMap[a]=b,g.regClass(a,b)},e.regViewRuntime=function(a,b){e.viewClassMap[a]=b},e.uiMap={},e.viewClassMap={},c(e,["uiClassMap",function(){return this.uiClassMap={ViewStack:$,LinkButton:G,TextArea:ha,ColorPicker:I,Box:F,Button:G,CheckBox:R,Clip:H,ComboBox:J,Component:D,HScrollBar:V,HSlider:Y,Image:M,Label:N,List:T,Panel:U,ProgressBar:O,Radio:X,RadioGroup:fa,ScrollBar:K,Slider:L,Tab:ga,TextInput:aa,View:e,VScrollBar:_,VSlider:ba,Tree:Z,HBox:da,VBox:ea,Sprite:t,Animation:f,Text:u}}]),e.__init$=function(){e._regs()},e}(F),R=function(a){function b(a,c){void 0===c&&(c=""),b.__super.call(this,a,c)}d(b,"laya.ui.CheckBox",a);var c=b.prototype;return c.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},c.initialize=function(){a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},e(0,c,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"boolean"==typeof b?this.selected=b:"string"==typeof b?this.selected="true"===b:a.prototype._$set_dataSource.call(this,b)}),b}(G),S=function(a){function b(){this._space=0,this._align="none",this._itemChanged=!1,b.__super.call(this)}d(b,"laya.ui.LayoutBox",a);var c=b.prototype;return c.addChild=function(a){return a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,a)},c.onResize=function(a){this._setItemChanged()},c.addChildAt=function(a,b){return a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,a,b)},c.removeChild=function(a){return a.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,a)},c.removeChildAt=function(a){return this.getChildAt(a).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,a)},c.refresh=function(){this._setItemChanged()},c.changeItems=function(){this._itemChanged=!1},c.sortItem=function(a){a&&a.sort(function(a,b){return a.y-b.y})},c._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},e(0,c,"space",function(){return this._space},function(a){this._space=a,this._setItemChanged()}),e(0,c,"align",function(){return this._align},function(a){this._align=a,this._setItemChanged()}),b}(F),T=function(a){function c(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,c.__super.call(this),this._cells=[]}d(c,"laya.ui.List",a);var f=c.prototype;return b.imps(f,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),f.destroy=function(a){void 0===a&&(a=!0),this._content&&this._content.destroy(a),this._scrollBar&&this._scrollBar.destroy(a),laya.ui.Component.prototype.destroy.call(this,a),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},f.createChildren=function(){this.addChild(this._content=new F)},f.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=a.prototype._$get_cacheAs.call(this)),a.prototype._$set_cacheAs.call(this,"none"),this._scrollBar.once("end",this,this.onScrollEnd)},f.onScrollEnd=function(){a.prototype._$set_cacheAs.call(this,this._$P.cacheAs)},f.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var a=this.ta(),b=a.width+this._spaceX||1,c=a.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/b):Math.ceil(this._width/b)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/c):Math.round(this._height/c));var d=this._width?this._width:b*this.repeatX-this._spaceX,e=this._height?this._height:c*this.repeatY-this._spaceY;this._cellSize=this._isVertical?c:b,this._cellOffset=this._isVertical?c*Math.max(this._repeatY2,this._repeatY)-e-this._spaceY:b*Math.max(this._repeatX2,this._repeatX)-d-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=e:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=d),this.setContentSize(d,e);var f=this._isVertical?this.repeatX:this.repeatY,g=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,f,g),this._createdLine=g,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},
f.ta=function(){return 0===this._cells.length&&this._cells.push(this.createItem()),this._cells[0]},f._createItems=function(a,b,c){var d=this._content,e=this.ta(),f=e.width+this._spaceX,g=e.height+this._spaceY;if(this.cacheContent){var h=new F;h.cacheAsBitmap=!0,h.pos((this._isVertical?0:a)*f,(this._isVertical?a:0)*g),this._content.addChild(h),this._content.optimizeScrollRect=!0,d=h}for(var i=[],j=this._cells.length-1;j>-1;j--){var k=this._cells[j];k.removeSelf(),i.push(k)}this._cells.length=0;for(var l=a;l<c;l++)for(var m=0;m<b;m++)e=i.length?i.pop():this.createItem(),e.x=(this._isVertical?m:l)*f-d.x,e.y=(this._isVertical?l:m)*g-d.y,e.name="item"+(l*b+m),d.addChild(e),this.addCell(e)},f.createItem=function(){return"function"==typeof this._itemRender?new this._itemRender:Q.createComp(this._itemRender)},f.addCell=function(a){a.on("click",this,this.onCellMouse),a.on("rightclick",this,this.onCellMouse),a.on("mouseover",this,this.onCellMouse),a.on("mouseout",this,this.onCellMouse),a.on("mousedown",this,this.onCellMouse),a.on("mouseup",this,this.onCellMouse),this._cells.push(a)},f.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;var a=0;a=0;for(var b=0;b<1e4;b++){var c=this.getChildByName("item"+b);{if(!c)break;this.addCell(c),a++}}this.repeatY=a}},f.setContentSize=function(a,b){this._content.width=a,this._content.height=b,this._scrollBar&&(this._content.scrollRect||(this._content.scrollRect=new r),this._content.scrollRect.setTo(0,0,a,b),this._content.conchModel&&this._content.conchModel.scrollRect(0,0,a,b),this.event("resize"))},f.onCellMouse=function(a){"mousedown"===a.type&&(this._isMoved=!1);var b=a.currentTarget,c=this._startIndex+this._cells.indexOf(b);c<0||("click"===a.type||"rightclick"===a.type?this.selectEnable&&!this._isMoved?this.selectedIndex=c:this.changeCellState(b,!0,0):"mouseover"!==a.type&&"mouseout"!==a.type||this._selectedIndex===c||this.changeCellState(b,"mouseover"===a.type,0),this.mouseHandler&&this.mouseHandler.runWith([a,c]))},f.changeCellState=function(a,b,c){var d=a.getChildByName("selectBox");d&&(this.selectEnable=!0,d.visible=b,d.index=c)},f.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},f.onScrollBarChange=function(a){this.runCallLater(this.changeCells);var b=this._scrollBar.value,c=this._isVertical?this.repeatX:this.repeatY,d=this._isVertical?this.repeatY:this.repeatX,e=Math.floor(b/this._cellSize);if(this.cacheContent)g=d+1,this._createdLine-e<g&&(this._createItems(this._createdLine,c,this._createdLine+g),this._createdLine+=g,this.renderItems(this._createdLine*c,0));else{var f=e*c;if(f>this._startIndex){var g=f-this._startIndex,h=!0,i=this._startIndex+c*(d+1);this._isMoved=!0}else f<this._startIndex&&(g=this._startIndex-f,h=!1,i=this._startIndex-1,this._isMoved=!0);for(var j=0;j<g;j++){if(h){var k=this._cells.shift();this._cells[this._cells.length]=k;var l=i+j}else k=this._cells.pop(),this._cells.unshift(k),l=i-j;var m=Math.floor(l/c)*this._cellSize;this._isVertical?k.y=m:k.x=m,this.renderItem(k,l)}this._startIndex=f,this.changeSelectStatus()}var n=this._content.scrollRect;this._isVertical?n.y=b:n.x=b,this._content.conchModel&&this._content.conchModel.scrollRect(n.x,n.y,n.width,n.height),this.repaint()},f.posCell=function(a,b){if(this._scrollBar){var c=this._isVertical?this.repeatX:this.repeatY,d=(this._isVertical?this.repeatY:this.repeatX,Math.floor(b/c)*this._cellSize);this._isVertical?a.y=d:a.x=d}},f.changeSelectStatus=function(){for(var a=0,b=this._cells.length;a<b;a++)this.changeCellState(this._cells[a],this._selectedIndex===this._startIndex+a,1)},f.renderItems=function(a,b){void 0===a&&(a=0),void 0===b&&(b=0);for(var c=0,d=b||this._cells.length;c<d;c++)this.renderItem(this._cells[c],this._startIndex+c);this.changeSelectStatus()},f.renderItem=function(a,b){b>=0&&b<this._array.length?(a.visible=!0,a.dataSource=this._array[b],this.cacheContent||this.posCell(a,b),this.hasListener("render")&&this.event("render",[a,b]),this.renderHandler&&this.renderHandler.runWith([a,b])):(a.visible=!1,a.dataSource=null)},f.refresh=function(){this.array=this._array},f.getItem=function(a){return a>-1&&a<this._array.length?this._array[a]:null},f.changeItem=function(a,b){a>-1&&a<this._array.length&&(this._array[a]=b,a>=this._startIndex&&a<this._startIndex+this._cells.length&&this.renderItem(this.getCell(a),a))},f.setItem=function(a,b){this.changeItem(a,b)},f.addItem=function(a){this._array.push(a),this.array=this._array},f.addItemAt=function(a,b){this._array.splice(b,0,a),this.array=this._array},f.deleteItem=function(a){this._array.splice(a,1),this.array=this._array},f.getCell=function(a){return this.runCallLater(this.changeCells),a>-1&&this._cells?this._cells[(a-this._startIndex)%this._cells.length]:null},f.scrollTo=function(a){if(this._scrollBar){var b=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(a/b)*this._cellSize}else this.startIndex=a},f.tweenTo=function(a,b,c){if(void 0===b&&(b=200),this._scrollBar){var d=this._isVertical?this.repeatX:this.repeatY;w.to(this._scrollBar,{value:Math.floor(a/d)*this._cellSize},b,null,c,0,!0)}else this.startIndex=a,c&&c.run()},f._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},f.commitMeasure=function(){this.runCallLater(this.changeCells)},e(0,f,"cacheAs",a.prototype._$get_cacheAs,function(b){a.prototype._$set_cacheAs.call(this,b),this._scrollBar&&(this._$P.cacheAs=null,"none"!==b?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),e(0,f,"content",function(){return this._content}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._setCellChanged()}),e(0,f,"itemRender",function(){return this._itemRender},function(a){if(this._itemRender!=a){this._itemRender=a;for(var b=this._cells.length-1;b>-1;b--)this._cells[b].destroy();this._cells.length=0,this._setCellChanged()}}),e(0,f,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(a){this.removeChildByName("scrollBar");var b=new _;b.name="scrollBar",b.right=0,a&&" "!=a&&(b.skin=a),this.scrollBar=b,this.addChild(b),this._setCellChanged()}),e(0,f,"page",function(){return this._page},function(a){this._page=a,this._array&&(this._page=a>0?a:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),e(0,f,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(a){this.removeChildByName("scrollBar");var b=new V;b.name="scrollBar",b.bottom=0,a&&" "!=a&&(b.skin=a),this.scrollBar=b,this.addChild(b),this._setCellChanged()}),e(0,f,"repeatX",function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},function(a){this._repeatX=a,this._setCellChanged()}),e(0,f,"scrollBar",function(){return this._scrollBar},function(a){this._scrollBar!=a&&(this._scrollBar=a,a&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange)))}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._setCellChanged()}),e(0,f,"repeatY",function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},function(a){this._repeatY=a,this._setCellChanged()}),e(0,f,"spaceX",function(){return this._spaceX},function(a){this._spaceX=a,this._setCellChanged()}),e(0,f,"spaceY",function(){return this._spaceY},function(a){this._spaceY=a,this._setCellChanged()}),e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this._selectedIndex=a,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(a))}),e(0,f,"selectedItem",function(){return this._selectedIndex!=-1?this._array[this._selectedIndex]:null},function(a){this.selectedIndex=this._array.indexOf(a)}),e(0,f,"length",function(){return this._array?this._array.length:0}),e(0,f,"selection",function(){return this.getCell(this._selectedIndex)},function(a){this.selectedIndex=this._startIndex+this._cells.indexOf(a)}),e(0,f,"startIndex",function(){return this._startIndex},function(a){this._startIndex=a>0?a:0,this.callLater(this.renderItems)}),e(0,f,"array",function(){return this._array},function(a){this.runCallLater(this.changeCells),this._array=a||[];var b=this._array.length;if(this.totalPage=Math.ceil(b/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<b?this._selectedIndex:b-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var c=this._isVertical?this.repeatX:this.repeatY,d=this._isVertical?this.repeatY:this.repeatX,e=Math.ceil(b/c);(this._cellOffset>0?this.totalPage+1:this.totalPage)>1?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=d/e,this._scrollBar.setScroll(0,(e-d)*this._cellSize+this._cellOffset,this._scrollBar.value),this._scrollBar.target=this._content):(this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.selectedIndex=parseInt(b):b instanceof Array?this.array=b:a.prototype._$set_dataSource.call(this,b)}),e(0,f,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),c}(F),U=function(a){function b(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,b.__super.call(this),this.width=this.height=100,this._content.optimizeScrollRect=!0}d(b,"laya.ui.Panel",a);var c=b.prototype;return c.destroy=function(a){void 0===a&&(a=!0),laya.ui.Component.prototype.destroy.call(this,a),this._content&&this._content.destroy(a),this._vScrollBar&&this._vScrollBar.destroy(a),this._hScrollBar&&this._hScrollBar.destroy(a),this._vScrollBar=null,this._hScrollBar=null,this._content=null},c.destroyChildren=function(){this._content.destroyChildren()},c.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new F)},c.addChild=function(a){return a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(a)},c.onResize=function(){this._setScrollChanged()},c.addChildAt=function(a,b){return a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(a,b)},c.removeChild=function(a){return a.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(a)},c.removeChildAt=function(a){return this.getChildAt(a).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(a)},c.removeChildren=function(a,b){void 0===a&&(a=0),void 0===b&&(b=2147483647);for(var c=this._content.numChildren-1;c>-1;c--)this._content.removeChildAt(c);return this._setScrollChanged(),this},c.getChildAt=function(a){return this._content.getChildAt(a)},c.getChildByName=function(a){return this._content.getChildByName(a)},c.getChildIndex=function(a){return this._content.getChildIndex(a)},c.changeScroll=function(){this._scrollChanged=!1;var a=this.contentWidth,b=this.contentHeight,c=this._vScrollBar,d=this._hScrollBar,e=c&&b>this._height,f=d&&a>this._width,g=e?this._width-c.width:this._width,h=f?this._height-d.height:this._height;c&&(c.x=this._width-c.width,c.y=0,c.height=this._height-(f?d.height:0),c.scrollSize=Math.max(.033*this._height,1),c.thumbPercent=h/b,c.setScroll(0,b-h,c.value)),d&&(d.x=0,d.y=this._height-d.height,d.width=this._width-(e?c.width:0),d.scrollSize=Math.max(.033*this._width,1),d.thumbPercent=g/a,d.setScroll(0,a-g,d.value))},c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},c.setContentSize=function(a,b){var c=this._content;c.width=a,c.height=b,c.scrollRect||(c.scrollRect=new r),c.scrollRect.setTo(0,0,a,b),c.conchModel&&c.conchModel.scrollRect(0,0,a,b)},c.onScrollBarChange=function(a){var b=this._content.scrollRect;if(b){var c=Math.round(a.value);a.isVertical?b.y=c:b.x=c,this._content.conchModel&&this._content.conchModel.scrollRect(b.x,b.y,b.width,b.height)}},c.scrollTo=function(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this.vScrollBar&&(this.vScrollBar.value=b),this.hScrollBar&&(this.hScrollBar.value=a)},c.refresh=function(){this.changeScroll()},c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=a.prototype._$get_cacheAs.call(this)),a.prototype._$set_cacheAs.call(this,"none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},c.onScrollEnd=function(){a.prototype._$set_cacheAs.call(this,this._$P.cacheAs)},c._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},e(0,c,"numChildren",function(){return this._content.numChildren}),e(0,c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(a){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new V),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=a}),e(0,c,"contentWidth",function(){for(var a=0,b=this._content.numChildren-1;b>-1;b--){var c=this._content.getChildAt(b);a=Math.max(c.x+c.width*c.scaleX,a)}return a}),e(0,c,"contentHeight",function(){for(var a=0,b=this._content.numChildren-1;b>-1;b--){var c=this._content.getChildAt(b);a=Math.max(c.y+c.height*c.scaleY,a)}return a}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._setScrollChanged()}),e(0,c,"hScrollBar",function(){return this._hScrollBar}),e(0,c,"content",function(){return this._content}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._setScrollChanged()}),e(0,c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(a){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new _),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=a}),e(0,c,"vScrollBar",function(){return this._vScrollBar}),e(0,c,"cacheAs",a.prototype._$get_cacheAs,function(b){a.prototype._$set_cacheAs.call(this,b),this._$P.cacheAs=null,"none"!==b?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),b}(F),V=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.HScrollBar",a),b.prototype.initialize=function(){a.prototype.initialize.call(this),this.slider.isVertical=!1},b}(K),W=function(a){function c(a,b){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,c.__super.call(this),this.skin=b,this.labels=a}d(c,"laya.ui.UIGroup",a);var f=c.prototype;return b.imps(f,{"laya.ui.IItem":!0}),f.preinitialize=function(){this.mouseEnabled=!0},f.destroy=function(a){void 0===a&&(a=!0),laya.ui.Component.prototype.destroy.call(this,a),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},f.addItem=function(a,b){void 0===b&&(b=!0);var c=a,d=this._items.length;if(c.name="item"+d,this.addChild(c),this.initItems(),b&&d>0){var e=this._items[d-1];"horizontal"==this._direction?c.x=e.x+e.width+this._space:c.y=e.y+e.height+this._space}else b&&(c.x=0,c.y=0);return d},f.delItem=function(a,b){void 0===b&&(b=!0);var c=this._items.indexOf(a);if(c!=-1){var d=a;this.removeChild(d);for(var e=c+1,f=this._items.length;e<f;e++){var g=this._items[e];g.name="item"+(e-1),b&&("horizontal"==this._direction?g.x-=d.width+this._space:g.y-=d.height+this._space)}if(this.initItems(),this._selectedIndex>-1){var h=0;h=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=h}}},f.initItems=function(){this._items||(this._items=[]),this._items.length=0;for(var a=0;a<1e4;a++){var b=this.getChildByName("item"+a);if(null==b)break;this._items.push(b),b.selected=a===this._selectedIndex,b.clickHandler=n.create(this,this.itemClick,[a],!1)}},f.itemClick=function(a){this.selectedIndex=a},f.setSelect=function(a,b){this._items&&a>-1&&a<this._items.length&&(this._items[a].selected=b)},f.createItem=function(a,b){return null},f.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var a=0,b=0,c=this._items.length;b<c;b++){var d=this._items[b];this._skin&&(d.skin=this._skin),this._labelColors&&(d.labelColors=this._labelColors),this._labelSize&&(d.labelSize=this._labelSize),this._labelStroke&&(d.labelStroke=this._labelStroke),this._labelStrokeColor&&(d.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(d.strokeColors=this._strokeColors),this._labelBold&&(d.labelBold=this._labelBold),this._labelPadding&&(d.labelPadding=this._labelPadding),this._labelAlign&&(d.labelAlign=this._labelAlign),this._stateNum&&(d.stateNum=this._stateNum),"horizontal"===this._direction?(d.y=0,d.x=a,a+=d.width+this._space):(d.x=0,d.y=a,a+=d.height+this._space)}this.changeSize()},f.commitMeasure=function(){this.runCallLater(this.changeLabels)},f._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},e(0,f,"labelStrokeColor",function(){return this._labelStrokeColor},function(a){this._labelStrokeColor!=a&&(this._labelStrokeColor=a,this._setLabelChanged())}),e(0,f,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._setLabelChanged())}),e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=a,this.setSelect(a,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),e(0,f,"labels",function(){return this._labels},function(a){if(this._labels!=a){if(this._labels=a,this.removeChildren(),this._setLabelChanged(),this._labels)for(var b=this._labels.split(","),c=0,d=b.length;c<d;c++){var e=this.createItem(this._skin,b[c]);e.name="item"+c,this.addChild(e)}this.initItems()}}),e(0,f,"strokeColors",function(){return this._strokeColors},function(a){this._strokeColors!=a&&(this._strokeColors=a,this._setLabelChanged())}),e(0,f,"labelColors",function(){return this._labelColors},function(a){this._labelColors!=a&&(this._labelColors=a,this._setLabelChanged())}),e(0,f,"labelStroke",function(){return this._labelStroke},function(a){this._labelStroke!=a&&(this._labelStroke=a,this._setLabelChanged())}),e(0,f,"labelSize",function(){return this._labelSize},function(a){this._labelSize!=a&&(this._labelSize=a,this._setLabelChanged())}),e(0,f,"stateNum",function(){return this._stateNum},function(a){this._stateNum!=a&&(this._stateNum=a,this._setLabelChanged())}),e(0,f,"labelBold",function(){return this._labelBold},function(a){this._labelBold!=a&&(this._labelBold=a,this._setLabelChanged())}),e(0,f,"labelPadding",function(){return this._labelPadding},function(a){this._labelPadding!=a&&(this._labelPadding=a,this._setLabelChanged())}),e(0,f,"direction",function(){return this._direction},function(a){this._direction=a,this._setLabelChanged()}),e(0,f,"space",function(){return this._space},function(a){this._space=a,this._setLabelChanged()}),e(0,f,"items",function(){return this._items}),e(0,f,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(a){this.selectedIndex=this._items.indexOf(a)}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,"number"==typeof b&&Math.floor(b)==b||"string"==typeof b?this.selectedIndex=parseInt(b):b instanceof Array?this.labels=b.join(","):a.prototype._$set_dataSource.call(this,b)}),c}(F),X=function(a){function b(a,c){this._value=null,void 0===c&&(c=""),b.__super.call(this,a,c)}d(b,"laya.ui.Radio",a);var c=b.prototype;return c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._value=null},c.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},c.initialize=function(){a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},c.onClick=function(a){this.selected=!0},e(0,c,"value",function(){return null!=this._value?this._value:this.label},function(a){this._value=a}),b}(G),Y=function(a){function b(a){b.__super.call(this,a),this.isVertical=!1}return d(b,"laya.ui.HSlider",a),b}(L),Z=function(a){function c(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,c.__super.call(this),this.width=this.height=200}d(c,"laya.ui.Tree",a);var f=c.prototype;return b.imps(f,{"laya.ui.IRender":!0}),f.destroy=function(a){void 0===a&&(a=!0),laya.ui.Component.prototype.destroy.call(this,a),this._list&&this._list.destroy(a),this._list=null,this._source=null,this._renderHandler=null},f.createChildren=function(){this.addChild(this._list=new T),this._list.renderHandler=n.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},f.onListChange=function(a){this.event("change")},f.getArray=function(){var a,b=[];for(var c in this._source)a=this._source[c],this.getParentOpenStatus(a)&&(a.x=this._spaceLeft*this.getDepth(a),b.push(a));return b},f.getDepth=function(a,b){return void 0===b&&(b=0),null==a.nodeParent?b:this.getDepth(a.nodeParent,b+1)},f.getParentOpenStatus=function(a){var b=a.nodeParent;return null==b||!!b.isOpen&&(null==b.nodeParent||this.getParentOpenStatus(b))},f.renderItem=function(a,b){var c=a.dataSource;if(c){a.left=c.x;var d=a.getChildByName("arrow");d&&(c.hasChild?(d.visible=!0,d.index=c.isOpen?1:0,d.tag=b,d.off("click",this,this.onArrowClick),d.on("click",this,this.onArrowClick)):d.visible=!1);var e=a.getChildByName("folder");e&&(2==e.clipY?e.index=c.isDirectory?0:1:e.index=c.isDirectory?c.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([a,b])}},f.onArrowClick=function(a){var b=a.currentTarget,c=b.tag;this._list.array[c].isOpen=!this._list.array[c].isOpen,this._list.array=this.getArray()},f.setItemState=function(a,b){this._list.array[a]&&(this._list.array[a].isOpen=b,this._list.array=this.getArray())},f.fresh=function(){this._list.array=this.getArray(),this.repaint()},f.parseXml=function(a,b,c,d){var e,f=a.childNodes,g=f.length;if(!d){e={};var h,i=a.attributes;for(var j in i){h=i[j];var k=h.nodeName,l=h.nodeValue;e[k]="true"==l||"false"!=l&&l}e.nodeParent=c,g>0&&(e.isDirectory=!0),e.hasChild=g>0,b.push(e)}for(var m=0;m<g;m++){var n=f[m];this.parseXml(n,b,e,!1)}},f.parseOpenStatus=function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e.isDirectory)for(var f=0,g=a.length;f<g;f++){var h=a[f];if(h.isDirectory&&this.isSameParent(h,e)&&e.label==h.label){e.isOpen=h.isOpen;break}}}},f.isSameParent=function(a,b){return null==a.nodeParent&&null==b.nodeParent||null!=a.nodeParent&&null!=b.nodeParent&&(a.nodeParent.label==b.nodeParent.label&&this.isSameParent(a.nodeParent,b.nodeParent))},f.filter=function(a){if(a){var b=[];this.getFilterSource(this._source,b,a),this._list.array=b}else this._list.array=this.getArray()},f.getFilterSource=function(a,b,c){c=c.toLocaleLowerCase();var d;for(var e in a)d=a[e],!d.isDirectory&&(d.label+"").toLowerCase().indexOf(c)>-1&&(d.x=0,b.push(d)),d.child&&d.child.length>0&&this.getFilterSource(d.child,b,c)},e(0,f,"spaceBottom",function(){return this._list.spaceY},function(a){this._list.spaceY=a}),e(0,f,"keepStatus",function(){return this._keepStatus},function(a){this._keepStatus=a}),e(0,f,"itemRender",function(){return this._list.itemRender},function(a){this._list.itemRender=a}),e(0,f,"array",function(){return this._list.array},function(a){this._keepStatus&&this._list.array&&a&&this.parseOpenStatus(this._list.array,a),this._source=a,this._list.array=this.getArray()}),e(0,f,"mouseHandler",function(){return this._list.mouseHandler},function(a){this._list.mouseHandler=a}),e(0,f,"dataSource",a.prototype._$get_dataSource,function(b){this._dataSource=b,a.prototype._$set_dataSource.call(this,b)}),e(0,f,"source",function(){return this._source}),e(0,f,"scrollBar",function(){return this._list.scrollBar}),e(0,f,"list",function(){return this._list}),e(0,f,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(a){this._list.vScrollBarSkin=a}),e(0,f,"renderHandler",function(){return this._renderHandler},function(a){this._renderHandler=a}),e(0,f,"selectedIndex",function(){return this._list.selectedIndex},function(a){this._list.selectedIndex=a}),e(0,f,"spaceLeft",function(){return this._spaceLeft},function(a){this._spaceLeft=a}),e(0,f,"selectedItem",function(){return this._list.selectedItem},function(a){this._list.selectedItem=a}),e(0,f,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._list.width=b}),e(0,f,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._list.height=b}),e(0,f,"xml",null,function(a){var b=[];this.parseXml(a.childNodes[0],b,null,!0),this.array=b}),e(0,f,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),c}(F),$=function(a){function c(){this._items=null,this._selectedIndex=0,c.__super.call(this),this._setIndexHandler=n.create(this,this.setIndex,null,!1)}d(c,"laya.ui.ViewStack",a);var f=c.prototype;return b.imps(f,{"laya.ui.IItem":!0}),f.setItems=function(a){this.removeChildren();for(var b=0,c=0,d=a.length;c<d;c++){var e=a[c];e&&(e.name="item"+b,this.addChild(e),b++)}this.initItems()},f.addItem=function(a){a.name="item"+this._items.length,this.addChild(a),this.initItems()},f.initItems=function(){this._items=[];for(var a=0;a<1e4;a++){var b=this.getChildByName("item"+a);if(null==b)break;this._items.push(b),b.visible=a==this._selectedIndex}},f.setSelect=function(a,b){this._items&&a>-1&&a<this._items.length&&(this._items[a].visible=b)},f.setIndex=function(a){this.selectedIndex=a},e(0,f,"dataSource",a.prototype._$get_dataSource,function(a){if(this._dataSource=a,"number"==typeof a&&Math.floor(a)==a||"string"==typeof a)this.selectedIndex=parseInt(a);else for(var b in this._dataSource)this.hasOwnProperty(b)&&(this[b]=this._dataSource[b])}),e(0,f,"selectedIndex",function(){return this._selectedIndex},function(a){this._selectedIndex!=a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=a,this.setSelect(this._selectedIndex,!0))}),e(0,f,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(a){this.selectedIndex=this._items.indexOf(a)}),e(0,f,"items",function(){return this._items}),e(0,f,"setIndexHandler",function(){return this._setIndexHandler},function(a){this._setIndexHandler=a}),c}(F),_=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.VScrollBar",a),b}(K),aa=function(a){function b(a){this._bg=null,this._skin=null,b.__super.call(this),void 0===a&&(a=""),this.text=a,this.skin=this.skin}d(b,"laya.ui.TextInput",a);var c=b.prototype;return c.preinitialize=function(){this.mouseEnabled=!0},c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._bg&&this._bg.destroy(),this._bg=null},c.createChildren=function(){this.addChild(this._tf=new o),this._tf.padding=z.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},c._onFocus=function(){this.event("focus",this)},c._onBlur=function(){this.event("blur",this)},c._onInput=function(){this.event("input",this)},c._onEnter=function(){this.event("enter",this)},c.initialize=function(){this.width=128,this.height=22},c.select=function(){this._tf.select()},c.setSelection=function(a,b){this._tf.setSelection(a,b)},e(0,c,"bg",function(){return this._bg},function(a){this.graphics=this._bg=a}),e(0,c,"multiline",function(){return this._tf.multiline},function(a){this._tf.multiline=a}),e(0,c,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(a){this._tf.inputElementYAdjuster=a}),e(0,c,"skin",function(){return this._skin},function(a){this._skin!=a&&(this._skin=a,this._bg||(this.graphics=this._bg=new C),this._bg.source=p.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),e(0,c,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(a){this._bg||(this.graphics=this._bg=new C),this._bg.sizeGrid=A.fillArray(z.defaultSizeGrid,a,Number)}),e(0,c,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(a){this._tf.inputElementXAdjuster=a}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this._bg&&(this._bg.width=b)}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this._bg&&(this._bg.height=b)}),e(0,c,"editable",function(){return this._tf.editable},function(a){this._tf.editable=a}),e(0,c,"restrict",function(){return this._tf.restrict},function(a){this._tf.restrict=a}),e(0,c,"prompt",function(){return this._tf.prompt},function(a){this._tf.prompt=a}),e(0,c,"promptColor",function(){return this._tf.promptColor},function(a){this._tf.promptColor=a}),e(0,c,"maxChars",function(){return this._tf.maxChars},function(a){this._tf.maxChars=a}),e(0,c,"focus",function(){return this._tf.focus},function(a){this._tf.focus=a}),e(0,c,"type",function(){return this._tf.type},function(a){this._tf.type=a}),e(0,c,"asPassword",function(){return this._tf.asPassword},function(a){this._tf.asPassword=a}),b}(N),ba=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.VSlider",a),b}(L),ca=function(a){function b(){this.popupCenter=!0,this.closeHandler=null,this.group=null,this.isModal=!1,this._dragArea=null,b.__super.call(this)}d(b,"laya.ui.Dialog",a);var c=b.prototype;return c.initialize=function(){this._dealDragArea(),this.on("click",this,this._onClick)},c._dealDragArea=function(){var a=this.getChildByName("drag");a&&(this.dragArea=a.x+","+a.y+","+a.width+","+a.height,a.removeSelf())},c._onClick=function(a){var b=a.target;if(b)switch(b.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(b.name)}},c.show=function(a){void 0===a&&(a=!1),this._open(!1,a)},c.popup=function(a){void 0===a&&(a=!1),this._open(!0,a)},c._open=function(a,c){b.manager.lock(!1),this.isModal=a,b.manager.open(this,c)},c.close=function(a){b.manager.close(this)},c._onMouseDown=function(a){var b=this.getMousePoint();this._dragArea.contains(b.x,b.y)?this.startDrag():this.stopDrag()},e(0,c,"dragArea",function(){return this._dragArea?""+this._dragArea:null},function(a){if(a){var b=A.fillArray([0,0,0,0],a,Number);this._dragArea=new r(b[0],b[1],b[2],b[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),e(0,c,"isPopup",function(){return null!=this.parent}),e(0,c,"zOrder",a.prototype._$get_zOrder,function(c){a.prototype._$set_zOrder.call(this,c),b.manager._checkMask()}),e(1,b,"manager",function(){return b._manager=b._manager||new E},function(a){b._manager=a}),b.setLockView=function(a){b.manager.setLockView(a)},b.lock=function(a){b.manager.lock(a)},b.closeAll=function(){b.manager.closeAll()},b.getDialogsByGroup=function(a){
return b.manager.getDialogsByGroup(a)},b.closeByGround=function(a){return b.manager.closeByGround(a)},b.CLOSE="close",b.CANCEL="cancel",b.SURE="sure",b.NO="no",b.OK="ok",b.YES="yes",b._manager=null,b}(Q),da=function(a){function b(){b.__super.call(this)}d(b,"laya.ui.HBox",a);var c=b.prototype;return c.sortItem=function(a){a&&a.sort(function(a,b){return a.x-b.x})},c.changeItems=function(){this._itemChanged=!1;for(var a=[],b=0,c=0,d=this.numChildren;c<d;c++){var e=this.getChildAt(c);e&&(a.push(e),b=Math.max(b,e.height*e.scaleY))}this.sortItem(a);var f=0;for(c=0,d=this.numChildren;c<d;c++)e=a[c],e.x=f,f+=e.width*e.scaleX+this._space,"top"==this._align?e.y=0:"middle"==this._align?e.y=.5*(b-e.height*e.scaleY):"bottom"==this._align&&(e.y=b-e.height*e.scaleY);this.changeSize()},b.NONE="none",b.TOP="top",b.MIDDLE="middle",b.BOTTOM="bottom",b}(S),ea=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.VBox",a),b.prototype.changeItems=function(){this._itemChanged=!1;for(var a=[],b=0,c=0,d=this.numChildren;c<d;c++){var e=this.getChildAt(c);e&&(a.push(e),b=Math.max(b,e.width*e.scaleX))}this.sortItem(a);var f=0;for(c=0,d=this.numChildren;c<d;c++)e=a[c],e.y=f,f+=e.height*e.scaleY+this._space,"left"==this._align?e.x=0:"center"==this._align?e.x=.5*(b-e.width*e.scaleX):"right"==this._align&&(e.x=b-e.width*e.scaleX);this.changeSize()},b.NONE="none",b.LEFT="left",b.CENTER="center",b.RIGHT="right",b}(S),fa=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.RadioGroup",a),b.prototype.createItem=function(a,b){return new X(a,b)},b}(W),ga=function(a){function b(){b.__super.call(this)}return d(b,"laya.ui.Tab",a),b.prototype.createItem=function(a,b){return new G(a,b)},b}(W),ha=function(a){function b(a){this._vScrollBar=null,this._hScrollBar=null,void 0===a&&(a=""),b.__super.call(this,a)}d(b,"laya.ui.TextArea",a);var c=b.prototype;return c.destroy=function(b){void 0===b&&(b=!0),a.prototype.destroy.call(this,b),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},c.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},c.onVBarChanged=function(a){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},c.onHBarChanged=function(a){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},c.changeScroll=function(){var a=this._vScrollBar&&this._tf.maxScrollY>0,b=this._hScrollBar&&this._tf.maxScrollX>0,c=a?this._width-this._vScrollBar.width:this._width,d=b?this._height-this._hScrollBar.height:this._height,e=this._tf.padding||z.labelPadding;this._tf.width=c,this._tf.height=d,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-e[2],this._vScrollBar.y=e[1],this._vScrollBar.height=this._height-(b?this._hScrollBar.height:0)-e[1]-e[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=d/Math.max(this._tf.textHeight,d),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=a),this._hScrollBar&&(this._hScrollBar.x=e[0],this._hScrollBar.y=this._height-this._hScrollBar.height-e[3],this._hScrollBar.width=this._width-(a?this._vScrollBar.width:0)-e[0]-e[2],this._hScrollBar.scrollSize=Math.max(.033*c,1),this._hScrollBar.thumbPercent=c/Math.max(this._tf.textWidth,c),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=b)},c.scrollTo=function(a){this.commitMeasure(),this._tf.scrollY=a},e(0,c,"scrollY",function(){return this._tf.scrollY}),e(0,c,"width",a.prototype._$get_width,function(b){a.prototype._$set_width.call(this,b),this.callLater(this.changeScroll)}),e(0,c,"hScrollBar",function(){return this._hScrollBar}),e(0,c,"height",a.prototype._$get_height,function(b){a.prototype._$set_height.call(this,b),this.callLater(this.changeScroll)}),e(0,c,"maxScrollX",function(){return this._tf.maxScrollX}),e(0,c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(a){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new _),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=a}),e(0,c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(a){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new V),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=a}),e(0,c,"vScrollBar",function(){return this._vScrollBar}),e(0,c,"maxScrollY",function(){return this._tf.maxScrollY}),e(0,c,"scrollX",function(){return this._tf.scrollX}),b}(aa);!function(a){function b(){this._uiView=null,b.__super.call(this)}d(b,"laya.ui.AsynDialog",a);var c=b.prototype;c.createView=function(a){this._uiView=a},c.ready=function(){this._uiView&&(laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null),this._dealDragArea(),this.callLater(this.event,["ready"])},c.show=function(a){void 0===a&&(a=!1),ca.manager.lock(!0),this.once("ready",this,this._open,[!1,a]),this.ua()},c.popup=function(a){void 0===a&&(a=!1),ca.manager.lock(!0),this.once("ready",this,this._open,[!0,a]),this.ua()},c.ua=function(){},b}(ca);b.__init([Q])}(0,0,b);var c=c||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,b){a=this.words=a||[],this.sigBytes=void 0!=b?b:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(a){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;i<b;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=c,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;e<c;e+=3)for(var f=(b[e>>>2]>>>24-e%4*8&255)<<16|(b[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|b[e+2>>>2]>>>24-(e+2)%4*8&255,g=0;4>g&&e+.75*g<c;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&-1!=(e=a.indexOf(e))&&(c=e);for(var e=[],f=0,g=0;g<c;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<g%4*2,i=d.indexOf(a.charAt(g))>>>6-g%4*2;e[f>>>2]|=(h|i)<<24-f%4*8,f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return((a=a+(b&c|~b&d)+e+g)<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return((a=a+(b&d|c&~d)+e+g)<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return((a=a+(b^c^d)+e+g)<<f|a>>>32-f)+b}function f(a,b,c,d,e,f,g){return((a=a+(c^(b|~d))+e+g)<<f|a>>>32-f)+b}for(var g=c,h=g.lib,i=h.WordArray,j=h.Hasher,h=g.algo,k=[],l=0;64>l;l++)k[l]=4294967296*a.abs(a.sin(l+1))|0;h=h.MD5=j.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,c){for(var g=0;16>g;g++){var h=c+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[c+0],i=a[c+1],j=a[c+2],l=a[c+3],m=a[c+4],n=a[c+5],o=a[c+6],p=a[c+7],q=a[c+8],r=a[c+9],s=a[c+10],t=a[c+11],u=a[c+12],v=a[c+13],w=a[c+14],x=a[c+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,k[0]),B=b(B,y,z,A,i,12,k[1]),A=b(A,B,y,z,j,17,k[2]),z=b(z,A,B,y,l,22,k[3]),y=b(y,z,A,B,m,7,k[4]),B=b(B,y,z,A,n,12,k[5]),A=b(A,B,y,z,o,17,k[6]),z=b(z,A,B,y,p,22,k[7]),y=b(y,z,A,B,q,7,k[8]),B=b(B,y,z,A,r,12,k[9]),A=b(A,B,y,z,s,17,k[10]),z=b(z,A,B,y,t,22,k[11]),y=b(y,z,A,B,u,7,k[12]),B=b(B,y,z,A,v,12,k[13]),A=b(A,B,y,z,w,17,k[14]),z=b(z,A,B,y,x,22,k[15]),y=d(y,z,A,B,i,5,k[16]),B=d(B,y,z,A,o,9,k[17]),A=d(A,B,y,z,t,14,k[18]),z=d(z,A,B,y,h,20,k[19]),y=d(y,z,A,B,n,5,k[20]),B=d(B,y,z,A,s,9,k[21]),A=d(A,B,y,z,x,14,k[22]),z=d(z,A,B,y,m,20,k[23]),y=d(y,z,A,B,r,5,k[24]),B=d(B,y,z,A,w,9,k[25]),A=d(A,B,y,z,l,14,k[26]),z=d(z,A,B,y,q,20,k[27]),y=d(y,z,A,B,v,5,k[28]),B=d(B,y,z,A,j,9,k[29]),A=d(A,B,y,z,p,14,k[30]),z=d(z,A,B,y,u,20,k[31]),y=e(y,z,A,B,n,4,k[32]),B=e(B,y,z,A,q,11,k[33]),A=e(A,B,y,z,t,16,k[34]),z=e(z,A,B,y,w,23,k[35]),y=e(y,z,A,B,i,4,k[36]),B=e(B,y,z,A,m,11,k[37]),A=e(A,B,y,z,p,16,k[38]),z=e(z,A,B,y,s,23,k[39]),y=e(y,z,A,B,v,4,k[40]),B=e(B,y,z,A,h,11,k[41]),A=e(A,B,y,z,l,16,k[42]),z=e(z,A,B,y,o,23,k[43]),y=e(y,z,A,B,r,4,k[44]),B=e(B,y,z,A,u,11,k[45]),A=e(A,B,y,z,x,16,k[46]),z=e(z,A,B,y,j,23,k[47]),y=f(y,z,A,B,h,6,k[48]),B=f(B,y,z,A,p,10,k[49]),A=f(A,B,y,z,w,15,k[50]),z=f(z,A,B,y,n,21,k[51]),y=f(y,z,A,B,u,6,k[52]),B=f(B,y,z,A,l,10,k[53]),A=f(A,B,y,z,s,15,k[54]),z=f(z,A,B,y,i,21,k[55]),y=f(y,z,A,B,q,6,k[56]),B=f(B,y,z,A,x,10,k[57]),A=f(A,B,y,z,o,15,k[58]),z=f(z,A,B,y,v,21,k[59]),y=f(y,z,A,B,m,6,k[60]),B=f(B,y,z,A,t,10,k[61]),A=f(A,B,y,z,j,15,k[62]),z=f(z,A,B,y,r,21,k[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[15+(e+64>>>9<<4)]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[14+(e+64>>>9<<4)]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=j.clone.call(this);return a._hash=this._hash.clone(),a}}),g.MD5=j._createHelper(h),g.HmacMD5=j._createHmacHelper(h)}(Math),function(){var a=c,b=a.lib,d=b.Base,e=b.WordArray,b=a.algo,f=b.EvpKDF=d.extend({cfg:d.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=c.hasher.create(),f=e.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&d.update(i);var i=d.update(a).finalize(b);d.reset();for(var j=1;j<c;j++)i=d.finalize(i),d.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return f.create(c).compute(a,b)}}(),c.lib.Cipher||function(a){var b=c,d=b.lib,e=d.Base,f=d.WordArray,g=d.BufferedBlockAlgorithm,h=b.enc.Base64,i=b.algo.EvpKDF,j=d.Cipher=g.extend({cfg:e.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{va:function(b,c,d){return("string"==typeof c?p:o).va(a,b,c,d)},wa:function(b,c,d){return("string"==typeof c?p:o).wa(a,b,c,d)}}}});d.StreamCipher=j.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var k=b.mode={},l=function(a,b,c){var d=this._iv;d?this._iv=void 0:d=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=d[e]},m=(d.BlockCipherMode=e.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();m.Encryptor=m.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;l.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),m.Decryptor=m.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),l.call(this,a,b,d),this._prevBlock=e}}),k=k.CBC=m,m=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],g=0;g<c;g+=4)e.push(d);c=f.create(e,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},d.BlockCipher=j.extend({cfg:j.cfg.extend({mode:k,padding:m}),reset:function(){j.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var n=d.CipherParams=e.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),k=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?f.create([1398893684,1701076831]).concat(a).concat(b):b).toString(h)},parse:function(a){a=h.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=f.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return n.create({ciphertext:a,salt:c})}},o=d.SerializableCipher=e.extend({cfg:e.extend({format:k}),va:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,n.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},wa:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.xa={}).OpenSSL={ya:function(a,b,c,d){return d||(d=f.random(8)),a=i.create({keySize:b+c}).compute(a,d),c=f.create(a.words.slice(b),4*c),a.sigBytes=4*b,n.create({key:a,iv:c,salt:d})}},p=d.za=o.extend({cfg:o.cfg.extend({xa:b}),va:function(a,b,c,d){return d=this.cfg.extend(d),c=d.xa.ya(c,a.keySize,a.ivSize),d.iv=c.iv,a=o.va.call(this,a,b,c.key,d),a.mixIn(c),a},wa:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.xa.ya(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,o.wa.call(this,a,b,c.key,d)}})}(),function(){for(var a=c,b=a.lib.BlockCipher,d=a.algo,e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=0;256>p;p++)o[p]=128>p?p<<1:p<<1^283;for(var q=0,r=0,p=0;256>p;p++){var s=r^r<<1^r<<2^r<<3^r<<4,s=s>>>8^255&s^99;e[q]=s,f[s]=q;var t=o[q],u=o[t],v=o[u],w=257*o[s]^16843008*s;g[q]=w<<24|w>>>8,h[q]=w<<16|w>>>16,i[q]=w<<8|w>>>24,j[q]=w,w=16843009*v^65537*u^257*t^16843008*q,k[s]=w<<24|w>>>8,l[s]=w<<16|w>>>16,m[s]=w<<8|w>>>24,n[s]=w,q?(q=t^o[o[o[v^t]]],r^=o[o[r]]):q=r=1}var x=[0,1,2,4,8,16,32,64,128,27,54],d=d.Aa=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this.Ba=c+6)+1),d=this.Ca=[],f=0;f<a;f++)if(f<c)d[f]=b[f];else{var g=d[f-1];f%c?6<c&&4==f%c&&(g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g]):(g=g<<8|g>>>24,g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g],g^=x[f/c|0]<<24),d[f]=d[f-c]^g}for(b=this.Da=[],c=0;c<a;c++)f=a-c,g=c%4?d[f]:d[f-4],b[c]=4>c||4>=f?g:k[e[g>>>24]]^l[e[g>>>16&255]]^m[e[g>>>8&255]]^n[e[255&g]]},encryptBlock:function(a,b){this.Ea(a,b,this.Ca,g,h,i,j,e)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this.Ea(a,b,this.Da,k,l,m,n,f),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},Ea:function(a,b,c,d,e,f,g,h){for(var i=this.Ba,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;o<i;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});a.Aa=b._createHelper(d)}();var LZString=function(){function a(a,b){if(!e[a]){e[a]={};for(var c=0;c<a.length;c++)e[a][a.charAt(c)]=c}return e[a][b]}var b=String.fromCharCode,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",e={},f={Fa:function(a){if(null==a)return"";var b=f.Ga(a,6,function(a){return c.charAt(a)});switch(b.length%4){default:case 0:return b;case 1:return b+"===";case 2:return b+"==";case 3:return b+"="}},Ha:function(b){return null==b?"":""==b?null:f.Ia(b.length,32,function(d){return a(c,b.charAt(d))})},Ja:function(a){return null==a?"":f.Ga(a,15,function(a){return b(a+32)})+" "},Ka:function(a){return null==a?"":""==a?null:f.Ia(a.length,16384,function(b){return a.charCodeAt(b)-32})},La:function(a){for(var b=f.Ma(a),c=new Uint8Array(2*b.length),d=0,e=b.length;e>d;d++){var g=b.charCodeAt(d);c[2*d]=g>>>8,c[2*d+1]=g%256}return c},Na:function(a){if(null===a||void 0===a)return f.Oa(a);for(var c=Array(a.length/2),d=0,e=c.length;e>d;d++)c[d]=256*a[2*d]+a[2*d+1];var g=[];return c.forEach(function(a){g.push(b(a))}),f.Oa(g.join(""))},Pa:function(a){return null==a?"":f.Ga(a,6,function(a){return d.charAt(a)})},Qa:function(b){return null==b?"":""==b?null:(b=b.replace(/ /g,"+"),f.Ia(b.length,32,function(c){return a(d,b.charAt(c))}))},Ma:function(a){return f.Ga(a,16,function(a){return b(a)})},Ga:function(a,b,c){if(null==a)return"";var d,e,f,g={},h={},i="",j="",k="",l=2,m=3,n=2,o=[],p=0,q=0;for(f=0;f<a.length;f+=1)if(i=a.charAt(f),Object.prototype.hasOwnProperty.call(g,i)||(g[i]=m++,h[i]=!0),j=k+i,Object.prototype.hasOwnProperty.call(g,j))k=j;else{if(Object.prototype.hasOwnProperty.call(h,k)){if(k.charCodeAt(0)<256){for(d=0;n>d;d++)p<<=1,q==b-1?(q=0,o.push(c(p)),p=0):q++;for(e=k.charCodeAt(0),d=0;8>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}else{for(e=1,d=0;n>d;d++)p=p<<1|e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e=0;for(e=k.charCodeAt(0),d=0;16>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}l--,0==l&&(l=Math.pow(2,n),n++),delete h[k]}else for(e=g[k],d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;l--,0==l&&(l=Math.pow(2,n),n++),g[j]=m++,k=i+""}if(""!==k){if(Object.prototype.hasOwnProperty.call(h,k)){if(k.charCodeAt(0)<256){for(d=0;n>d;d++)p<<=1,q==b-1?(q=0,o.push(c(p)),p=0):q++;for(e=k.charCodeAt(0),d=0;8>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}else{for(e=1,d=0;n>d;d++)p=p<<1|e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e=0;for(e=k.charCodeAt(0),d=0;16>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}l--,0==l&&(l=Math.pow(2,n),n++),delete h[k]}else for(e=g[k],d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;0==--l&&(l=Math.pow(2,n),n++)}for(e=2,d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;for(;;){if(p<<=1,q==b-1){o.push(c(p));break}q++}return o.join("")},Oa:function(a){return null==a?"":""==a?null:f.Ia(a.length,32768,function(b){return a.charCodeAt(b)})},Ia:function(a,c,d){var e,f,g,h,i,j,k,l=[],m=4,n=4,o=3,p="",q=[],r={Ra:d(0),position:c,index:1};for(e=0;3>e;e+=1)l[e]=e;for(g=0,i=Math.pow(2,2),j=1;j!=i;)h=r.Ra&r.position,r.position>>=1,0==r.position&&(r.position=c,r.Ra=d(r.index++)),g|=(h>0?1:0)*j,j<<=1;switch(g){case 0:for(g=0,i=Math.pow(2,8),j=1;j!=i;)h=r.Ra&r.position,r.position>>=1,0==r.position&&(r.position=c,r.Ra=d(r.index++)),g|=(h>0?1:0)*j,j<<=1;k=b(g);break;case 1:for(g=0,i=Math.pow(2,16),j=1;j!=i;)h=r.Ra&r.position,r.position>>=1,0==r.position&&(r.position=c,r.Ra=d(r.index++)),g|=(h>0?1:0)*j,j<<=1;k=b(g);break;case 2:return""}for(l[3]=k,f=k,q.push(k);;){if(r.index>a)return"";for(g=0,i=Math.pow(2,o),j=1;j!=i;)h=r.Ra&r.position,r.position>>=1,0==r.position&&(r.position=c,r.Ra=d(r.index++)),g|=(h>0?1:0)*j,j<<=1;switch(k=g){case 0:for(g=0,i=Math.pow(2,8),j=1;j!=i;)h=r.Ra&r.position,r.position>>=1,0==r.position&&(r.position=c,r.Ra=d(r.index++)),g|=(h>0?1:0)*j,j<<=1;l[n++]=b(g),k=n-1,m--;break;case 1:for(g=0,i=Math.pow(2,16),j=1;j!=i;)h=r.Ra&r.position,r.position>>=1,0==r.position&&(r.position=c,r.Ra=d(r.index++)),g|=(h>0?1:0)*j,j<<=1;l[n++]=b(g),k=n-1,m--;break;case 2:return q.join("")}if(0==m&&(m=Math.pow(2,o),o++),l[k])p=l[k];else{if(k!==n)return null;p=f+f.charAt(0)}q.push(p),l[n++]=f+p.charAt(0),m--,f=p,0==m&&(m=Math.pow(2,o),o++)}}};return f}();"function"==typeof define&&define.Sa?define(function(){return LZString}):"undefined"!=typeof module&&null!=module&&(module.Ta=LZString);var d=function(){function a(){}return a.Ua=function(b){return!!a.Va(b)&&(!(b.length<=0)&&(b=b.replace(/\s/g,"").replace(/\n|\r/,""),/^\{(.*?)\}$/.test(b)?/"(.*?)":(.*?)/g.test(b):!!/^\[(.*?)\]$/.test(b)&&b.replace(/^\[/,"").replace(/\]$/,"").replace(/},{/g,"}\n{").split(/\n/).map(function(b){return a.Ua(b)}).reduce(function(a,b){return!!b})))},a.Va=function(a){return"[object String]"===Object.prototype.toString.call(a)},a}(),e=function(){function a(){}return a.wa=function(b){return c.Aa.wa(b,a.Wa).toString(c.enc.Utf8)},a.va=function(b){return""+c.Aa.va(b,a.Wa)},a.Xa=function(b){return a.wa(b)},a.Ya=function(b){return a.va(b)},a.Za=function(b){return c.Aa.wa(b,a.$a).toString(c.enc.Utf8)},a._a=function(c,d){var e=b.loader.getRes(c),f=a.Za(e);switch(d){case b.Loader.JSON:return JSON.parse(f)}return null},a.Wa="xS40OKndVqdcCxRglgr",a.$a="74c13t82jhg3e34099c7d8432ciuhgf0",a}(),f=function(){function a(){if(this.eb="http://kownse.natapp1.cc",null!=a.cb)throw Error("game instance existed!");a.cb=this}return a.getInstance=function(){return a.cb},a.prototype.xb=function(){return this.code},a.prototype.Ue=function(){return this.eb},a.prototype.Ve=function(){return this.sign},Object.defineProperty(a.prototype,"TimeStamp",{get:function(){return this.timestamp},enumerable:!0,configurable:!0}),a.prototype.We=function(){return this.fb},a.prototype.Xe=function(){return this.gb},a.prototype.hb=function(){var a=this.jb(window.location,"c"),b=e.wa(a);b?(this.code=this.kb(b,"c"),this.eb="http://"+this.kb(b,"s")):this.eb="http://kownse.natapp1.cc"},a.prototype.jb=function(a,b){var c=RegExp("(^|&)"+b+"=([^&]*)(&|$)"),d=a.search.substr(1).match(c);return null!=d?decodeURI(d[2]):""},a.prototype.kb=function(a,b){var c=RegExp("(^|&)"+b+"=([^&]*)(&|$)"),d=c.exec(a);return d&&d.length>3?decodeURI(d[2]):""},a.cb=new a,a}(),g="score",h="askrank",i="askname",j="eliminate",k=function(){function a(){}return a.prototype.lb=function(){return!0},a.prototype.connect=function(b,c){a.owner=c},a.prototype.disconnect=function(){},a.prototype.mb=function(a){if(null!=a&&void 0!=a){var b=this.nb();b.open("GET",a,!0),b.setRequestHeader("cache-control","no-cache"),b.setRequestHeader("contentType","text/html;charset=uft-8"),b.onreadystatechange=function(){b.readyState},b.send()}},a.prototype.send=function(b,c){null!=c&&void 0!=c||(c={}),c.tag=b;var g=JSON.stringify(c),h=e.Ya(g),i=this.nb(),j="",k=f.getInstance().Ue()+"/api";i.open("POST",k,!0),i.setRequestHeader("cache-control","no-cache"),i.setRequestHeader("Content-Type","application/vnd.symbian.install"),i.onreadystatechange=function(){if(4==i.readyState){var c=200==i.status,f="";c&&(f=i.responseText,j=e.Xa(f),d.Ua(j)||(c=!1,j="")),null!=a.owner&&a.owner.pb(b,c,j)}},i.send(h)},a.prototype.nb=function(){return new XMLHttpRequest},a.owner=null,a}(),l=function(){function a(){if(this.rb=null,this.sb=null,this.tb=null,this.enable=!0,this.url="http://localhost:10666",null!=a.cb)throw Error("game instance existed!");a.cb=this,this.init()}return a.getInstance=function(){return a.cb},a.prototype.init=function(){this.sb=new k},a.prototype.connect=function(){this.enable&&this.sb&&this.sb.connect(this.url,this)},a.prototype.send=function(a,c,d,e){void 0===d&&(d=!0),void 0===e&&(e=null),this.sb&&(this.sb.send(a,c),d&&(this.rb=new J,b.stage.addChild(this.rb),this.rb.zOrder=100,this.rb.popup(!1))),this.tb=e},a.prototype.disconnect=function(){this.sb&&this.sb.disconnect()},a.prototype.pb=function(a,b,c){null!=this.rb&&(this.rb.close(),this.rb=null),null!=this.tb&&this.tb.call(this,a,b,c)},a.cb=new a,a}(),m=function(){function a(){if(this.code="",this.name="求名字",this.ub=0,this.wb=!1,null!=a.cb)throw Error("game instance existed!");a.cb=this}return a.getInstance=function(){return a.cb},a.prototype.xb=function(){return this.code},a.prototype.getName=function(){return this.name},a.prototype.yb=function(a){this.wb||(this.name=a,this.wb=!0)},a.prototype.zb=function(){return this.ub},a.prototype.Ab=function(a){this.ub=a},a.prototype.Bb=function(){return this.wb},a.prototype.Cb=function(){f.getInstance().hb(),this.Db();var a={app:j,code:this.code};l.getInstance().send("askname",a,!1,this.Eb.bind(this))},a.prototype.Eb=function(a,b,c){if("askname"==a&&1==b&&c.length>0){var d=JSON.parse(c);this.name=d.name,this.ub=d.score,this.code=d.code}},a.prototype.Db=function(){this.code=f.getInstance().xb()},a.cb=new a,a}(),n=function(){function a(){this.Gb=[],this.Hb=[]}return a.prototype.Ib=function(){this.Jb(),this.Kb(),this.Lb()},a.prototype.Mb=function(){var a=this.Nb();this.Ob(a)},a.prototype.Kb=function(){this.Gb=[],this.Gb.push([0]),this.Gb.push([])},a.prototype.Jb=function(){var a=v.getInstance().Pb;this.Hb=[],this.Hb.push(a),this.Hb.push(a)},a.prototype.Qb=function(a){for(var b=(v.getInstance().Pb,[]),c=0;c<a;c++)b.push(this.Rb());return b},a.prototype.Sb=function(a){v.getInstance().elements[a].type=this.Tb()},a.prototype.Ub=function(){for(var a=this.Vb(),b=this.Wb(a),c=v.getInstance(),d=c.Xb,e=a.length,f=b.length,g=0;g<f;g++){for(var h=b[g],i=[],j=[],k=c.Yb-1,l=c.Yb-1;l>=0;l--){for(var m=d[l][h],n=!1,o=0;o<e;o++)if(m==a[o]){j.push(a[o]),n=!0,l<k&&(k=l);break}n||m!=-1&&i.push(m)}i=j.concat(i);for(var l=c.Yb-1;l>=k;l--){var m=d[l][h];if(m!=-1){var p=l*c.Zb+h,q=i[0];d[l][h]=q,c.elements[q].location=p,i.shift()}}}},a.prototype.Wb=function(a){for(var b=v.getInstance(),c=(b.Xb,a.length),d=[],e=0;e<c;e++){for(var f=b.elements[a[e]].location%b.Zb,g=!1,h=d.length,i=0;i<h;i++)if(d[i]==f){g=!0;break}if(!g&&(d.push(f),d.length>=b.Zb))break}return d},a.prototype.Vb=function(){for(var a=[],b=p.$b.length,c=0;c<b;c++)for(var d=p.$b[c],e=d.line.length,f=0;f<e;f++){for(var g=!1,h=a.length,i=0;i<h;i++)if(a[i]==d.line[f]){g=!0;break}g||(this.Sb(d.line[f]),a.push(d.line[f]))}return a},a.prototype._b=function(){var a=this.Nb();this.ac(a)},a.prototype.Lb=function(){var a=this.bc();this.ac(a,w.Main)},a.prototype.Nb=function(){for(var a=[],b=[],c=v.getInstance(),d=c.Pb.length,e=1;e<d;e++)b.push(c.Pb[e]);return a.push(b),a.push([]),a},a.prototype.bc=function(){var a=[],b=[0];return a.push(b),a.push([]),a},a.prototype.ac=function(a,b){var c,d=v.getInstance(),e=d.Xb,f=(d.Yb,d.Zb,0);void 0==b&&(b=this.cc(a));for(var g=0;g<d.Yb;g++)for(var h=0;h<d.Zb;h++){var i=this.dc(a,g,h,b);c=this.ec(i),f=d.fc[0].id,d.elements[f].type=c,d.elements[f].location=g*d.Zb+h,e[g][h]=f,d.fc.shift()}},a.prototype.cc=function(a){var b=w.gc;return void 0!=a&&(a[0].length>0?b=w.hc:a[1].length>0&&(b=w.Main)),b},a.prototype.dc=function(a,b,c,d){var e=this.ic(b,c,d);return e[0]=e[0].concat(a[0]),e[1]=e[1].concat(a[1]),e},a.prototype.Ob=function(a){for(var b,c=v.getInstance(),d=c.Xb,e=(c.Yb,c.Zb,0),f=this.cc(a),g=0;g<c.Yb;g++)for(var h=0;h<c.Zb;h++){var i=this.dc(a,g,h,f);b=this.ec(i),e=g*c.Zb+h,c.elements[e].type=b,c.elements[e].location=g*c.Zb+h,d[g][h]=e}},a.prototype.ic=function(a,b,c){var d=[],e=v.getInstance(),f=e.Xb,g=[],h=[];if(a>1&&f[a-1][b]!=-1&&f[a-2][b]!=-1){var i=e.elements[f[a-1][b]],j=e.elements[f[a-2][b]];if(c==w.Main||c==w.gc){var k=i.type.jc;k==j.type.jc&&g.push(k)}else if(c==w.hc||c==w.gc){var l=i.type.sub,m=j.type.sub;l==m&&h.push(l)}}if(b>1&&f[a][b-1]!=-1&&f[a][b-2]!=-1){var i=e.elements[f[a][b-1]],j=e.elements[f[a][b-2]];if(c==w.Main||c==w.gc){var n=i.type.jc;n==j.type.jc&&g.push(n)}else if(c==w.hc||c==w.gc){var o=i.type.sub,p=j.type.sub;o==p&&h.push(o)}}return d.push(g),d.push(h),d},a.prototype.kc=function(a){var b=new x;return b.jc=a[0][Math.floor(Math.random()*a[0].length)],b.sub=a[1][Math.floor(Math.random()*a[1].length)],b},a.prototype.Rb=function(){return this.kc(this.Hb)},a.prototype.Tb=function(){return this.ec(this.Gb)},a.prototype.ec=function(a){var b=this.lc(a);return this.kc(b)},a.prototype.lc=function(a){var b=[];return b.push(this.mc(a[0])),b.push(this.mc(a[1])),b},a.prototype.mc=function(a){var b=a.length,c=v.getInstance().Pb;if(0==b)return c;for(var d=[],e=c.length,f=0;f<e;f++){for(var g=c[f],h=!1,i=0;i<b;i++)a[i]==g&&(h=!0);h||d.push(g)}return d},a}(),o=function(){function a(a,b){this.line=a,this.type=b}return a}(),p=function(){function a(){}return a.nc=function(){for(var b=0;b<w.gc;b++)if(a.oc(b,0==b))return!0;return!1},a.oc=function(b,c){void 0===c&&(c=!0),(c||null==a.$b)&&(a.$b=[]);for(var d=null,e=0,f=v.getInstance(),g=f.Xb,h=0,i=0;i<f.Yb;i++){for(h=0;h<f.Zb;h++)if(g[i][h]!=-1){var j=f.elements[g[i][h]];d&&d.isSame(j.type,b)?++e:(a.pc(i,h,e,b),d=j.type,e=1)}else a.pc(i,h,e,b),d=null,e=0;a.pc(i,h,e,b),d=null,e=0}for(var i=0;i<f.Zb;i++){for(var k=0;k<f.Yb;k++)if(g[k][i]!=-1){var j=f.elements[g[k][i]];d&&d.isSame(j.type,b)?++e:(a.qc(k,i,e,b),d=j.type,e=1)}else a.qc(k,i,e,b),d=null,e=0;a.qc(h,i,e,b),d=null,e=0}return a.$b.length>0},a.pc=function(b,c,d,e){if(d>=3){for(var f=v.getInstance(),g=f.Xb,h=[],i=(f.Zb,1);i<=d;i++)h.push(g[b][c-i]);return a.$b.push(new o(h,e)),!0}return!1},a.qc=function(b,c,d,e){if(d>=3){for(var f=v.getInstance().Xb,g=[],h=1;h<=d;h++)g.push(f[b-h][c]);return a.$b.push(new o(g,e)),!0}return!1},a.rc=function(){for(var b=v.getInstance(),c=b.Xb,d=0;d<b.Yb;d++)for(var e=0;e<b.Zb;e++)if(a.sc(c,b.elements,b.Yb,b.Zb,d,e,w.Main)||a.sc(c,b.elements,b.Yb,b.Zb,d,e,w.hc))return!0;return!1},a.sc=function(b,c,d,e,f,g,h){if(b[f][g]!=-1){if(g<e-1&&a.tc(b,c,f,g,0,1,h)){if(g>0&&b[f][g-1]!=-1){if(f>0&&a.tc(b,c,f,g,-1,-1,h))return!0;if(f<d-1&&a.tc(b,c,f,g,1,-1,h))return!0
;if(f<d-1&&a.tc(b,c,f,g,1,-1,h))return!0;if(f>0&&g>1&&a.tc(b,c,f,g,0,-2,h))return!0}if(g<e-1&&b[f][g+2]!=-1){if(g<e-2&&f>0&&a.tc(b,c,f,g,-1,2,h))return!0;if(g<e-2&&f<d-1&&a.tc(b,c,f,g,1,2,h))return!0;if(g<e-3&&a.tc(b,c,f,g,0,3,h))return!0}}if(f<d-1&&a.tc(b,c,f,g,1,0,h)){if(f>0&&b[f-1][g]!=-1){if(g>0&&a.tc(b,c,f,g,-1,-1,h))return!0;if(g<e-1&&a.tc(b,c,f,g,-1,1,h))return!0;if(f>1&&a.tc(b,c,f,g,-2,0,h))return!0}if(f<d-2&&b[f+2][g]!=-1){if(g>0&&a.tc(b,c,f,g,2,-1,h))return!0;if(g<e-1&&a.tc(b,c,f,g,2,1,h))return!0;if(f<d-3&&a.tc(b,c,f,g,3,0,h))return!0}}if(g<e-2&&a.tc(b,c,f,g,0,2,h)){if(f>0&&a.tc(b,c,f,g,-1,1,h))return!0;if(f<d-1&&a.tc(b,c,f,g,1,1,h))return!0}if(f<d-2&&a.tc(b,c,f,g,2,0,h)){if(g>0&&a.tc(b,c,f,g,1,-1,h))return!0;if(g<e-1&&a.tc(b,c,f,g,1,1,h))return!0}}},a.tc=function(a,b,c,d,e,f,g){var h=c+e,i=d+f;return!!(a[c][d]&&a[c][d]!=-1&&a[h][i]&&a[h][i]!=-1&&b[a[c][d]].type.isSame(b[a[h][i]].type,g))},a.uc=function(a,b,c,d){var e=v.getInstance(),f=e.Xb,g=Math.floor(a/e.Zb),h=a%e.Zb,i=Math.floor(b/e.Zb),j=b%e.Zb,k=f[g][h],l=f[i][j];f[g][h]=l,f[i][j]=k;var m=c.call(null,d);return m?(e.elements[k].location=b,e.elements[l].location=a):(f[g][h]=k,f[i][j]=l),m},a.vc=function(b,c){return a.uc(b,c,a.nc,0)},a.wc=function(b,c,d){return a.uc(b,c,a.oc,d)},a.xc=function(a,b){var c=v.getInstance(),d=c.Xb,e=Math.floor(a/c.Zb),f=a%c.Zb,g=Math.floor(b/c.Zb),h=b%c.Zb;if(d[e][f]==-1||d[g][h]==-1)return!1;var i=Math.abs(e-g),j=Math.abs(f-h);return 0==i&&1==j||1==i&&0==j},a.yc=function(){for(var a=v.getInstance(),b=a.Xb,c=[],d=0;d<a.Yb;d++)for(var e=0;e<a.Zb;e++)b[d][e]!=-1&&c.push(b[d][e]);for(var f=0,d=0;d<a.Yb;d++)for(var e=0;e<a.Zb;e++)f=Math.floor(Math.random()*c.length),b[d][e]=c[f],a.elements[c[f]].location=d*a.Zb+e,c.slice(f,1)},a.$b=null,a}(),q;!function(a){a[a.zc=0]="Wait",a[a.Ac=1]="End",a[a.Bc=2]="Runing"}(q||(q={}));var r=function(){function a(){if(this.Cc=q.Ac,this.Dc=120,this.score=0,null!=a.cb)throw Error("gamedata instance existed!");a.cb=this}return a.getInstance=function(){return a.cb},Object.defineProperty(a.prototype,"IsGameRunning",{get:function(){return this.Cc==q.Bc},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"getGameTime",{get:function(){return this.Dc},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"getScore",{get:function(){return Math.floor(this.score)},enumerable:!0,configurable:!0}),a.prototype.init=function(){v.getInstance().initData();var a=e._a("res/data/l1.bin",b.Loader.JSON);t.Ec(a),this.Fc=new n,this.Fc.Ib();var c=new b.Sprite;c.x=20,c.y=-20,b.stage.addChild(c),this.Gc=new L(c),this.Hc=new I,b.stage.addChild(this.Hc),this.Hc.visible=!1,this.Gc.on(s.Ic,this,this.Jc),this.Gc.on(s.Kc,this,this.Lc),this.Gc.on(s.Mc,this,this.Nc),this.Gc.on(s.Oc,this,this.Pc),this.Gc.on(s.Qc,this,this.Rc)},a.prototype.Sc=function(){this.Cc=q.Bc,this.Dc=v.getInstance().Dc,this.score=0,this.Hc.Tc(this.score),this.Hc.setTime(this.Dc),this.Hc.visible=!0,this.Hc.Uc(),this.Gc.Vc(),b.timer.loop(1e3,this,this.Wc)},a.prototype.Wc=function(){--this.Dc,this.Dc<=0&&(this.Dc=0,b.timer.clear(this,this.Wc),this.Xc()),this.Hc.setTime(this.Dc)},a.prototype.Jc=function(a,b){var c=v.getInstance(),d=c.Xb,e=Math.floor(a/c.Zb),f=a%c.Zb,g=Math.floor(b/c.Zb),h=b%c.Zb;p.xc(a,b)&&(p.vc(a,b)?(this.Gc.Yc(d[e][f],d[g][h]),c.Zc--,c.$c=!0):this.Gc._c(d[e][f],d[g][h]))},a.prototype.Lc=function(){for(var a=(v.getInstance(),p.$b.length),b=0;b<a;b++)for(var c=p.$b[b].line.length,d=0;d<c;d++)this.Gc.ad(p.$b[b].line[d])},a.prototype.Nc=function(){this.Fc.Ub(),this.Gc.bd()},a.prototype.Pc=function(){if(this.dd(p.$b),p.nc())this.Lc();else{if(!p.rc()){for(var a=!1,b=!1;b;)p.yc(),p.nc()||p.rc()&&(b=!1,a=!0);a&&this.Gc.updateOrder()}v.getInstance().$c=!1}},a.prototype.Xc=function(){this.Hc.ed("游戏结束！\n请刷新页面重新开始"),this.Cc=q.Ac;var a=new H;b.stage.addChild(a),a.popup()},a.prototype.fd=function(){b.stage.once(b.Event.CLICK,this,this.gd)},a.prototype.gd=function(){this.Hc.Uc(),a.getInstance().Sc()},a.prototype.Rc=function(a){},a.prototype.dd=function(a){for(var b=a.length,c=0,d=0,e=0;e<b;e++){var f=a[e];switch(d=0,f.type){case w.Main:d=3*Math.pow(f.line.length,1.3);break;case w.hc:d=f.line.length}c+=d}this.score+=c,this.Hc.Tc(this.score)},a.cb=new a,a}(),s=function(){function a(){}return a.Ic="tap_two_element",a.Kc="remove_animation_over",a.Mc="update_map",a.Qc="use_prop_click",a.Oc="update_view_over",a.hd="start_decay",a.jd="end_decay",a}(),t=function(){function a(){}return a.Ec=function(a){var b=v.getInstance();b.Yb=a.maxrow,b.Zb=a.maxcol,b.decay=a.decay,b.Dc=a.gtime;var c=a.map,d=c.length;b.kd=d;for(var e=0,f=0;f<d;f++){e=c[f];var g=Math.floor(e/b.Zb),h=e%b.Yb;b.Xb[g][h]=-1}b.ld=b.Yb*b.Zb-d,b.Pb=a.element},a}(),u=function(){function a(){}return a.md=function(b){var c=v.getInstance();c.Zc=b.step,c.nd=b.step,c.Pb=b.element,c.od=b.pd,a.qd(b.rd)},a.qd=function(a){v.getInstance()},a}(),v=function(){function a(){if(this.kd=0,this.Zc=0,this.nd=0,this.decay=1e4,this.Dc=120,this.od="",this.$c=!1,this.Yb=12,this.Zb=8,this.ld=0,null!=a.cb)throw Error("gamedata instance existed!");a.cb=this}return a.getInstance=function(){return a.cb},a.prototype.initData=function(){this.Xb=[];for(var a=0;a<this.Yb;a++){for(var b=[],c=0;c<this.Zb;c++)b.push(-2);this.Xb.push(b)}this.elements=[],this.fc=[];for(var d=this.Yb*this.Zb,a=0;a<d;a++){var e=new A;e.id=a,this.elements.push(e),this.fc.push(e)}},a.prototype.reset=function(){for(var a=this.elements.length,b=0;b<a;b++){this.elements[b].sd()}},a.cb=new a,a}(),w;!function(a){a[a.Main=0]="Main",a[a.hc=1]="Sub",a[a.gc=2]="All"}(w||(w={}));var x=function(){function a(){this.jc=-1,this.sub=-1,this.td=0}return a.prototype.clear=function(){this.jc=-1,this.sub=-1,this.td=0},a.prototype.reset=function(){this.jc=0,this.sub=0,this.td=0},a.prototype.isSame=function(a,b){switch(b){case w.Main:return 0!=this.jc&&this.jc==a.jc;case w.hc:return 0==this.jc&&0==a.jc&&this.sub==a.sub;case w.gc:return this.jc==a.jc&&this.sub==a.sub}},a}(),y=function(){function a(){}return a.prototype.sd=function(){this.type.reset()},a}(),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),A=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.id=0,b.location=0,b}return z(b,a),b}(y),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),B=laya.ui.View,C=laya.ui.Dialog,D;!function(a){var b=function(b){function c(){return b.call(this)||this}return z(c,b),c.prototype.createChildren=function(){b.prototype.createChildren.call(this),this.createView(a.ud.uiView)},c.uiView={type:"View",props:{width:640,height:1136},child:[{type:"Label",props:{y:383,x:38,width:568,text:"DECAY",height:105,fontSize:60,font:"Microsoft YaHei",color:"#e5e5e5",bold:!0,align:"center"}},{type:"Label",props:{y:461,x:38,width:568,text:"by kownse",height:105,fontSize:30,font:"Microsoft YaHei",color:"#e5e5e5",bold:!0,align:"center"}},{type:"Label",props:{y:662,x:38,width:568,var:"loading",text:"loading...(0%)",height:105,fontSize:30,font:"Microsoft YaHei",color:"#e5e5e5",bold:!0,align:"center"}},{type:"Label",props:{y:406,x:197,width:568,text:"v0.2",height:105,fontSize:30,font:"Microsoft YaHei",color:"#e5e5e5",bold:!0,align:"center"}}]},c}(B);a.ud=b}(D||(D={})),function(a){var b=function(b){function c(){return b.call(this)||this}return z(c,b),c.prototype.createChildren=function(){b.prototype.createChildren.call(this),this.createView(a.vd.uiView)},c.uiView={type:"View",props:{width:640,height:1136},child:[{type:"Image",props:{y:0,x:0,width:640,skin:"comp/bg.png",height:1136,sizeGrid:"28,7,7,5"}},{type:"Button",props:{y:595,x:198,width:253,var:"btnStart",skin:"comp/button.png",mouseThrough:!1,labelSize:24,wd:"Microsoft YaHei",label:"开始游戏",height:77,sizeGrid:"2,3,3,3"}},{type:"Button",props:{y:757,x:198,width:253,var:"btnRank",skin:"comp/button.png",mouseThrough:!1,labelSize:24,wd:"Microsoft YaHei",label:"查看排行",height:77,sizeGrid:"2,3,3,3"}},{type:"Label",props:{y:306,x:32,width:568,text:"DECAY",height:105,fontSize:60,font:"Microsoft YaHei",color:"#060606",bold:!0,align:"center"}},{type:"Label",props:{y:398,x:92,width:568,text:"by kownse",height:105,fontSize:30,font:"Microsoft YaHei",color:"#010101",bold:!0,align:"center"}},{type:"Label",props:{y:341,x:405,width:165,text:"v0.2",height:40,fontSize:30,font:"Microsoft YaHei",color:"#010101",bold:!0,align:"center"}}]},c}(B);a.vd=b}(D||(D={})),function(a){var b=function(b){function c(){return b.call(this)||this}return z(c,b),c.prototype.createChildren=function(){b.prototype.createChildren.call(this),this.createView(a.xd.uiView)},c.uiView={type:"Dialog",props:{width:500,height:800},child:[{type:"Image",props:{y:0,x:0,width:500,skin:"comp/bg.png",height:800,sizeGrid:"28,7,7,5"}},{type:"List",props:{y:174,x:49,width:391,var:"lstRank",vScrollBarSkin:"comp/vscroll.png",spaceY:5,yd:0,repeatY:12,repeatX:1,height:571},child:[{type:"Box",props:{name:"render"},child:[{type:"Label",props:{y:1,x:26,width:155,text:"玩家名",name:"name",height:34,fontSize:28,font:"Microsoft YaHei"}},{type:"Label",props:{y:1,x:197,width:150,text:"得分",name:"score",height:34,fontSize:28,font:"Microsoft YaHei",align:"center"}}]}]},{type:"Label",props:{y:130,x:73,width:155,text:"玩家名",height:34,fontSize:30,font:"Microsoft YaHei",bold:!0}},{type:"Label",props:{y:130,x:289,width:150,text:"得分",height:34,fontSize:30,font:"Microsoft YaHei",bold:!0}},{type:"Button",props:{y:0,x:452,width:44,var:"btnClose",skin:"comp/btn_close.png",height:27}},{type:"Label",props:{y:56,x:156,width:175,text:"积分排名",height:48,fontSize:30,font:"Microsoft YaHei",bold:!0,align:"center"}}]},c}(C);a.xd=b}(D||(D={})),function(a){var b=function(b){function c(){return b.call(this)||this}return z(c,b),c.prototype.createChildren=function(){b.prototype.createChildren.call(this),this.createView(a.zd.uiView)},c.uiView={type:"Dialog",props:{width:400,mouseThrough:!1,height:300},child:[{type:"Image",props:{y:-2,x:2,width:400,skin:"comp/bg.png",mouseThrough:!1,height:300,sizeGrid:"28,7,7,5"}},{type:"Button",props:{y:-1,x:363,width:39,var:"btnClose",skin:"comp/btn_close.png",mouseThrough:!1,height:25}},{type:"Button",props:{y:218,x:59,width:135,var:"btnSendScore",skin:"comp/button.png",mouseThrough:!1,labelSize:24,wd:"Microsoft YaHei",label:"上传分数",height:43,sizeGrid:"2,3,3,3"}},{type:"TextInput",props:{y:159,x:198,width:131,var:"input_name",text:"无名氏",skin:"comp/textinput.png",mouseThrough:!1,maxChars:6,height:32,fontSize:20,font:"Microsoft YaHei",sizeGrid:"3,5,5,5"}},{type:"Label",props:{y:161,x:83,width:103,text:"请留下大名",height:28,fontSize:20,font:"Microsoft YaHei"}},{type:"Label",props:{y:117,x:114,width:82,text:"得分",height:22,fontSize:20,font:"Microsoft YaHei"}},{type:"Label",props:{y:113,x:203,width:97,var:"score",text:"0",height:31,fontSize:24,font:"Microsoft YaHei",color:"#ee0e0b",align:"left"}},{type:"Label",props:{y:57,x:92,width:220,var:"titletip",text:"恭喜您达到新高度！",height:35,fontSize:24,font:"Microsoft YaHei",color:"#ee0e0b",align:"center"}},{type:"Button",props:{y:218,x:221,width:135,var:"btnRank",skin:"comp/button.png",mouseThrough:!1,labelSize:24,wd:"Microsoft YaHei",label:"查看排名",height:43,sizeGrid:"2,3,3,3"}}]},c}(C);a.zd=b}(D||(D={})),function(a){var b=function(b){function c(){return b.call(this)||this}return z(c,b),c.prototype.createChildren=function(){b.prototype.createChildren.call(this),this.createView(a.Ad.uiView)},c.uiView={type:"View",props:{width:640,height:1136},child:[{type:"Box",props:{y:8,x:69},child:[{type:"Label",props:{x:128,width:128,text:"SCORE",height:42,fontSize:30,font:"Microsoft YaHei",color:"#ece9e9",bold:!0,anchorX:1,align:"center"}},{type:"Label",props:{y:0,x:132,width:183,var:"score",text:"0",overflow:"visible",height:42,fontSize:30,font:"Microsoft YaHei",color:"#ece9e9",bold:!0,anchorX:0,align:"left"}}]},{type:"Box",props:{y:8,x:395},child:[{type:"Label",props:{x:128,width:128,text:"TIME",height:42,fontSize:30,font:"Microsoft YaHei",color:"#ece9e9",bold:!0,anchorX:1,align:"center"}},{type:"Label",props:{y:0,x:117,width:183,var:"time",text:"0",overflow:"visible",height:42,fontSize:30,font:"Microsoft YaHei",color:"#ece9e9",bold:!0,anchorX:0,align:"left"}}]},{type:"Label",props:{y:533,x:612,width:566,var:"msg",text:"msg",height:150,fontSize:40,font:"Microsoft YaHei",color:"#ece9e9",bold:!0,anchorX:1,align:"center"}}]},c}(B);a.Ad=b}(D||(D={})),function(a){var b=function(b){function c(){return b.call(this)||this}return z(c,b),c.prototype.createChildren=function(){b.prototype.createChildren.call(this),this.createView(a.Bd.uiView)},c.uiView={type:"Dialog",props:{width:300,popupCenter:!0,mouseThrough:!1,mouseEnabled:!1,height:130},child:[{type:"Image",props:{y:0,x:0,width:300,skin:"comp/bg.png",height:130,sizeGrid:"28,7,7,5"}},{type:"Label",props:{y:47.5,x:70.5,width:159,text:"wait",height:35,fontSize:30,font:"Microsoft YaHei",align:"center"}}]},c}(C);a.Bd=b}(D||(D={}));var z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),E=function(a){function b(){return a.call(this)||this}return z(b,a),b.prototype.Cd=function(a){this.loading.text="loading...("+a.toFixed(2)+")"},b}(D.ud),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),F=function(a){function c(){var b=a.call(this)||this;return b.init(),b}return z(c,a),c.prototype.init=function(){this.btnStart.on(b.Event.CLICK,this,this.Dd),this.btnRank.on(b.Event.CLICK,this,this.Ed)},c.prototype.Dd=function(){r.getInstance().Sc(),this.removeSelf(),this.destroy()},c.prototype.Ed=function(){G.show()},c}(D.vd),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),G=function(a){function c(){var b=a.call(this)||this;return b.init(),b}return z(c,a),c.prototype.init=function(){this.lstRank.array=[],this.btnClose.on(b.Event.CLICK,this,this.close),this.Fd()},c.prototype.Gd=function(){this.Fd()},c.prototype.Hd=function(a,b,c){if(1==b&&"askrank"==a&&c.length>0){var d=JSON.parse(c);d.sort(function(a,b){return b.score-a.score}),this.lstRank.array=d}},c.prototype.Fd=function(){var a={app:j};l.getInstance().send("askrank",a,!0,this.Hd.bind(this))},c.show=function(){var a=new c;b.stage.addChild(a),a.zOrder=b.stage.numChildren+1,a.popup(!1)},c}(D.xd),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),H=function(a){function c(){var b=a.call(this)||this;return b.Id=!1,b.ub=0,b.Jd="",b.init(),b}return z(c,a),c.prototype.init=function(){this.Id=m.getInstance().Bb(),this.ub=m.getInstance().zb();var a=r.getInstance().getScore;a>this.ub?(this.score.text=a+" > "+this.ub,this.titletip.visible=!0,this.titletip.text="恭喜您达到新高度！"):(this.score.text=a+" < "+this.ub,this.titletip.visible=!0,this.titletip.text="很遗憾不如上次"),this.Jd=m.getInstance().getName(),this.input_name.text=this.Jd,this.input_name.disabled=!0,this.btnSendScore.on(b.Event.CLICK,this,this.Kd),this.btnClose.on(b.Event.CLICK,this,this.Ld),this.btnRank.on(b.Event.CLICK,this,function(){G.show()})},c.prototype.Ld=function(){this.close()},c.prototype.Kd=function(){var a=r.getInstance().getScore,b=this.input_name.text,c=!this.Id&&b!=this.Jd;c&&m.getInstance().yb(b);var d={app:j,score:a,name:b,code:m.getInstance().xb(),Md:!c};l.getInstance().send("score",d,!0,this.Nd.bind(this))},c.prototype.Nd=function(a,b,c){if("score"==a)if(b){if(this.titletip.text="分数上报成功",this.titletip.color="#0baa0b",this.btnSendScore.disabled=!0,c.length>0){var d=JSON.parse(c).score;m.getInstance().Ab(d)}}else this.titletip.text="分数上报失败"},c.prototype.close=function(b){"side"!==b&&a.prototype.close.call(this,b)},c}(D.zd),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),I=function(a){function b(){return a.call(this)||this}return z(b,a),b.prototype.setTime=function(a){this.time.text=""+Math.floor(a)},b.prototype.Tc=function(a){this.score.text=""+Math.floor(a)},b.prototype.ed=function(a){this.msg.text=a,this.msg.visible=!0},b.prototype.Uc=function(){this.msg.visible=!1},b}(D.Ad),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),J=function(a){function b(){return a.call(this)||this}return z(b,a),b.prototype.close=function(b){"side"!==b&&a.prototype.close.call(this,b)},b}(D.Bd),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),K=function(a){function c(b,c){var d=a.call(this)||this;return d.location=0,d._id=-1,d.Od=!1,d.Pd=null,d.Qd=null,d._focus=!1,d.Rd=!1,d.Sd=b,d.Pd=c,d.init(),d}return z(c,a),Object.defineProperty(c.prototype,"IsMoving",{get:function(){return this.Od},enumerable:!0,configurable:!0}),c.prototype.Td=function(){this.Od=!1},c.prototype.init=function(){this.mouseEnabled=!0,this.Ud(),this.width=c._gridSize-10,this.height=c._gridSize-10,this.pivotX=c._gridSize/2,this.pivotY=c._gridSize/2},c.prototype.Vd=function(a){var c=b.loader.getRes(a);c.width=this.width,c.height=this.height,this.texture=c},c.prototype.Wd=function(a){a.jc>0&&(null==this.Qd||!this.Qd.isSame(a,w.gc))&&(this.Qd=a,b.timer.once(v.getInstance().decay,this,this.Xd))},c.prototype.Xd=function(){null!=this.Qd&&(this.Qd.td>=1?(this.Qd.jc=0,this.Qd.td=0,this.Vd(this.Pd.Yd(this.Qd)),this.Qd=null):this.Qd.td<1&&(this.Qd.td=1,this.Vd(this.Pd.Yd(this.Qd)),b.timer.once(v.getInstance().decay,this,this.Xd)))},Object.defineProperty(c.prototype,"focus",{get:function(){return this._focus},enumerable:!0,configurable:!0}),c.prototype.move=function(){this.Od=!0,b.Tween.to(this,{x:this.targetX(),y:this.targetY()},c.speed,b.Ease.cubicInOut,b.Handler.create(this,this.Td))},c.prototype.targetX=function(){return this.Zd(this.location)},c.prototype.targetY=function(){return this.$d(this.location)},c.prototype.Zd=function(a){return c._gridSize*(a%v.getInstance().Zb)+c._gridSize/2},c.prototype.$d=function(a){var b=v.getInstance();return(c._gridSize+5)*b.Yb-c._gridSize*Math.floor(a/b.Zb)+c._gridSize/2},c.prototype.show=function(a){b.timer.once(a,this,this._d)},c.prototype._d=function(){this.parent||(this.Sd.addChild(this),this.Od=!0,b.Tween.to(this,{x:this.targetX(),y:this.targetY()},c.speed,b.Ease.bounceOut,b.Handler.create(this,this.Td)))},c.prototype.ae=function(a,d){void 0===d&&(d=!1);var e=this.Zd(a),f=this.$d(a);this.Od=!0;var g=d?1.2:.8,h={x:e,y:f,scaleX:g,scaleY:g};b.Tween.to(this,h,c.be,b.Ease.cubicOut,b.Handler.create(this,this.back))},c.prototype.back=function(){this.Od=!0,b.Tween.to(this,{x:this.targetX(),y:this.targetY(),scaleX:1,scaleY:1},c.be,b.Ease.cubicOut,b.Handler.create(this,this.Td))},c.prototype.ce=function(a,d){void 0===d&&(d=!1);var e=this.Zd(a),f=this.$d(a);this.Od=!0;var g=d?1.4:.6,h={x:e,y:f,scaleX:g,scaleY:g};b.Tween.to(this,h,c.be,b.Ease.cubicOut,b.Handler.create(this,this.de))},c.prototype.de=function(){this.Od=!0,b.Tween.to(this,{scaleX:1,scaleY:1},c.be,b.Ease.backOut,b.Handler.create(this,this.ee))},c.prototype.ee=function(){this.Td(),this.event(s.Kc)},c.prototype.fe=function(a,d){this.Od=!0,b.Tween.to(this,{x:a,y:d},c.speed,b.Ease.quadOut,b.Handler.create(this,this.ge))},c.prototype.ge=function(){this.Td(),this.removeSelf(),this.event(s.Mc)},c.prototype.Ud=function(){if(0==c._gridSize){var a=v.getInstance(),d=b.stage.width-40;c._gridSize=d/a.Zb}return c._gridSize},c.prototype.ad=function(){this.Od=!0,b.Tween.to(this,{scaleX:1.4,scaleY:1.4},c.be,b.Ease.cubicInOut).to(this,{scaleX:.1,scaleY:.1},c.be,b.Ease.cubicInOut,b.Handler.create(this,this.he))},c.prototype.he=function(){this.Td(),this.removeSelf(),this.event(s.Mc)},c.prototype.ie=function(){var a=!1;this.parent||(this.y=0,this.x=this.targetX(),this.scaleX=1,this.scaleY=1,this.Sd.addChild(this));var d=this.targetX(),e=this.targetY();return this.x!=d||this.y!=e?(this.Od=!0,b.Tween.to(this,{x:this.targetX(),y:this.targetY()},c.be,b.Ease.linearOut,b.Handler.create(this,this.je)),a=!0):this.je(),a},c.prototype.je=function(){this.Td(),this.event(s.Oc)},c.prototype.ke=function(a){var b=a?1.15:1;this.scaleX=b,this.scaleY=b,this.Rd=a},c.speed=600,c.be=200,c._gridSize=0,c}(b.Sprite),z=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),L=function(a){function c(b){var c=a.call(this)||this;return c.le="grids",c.me=-1,c.ne=-1,c.oe=-1,c.pe=0,c.qe=0,c.re=0,c.se=b,c.init(),c}return z(c,a),c.prototype.init=function(){var a=v.getInstance();this.te=[];for(var c,d=a.Zb*a.Yb,e=0;e<d;e++)c=new K(this.se,this),c._id=e,c.location=a.elements[e].location,this.te.push(c),c.on(b.Event.MOUSE_DOWN,this,this.ue),c.on(b.Event.MOUSE_UP,this,this.ve),c.on(s.Kc,this,this.Lc),c.on(s.Mc,this,this.we),c.on(s.Oc,this,this.je);b.stage.on(b.Event.MOUSE_UP,this,this.xe)},c.prototype.ue=function(a){if(!r.getInstance().IsGameRunning)return void this.ye();if(v.getInstance().$c)return void this.ye();var b=null;a.target instanceof K?(b=a.target,b.ze||(b.ke(!0),this.oe=b.location,this.me=a.stageX,this.ne=a.stageY)):(this.oe!=-1&&(this.oe=-1),b&&this.event(s.Qc,[b.location]))},c.prototype.ve=function(a){if(!r.getInstance().IsGameRunning)return void this.ye();if(v.getInstance().$c)return void this.ye();var b=null;a.target instanceof K&&(b=a.target,this.oe!=-1&&b.location!=this.oe&&this.Ae(a)),this.Be(a)},c.prototype.Ae=function(a){if(this.me!=-1&&this.ne!=-1&&this.oe!=-1){var b=a.stageX-this.me,c=a.stageY-this.ne,d=Math.abs(b),e=Math.abs(c);if(!(d<5&&e<5)){d>e?c=0:b=0;var f=v.getInstance(),g=Math.floor(this.oe/f.Zb),h=this.oe%f.Zb,i=-1,j=-1;i=g>0&&c>0?g-1:g<f.Yb-1&&c<0?g+1:g,j=h>0&&b<0?h-1:h<f.Zb-1&&b>0?h+1:h;var k=i*f.Zb+j;this.te[k].ze||this.event(s.Ic,[this.oe,k])}}},c.prototype.xe=function(a){this.Ae(a),this.Be(a)},c.prototype.Be=function(a){this.ye(),a.stopPropagation()},c.prototype.ye=function(){this.oe>=0&&(this.te[this.oe].ke(!1),this.oe=-1),this.me=-1,this.ne=-1},c.prototype.Ce=function(a){a.stopPropagation()},c.prototype.De=function(a){this.Be(a)},c.prototype.Ee=function(a){this.te[this.oe].ke(!1),this.te[a].ke(!0),this.oe=a},c.prototype._c=function(a,b){var c=this.te[a],d=this.te[b];c.focus?this.Fe(c,d):this.Fe(d,c),this.oe=-1},c.prototype.Fe=function(a,b){this.Ge(a,b),a.ae(b.location,!0),b.ae(a.location)},c.prototype.Ge=function(a,b){a.ke(!1);var c=this.se.getChildIndex(a),d=this.se.getChildIndex(b);c<d&&(this.se.setChildIndex(a,d),this.se.setChildIndex(b,c))},c.prototype.Yc=function(a,b){var c=this.te[a],d=this.te[b];c.focus?this.He(c,d):this.He(d,c),this.oe=-1},c.prototype.He=function(a,b){this.Ge(a,b),a.ce(b.location,!0),b.ce(a.location)},c.prototype.Vc=function(){this.se.removeChildren();for(var a,c=v.getInstance(),d=c.Xb,e=(b.stage.width,c.Zb,0);e<c.Yb;e++)for(var f=0;f<c.Zb;f++)if(d[e][f]!=-1){var g=e*c.Zb+f;a=this.te[g];var h=c.elements[d[e][f]],i=this.Yd(h.type);a.Vd(i),a.Wd(h.type),a.x=a.targetX(),a.y=0+a.width,a.show(20*c.Zb*c.Yb-20*c.kd-20*((c.Yb-e)*c.Yb+f))}},c.prototype.Ie=function(a){return this.Yd(v.getInstance().elements[a].type)},c.prototype.Yd=function(a){var b=a.jc,c=a.sub,d=a.td;return this.le+"/"+b+c+d+".png"},c.prototype.Lc=function(){2==++this.pe&&(this.pe=0,this.event(s.Kc))},c.prototype.Je=function(a,b,c){++this.qe;var d=this.te[a];d.parent&&this.se.setChildIndex(d,this.se.numChildren),d.fe(b,c)},c.prototype.ad=function(a){++this.qe;var b=this.te[a];b.parent&&this.se.setChildIndex(b,this.se.numChildren-1),b.ad()},c.prototype.we=function(){0==--this.qe&&this.event(s.Mc)},c.prototype.bd=function(){this.re=0;for(var a=v.getInstance(),b=this.te.length,c=0;c<b;c++){var d=this.te[c];d.location=a.elements[c].location,d.Vd(this.Ie(c)),d.Wd(a.elements[c].type),d.ie()}},c.prototype.Ke=function(a){for(var b=v.getInstance(),c=a[0],d=a[1],e=c.length,f=0;f<e;f++){var g=c[f],h=this.te[g];if(null!=h){var i=b.elements[d[f]];h.location=i.location,h.Vd(this.Ie(i.id)),h.Wd(i.type),h.ie()}}},c.prototype.Le=function(a){for(var b=this.te.length,c=0;c<b;c++){var d=this.te[c];if(d.location==a)return d}return null},c.prototype.je=function(){this.re++;var a=v.getInstance(),b=a.Yb*a.Zb;this.re==b&&this.event(s.Oc)},c.prototype.updateOrder=function(){for(var a=v.getInstance(),c=this.te.length,d=0;d<c;d++){var e=this.te[d];b.Tween.clearAll(e),e.location=a.elements[d].location,e.move()}},c.prototype.Me=function(){var a=v.getInstance(),c=new b.Sprite;c.y=200,this.se.addChild(c);for(var d=[],e=0,f=0;f<a.Yb;f++)for(var g=0;g<a.Zb;g++){var h=Math.floor(5*Math.random()),i=Math.floor(5*Math.random()),j=Math.floor(2*Math.random()),k="candis/"+h+i+j+".png",l=b.loader.getRes(k),m=new b.Sprite;m.texture=l,m.x=f*l.width+10,m.y=g*l.height,c.addChild(m),d.push(m),0==e&&(e=l.width)}c.scaleX=(b.stage.width-40)/e/a.Yb,c.scaleY=c.scaleX},c}(b.Sprite),M=function(){function a(){this.Ne=null,this.Oe=null,b.init(640,960,b.WebGL),b.stage.scaleMode=b.Stage.SCALE_SHOWALL,b.stage.alignH=b.Stage.ALIGN_CENTER,b.stage.alignV=b.Stage.ALIGN_MIDDLE,b.Browser.onMobile&&(b.stage.screenMode=b.Stage.SCREEN_VERTICAL),this.Pe(),this.Qe(),m.getInstance().Cb()}return a.prototype.Pe=function(){this.Oe=new E,b.stage.addChild(this.Oe),l.getInstance().connect()},a.prototype.Re=function(){this.Oe&&(this.Oe.removeSelf(),this.Oe.destroy(),this.Oe=null)},a.prototype.Qe=function(){var a=[{url:"res/atlas/grids.json",type:b.Loader.ATLAS},{url:"res/atlas/comp.json",type:b.Loader.ATLAS},{url:"res/data/l1.bin",type:b.Loader.TEXT}];b.loader.load(a,b.Handler.create(this,this.onLoaded),b.Handler.create(this,this.Se))},a.prototype.Se=function(a){null!=this.Oe&&this.Oe.Cd(100*a)},a.prototype.onLoaded=function(){this.Re(),this.Te(),r.getInstance().init()},a.prototype.Te=function(){var a=new F;b.stage.addChild(a)},a}();new M;